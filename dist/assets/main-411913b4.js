var UP=Object.defineProperty;var BP=(t,e,n)=>e in t?UP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Pw=(t,e,n)=>(BP(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function $P(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vT={exports:{}},Cf={},wT={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pu=Symbol.for("react.element"),zP=Symbol.for("react.portal"),qP=Symbol.for("react.fragment"),HP=Symbol.for("react.strict_mode"),GP=Symbol.for("react.profiler"),WP=Symbol.for("react.provider"),KP=Symbol.for("react.context"),QP=Symbol.for("react.forward_ref"),YP=Symbol.for("react.suspense"),JP=Symbol.for("react.memo"),XP=Symbol.for("react.lazy"),kw=Symbol.iterator;function ZP(t){return t===null||typeof t!="object"?null:(t=kw&&t[kw]||t["@@iterator"],typeof t=="function"?t:null)}var IT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ET=Object.assign,TT={};function il(t,e,n){this.props=t,this.context=e,this.refs=TT,this.updater=n||IT}il.prototype.isReactComponent={};il.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};il.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function AT(){}AT.prototype=il.prototype;function Ay(t,e,n){this.props=t,this.context=e,this.refs=TT,this.updater=n||IT}var Ry=Ay.prototype=new AT;Ry.constructor=Ay;ET(Ry,il.prototype);Ry.isPureReactComponent=!0;var Cw=Array.isArray,RT=Object.prototype.hasOwnProperty,Sy={current:null},ST={key:!0,ref:!0,__self:!0,__source:!0};function bT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)RT.call(e,r)&&!ST.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Pu,type:t,key:s,ref:o,props:i,_owner:Sy.current}}function ek(t,e){return{$$typeof:Pu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function by(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pu}function tk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Nw=/\/+/g;function Gp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?tk(""+t.key):e.toString(36)}function od(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Pu:case zP:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gp(o,0):r,Cw(i)?(n="",t!=null&&(n=t.replace(Nw,"$&/")+"/"),od(i,e,n,"",function(u){return u})):i!=null&&(by(i)&&(i=ek(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Nw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Cw(t))for(var a=0;a<t.length;a++){s=t[a];var c=r+Gp(s,a);o+=od(s,e,n,c,i)}else if(c=ZP(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=r+Gp(s,a++),o+=od(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ph(t,e,n){if(t==null)return t;var r=[],i=0;return od(t,r,"","",function(s){return e.call(n,s,i++)}),r}function nk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Qt={current:null},ad={transition:null},rk={ReactCurrentDispatcher:Qt,ReactCurrentBatchConfig:ad,ReactCurrentOwner:Sy};function xT(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:Ph,forEach:function(t,e,n){Ph(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ph(t,function(){e++}),e},toArray:function(t){return Ph(t,function(e){return e})||[]},only:function(t){if(!by(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=il;fe.Fragment=qP;fe.Profiler=GP;fe.PureComponent=Ay;fe.StrictMode=HP;fe.Suspense=YP;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rk;fe.act=xT;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ET({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Sy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)RT.call(e,c)&&!ST.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Pu,type:t.type,key:i,ref:s,props:r,_owner:o}};fe.createContext=function(t){return t={$$typeof:KP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:WP,_context:t},t.Consumer=t};fe.createElement=bT;fe.createFactory=function(t){var e=bT.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:QP,render:t}};fe.isValidElement=by;fe.lazy=function(t){return{$$typeof:XP,_payload:{_status:-1,_result:t},_init:nk}};fe.memo=function(t,e){return{$$typeof:JP,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=ad.transition;ad.transition={};try{t()}finally{ad.transition=e}};fe.unstable_act=xT;fe.useCallback=function(t,e){return Qt.current.useCallback(t,e)};fe.useContext=function(t){return Qt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return Qt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return Qt.current.useEffect(t,e)};fe.useId=function(){return Qt.current.useId()};fe.useImperativeHandle=function(t,e,n){return Qt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return Qt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return Qt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return Qt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return Qt.current.useReducer(t,e,n)};fe.useRef=function(t){return Qt.current.useRef(t)};fe.useState=function(t){return Qt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return Qt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return Qt.current.useTransition()};fe.version="18.3.1";wT.exports=fe;var ie=wT.exports;const ik=$P(ie);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sk=ie,ok=Symbol.for("react.element"),ak=Symbol.for("react.fragment"),lk=Object.prototype.hasOwnProperty,ck=sk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uk={key:!0,ref:!0,__self:!0,__source:!0};function PT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)lk.call(e,r)&&!uk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:ok,type:t,key:s,ref:o,props:i,_owner:ck.current}}Cf.Fragment=ak;Cf.jsx=PT;Cf.jsxs=PT;vT.exports=Cf;var g=vT.exports,Gm={},kT={exports:{}},bn={},CT={exports:{}},NT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,te){var oe=K.length;K.push(te);e:for(;0<oe;){var be=oe-1>>>1,ye=K[be];if(0<i(ye,te))K[be]=te,K[oe]=ye,oe=be;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var te=K[0],oe=K.pop();if(oe!==te){K[0]=oe;e:for(var be=0,ye=K.length,xe=ye>>>1;be<xe;){var ht=2*(be+1)-1,Nt=K[ht],Cn=ht+1,Dt=K[Cn];if(0>i(Nt,oe))Cn<ye&&0>i(Dt,Nt)?(K[be]=Dt,K[Cn]=oe,be=Cn):(K[be]=Nt,K[ht]=oe,be=ht);else if(Cn<ye&&0>i(Dt,oe))K[be]=Dt,K[Cn]=oe,be=Cn;else break e}}return te}function i(K,te){var oe=K.sortIndex-te.sortIndex;return oe!==0?oe:K.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],u=[],h=1,f=null,p=3,v=!1,b=!1,P=!1,C=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(K){for(var te=n(u);te!==null;){if(te.callback===null)r(u);else if(te.startTime<=K)r(u),te.sortIndex=te.expirationTime,e(c,te);else break;te=n(u)}}function V(K){if(P=!1,R(K),!b)if(n(c)!==null)b=!0,ws(B);else{var te=n(u);te!==null&&kn(V,te.startTime-K)}}function B(K,te){b=!1,P&&(P=!1,E(_),_=-1),v=!0;var oe=p;try{for(R(te),f=n(c);f!==null&&(!(f.expirationTime>te)||K&&!k());){var be=f.callback;if(typeof be=="function"){f.callback=null,p=f.priorityLevel;var ye=be(f.expirationTime<=te);te=t.unstable_now(),typeof ye=="function"?f.callback=ye:f===n(c)&&r(c),R(te)}else r(c);f=n(c)}if(f!==null)var xe=!0;else{var ht=n(u);ht!==null&&kn(V,ht.startTime-te),xe=!1}return xe}finally{f=null,p=oe,v=!1}}var $=!1,A=null,_=-1,S=5,T=-1;function k(){return!(t.unstable_now()-T<S)}function N(){if(A!==null){var K=t.unstable_now();T=K;var te=!0;try{te=A(!0,K)}finally{te?x():($=!1,A=null)}}else $=!1}var x;if(typeof w=="function")x=function(){w(N)};else if(typeof MessageChannel<"u"){var Rt=new MessageChannel,Jt=Rt.port2;Rt.port1.onmessage=N,x=function(){Jt.postMessage(null)}}else x=function(){C(N,0)};function ws(K){A=K,$||($=!0,x())}function kn(K,te){_=C(function(){K(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){b||v||(b=!0,ws(B))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(K){switch(p){case 1:case 2:case 3:var te=3;break;default:te=p}var oe=p;p=te;try{return K()}finally{p=oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,te){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var oe=p;p=K;try{return te()}finally{p=oe}},t.unstable_scheduleCallback=function(K,te,oe){var be=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?be+oe:be):oe=be,K){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=oe+ye,K={id:h++,callback:te,priorityLevel:K,startTime:oe,expirationTime:ye,sortIndex:-1},oe>be?(K.sortIndex=oe,e(u,K),n(c)===null&&K===n(u)&&(P?(E(_),_=-1):P=!0,kn(V,oe-be))):(K.sortIndex=ye,e(c,K),b||v||(b=!0,ws(B))),K},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(K){var te=p;return function(){var oe=p;p=te;try{return K.apply(this,arguments)}finally{p=oe}}}})(NT);CT.exports=NT;var hk=CT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dk=ie,An=hk;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var DT=new Set,$c={};function Io(t,e){Pa(t,e),Pa(t+"Capture",e)}function Pa(t,e){for($c[t]=e,t=0;t<e.length;t++)DT.add(e[t])}var Br=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wm=Object.prototype.hasOwnProperty,fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dw={},Ow={};function pk(t){return Wm.call(Ow,t)?!0:Wm.call(Dw,t)?!1:fk.test(t)?Ow[t]=!0:(Dw[t]=!0,!1)}function mk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gk(t,e,n,r){if(e===null||typeof e>"u"||mk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ct={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ct[t]=new Yt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ct[e]=new Yt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ct[t]=new Yt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ct[t]=new Yt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ct[t]=new Yt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ct[t]=new Yt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ct[t]=new Yt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ct[t]=new Yt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ct[t]=new Yt(t,5,!1,t.toLowerCase(),null,!1,!1)});var xy=/[\-:]([a-z])/g;function Py(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xy,Py);Ct[e]=new Yt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xy,Py);Ct[e]=new Yt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xy,Py);Ct[e]=new Yt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ct[t]=new Yt(t,1,!1,t.toLowerCase(),null,!1,!1)});Ct.xlinkHref=new Yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ct[t]=new Yt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ky(t,e,n,r){var i=Ct.hasOwnProperty(e)?Ct[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gk(e,n,i,r)&&(n=null),r||i===null?pk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Jr=dk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kh=Symbol.for("react.element"),sa=Symbol.for("react.portal"),oa=Symbol.for("react.fragment"),Cy=Symbol.for("react.strict_mode"),Km=Symbol.for("react.profiler"),OT=Symbol.for("react.provider"),LT=Symbol.for("react.context"),Ny=Symbol.for("react.forward_ref"),Qm=Symbol.for("react.suspense"),Ym=Symbol.for("react.suspense_list"),Dy=Symbol.for("react.memo"),Si=Symbol.for("react.lazy"),VT=Symbol.for("react.offscreen"),Lw=Symbol.iterator;function ql(t){return t===null||typeof t!="object"?null:(t=Lw&&t[Lw]||t["@@iterator"],typeof t=="function"?t:null)}var We=Object.assign,Wp;function oc(t){if(Wp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wp=e&&e[1]||""}return`
`+Wp+t}var Kp=!1;function Qp(t,e){if(!t||Kp)return"";Kp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Kp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?oc(t):""}function yk(t){switch(t.tag){case 5:return oc(t.type);case 16:return oc("Lazy");case 13:return oc("Suspense");case 19:return oc("SuspenseList");case 0:case 2:case 15:return t=Qp(t.type,!1),t;case 11:return t=Qp(t.type.render,!1),t;case 1:return t=Qp(t.type,!0),t;default:return""}}function Jm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case oa:return"Fragment";case sa:return"Portal";case Km:return"Profiler";case Cy:return"StrictMode";case Qm:return"Suspense";case Ym:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case LT:return(t.displayName||"Context")+".Consumer";case OT:return(t._context.displayName||"Context")+".Provider";case Ny:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Dy:return e=t.displayName||null,e!==null?e:Jm(t.type)||"Memo";case Si:e=t._payload,t=t._init;try{return Jm(t(e))}catch{}}return null}function _k(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jm(e);case 8:return e===Cy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ns(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function MT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function vk(t){var e=MT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ch(t){t._valueTracker||(t._valueTracker=vk(t))}function FT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=MT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Od(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Xm(t,e){var n=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Vw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ns(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jT(t,e){e=e.checked,e!=null&&ky(t,"checked",e,!1)}function Zm(t,e){jT(t,e);var n=ns(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?eg(t,e.type,n):e.hasOwnProperty("defaultValue")&&eg(t,e.type,ns(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Mw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function eg(t,e,n){(e!=="number"||Od(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ac=Array.isArray;function ya(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ns(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function tg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Fw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(ac(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ns(n)}}function UT(t,e){var n=ns(e.value),r=ns(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function jw(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function BT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ng(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?BT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Nh,$T=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Nh=Nh||document.createElement("div"),Nh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Nh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var yc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wk=["Webkit","ms","Moz","O"];Object.keys(yc).forEach(function(t){wk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yc[e]=yc[t]})});function zT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||yc.hasOwnProperty(t)&&yc[t]?(""+e).trim():e+"px"}function qT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=zT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Ik=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rg(t,e){if(e){if(Ik[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function ig(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sg=null;function Oy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var og=null,_a=null,va=null;function Uw(t){if(t=Nu(t)){if(typeof og!="function")throw Error(z(280));var e=t.stateNode;e&&(e=Vf(e),og(t.stateNode,t.type,e))}}function HT(t){_a?va?va.push(t):va=[t]:_a=t}function GT(){if(_a){var t=_a,e=va;if(va=_a=null,Uw(t),e)for(t=0;t<e.length;t++)Uw(e[t])}}function WT(t,e){return t(e)}function KT(){}var Yp=!1;function QT(t,e,n){if(Yp)return t(e,n);Yp=!0;try{return WT(t,e,n)}finally{Yp=!1,(_a!==null||va!==null)&&(KT(),GT())}}function qc(t,e){var n=t.stateNode;if(n===null)return null;var r=Vf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var ag=!1;if(Br)try{var Hl={};Object.defineProperty(Hl,"passive",{get:function(){ag=!0}}),window.addEventListener("test",Hl,Hl),window.removeEventListener("test",Hl,Hl)}catch{ag=!1}function Ek(t,e,n,r,i,s,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var _c=!1,Ld=null,Vd=!1,lg=null,Tk={onError:function(t){_c=!0,Ld=t}};function Ak(t,e,n,r,i,s,o,a,c){_c=!1,Ld=null,Ek.apply(Tk,arguments)}function Rk(t,e,n,r,i,s,o,a,c){if(Ak.apply(this,arguments),_c){if(_c){var u=Ld;_c=!1,Ld=null}else throw Error(z(198));Vd||(Vd=!0,lg=u)}}function Eo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function YT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Bw(t){if(Eo(t)!==t)throw Error(z(188))}function Sk(t){var e=t.alternate;if(!e){if(e=Eo(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Bw(i),t;if(s===r)return Bw(i),e;s=s.sibling}throw Error(z(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function JT(t){return t=Sk(t),t!==null?XT(t):null}function XT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=XT(t);if(e!==null)return e;t=t.sibling}return null}var ZT=An.unstable_scheduleCallback,$w=An.unstable_cancelCallback,bk=An.unstable_shouldYield,xk=An.unstable_requestPaint,rt=An.unstable_now,Pk=An.unstable_getCurrentPriorityLevel,Ly=An.unstable_ImmediatePriority,eA=An.unstable_UserBlockingPriority,Md=An.unstable_NormalPriority,kk=An.unstable_LowPriority,tA=An.unstable_IdlePriority,Nf=null,yr=null;function Ck(t){if(yr&&typeof yr.onCommitFiberRoot=="function")try{yr.onCommitFiberRoot(Nf,t,void 0,(t.current.flags&128)===128)}catch{}}var tr=Math.clz32?Math.clz32:Ok,Nk=Math.log,Dk=Math.LN2;function Ok(t){return t>>>=0,t===0?32:31-(Nk(t)/Dk|0)|0}var Dh=64,Oh=4194304;function lc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Fd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=lc(a):(s&=o,s!==0&&(r=lc(s)))}else o=n&~i,o!==0?r=lc(o):s!==0&&(r=lc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-tr(e),i=1<<n,r|=t[n],e&=~i;return r}function Lk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-tr(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=Lk(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function cg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function nA(){var t=Dh;return Dh<<=1,!(Dh&4194240)&&(Dh=64),t}function Jp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ku(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-tr(e),t[e]=n}function Mk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-tr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Vy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-tr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ae=0;function rA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var iA,My,sA,oA,aA,ug=!1,Lh=[],zi=null,qi=null,Hi=null,Hc=new Map,Gc=new Map,Pi=[],Fk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zw(t,e){switch(t){case"focusin":case"focusout":zi=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":Hi=null;break;case"pointerover":case"pointerout":Hc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(e.pointerId)}}function Gl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Nu(e),e!==null&&My(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function jk(t,e,n,r,i){switch(e){case"focusin":return zi=Gl(zi,t,e,n,r,i),!0;case"dragenter":return qi=Gl(qi,t,e,n,r,i),!0;case"mouseover":return Hi=Gl(Hi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Hc.set(s,Gl(Hc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Gc.set(s,Gl(Gc.get(s)||null,t,e,n,r,i)),!0}return!1}function lA(t){var e=Bs(t.target);if(e!==null){var n=Eo(e);if(n!==null){if(e=n.tag,e===13){if(e=YT(n),e!==null){t.blockedOn=e,aA(t.priority,function(){sA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ld(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=hg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);sg=r,n.target.dispatchEvent(r),sg=null}else return e=Nu(n),e!==null&&My(e),t.blockedOn=n,!1;e.shift()}return!0}function qw(t,e,n){ld(t)&&n.delete(e)}function Uk(){ug=!1,zi!==null&&ld(zi)&&(zi=null),qi!==null&&ld(qi)&&(qi=null),Hi!==null&&ld(Hi)&&(Hi=null),Hc.forEach(qw),Gc.forEach(qw)}function Wl(t,e){t.blockedOn===e&&(t.blockedOn=null,ug||(ug=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,Uk)))}function Wc(t){function e(i){return Wl(i,t)}if(0<Lh.length){Wl(Lh[0],t);for(var n=1;n<Lh.length;n++){var r=Lh[n];r.blockedOn===t&&(r.blockedOn=null)}}for(zi!==null&&Wl(zi,t),qi!==null&&Wl(qi,t),Hi!==null&&Wl(Hi,t),Hc.forEach(e),Gc.forEach(e),n=0;n<Pi.length;n++)r=Pi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Pi.length&&(n=Pi[0],n.blockedOn===null);)lA(n),n.blockedOn===null&&Pi.shift()}var wa=Jr.ReactCurrentBatchConfig,jd=!0;function Bk(t,e,n,r){var i=Ae,s=wa.transition;wa.transition=null;try{Ae=1,Fy(t,e,n,r)}finally{Ae=i,wa.transition=s}}function $k(t,e,n,r){var i=Ae,s=wa.transition;wa.transition=null;try{Ae=4,Fy(t,e,n,r)}finally{Ae=i,wa.transition=s}}function Fy(t,e,n,r){if(jd){var i=hg(t,e,n,r);if(i===null)am(t,e,r,Ud,n),zw(t,r);else if(jk(i,t,e,n,r))r.stopPropagation();else if(zw(t,r),e&4&&-1<Fk.indexOf(t)){for(;i!==null;){var s=Nu(i);if(s!==null&&iA(s),s=hg(t,e,n,r),s===null&&am(t,e,r,Ud,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else am(t,e,r,null,n)}}var Ud=null;function hg(t,e,n,r){if(Ud=null,t=Oy(r),t=Bs(t),t!==null)if(e=Eo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=YT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ud=t,null}function cA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Pk()){case Ly:return 1;case eA:return 4;case Md:case kk:return 16;case tA:return 536870912;default:return 16}default:return 16}}var Fi=null,jy=null,cd=null;function uA(){if(cd)return cd;var t,e=jy,n=e.length,r,i="value"in Fi?Fi.value:Fi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return cd=i.slice(t,1<r?1-r:void 0)}function ud(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Vh(){return!0}function Hw(){return!1}function xn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Vh:Hw,this.isPropagationStopped=Hw,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vh)},persist:function(){},isPersistent:Vh}),e}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uy=xn(sl),Cu=We({},sl,{view:0,detail:0}),zk=xn(Cu),Xp,Zp,Kl,Df=We({},Cu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:By,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Kl&&(Kl&&t.type==="mousemove"?(Xp=t.screenX-Kl.screenX,Zp=t.screenY-Kl.screenY):Zp=Xp=0,Kl=t),Xp)},movementY:function(t){return"movementY"in t?t.movementY:Zp}}),Gw=xn(Df),qk=We({},Df,{dataTransfer:0}),Hk=xn(qk),Gk=We({},Cu,{relatedTarget:0}),em=xn(Gk),Wk=We({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),Kk=xn(Wk),Qk=We({},sl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Yk=xn(Qk),Jk=We({},sl,{data:0}),Ww=xn(Jk),Xk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eC[t])?!!e[t]:!1}function By(){return tC}var nC=We({},Cu,{key:function(t){if(t.key){var e=Xk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ud(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Zk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:By,charCode:function(t){return t.type==="keypress"?ud(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ud(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rC=xn(nC),iC=We({},Df,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kw=xn(iC),sC=We({},Cu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:By}),oC=xn(sC),aC=We({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),lC=xn(aC),cC=We({},Df,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),uC=xn(cC),hC=[9,13,27,32],$y=Br&&"CompositionEvent"in window,vc=null;Br&&"documentMode"in document&&(vc=document.documentMode);var dC=Br&&"TextEvent"in window&&!vc,hA=Br&&(!$y||vc&&8<vc&&11>=vc),Qw=String.fromCharCode(32),Yw=!1;function dA(t,e){switch(t){case"keyup":return hC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var aa=!1;function fC(t,e){switch(t){case"compositionend":return fA(e);case"keypress":return e.which!==32?null:(Yw=!0,Qw);case"textInput":return t=e.data,t===Qw&&Yw?null:t;default:return null}}function pC(t,e){if(aa)return t==="compositionend"||!$y&&dA(t,e)?(t=uA(),cd=jy=Fi=null,aa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return hA&&e.locale!=="ko"?null:e.data;default:return null}}var mC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!mC[t.type]:e==="textarea"}function pA(t,e,n,r){HT(r),e=Bd(e,"onChange"),0<e.length&&(n=new Uy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var wc=null,Kc=null;function gC(t){RA(t,0)}function Of(t){var e=ua(t);if(FT(e))return t}function yC(t,e){if(t==="change")return e}var mA=!1;if(Br){var tm;if(Br){var nm="oninput"in document;if(!nm){var Xw=document.createElement("div");Xw.setAttribute("oninput","return;"),nm=typeof Xw.oninput=="function"}tm=nm}else tm=!1;mA=tm&&(!document.documentMode||9<document.documentMode)}function Zw(){wc&&(wc.detachEvent("onpropertychange",gA),Kc=wc=null)}function gA(t){if(t.propertyName==="value"&&Of(Kc)){var e=[];pA(e,Kc,t,Oy(t)),QT(gC,e)}}function _C(t,e,n){t==="focusin"?(Zw(),wc=e,Kc=n,wc.attachEvent("onpropertychange",gA)):t==="focusout"&&Zw()}function vC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Of(Kc)}function wC(t,e){if(t==="click")return Of(e)}function IC(t,e){if(t==="input"||t==="change")return Of(e)}function EC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ir=typeof Object.is=="function"?Object.is:EC;function Qc(t,e){if(ir(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Wm.call(e,i)||!ir(t[i],e[i]))return!1}return!0}function e0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function t0(t,e){var n=e0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=e0(n)}}function yA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?yA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function _A(){for(var t=window,e=Od();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Od(t.document)}return e}function zy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function TC(t){var e=_A(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&yA(n.ownerDocument.documentElement,n)){if(r!==null&&zy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=t0(n,s);var o=t0(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var AC=Br&&"documentMode"in document&&11>=document.documentMode,la=null,dg=null,Ic=null,fg=!1;function n0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;fg||la==null||la!==Od(r)||(r=la,"selectionStart"in r&&zy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ic&&Qc(Ic,r)||(Ic=r,r=Bd(dg,"onSelect"),0<r.length&&(e=new Uy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=la)))}function Mh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ca={animationend:Mh("Animation","AnimationEnd"),animationiteration:Mh("Animation","AnimationIteration"),animationstart:Mh("Animation","AnimationStart"),transitionend:Mh("Transition","TransitionEnd")},rm={},vA={};Br&&(vA=document.createElement("div").style,"AnimationEvent"in window||(delete ca.animationend.animation,delete ca.animationiteration.animation,delete ca.animationstart.animation),"TransitionEvent"in window||delete ca.transitionend.transition);function Lf(t){if(rm[t])return rm[t];if(!ca[t])return t;var e=ca[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in vA)return rm[t]=e[n];return t}var wA=Lf("animationend"),IA=Lf("animationiteration"),EA=Lf("animationstart"),TA=Lf("transitionend"),AA=new Map,r0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hs(t,e){AA.set(t,e),Io(e,[t])}for(var im=0;im<r0.length;im++){var sm=r0[im],RC=sm.toLowerCase(),SC=sm[0].toUpperCase()+sm.slice(1);hs(RC,"on"+SC)}hs(wA,"onAnimationEnd");hs(IA,"onAnimationIteration");hs(EA,"onAnimationStart");hs("dblclick","onDoubleClick");hs("focusin","onFocus");hs("focusout","onBlur");hs(TA,"onTransitionEnd");Pa("onMouseEnter",["mouseout","mouseover"]);Pa("onMouseLeave",["mouseout","mouseover"]);Pa("onPointerEnter",["pointerout","pointerover"]);Pa("onPointerLeave",["pointerout","pointerover"]);Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Io("onBeforeInput",["compositionend","keypress","textInput","paste"]);Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bC=new Set("cancel close invalid load scroll toggle".split(" ").concat(cc));function i0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Rk(r,e,void 0,t),t.currentTarget=null}function RA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;i0(i,a,u),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;i0(i,a,u),s=c}}}if(Vd)throw t=lg,Vd=!1,lg=null,t}function Le(t,e){var n=e[_g];n===void 0&&(n=e[_g]=new Set);var r=t+"__bubble";n.has(r)||(SA(e,t,2,!1),n.add(r))}function om(t,e,n){var r=0;e&&(r|=4),SA(n,t,r,e)}var Fh="_reactListening"+Math.random().toString(36).slice(2);function Yc(t){if(!t[Fh]){t[Fh]=!0,DT.forEach(function(n){n!=="selectionchange"&&(bC.has(n)||om(n,!1,t),om(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Fh]||(e[Fh]=!0,om("selectionchange",!1,e))}}function SA(t,e,n,r){switch(cA(e)){case 1:var i=Bk;break;case 4:i=$k;break;default:i=Fy}n=i.bind(null,e,n,t),i=void 0,!ag||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function am(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Bs(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}QT(function(){var u=s,h=Oy(n),f=[];e:{var p=AA.get(t);if(p!==void 0){var v=Uy,b=t;switch(t){case"keypress":if(ud(n)===0)break e;case"keydown":case"keyup":v=rC;break;case"focusin":b="focus",v=em;break;case"focusout":b="blur",v=em;break;case"beforeblur":case"afterblur":v=em;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Gw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Hk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=oC;break;case wA:case IA:case EA:v=Kk;break;case TA:v=lC;break;case"scroll":v=zk;break;case"wheel":v=uC;break;case"copy":case"cut":case"paste":v=Yk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Kw}var P=(e&4)!==0,C=!P&&t==="scroll",E=P?p!==null?p+"Capture":null:p;P=[];for(var w=u,R;w!==null;){R=w;var V=R.stateNode;if(R.tag===5&&V!==null&&(R=V,E!==null&&(V=qc(w,E),V!=null&&P.push(Jc(w,V,R)))),C)break;w=w.return}0<P.length&&(p=new v(p,b,null,n,h),f.push({event:p,listeners:P}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",p&&n!==sg&&(b=n.relatedTarget||n.fromElement)&&(Bs(b)||b[$r]))break e;if((v||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,v?(b=n.relatedTarget||n.toElement,v=u,b=b?Bs(b):null,b!==null&&(C=Eo(b),b!==C||b.tag!==5&&b.tag!==6)&&(b=null)):(v=null,b=u),v!==b)){if(P=Gw,V="onMouseLeave",E="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(P=Kw,V="onPointerLeave",E="onPointerEnter",w="pointer"),C=v==null?p:ua(v),R=b==null?p:ua(b),p=new P(V,w+"leave",v,n,h),p.target=C,p.relatedTarget=R,V=null,Bs(h)===u&&(P=new P(E,w+"enter",b,n,h),P.target=R,P.relatedTarget=C,V=P),C=V,v&&b)t:{for(P=v,E=b,w=0,R=P;R;R=Ho(R))w++;for(R=0,V=E;V;V=Ho(V))R++;for(;0<w-R;)P=Ho(P),w--;for(;0<R-w;)E=Ho(E),R--;for(;w--;){if(P===E||E!==null&&P===E.alternate)break t;P=Ho(P),E=Ho(E)}P=null}else P=null;v!==null&&s0(f,p,v,P,!1),b!==null&&C!==null&&s0(f,C,b,P,!0)}}e:{if(p=u?ua(u):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var B=yC;else if(Jw(p))if(mA)B=IC;else{B=vC;var $=_C}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(B=wC);if(B&&(B=B(t,u))){pA(f,B,n,h);break e}$&&$(t,p,u),t==="focusout"&&($=p._wrapperState)&&$.controlled&&p.type==="number"&&eg(p,"number",p.value)}switch($=u?ua(u):window,t){case"focusin":(Jw($)||$.contentEditable==="true")&&(la=$,dg=u,Ic=null);break;case"focusout":Ic=dg=la=null;break;case"mousedown":fg=!0;break;case"contextmenu":case"mouseup":case"dragend":fg=!1,n0(f,n,h);break;case"selectionchange":if(AC)break;case"keydown":case"keyup":n0(f,n,h)}var A;if($y)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else aa?dA(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(hA&&n.locale!=="ko"&&(aa||_!=="onCompositionStart"?_==="onCompositionEnd"&&aa&&(A=uA()):(Fi=h,jy="value"in Fi?Fi.value:Fi.textContent,aa=!0)),$=Bd(u,_),0<$.length&&(_=new Ww(_,t,null,n,h),f.push({event:_,listeners:$}),A?_.data=A:(A=fA(n),A!==null&&(_.data=A)))),(A=dC?fC(t,n):pC(t,n))&&(u=Bd(u,"onBeforeInput"),0<u.length&&(h=new Ww("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=A))}RA(f,e)})}function Jc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Bd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=qc(t,n),s!=null&&r.unshift(Jc(t,s,i)),s=qc(t,e),s!=null&&r.push(Jc(t,s,i))),t=t.return}return r}function Ho(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function s0(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,u=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&u!==null&&(a=u,i?(c=qc(n,s),c!=null&&o.unshift(Jc(n,c,a))):i||(c=qc(n,s),c!=null&&o.push(Jc(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var xC=/\r\n?/g,PC=/\u0000|\uFFFD/g;function o0(t){return(typeof t=="string"?t:""+t).replace(xC,`
`).replace(PC,"")}function jh(t,e,n){if(e=o0(e),o0(t)!==e&&n)throw Error(z(425))}function $d(){}var pg=null,mg=null;function gg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yg=typeof setTimeout=="function"?setTimeout:void 0,kC=typeof clearTimeout=="function"?clearTimeout:void 0,a0=typeof Promise=="function"?Promise:void 0,CC=typeof queueMicrotask=="function"?queueMicrotask:typeof a0<"u"?function(t){return a0.resolve(null).then(t).catch(NC)}:yg;function NC(t){setTimeout(function(){throw t})}function lm(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Wc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Wc(e)}function Gi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function l0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ol=Math.random().toString(36).slice(2),dr="__reactFiber$"+ol,Xc="__reactProps$"+ol,$r="__reactContainer$"+ol,_g="__reactEvents$"+ol,DC="__reactListeners$"+ol,OC="__reactHandles$"+ol;function Bs(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[$r]||n[dr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=l0(t);t!==null;){if(n=t[dr])return n;t=l0(t)}return e}t=n,n=t.parentNode}return null}function Nu(t){return t=t[dr]||t[$r],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ua(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function Vf(t){return t[Xc]||null}var vg=[],ha=-1;function ds(t){return{current:t}}function Fe(t){0>ha||(t.current=vg[ha],vg[ha]=null,ha--)}function Ne(t,e){ha++,vg[ha]=t.current,t.current=e}var rs={},qt=ds(rs),an=ds(!1),no=rs;function ka(t,e){var n=t.type.contextTypes;if(!n)return rs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ln(t){return t=t.childContextTypes,t!=null}function zd(){Fe(an),Fe(qt)}function c0(t,e,n){if(qt.current!==rs)throw Error(z(168));Ne(qt,e),Ne(an,n)}function bA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(z(108,_k(t)||"Unknown",i));return We({},n,r)}function qd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||rs,no=qt.current,Ne(qt,t),Ne(an,an.current),!0}function u0(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=bA(t,e,no),r.__reactInternalMemoizedMergedChildContext=t,Fe(an),Fe(qt),Ne(qt,t)):Fe(an),Ne(an,n)}var Nr=null,Mf=!1,cm=!1;function xA(t){Nr===null?Nr=[t]:Nr.push(t)}function LC(t){Mf=!0,xA(t)}function fs(){if(!cm&&Nr!==null){cm=!0;var t=0,e=Ae;try{var n=Nr;for(Ae=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Nr=null,Mf=!1}catch(i){throw Nr!==null&&(Nr=Nr.slice(t+1)),ZT(Ly,fs),i}finally{Ae=e,cm=!1}}return null}var da=[],fa=0,Hd=null,Gd=0,On=[],Ln=0,ro=null,Dr=1,Or="";function ks(t,e){da[fa++]=Gd,da[fa++]=Hd,Hd=t,Gd=e}function PA(t,e,n){On[Ln++]=Dr,On[Ln++]=Or,On[Ln++]=ro,ro=t;var r=Dr;t=Or;var i=32-tr(r)-1;r&=~(1<<i),n+=1;var s=32-tr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Dr=1<<32-tr(e)+i|n<<i|r,Or=s+t}else Dr=1<<s|n<<i|r,Or=t}function qy(t){t.return!==null&&(ks(t,1),PA(t,1,0))}function Hy(t){for(;t===Hd;)Hd=da[--fa],da[fa]=null,Gd=da[--fa],da[fa]=null;for(;t===ro;)ro=On[--Ln],On[Ln]=null,Or=On[--Ln],On[Ln]=null,Dr=On[--Ln],On[Ln]=null}var wn=null,_n=null,$e=!1,Zn=null;function kA(t,e){var n=Vn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function h0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,wn=t,_n=Gi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,wn=t,_n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ro!==null?{id:Dr,overflow:Or}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,wn=t,_n=null,!0):!1;default:return!1}}function wg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ig(t){if($e){var e=_n;if(e){var n=e;if(!h0(t,e)){if(wg(t))throw Error(z(418));e=Gi(n.nextSibling);var r=wn;e&&h0(t,e)?kA(r,n):(t.flags=t.flags&-4097|2,$e=!1,wn=t)}}else{if(wg(t))throw Error(z(418));t.flags=t.flags&-4097|2,$e=!1,wn=t}}}function d0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;wn=t}function Uh(t){if(t!==wn)return!1;if(!$e)return d0(t),$e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!gg(t.type,t.memoizedProps)),e&&(e=_n)){if(wg(t))throw CA(),Error(z(418));for(;e;)kA(t,e),e=Gi(e.nextSibling)}if(d0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){_n=Gi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}_n=null}}else _n=wn?Gi(t.stateNode.nextSibling):null;return!0}function CA(){for(var t=_n;t;)t=Gi(t.nextSibling)}function Ca(){_n=wn=null,$e=!1}function Gy(t){Zn===null?Zn=[t]:Zn.push(t)}var VC=Jr.ReactCurrentBatchConfig;function Ql(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function Bh(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function f0(t){var e=t._init;return e(t._payload)}function NA(t){function e(E,w){if(t){var R=E.deletions;R===null?(E.deletions=[w],E.flags|=16):R.push(w)}}function n(E,w){if(!t)return null;for(;w!==null;)e(E,w),w=w.sibling;return null}function r(E,w){for(E=new Map;w!==null;)w.key!==null?E.set(w.key,w):E.set(w.index,w),w=w.sibling;return E}function i(E,w){return E=Yi(E,w),E.index=0,E.sibling=null,E}function s(E,w,R){return E.index=R,t?(R=E.alternate,R!==null?(R=R.index,R<w?(E.flags|=2,w):R):(E.flags|=2,w)):(E.flags|=1048576,w)}function o(E){return t&&E.alternate===null&&(E.flags|=2),E}function a(E,w,R,V){return w===null||w.tag!==6?(w=gm(R,E.mode,V),w.return=E,w):(w=i(w,R),w.return=E,w)}function c(E,w,R,V){var B=R.type;return B===oa?h(E,w,R.props.children,V,R.key):w!==null&&(w.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Si&&f0(B)===w.type)?(V=i(w,R.props),V.ref=Ql(E,w,R),V.return=E,V):(V=yd(R.type,R.key,R.props,null,E.mode,V),V.ref=Ql(E,w,R),V.return=E,V)}function u(E,w,R,V){return w===null||w.tag!==4||w.stateNode.containerInfo!==R.containerInfo||w.stateNode.implementation!==R.implementation?(w=ym(R,E.mode,V),w.return=E,w):(w=i(w,R.children||[]),w.return=E,w)}function h(E,w,R,V,B){return w===null||w.tag!==7?(w=Qs(R,E.mode,V,B),w.return=E,w):(w=i(w,R),w.return=E,w)}function f(E,w,R){if(typeof w=="string"&&w!==""||typeof w=="number")return w=gm(""+w,E.mode,R),w.return=E,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case kh:return R=yd(w.type,w.key,w.props,null,E.mode,R),R.ref=Ql(E,null,w),R.return=E,R;case sa:return w=ym(w,E.mode,R),w.return=E,w;case Si:var V=w._init;return f(E,V(w._payload),R)}if(ac(w)||ql(w))return w=Qs(w,E.mode,R,null),w.return=E,w;Bh(E,w)}return null}function p(E,w,R,V){var B=w!==null?w.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return B!==null?null:a(E,w,""+R,V);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case kh:return R.key===B?c(E,w,R,V):null;case sa:return R.key===B?u(E,w,R,V):null;case Si:return B=R._init,p(E,w,B(R._payload),V)}if(ac(R)||ql(R))return B!==null?null:h(E,w,R,V,null);Bh(E,R)}return null}function v(E,w,R,V,B){if(typeof V=="string"&&V!==""||typeof V=="number")return E=E.get(R)||null,a(w,E,""+V,B);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case kh:return E=E.get(V.key===null?R:V.key)||null,c(w,E,V,B);case sa:return E=E.get(V.key===null?R:V.key)||null,u(w,E,V,B);case Si:var $=V._init;return v(E,w,R,$(V._payload),B)}if(ac(V)||ql(V))return E=E.get(R)||null,h(w,E,V,B,null);Bh(w,V)}return null}function b(E,w,R,V){for(var B=null,$=null,A=w,_=w=0,S=null;A!==null&&_<R.length;_++){A.index>_?(S=A,A=null):S=A.sibling;var T=p(E,A,R[_],V);if(T===null){A===null&&(A=S);break}t&&A&&T.alternate===null&&e(E,A),w=s(T,w,_),$===null?B=T:$.sibling=T,$=T,A=S}if(_===R.length)return n(E,A),$e&&ks(E,_),B;if(A===null){for(;_<R.length;_++)A=f(E,R[_],V),A!==null&&(w=s(A,w,_),$===null?B=A:$.sibling=A,$=A);return $e&&ks(E,_),B}for(A=r(E,A);_<R.length;_++)S=v(A,E,_,R[_],V),S!==null&&(t&&S.alternate!==null&&A.delete(S.key===null?_:S.key),w=s(S,w,_),$===null?B=S:$.sibling=S,$=S);return t&&A.forEach(function(k){return e(E,k)}),$e&&ks(E,_),B}function P(E,w,R,V){var B=ql(R);if(typeof B!="function")throw Error(z(150));if(R=B.call(R),R==null)throw Error(z(151));for(var $=B=null,A=w,_=w=0,S=null,T=R.next();A!==null&&!T.done;_++,T=R.next()){A.index>_?(S=A,A=null):S=A.sibling;var k=p(E,A,T.value,V);if(k===null){A===null&&(A=S);break}t&&A&&k.alternate===null&&e(E,A),w=s(k,w,_),$===null?B=k:$.sibling=k,$=k,A=S}if(T.done)return n(E,A),$e&&ks(E,_),B;if(A===null){for(;!T.done;_++,T=R.next())T=f(E,T.value,V),T!==null&&(w=s(T,w,_),$===null?B=T:$.sibling=T,$=T);return $e&&ks(E,_),B}for(A=r(E,A);!T.done;_++,T=R.next())T=v(A,E,_,T.value,V),T!==null&&(t&&T.alternate!==null&&A.delete(T.key===null?_:T.key),w=s(T,w,_),$===null?B=T:$.sibling=T,$=T);return t&&A.forEach(function(N){return e(E,N)}),$e&&ks(E,_),B}function C(E,w,R,V){if(typeof R=="object"&&R!==null&&R.type===oa&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case kh:e:{for(var B=R.key,$=w;$!==null;){if($.key===B){if(B=R.type,B===oa){if($.tag===7){n(E,$.sibling),w=i($,R.props.children),w.return=E,E=w;break e}}else if($.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Si&&f0(B)===$.type){n(E,$.sibling),w=i($,R.props),w.ref=Ql(E,$,R),w.return=E,E=w;break e}n(E,$);break}else e(E,$);$=$.sibling}R.type===oa?(w=Qs(R.props.children,E.mode,V,R.key),w.return=E,E=w):(V=yd(R.type,R.key,R.props,null,E.mode,V),V.ref=Ql(E,w,R),V.return=E,E=V)}return o(E);case sa:e:{for($=R.key;w!==null;){if(w.key===$)if(w.tag===4&&w.stateNode.containerInfo===R.containerInfo&&w.stateNode.implementation===R.implementation){n(E,w.sibling),w=i(w,R.children||[]),w.return=E,E=w;break e}else{n(E,w);break}else e(E,w);w=w.sibling}w=ym(R,E.mode,V),w.return=E,E=w}return o(E);case Si:return $=R._init,C(E,w,$(R._payload),V)}if(ac(R))return b(E,w,R,V);if(ql(R))return P(E,w,R,V);Bh(E,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,w!==null&&w.tag===6?(n(E,w.sibling),w=i(w,R),w.return=E,E=w):(n(E,w),w=gm(R,E.mode,V),w.return=E,E=w),o(E)):n(E,w)}return C}var Na=NA(!0),DA=NA(!1),Wd=ds(null),Kd=null,pa=null,Wy=null;function Ky(){Wy=pa=Kd=null}function Qy(t){var e=Wd.current;Fe(Wd),t._currentValue=e}function Eg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ia(t,e){Kd=t,Wy=pa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(nn=!0),t.firstContext=null)}function Fn(t){var e=t._currentValue;if(Wy!==t)if(t={context:t,memoizedValue:e,next:null},pa===null){if(Kd===null)throw Error(z(308));pa=t,Kd.dependencies={lanes:0,firstContext:t}}else pa=pa.next=t;return e}var $s=null;function Yy(t){$s===null?$s=[t]:$s.push(t)}function OA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Yy(e)):(n.next=i.next,i.next=n),e.interleaved=n,zr(t,r)}function zr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var bi=!1;function Jy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Wi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,_e&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,zr(t,n)}return i=r.interleaved,i===null?(e.next=e,Yy(r)):(e.next=i.next,i.next=e),r.interleaved=e,zr(t,n)}function hd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vy(t,n)}}function p0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qd(t,e,n,r){var i=t.updateQueue;bi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,h=u=c=null,a=s;do{var p=a.lane,v=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,P=a;switch(p=e,v=n,P.tag){case 1:if(b=P.payload,typeof b=="function"){f=b.call(v,f,p);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=P.payload,p=typeof b=="function"?b.call(v,f,p):b,p==null)break e;f=We({},f,p);break e;case 2:bi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else v={eventTime:v,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=v,c=f):h=h.next=v,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(1);if(h===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);so|=o,t.lanes=o,t.memoizedState=f}}function m0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(z(191,i));i.call(r)}}}var Du={},_r=ds(Du),Zc=ds(Du),eu=ds(Du);function zs(t){if(t===Du)throw Error(z(174));return t}function Xy(t,e){switch(Ne(eu,e),Ne(Zc,t),Ne(_r,Du),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ng(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ng(e,t)}Fe(_r),Ne(_r,e)}function Da(){Fe(_r),Fe(Zc),Fe(eu)}function VA(t){zs(eu.current);var e=zs(_r.current),n=ng(e,t.type);e!==n&&(Ne(Zc,t),Ne(_r,n))}function Zy(t){Zc.current===t&&(Fe(_r),Fe(Zc))}var He=ds(0);function Yd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var um=[];function e_(){for(var t=0;t<um.length;t++)um[t]._workInProgressVersionPrimary=null;um.length=0}var dd=Jr.ReactCurrentDispatcher,hm=Jr.ReactCurrentBatchConfig,io=0,Ge=null,dt=null,vt=null,Jd=!1,Ec=!1,tu=0,MC=0;function Vt(){throw Error(z(321))}function t_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ir(t[n],e[n]))return!1;return!0}function n_(t,e,n,r,i,s){if(io=s,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dd.current=t===null||t.memoizedState===null?BC:$C,t=n(r,i),Ec){s=0;do{if(Ec=!1,tu=0,25<=s)throw Error(z(301));s+=1,vt=dt=null,e.updateQueue=null,dd.current=zC,t=n(r,i)}while(Ec)}if(dd.current=Xd,e=dt!==null&&dt.next!==null,io=0,vt=dt=Ge=null,Jd=!1,e)throw Error(z(300));return t}function r_(){var t=tu!==0;return tu=0,t}function cr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?Ge.memoizedState=vt=t:vt=vt.next=t,vt}function jn(){if(dt===null){var t=Ge.alternate;t=t!==null?t.memoizedState:null}else t=dt.next;var e=vt===null?Ge.memoizedState:vt.next;if(e!==null)vt=e,dt=t;else{if(t===null)throw Error(z(310));dt=t,t={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},vt===null?Ge.memoizedState=vt=t:vt=vt.next=t}return vt}function nu(t,e){return typeof e=="function"?e(t):e}function dm(t){var e=jn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=dt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,u=s;do{var h=u.lane;if((io&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=f,o=r):c=c.next=f,Ge.lanes|=h,so|=h}u=u.next}while(u!==null&&u!==s);c===null?o=r:c.next=a,ir(r,e.memoizedState)||(nn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ge.lanes|=s,so|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fm(t){var e=jn(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);ir(s,e.memoizedState)||(nn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function MA(){}function FA(t,e){var n=Ge,r=jn(),i=e(),s=!ir(r.memoizedState,i);if(s&&(r.memoizedState=i,nn=!0),r=r.queue,i_(BA.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,ru(9,UA.bind(null,n,r,i,e),void 0,null),It===null)throw Error(z(349));io&30||jA(n,e,i)}return i}function jA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function UA(t,e,n,r){e.value=n,e.getSnapshot=r,$A(e)&&zA(t)}function BA(t,e,n){return n(function(){$A(e)&&zA(t)})}function $A(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ir(t,n)}catch{return!0}}function zA(t){var e=zr(t,1);e!==null&&nr(e,t,1,-1)}function g0(t){var e=cr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nu,lastRenderedState:t},e.queue=t,t=t.dispatch=UC.bind(null,Ge,t),[e.memoizedState,t]}function ru(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function qA(){return jn().memoizedState}function fd(t,e,n,r){var i=cr();Ge.flags|=t,i.memoizedState=ru(1|e,n,void 0,r===void 0?null:r)}function Ff(t,e,n,r){var i=jn();r=r===void 0?null:r;var s=void 0;if(dt!==null){var o=dt.memoizedState;if(s=o.destroy,r!==null&&t_(r,o.deps)){i.memoizedState=ru(e,n,s,r);return}}Ge.flags|=t,i.memoizedState=ru(1|e,n,s,r)}function y0(t,e){return fd(8390656,8,t,e)}function i_(t,e){return Ff(2048,8,t,e)}function HA(t,e){return Ff(4,2,t,e)}function GA(t,e){return Ff(4,4,t,e)}function WA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function KA(t,e,n){return n=n!=null?n.concat([t]):null,Ff(4,4,WA.bind(null,e,t),n)}function s_(){}function QA(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&t_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function YA(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&t_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function JA(t,e,n){return io&21?(ir(n,e)||(n=nA(),Ge.lanes|=n,so|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,nn=!0),t.memoizedState=n)}function FC(t,e){var n=Ae;Ae=n!==0&&4>n?n:4,t(!0);var r=hm.transition;hm.transition={};try{t(!1),e()}finally{Ae=n,hm.transition=r}}function XA(){return jn().memoizedState}function jC(t,e,n){var r=Qi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ZA(t))e1(e,n);else if(n=OA(t,e,n,r),n!==null){var i=Wt();nr(n,t,r,i),t1(n,e,r)}}function UC(t,e,n){var r=Qi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ZA(t))e1(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ir(a,o)){var c=e.interleaved;c===null?(i.next=i,Yy(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=OA(t,e,i,r),n!==null&&(i=Wt(),nr(n,t,r,i),t1(n,e,r))}}function ZA(t){var e=t.alternate;return t===Ge||e!==null&&e===Ge}function e1(t,e){Ec=Jd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function t1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Vy(t,n)}}var Xd={readContext:Fn,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useInsertionEffect:Vt,useLayoutEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useMutableSource:Vt,useSyncExternalStore:Vt,useId:Vt,unstable_isNewReconciler:!1},BC={readContext:Fn,useCallback:function(t,e){return cr().memoizedState=[t,e===void 0?null:e],t},useContext:Fn,useEffect:y0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,fd(4194308,4,WA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return fd(4194308,4,t,e)},useInsertionEffect:function(t,e){return fd(4,2,t,e)},useMemo:function(t,e){var n=cr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=cr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=jC.bind(null,Ge,t),[r.memoizedState,t]},useRef:function(t){var e=cr();return t={current:t},e.memoizedState=t},useState:g0,useDebugValue:s_,useDeferredValue:function(t){return cr().memoizedState=t},useTransition:function(){var t=g0(!1),e=t[0];return t=FC.bind(null,t[1]),cr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ge,i=cr();if($e){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),It===null)throw Error(z(349));io&30||jA(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,y0(BA.bind(null,r,s,t),[t]),r.flags|=2048,ru(9,UA.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=cr(),e=It.identifierPrefix;if($e){var n=Or,r=Dr;n=(r&~(1<<32-tr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=tu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=MC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$C={readContext:Fn,useCallback:QA,useContext:Fn,useEffect:i_,useImperativeHandle:KA,useInsertionEffect:HA,useLayoutEffect:GA,useMemo:YA,useReducer:dm,useRef:qA,useState:function(){return dm(nu)},useDebugValue:s_,useDeferredValue:function(t){var e=jn();return JA(e,dt.memoizedState,t)},useTransition:function(){var t=dm(nu)[0],e=jn().memoizedState;return[t,e]},useMutableSource:MA,useSyncExternalStore:FA,useId:XA,unstable_isNewReconciler:!1},zC={readContext:Fn,useCallback:QA,useContext:Fn,useEffect:i_,useImperativeHandle:KA,useInsertionEffect:HA,useLayoutEffect:GA,useMemo:YA,useReducer:fm,useRef:qA,useState:function(){return fm(nu)},useDebugValue:s_,useDeferredValue:function(t){var e=jn();return dt===null?e.memoizedState=t:JA(e,dt.memoizedState,t)},useTransition:function(){var t=fm(nu)[0],e=jn().memoizedState;return[t,e]},useMutableSource:MA,useSyncExternalStore:FA,useId:XA,unstable_isNewReconciler:!1};function Qn(t,e){if(t&&t.defaultProps){e=We({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Tg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:We({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var jf={isMounted:function(t){return(t=t._reactInternals)?Eo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Wt(),i=Qi(t),s=Fr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Wi(t,s,i),e!==null&&(nr(e,t,i,r),hd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Wt(),i=Qi(t),s=Fr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Wi(t,s,i),e!==null&&(nr(e,t,i,r),hd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Wt(),r=Qi(t),i=Fr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Wi(t,i,r),e!==null&&(nr(e,t,r,n),hd(e,t,r))}};function _0(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Qc(n,r)||!Qc(i,s):!0}function n1(t,e,n){var r=!1,i=rs,s=e.contextType;return typeof s=="object"&&s!==null?s=Fn(s):(i=ln(e)?no:qt.current,r=e.contextTypes,s=(r=r!=null)?ka(t,i):rs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=jf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function v0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&jf.enqueueReplaceState(e,e.state,null)}function Ag(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Jy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Fn(s):(s=ln(e)?no:qt.current,i.context=ka(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Tg(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&jf.enqueueReplaceState(i,i.state,null),Qd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Oa(t,e){try{var n="",r=e;do n+=yk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function pm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Rg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var qC=typeof WeakMap=="function"?WeakMap:Map;function r1(t,e,n){n=Fr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ef||(ef=!0,Lg=r),Rg(t,e)},n}function i1(t,e,n){n=Fr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Rg(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Rg(t,e),typeof r!="function"&&(Ki===null?Ki=new Set([this]):Ki.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function w0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new qC;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=iN.bind(null,t,e,n),e.then(t,t))}function I0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function E0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fr(-1,1),e.tag=2,Wi(n,e,1))),n.lanes|=1),t)}var HC=Jr.ReactCurrentOwner,nn=!1;function Gt(t,e,n,r){e.child=t===null?DA(e,null,n,r):Na(e,t.child,n,r)}function T0(t,e,n,r,i){n=n.render;var s=e.ref;return Ia(e,i),r=n_(t,e,n,r,s,i),n=r_(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,qr(t,e,i)):($e&&n&&qy(e),e.flags|=1,Gt(t,e,r,i),e.child)}function A0(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!f_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,s1(t,e,s,r,i)):(t=yd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Qc,n(o,r)&&t.ref===e.ref)return qr(t,e,i)}return e.flags|=1,t=Yi(s,r),t.ref=e.ref,t.return=e,e.child=t}function s1(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Qc(s,r)&&t.ref===e.ref)if(nn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(nn=!0);else return e.lanes=t.lanes,qr(t,e,i)}return Sg(t,e,n,r,i)}function o1(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(ga,mn),mn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ne(ga,mn),mn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ne(ga,mn),mn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ne(ga,mn),mn|=r;return Gt(t,e,i,n),e.child}function a1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sg(t,e,n,r,i){var s=ln(n)?no:qt.current;return s=ka(e,s),Ia(e,i),n=n_(t,e,n,r,s,i),r=r_(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,qr(t,e,i)):($e&&r&&qy(e),e.flags|=1,Gt(t,e,n,i),e.child)}function R0(t,e,n,r,i){if(ln(n)){var s=!0;qd(e)}else s=!1;if(Ia(e,i),e.stateNode===null)pd(t,e),n1(e,n,r),Ag(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Fn(u):(u=ln(n)?no:qt.current,u=ka(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==u)&&v0(e,o,r,u),bi=!1;var p=e.memoizedState;o.state=p,Qd(e,r,o,i),c=e.memoizedState,a!==r||p!==c||an.current||bi?(typeof h=="function"&&(Tg(e,n,h,r),c=e.memoizedState),(a=bi||_0(e,n,a,r,p,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,LA(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Qn(e.type,a),o.props=u,f=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Fn(c):(c=ln(n)?no:qt.current,c=ka(e,c));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==c)&&v0(e,o,r,c),bi=!1,p=e.memoizedState,o.state=p,Qd(e,r,o,i);var b=e.memoizedState;a!==f||p!==b||an.current||bi?(typeof v=="function"&&(Tg(e,n,v,r),b=e.memoizedState),(u=bi||_0(e,n,u,r,p,b,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),o.props=r,o.state=b,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return bg(t,e,n,r,s,i)}function bg(t,e,n,r,i,s){a1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&u0(e,n,!1),qr(t,e,s);r=e.stateNode,HC.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Na(e,t.child,null,s),e.child=Na(e,null,a,s)):Gt(t,e,a,s),e.memoizedState=r.state,i&&u0(e,n,!0),e.child}function l1(t){var e=t.stateNode;e.pendingContext?c0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&c0(t,e.context,!1),Xy(t,e.containerInfo)}function S0(t,e,n,r,i){return Ca(),Gy(i),e.flags|=256,Gt(t,e,n,r),e.child}var xg={dehydrated:null,treeContext:null,retryLane:0};function Pg(t){return{baseLanes:t,cachePool:null,transitions:null}}function c1(t,e,n){var r=e.pendingProps,i=He.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ne(He,i&1),t===null)return Ig(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=$f(o,r,0,null),t=Qs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Pg(n),e.memoizedState=xg,t):o_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return GC(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Yi(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Yi(a,s):(s=Qs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Pg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=xg,r}return s=t.child,t=s.sibling,r=Yi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function o_(t,e){return e=$f({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $h(t,e,n,r){return r!==null&&Gy(r),Na(e,t.child,null,n),t=o_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function GC(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=pm(Error(z(422))),$h(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=$f({mode:"visible",children:r.children},i,0,null),s=Qs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Na(e,t.child,null,o),e.child.memoizedState=Pg(o),e.memoizedState=xg,s);if(!(e.mode&1))return $h(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(z(419)),r=pm(s,r,void 0),$h(t,e,o,r)}if(a=(o&t.childLanes)!==0,nn||a){if(r=It,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,zr(t,i),nr(r,t,i,-1))}return d_(),r=pm(Error(z(421))),$h(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=sN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,_n=Gi(i.nextSibling),wn=e,$e=!0,Zn=null,t!==null&&(On[Ln++]=Dr,On[Ln++]=Or,On[Ln++]=ro,Dr=t.id,Or=t.overflow,ro=e),e=o_(e,r.children),e.flags|=4096,e)}function b0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Eg(t.return,e,n)}function mm(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function u1(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Gt(t,e,r.children,n),r=He.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&b0(t,n,e);else if(t.tag===19)b0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ne(He,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Yd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),mm(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Yd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}mm(e,!0,n,null,s);break;case"together":mm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),so|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=Yi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Yi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function WC(t,e,n){switch(e.tag){case 3:l1(e),Ca();break;case 5:VA(e);break;case 1:ln(e.type)&&qd(e);break;case 4:Xy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ne(Wd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ne(He,He.current&1),e.flags|=128,null):n&e.child.childLanes?c1(t,e,n):(Ne(He,He.current&1),t=qr(t,e,n),t!==null?t.sibling:null);Ne(He,He.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return u1(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ne(He,He.current),r)break;return null;case 22:case 23:return e.lanes=0,o1(t,e,n)}return qr(t,e,n)}var h1,kg,d1,f1;h1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};kg=function(){};d1=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,zs(_r.current);var s=null;switch(n){case"input":i=Xm(t,i),r=Xm(t,r),s=[];break;case"select":i=We({},i,{value:void 0}),r=We({},r,{value:void 0}),s=[];break;case"textarea":i=tg(t,i),r=tg(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$d)}rg(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&($c.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&($c.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Le("scroll",t),s||a===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};f1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Yl(t,e){if(!$e)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Mt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function KC(t,e,n){var r=e.pendingProps;switch(Hy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(e),null;case 1:return ln(e.type)&&zd(),Mt(e),null;case 3:return r=e.stateNode,Da(),Fe(an),Fe(qt),e_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Uh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(Fg(Zn),Zn=null))),kg(t,e),Mt(e),null;case 5:Zy(e);var i=zs(eu.current);if(n=e.type,t!==null&&e.stateNode!=null)d1(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return Mt(e),null}if(t=zs(_r.current),Uh(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[dr]=e,r[Xc]=s,t=(e.mode&1)!==0,n){case"dialog":Le("cancel",r),Le("close",r);break;case"iframe":case"object":case"embed":Le("load",r);break;case"video":case"audio":for(i=0;i<cc.length;i++)Le(cc[i],r);break;case"source":Le("error",r);break;case"img":case"image":case"link":Le("error",r),Le("load",r);break;case"details":Le("toggle",r);break;case"input":Vw(r,s),Le("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Le("invalid",r);break;case"textarea":Fw(r,s),Le("invalid",r)}rg(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&jh(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&jh(r.textContent,a,t),i=["children",""+a]):$c.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Le("scroll",r)}switch(n){case"input":Ch(r),Mw(r,s,!0);break;case"textarea":Ch(r),jw(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=$d)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=BT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[dr]=e,t[Xc]=r,h1(t,e,!1,!1),e.stateNode=t;e:{switch(o=ig(n,r),n){case"dialog":Le("cancel",t),Le("close",t),i=r;break;case"iframe":case"object":case"embed":Le("load",t),i=r;break;case"video":case"audio":for(i=0;i<cc.length;i++)Le(cc[i],t);i=r;break;case"source":Le("error",t),i=r;break;case"img":case"image":case"link":Le("error",t),Le("load",t),i=r;break;case"details":Le("toggle",t),i=r;break;case"input":Vw(t,r),i=Xm(t,r),Le("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=We({},r,{value:void 0}),Le("invalid",t);break;case"textarea":Fw(t,r),i=tg(t,r),Le("invalid",t);break;default:i=r}rg(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?qT(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$T(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&zc(t,c):typeof c=="number"&&zc(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&($c.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Le("scroll",t):c!=null&&ky(t,s,c,o))}switch(n){case"input":Ch(t),Mw(t,r,!1);break;case"textarea":Ch(t),jw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ns(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ya(t,!!r.multiple,s,!1):r.defaultValue!=null&&ya(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=$d)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Mt(e),null;case 6:if(t&&e.stateNode!=null)f1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=zs(eu.current),zs(_r.current),Uh(e)){if(r=e.stateNode,n=e.memoizedProps,r[dr]=e,(s=r.nodeValue!==n)&&(t=wn,t!==null))switch(t.tag){case 3:jh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&jh(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dr]=e,e.stateNode=r}return Mt(e),null;case 13:if(Fe(He),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&_n!==null&&e.mode&1&&!(e.flags&128))CA(),Ca(),e.flags|=98560,s=!1;else if(s=Uh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(z(317));s[dr]=e}else Ca(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Mt(e),s=!1}else Zn!==null&&(Fg(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||He.current&1?ft===0&&(ft=3):d_())),e.updateQueue!==null&&(e.flags|=4),Mt(e),null);case 4:return Da(),kg(t,e),t===null&&Yc(e.stateNode.containerInfo),Mt(e),null;case 10:return Qy(e.type._context),Mt(e),null;case 17:return ln(e.type)&&zd(),Mt(e),null;case 19:if(Fe(He),s=e.memoizedState,s===null)return Mt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Yl(s,!1);else{if(ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Yd(t),o!==null){for(e.flags|=128,Yl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ne(He,He.current&1|2),e.child}t=t.sibling}s.tail!==null&&rt()>La&&(e.flags|=128,r=!0,Yl(s,!1),e.lanes=4194304)}else{if(!r)if(t=Yd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Yl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!$e)return Mt(e),null}else 2*rt()-s.renderingStartTime>La&&n!==1073741824&&(e.flags|=128,r=!0,Yl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=rt(),e.sibling=null,n=He.current,Ne(He,r?n&1|2:n&1),e):(Mt(e),null);case 22:case 23:return h_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?mn&1073741824&&(Mt(e),e.subtreeFlags&6&&(e.flags|=8192)):Mt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function QC(t,e){switch(Hy(e),e.tag){case 1:return ln(e.type)&&zd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Da(),Fe(an),Fe(qt),e_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Zy(e),null;case 13:if(Fe(He),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));Ca()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Fe(He),null;case 4:return Da(),null;case 10:return Qy(e.type._context),null;case 22:case 23:return h_(),null;case 24:return null;default:return null}}var zh=!1,Ut=!1,YC=typeof WeakSet=="function"?WeakSet:Set,X=null;function ma(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Je(t,e,r)}else n.current=null}function Cg(t,e,n){try{n()}catch(r){Je(t,e,r)}}var x0=!1;function JC(t,e){if(pg=jd,t=_A(),zy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,u=0,h=0,f=t,p=null;t:for(;;){for(var v;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)p=f,f=v;for(;;){if(f===t)break t;if(p===n&&++u===i&&(a=o),p===s&&++h===r&&(c=o),(v=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=v}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(mg={focusedElem:t,selectionRange:n},jd=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var P=b.memoizedProps,C=b.memoizedState,E=e.stateNode,w=E.getSnapshotBeforeUpdate(e.elementType===e.type?P:Qn(e.type,P),C);E.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(V){Je(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return b=x0,x0=!1,b}function Tc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Cg(e,n,s)}i=i.next}while(i!==r)}}function Uf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ng(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function p1(t){var e=t.alternate;e!==null&&(t.alternate=null,p1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dr],delete e[Xc],delete e[_g],delete e[DC],delete e[OC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function m1(t){return t.tag===5||t.tag===3||t.tag===4}function P0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||m1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Dg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$d));else if(r!==4&&(t=t.child,t!==null))for(Dg(t,e,n),t=t.sibling;t!==null;)Dg(t,e,n),t=t.sibling}function Og(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Og(t,e,n),t=t.sibling;t!==null;)Og(t,e,n),t=t.sibling}var bt=null,Jn=!1;function vi(t,e,n){for(n=n.child;n!==null;)g1(t,e,n),n=n.sibling}function g1(t,e,n){if(yr&&typeof yr.onCommitFiberUnmount=="function")try{yr.onCommitFiberUnmount(Nf,n)}catch{}switch(n.tag){case 5:Ut||ma(n,e);case 6:var r=bt,i=Jn;bt=null,vi(t,e,n),bt=r,Jn=i,bt!==null&&(Jn?(t=bt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):bt.removeChild(n.stateNode));break;case 18:bt!==null&&(Jn?(t=bt,n=n.stateNode,t.nodeType===8?lm(t.parentNode,n):t.nodeType===1&&lm(t,n),Wc(t)):lm(bt,n.stateNode));break;case 4:r=bt,i=Jn,bt=n.stateNode.containerInfo,Jn=!0,vi(t,e,n),bt=r,Jn=i;break;case 0:case 11:case 14:case 15:if(!Ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Cg(n,e,o),i=i.next}while(i!==r)}vi(t,e,n);break;case 1:if(!Ut&&(ma(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Je(n,e,a)}vi(t,e,n);break;case 21:vi(t,e,n);break;case 22:n.mode&1?(Ut=(r=Ut)||n.memoizedState!==null,vi(t,e,n),Ut=r):vi(t,e,n);break;default:vi(t,e,n)}}function k0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YC),e.forEach(function(r){var i=oN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Kn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:bt=a.stateNode,Jn=!1;break e;case 3:bt=a.stateNode.containerInfo,Jn=!0;break e;case 4:bt=a.stateNode.containerInfo,Jn=!0;break e}a=a.return}if(bt===null)throw Error(z(160));g1(s,o,i),bt=null,Jn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Je(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)y1(e,t),e=e.sibling}function y1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Kn(e,t),lr(t),r&4){try{Tc(3,t,t.return),Uf(3,t)}catch(P){Je(t,t.return,P)}try{Tc(5,t,t.return)}catch(P){Je(t,t.return,P)}}break;case 1:Kn(e,t),lr(t),r&512&&n!==null&&ma(n,n.return);break;case 5:if(Kn(e,t),lr(t),r&512&&n!==null&&ma(n,n.return),t.flags&32){var i=t.stateNode;try{zc(i,"")}catch(P){Je(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&jT(i,s),ig(a,o);var u=ig(a,s);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?qT(i,f):h==="dangerouslySetInnerHTML"?$T(i,f):h==="children"?zc(i,f):ky(i,h,f,u)}switch(a){case"input":Zm(i,s);break;case"textarea":UT(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?ya(i,!!s.multiple,v,!1):p!==!!s.multiple&&(s.defaultValue!=null?ya(i,!!s.multiple,s.defaultValue,!0):ya(i,!!s.multiple,s.multiple?[]:"",!1))}i[Xc]=s}catch(P){Je(t,t.return,P)}}break;case 6:if(Kn(e,t),lr(t),r&4){if(t.stateNode===null)throw Error(z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){Je(t,t.return,P)}}break;case 3:if(Kn(e,t),lr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wc(e.containerInfo)}catch(P){Je(t,t.return,P)}break;case 4:Kn(e,t),lr(t);break;case 13:Kn(e,t),lr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(c_=rt())),r&4&&k0(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Ut=(u=Ut)||h,Kn(e,t),Ut=u):Kn(e,t),lr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(X=t,h=t.child;h!==null;){for(f=X=h;X!==null;){switch(p=X,v=p.child,p.tag){case 0:case 11:case 14:case 15:Tc(4,p,p.return);break;case 1:ma(p,p.return);var b=p.stateNode;if(typeof b.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(P){Je(r,n,P)}}break;case 5:ma(p,p.return);break;case 22:if(p.memoizedState!==null){N0(f);continue}}v!==null?(v.return=p,X=v):N0(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=zT("display",o))}catch(P){Je(t,t.return,P)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(P){Je(t,t.return,P)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Kn(e,t),lr(t),r&4&&k0(t);break;case 21:break;default:Kn(e,t),lr(t)}}function lr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(m1(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(zc(i,""),r.flags&=-33);var s=P0(t);Og(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=P0(t);Dg(t,a,o);break;default:throw Error(z(161))}}catch(c){Je(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function XC(t,e,n){X=t,_1(t)}function _1(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var i=X,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||zh;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Ut;a=zh;var u=Ut;if(zh=o,(Ut=c)&&!u)for(X=i;X!==null;)o=X,c=o.child,o.tag===22&&o.memoizedState!==null?D0(i):c!==null?(c.return=o,X=c):D0(i);for(;s!==null;)X=s,_1(s),s=s.sibling;X=i,zh=a,Ut=u}C0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,X=s):C0(t)}}function C0(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ut||Uf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ut)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Qn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&m0(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}m0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Wc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Ut||e.flags&512&&Ng(e)}catch(p){Je(e,e.return,p)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function N0(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function D0(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Uf(4,e)}catch(c){Je(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Je(e,i,c)}}var s=e.return;try{Ng(e)}catch(c){Je(e,s,c)}break;case 5:var o=e.return;try{Ng(e)}catch(c){Je(e,o,c)}}}catch(c){Je(e,e.return,c)}if(e===t){X=null;break}var a=e.sibling;if(a!==null){a.return=e.return,X=a;break}X=e.return}}var ZC=Math.ceil,Zd=Jr.ReactCurrentDispatcher,a_=Jr.ReactCurrentOwner,Mn=Jr.ReactCurrentBatchConfig,_e=0,It=null,ct=null,kt=0,mn=0,ga=ds(0),ft=0,iu=null,so=0,Bf=0,l_=0,Ac=null,tn=null,c_=0,La=1/0,Cr=null,ef=!1,Lg=null,Ki=null,qh=!1,ji=null,tf=0,Rc=0,Vg=null,md=-1,gd=0;function Wt(){return _e&6?rt():md!==-1?md:md=rt()}function Qi(t){return t.mode&1?_e&2&&kt!==0?kt&-kt:VC.transition!==null?(gd===0&&(gd=nA()),gd):(t=Ae,t!==0||(t=window.event,t=t===void 0?16:cA(t.type)),t):1}function nr(t,e,n,r){if(50<Rc)throw Rc=0,Vg=null,Error(z(185));ku(t,n,r),(!(_e&2)||t!==It)&&(t===It&&(!(_e&2)&&(Bf|=n),ft===4&&ki(t,kt)),cn(t,r),n===1&&_e===0&&!(e.mode&1)&&(La=rt()+500,Mf&&fs()))}function cn(t,e){var n=t.callbackNode;Vk(t,e);var r=Fd(t,t===It?kt:0);if(r===0)n!==null&&$w(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&$w(n),e===1)t.tag===0?LC(O0.bind(null,t)):xA(O0.bind(null,t)),CC(function(){!(_e&6)&&fs()}),n=null;else{switch(rA(r)){case 1:n=Ly;break;case 4:n=eA;break;case 16:n=Md;break;case 536870912:n=tA;break;default:n=Md}n=S1(n,v1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function v1(t,e){if(md=-1,gd=0,_e&6)throw Error(z(327));var n=t.callbackNode;if(Ea()&&t.callbackNode!==n)return null;var r=Fd(t,t===It?kt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=nf(t,r);else{e=r;var i=_e;_e|=2;var s=I1();(It!==t||kt!==e)&&(Cr=null,La=rt()+500,Ks(t,e));do try{nN();break}catch(a){w1(t,a)}while(1);Ky(),Zd.current=s,_e=i,ct!==null?e=0:(It=null,kt=0,e=ft)}if(e!==0){if(e===2&&(i=cg(t),i!==0&&(r=i,e=Mg(t,i))),e===1)throw n=iu,Ks(t,0),ki(t,r),cn(t,rt()),n;if(e===6)ki(t,r);else{if(i=t.current.alternate,!(r&30)&&!eN(i)&&(e=nf(t,r),e===2&&(s=cg(t),s!==0&&(r=s,e=Mg(t,s))),e===1))throw n=iu,Ks(t,0),ki(t,r),cn(t,rt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:Cs(t,tn,Cr);break;case 3:if(ki(t,r),(r&130023424)===r&&(e=c_+500-rt(),10<e)){if(Fd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Wt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=yg(Cs.bind(null,t,tn,Cr),e);break}Cs(t,tn,Cr);break;case 4:if(ki(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-tr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ZC(r/1960))-r,10<r){t.timeoutHandle=yg(Cs.bind(null,t,tn,Cr),r);break}Cs(t,tn,Cr);break;case 5:Cs(t,tn,Cr);break;default:throw Error(z(329))}}}return cn(t,rt()),t.callbackNode===n?v1.bind(null,t):null}function Mg(t,e){var n=Ac;return t.current.memoizedState.isDehydrated&&(Ks(t,e).flags|=256),t=nf(t,e),t!==2&&(e=tn,tn=n,e!==null&&Fg(e)),t}function Fg(t){tn===null?tn=t:tn.push.apply(tn,t)}function eN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ir(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ki(t,e){for(e&=~l_,e&=~Bf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-tr(e),r=1<<n;t[n]=-1,e&=~r}}function O0(t){if(_e&6)throw Error(z(327));Ea();var e=Fd(t,0);if(!(e&1))return cn(t,rt()),null;var n=nf(t,e);if(t.tag!==0&&n===2){var r=cg(t);r!==0&&(e=r,n=Mg(t,r))}if(n===1)throw n=iu,Ks(t,0),ki(t,e),cn(t,rt()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Cs(t,tn,Cr),cn(t,rt()),null}function u_(t,e){var n=_e;_e|=1;try{return t(e)}finally{_e=n,_e===0&&(La=rt()+500,Mf&&fs())}}function oo(t){ji!==null&&ji.tag===0&&!(_e&6)&&Ea();var e=_e;_e|=1;var n=Mn.transition,r=Ae;try{if(Mn.transition=null,Ae=1,t)return t()}finally{Ae=r,Mn.transition=n,_e=e,!(_e&6)&&fs()}}function h_(){mn=ga.current,Fe(ga)}function Ks(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kC(n)),ct!==null)for(n=ct.return;n!==null;){var r=n;switch(Hy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zd();break;case 3:Da(),Fe(an),Fe(qt),e_();break;case 5:Zy(r);break;case 4:Da();break;case 13:Fe(He);break;case 19:Fe(He);break;case 10:Qy(r.type._context);break;case 22:case 23:h_()}n=n.return}if(It=t,ct=t=Yi(t.current,null),kt=mn=e,ft=0,iu=null,l_=Bf=so=0,tn=Ac=null,$s!==null){for(e=0;e<$s.length;e++)if(n=$s[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}$s=null}return t}function w1(t,e){do{var n=ct;try{if(Ky(),dd.current=Xd,Jd){for(var r=Ge.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Jd=!1}if(io=0,vt=dt=Ge=null,Ec=!1,tu=0,a_.current=null,n===null||n.return===null){ft=1,iu=e,ct=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=kt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=I0(o);if(v!==null){v.flags&=-257,E0(v,o,a,s,e),v.mode&1&&w0(s,u,e),e=v,c=u;var b=e.updateQueue;if(b===null){var P=new Set;P.add(c),e.updateQueue=P}else b.add(c);break e}else{if(!(e&1)){w0(s,u,e),d_();break e}c=Error(z(426))}}else if($e&&a.mode&1){var C=I0(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),E0(C,o,a,s,e),Gy(Oa(c,a));break e}}s=c=Oa(c,a),ft!==4&&(ft=2),Ac===null?Ac=[s]:Ac.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var E=r1(s,c,e);p0(s,E);break e;case 1:a=c;var w=s.type,R=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Ki===null||!Ki.has(R)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=i1(s,a,e);p0(s,V);break e}}s=s.return}while(s!==null)}T1(n)}catch(B){e=B,ct===n&&n!==null&&(ct=n=n.return);continue}break}while(1)}function I1(){var t=Zd.current;return Zd.current=Xd,t===null?Xd:t}function d_(){(ft===0||ft===3||ft===2)&&(ft=4),It===null||!(so&268435455)&&!(Bf&268435455)||ki(It,kt)}function nf(t,e){var n=_e;_e|=2;var r=I1();(It!==t||kt!==e)&&(Cr=null,Ks(t,e));do try{tN();break}catch(i){w1(t,i)}while(1);if(Ky(),_e=n,Zd.current=r,ct!==null)throw Error(z(261));return It=null,kt=0,ft}function tN(){for(;ct!==null;)E1(ct)}function nN(){for(;ct!==null&&!bk();)E1(ct)}function E1(t){var e=R1(t.alternate,t,mn);t.memoizedProps=t.pendingProps,e===null?T1(t):ct=e,a_.current=null}function T1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QC(n,e),n!==null){n.flags&=32767,ct=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ft=6,ct=null;return}}else if(n=KC(n,e,mn),n!==null){ct=n;return}if(e=e.sibling,e!==null){ct=e;return}ct=e=t}while(e!==null);ft===0&&(ft=5)}function Cs(t,e,n){var r=Ae,i=Mn.transition;try{Mn.transition=null,Ae=1,rN(t,e,n,r)}finally{Mn.transition=i,Ae=r}return null}function rN(t,e,n,r){do Ea();while(ji!==null);if(_e&6)throw Error(z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Mk(t,s),t===It&&(ct=It=null,kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qh||(qh=!0,S1(Md,function(){return Ea(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Mn.transition,Mn.transition=null;var o=Ae;Ae=1;var a=_e;_e|=4,a_.current=null,JC(t,n),y1(n,t),TC(mg),jd=!!pg,mg=pg=null,t.current=n,XC(n),xk(),_e=a,Ae=o,Mn.transition=s}else t.current=n;if(qh&&(qh=!1,ji=t,tf=i),s=t.pendingLanes,s===0&&(Ki=null),Ck(n.stateNode),cn(t,rt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ef)throw ef=!1,t=Lg,Lg=null,t;return tf&1&&t.tag!==0&&Ea(),s=t.pendingLanes,s&1?t===Vg?Rc++:(Rc=0,Vg=t):Rc=0,fs(),null}function Ea(){if(ji!==null){var t=rA(tf),e=Mn.transition,n=Ae;try{if(Mn.transition=null,Ae=16>t?16:t,ji===null)var r=!1;else{if(t=ji,ji=null,tf=0,_e&6)throw Error(z(331));var i=_e;for(_e|=4,X=t.current;X!==null;){var s=X,o=s.child;if(X.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(X=u;X!==null;){var h=X;switch(h.tag){case 0:case 11:case 15:Tc(8,h,s)}var f=h.child;if(f!==null)f.return=h,X=f;else for(;X!==null;){h=X;var p=h.sibling,v=h.return;if(p1(h),h===u){X=null;break}if(p!==null){p.return=v,X=p;break}X=v}}}var b=s.alternate;if(b!==null){var P=b.child;if(P!==null){b.child=null;do{var C=P.sibling;P.sibling=null,P=C}while(P!==null)}}X=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,X=o;else e:for(;X!==null;){if(s=X,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Tc(9,s,s.return)}var E=s.sibling;if(E!==null){E.return=s.return,X=E;break e}X=s.return}}var w=t.current;for(X=w;X!==null;){o=X;var R=o.child;if(o.subtreeFlags&2064&&R!==null)R.return=o,X=R;else e:for(o=w;X!==null;){if(a=X,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Uf(9,a)}}catch(B){Je(a,a.return,B)}if(a===o){X=null;break e}var V=a.sibling;if(V!==null){V.return=a.return,X=V;break e}X=a.return}}if(_e=i,fs(),yr&&typeof yr.onPostCommitFiberRoot=="function")try{yr.onPostCommitFiberRoot(Nf,t)}catch{}r=!0}return r}finally{Ae=n,Mn.transition=e}}return!1}function L0(t,e,n){e=Oa(n,e),e=r1(t,e,1),t=Wi(t,e,1),e=Wt(),t!==null&&(ku(t,1,e),cn(t,e))}function Je(t,e,n){if(t.tag===3)L0(t,t,n);else for(;e!==null;){if(e.tag===3){L0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ki===null||!Ki.has(r))){t=Oa(n,t),t=i1(e,t,1),e=Wi(e,t,1),t=Wt(),e!==null&&(ku(e,1,t),cn(e,t));break}}e=e.return}}function iN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Wt(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(kt&n)===n&&(ft===4||ft===3&&(kt&130023424)===kt&&500>rt()-c_?Ks(t,0):l_|=n),cn(t,e)}function A1(t,e){e===0&&(t.mode&1?(e=Oh,Oh<<=1,!(Oh&130023424)&&(Oh=4194304)):e=1);var n=Wt();t=zr(t,e),t!==null&&(ku(t,e,n),cn(t,n))}function sN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),A1(t,n)}function oN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),A1(t,n)}var R1;R1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||an.current)nn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return nn=!1,WC(t,e,n);nn=!!(t.flags&131072)}else nn=!1,$e&&e.flags&1048576&&PA(e,Gd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pd(t,e),t=e.pendingProps;var i=ka(e,qt.current);Ia(e,n),i=n_(null,e,r,t,i,n);var s=r_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ln(r)?(s=!0,qd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Jy(e),i.updater=jf,e.stateNode=i,i._reactInternals=e,Ag(e,r,t,n),e=bg(null,e,r,!0,s,n)):(e.tag=0,$e&&s&&qy(e),Gt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=lN(r),t=Qn(r,t),i){case 0:e=Sg(null,e,r,t,n);break e;case 1:e=R0(null,e,r,t,n);break e;case 11:e=T0(null,e,r,t,n);break e;case 14:e=A0(null,e,r,Qn(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),Sg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),R0(t,e,r,i,n);case 3:e:{if(l1(e),t===null)throw Error(z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,LA(t,e),Qd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Oa(Error(z(423)),e),e=S0(t,e,r,n,i);break e}else if(r!==i){i=Oa(Error(z(424)),e),e=S0(t,e,r,n,i);break e}else for(_n=Gi(e.stateNode.containerInfo.firstChild),wn=e,$e=!0,Zn=null,n=DA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ca(),r===i){e=qr(t,e,n);break e}Gt(t,e,r,n)}e=e.child}return e;case 5:return VA(e),t===null&&Ig(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,gg(r,i)?o=null:s!==null&&gg(r,s)&&(e.flags|=32),a1(t,e),Gt(t,e,o,n),e.child;case 6:return t===null&&Ig(e),null;case 13:return c1(t,e,n);case 4:return Xy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Na(e,null,r,n):Gt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),T0(t,e,r,i,n);case 7:return Gt(t,e,e.pendingProps,n),e.child;case 8:return Gt(t,e,e.pendingProps.children,n),e.child;case 12:return Gt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ne(Wd,r._currentValue),r._currentValue=o,s!==null)if(ir(s.value,o)){if(s.children===i.children&&!an.current){e=qr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Fr(-1,n&-n),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Eg(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(z(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Eg(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Gt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ia(e,n),i=Fn(i),r=r(i),e.flags|=1,Gt(t,e,r,n),e.child;case 14:return r=e.type,i=Qn(r,e.pendingProps),i=Qn(r.type,i),A0(t,e,r,i,n);case 15:return s1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Qn(r,i),pd(t,e),e.tag=1,ln(r)?(t=!0,qd(e)):t=!1,Ia(e,n),n1(e,r,i),Ag(e,r,i,n),bg(null,e,r,!0,t,n);case 19:return u1(t,e,n);case 22:return o1(t,e,n)}throw Error(z(156,e.tag))};function S1(t,e){return ZT(t,e)}function aN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(t,e,n,r){return new aN(t,e,n,r)}function f_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lN(t){if(typeof t=="function")return f_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ny)return 11;if(t===Dy)return 14}return 2}function Yi(t,e){var n=t.alternate;return n===null?(n=Vn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function yd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")f_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case oa:return Qs(n.children,i,s,e);case Cy:o=8,i|=8;break;case Km:return t=Vn(12,n,e,i|2),t.elementType=Km,t.lanes=s,t;case Qm:return t=Vn(13,n,e,i),t.elementType=Qm,t.lanes=s,t;case Ym:return t=Vn(19,n,e,i),t.elementType=Ym,t.lanes=s,t;case VT:return $f(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case OT:o=10;break e;case LT:o=9;break e;case Ny:o=11;break e;case Dy:o=14;break e;case Si:o=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=Vn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Qs(t,e,n,r){return t=Vn(7,t,r,e),t.lanes=n,t}function $f(t,e,n,r){return t=Vn(22,t,r,e),t.elementType=VT,t.lanes=n,t.stateNode={isHidden:!1},t}function gm(t,e,n){return t=Vn(6,t,null,e),t.lanes=n,t}function ym(t,e,n){return e=Vn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jp(0),this.expirationTimes=Jp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function p_(t,e,n,r,i,s,o,a,c){return t=new cN(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Vn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jy(s),t}function uN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function b1(t){if(!t)return rs;t=t._reactInternals;e:{if(Eo(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ln(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(ln(n))return bA(t,n,e)}return e}function x1(t,e,n,r,i,s,o,a,c){return t=p_(n,r,!0,t,i,s,o,a,c),t.context=b1(null),n=t.current,r=Wt(),i=Qi(n),s=Fr(r,i),s.callback=e??null,Wi(n,s,i),t.current.lanes=i,ku(t,i,r),cn(t,r),t}function zf(t,e,n,r){var i=e.current,s=Wt(),o=Qi(i);return n=b1(n),e.context===null?e.context=n:e.pendingContext=n,e=Fr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Wi(i,e,o),t!==null&&(nr(t,i,o,s),hd(t,i,o)),o}function rf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function V0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function m_(t,e){V0(t,e),(t=t.alternate)&&V0(t,e)}function hN(){return null}var P1=typeof reportError=="function"?reportError:function(t){console.error(t)};function g_(t){this._internalRoot=t}qf.prototype.render=g_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));zf(t,e,null,null)};qf.prototype.unmount=g_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;oo(function(){zf(null,t,null,null)}),e[$r]=null}};function qf(t){this._internalRoot=t}qf.prototype.unstable_scheduleHydration=function(t){if(t){var e=oA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Pi.length&&e!==0&&e<Pi[n].priority;n++);Pi.splice(n,0,t),n===0&&lA(t)}};function y_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function M0(){}function dN(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=rf(o);s.call(u)}}var o=x1(e,r,t,0,null,!1,!1,"",M0);return t._reactRootContainer=o,t[$r]=o.current,Yc(t.nodeType===8?t.parentNode:t),oo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=rf(c);a.call(u)}}var c=p_(t,0,!1,null,null,!1,!1,"",M0);return t._reactRootContainer=c,t[$r]=c.current,Yc(t.nodeType===8?t.parentNode:t),oo(function(){zf(e,c,n,r)}),c}function Gf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=rf(o);a.call(c)}}zf(e,o,t,i)}else o=dN(n,e,t,i,r);return rf(o)}iA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=lc(e.pendingLanes);n!==0&&(Vy(e,n|1),cn(e,rt()),!(_e&6)&&(La=rt()+500,fs()))}break;case 13:oo(function(){var r=zr(t,1);if(r!==null){var i=Wt();nr(r,t,1,i)}}),m_(t,1)}};My=function(t){if(t.tag===13){var e=zr(t,134217728);if(e!==null){var n=Wt();nr(e,t,134217728,n)}m_(t,134217728)}};sA=function(t){if(t.tag===13){var e=Qi(t),n=zr(t,e);if(n!==null){var r=Wt();nr(n,t,e,r)}m_(t,e)}};oA=function(){return Ae};aA=function(t,e){var n=Ae;try{return Ae=t,e()}finally{Ae=n}};og=function(t,e,n){switch(e){case"input":if(Zm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Vf(r);if(!i)throw Error(z(90));FT(r),Zm(r,i)}}}break;case"textarea":UT(t,n);break;case"select":e=n.value,e!=null&&ya(t,!!n.multiple,e,!1)}};WT=u_;KT=oo;var fN={usingClientEntryPoint:!1,Events:[Nu,ua,Vf,HT,GT,u_]},Jl={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pN={bundleType:Jl.bundleType,version:Jl.version,rendererPackageName:Jl.rendererPackageName,rendererConfig:Jl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=JT(t),t===null?null:t.stateNode},findFiberByHostInstance:Jl.findFiberByHostInstance||hN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hh.isDisabled&&Hh.supportsFiber)try{Nf=Hh.inject(pN),yr=Hh}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fN;bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y_(e))throw Error(z(200));return uN(t,e,null,n)};bn.createRoot=function(t,e){if(!y_(t))throw Error(z(299));var n=!1,r="",i=P1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=p_(t,1,!1,null,null,n,!1,r,i),t[$r]=e.current,Yc(t.nodeType===8?t.parentNode:t),new g_(e)};bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=JT(e),t=t===null?null:t.stateNode,t};bn.flushSync=function(t){return oo(t)};bn.hydrate=function(t,e,n){if(!Hf(e))throw Error(z(200));return Gf(null,t,e,!0,n)};bn.hydrateRoot=function(t,e,n){if(!y_(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=P1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=x1(e,null,t,1,n??null,i,!1,s,o),t[$r]=e.current,Yc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new qf(e)};bn.render=function(t,e,n){if(!Hf(e))throw Error(z(200));return Gf(null,t,e,!1,n)};bn.unmountComponentAtNode=function(t){if(!Hf(t))throw Error(z(40));return t._reactRootContainer?(oo(function(){Gf(null,null,t,!1,function(){t._reactRootContainer=null,t[$r]=null})}),!0):!1};bn.unstable_batchedUpdates=u_;bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hf(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return Gf(t,e,n,!1,r)};bn.version="18.3.1-next-f1338f8080-20240426";function k1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k1)}catch(t){console.error(t)}}k1(),kT.exports=bn;var mN=kT.exports,F0=mN;Gm.createRoot=F0.createRoot,Gm.hydrateRoot=F0.hydrateRoot;const gN="modulepreload",yN=function(t){return"/"+t},j0={},wi=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=yN(s),s in j0)return;j0[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let h=i.length-1;h>=0;h--){const f=i[h];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":gN,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((h,f)=>{u.addEventListener("load",h),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var _N={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const vN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wN=(t,e)=>{const n=ie.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,children:a,...c},u)=>ie.createElement("svg",{ref:u,..._N,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:`lucide lucide-${vN(t)}`,...c},[...e.map(([h,f])=>ie.createElement(h,f)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n};var mt=wN;const IN=mt("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),EN=mt("Car",[["path",{d:"M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2",key:"l5np60"}],["circle",{cx:"6.5",cy:"16.5",r:"2.5",key:"ae40ju"}],["circle",{cx:"16.5",cy:"16.5",r:"2.5",key:"1smtlt"}]]),U0=mt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),TN=mt("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),Ii=mt("Hammer",[["path",{d:"m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9",key:"1afvon"}],["path",{d:"M17.64 15 22 10.64",key:"zsji6s"}],["path",{d:"m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25v-.86L16.01 4.6a5.56 5.56 0 0 0-3.94-1.64H9l.92.82A6.18 6.18 0 0 1 12 8.4v1.56l2 2h2.47l2.26 1.91",key:"lehyy1"}]]),AN=mt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Gh=mt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),RN=mt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),SN=mt("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),Zt=mt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Go=mt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),xs=mt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Dn=mt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),B0=mt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),bN=mt("Sofa",[["path",{d:"M20 9V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3",key:"1dgpiv"}],["path",{d:"M2 11v5a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v2H6v-2a2 2 0 0 0-4 0Z",key:"u5qfb7"}],["path",{d:"M4 18v2",key:"jwo5n2"}],["path",{d:"M20 18v2",key:"1ar1qi"}],["path",{d:"M12 4v9",key:"oqhhn3"}]]),Xl=mt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),$0=mt("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]),z0=mt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),_m=mt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),xN=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},PN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},N1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let p=(a&15)<<2|u>>6,v=u&63;c||(v=64,o||(p=64)),r.push(n[h],n[f],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(C1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):PN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||f==null)throw new kN;const p=s<<2|a>>4;if(r.push(p),u!==64){const v=a<<4&240|u>>2;if(r.push(v),f!==64){const b=u<<6&192|f;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class kN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CN=function(t){const e=C1(t);return N1.encodeByteArray(e,!0)},sf=function(t){return CN(t).replace(/\./g,"")},D1=function(t){try{return N1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN=()=>O1().__FIREBASE_DEFAULTS__,DN=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ON=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D1(t[1]);return e&&JSON.parse(e)},Wf=()=>{try{return xN()||NN()||DN()||ON()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},L1=t=>{var e,n;return(n=(e=Wf())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},V1=t=>{const e=L1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},M1=()=>{var t;return(t=Wf())==null?void 0:t.config},F1=t=>{var e;return(e=Wf())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Kf(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t},a="";return[sf(JSON.stringify(n)),sf(JSON.stringify(o)),a].join(".")}const Sc={};function VN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Sc))Sc[e]?t.emulator.push(e):t.prod.push(e);return t}function MN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let q0=!1;function __(t,e){if(typeof window>"u"||typeof document>"u"||!Xr(window.location.host)||Sc[t]===e||Sc[t]||q0)return;Sc[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=VN().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,v){p.setAttribute("width","24"),p.setAttribute("id",v),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{q0=!0,o()},p}function h(p,v){p.setAttribute("id",v),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=MN(r),v=n("text"),b=document.getElementById(v)||document.createElement("span"),P=n("learnmore"),C=document.getElementById(P)||document.createElement("a"),E=n("preprendIcon"),w=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const R=p.element;a(R),h(C,P);const V=u();c(w,E),R.append(w,b,C,V),document.body.appendChild(R)}s?(b.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pt())}function U1(){var e;const t=(e=Wf())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function B1(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function UN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function BN(){const t=pt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function $1(){return!U1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function z1(){return!U1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function v_(){try{return typeof indexedDB=="object"}catch{return!1}}function q1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}function $N(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="FirebaseError";class Pn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=zN,Object.setPrototypeOf(this,Pn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,To.prototype.create)}}class To{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?qN(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Pn(i,a,r)}}function qN(t,e){return t.replace(HN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const HN=/\{\$([^}]+)}/g;function GN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Un(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(H0(s)&&H0(o)){if(!Un(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function H0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function uc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function hc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function WN(t,e){const n=new KN(t,e);return n.subscribe.bind(n)}class KN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");QN(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=vm),i.error===void 0&&(i.error=vm),i.complete===void 0&&(i.complete=vm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function vm(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN=1e3,JN=2,XN=4*60*60*1e3,ZN=.5;function G0(t,e=YN,n=JN){const r=e*Math.pow(n,t),i=Math.round(ZN*r*(Math.random()-.5)*2);return Math.min(XN,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t){return t&&t._delegate?t._delegate:t}class Rn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new LN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(nD(e))try{this.getOrInitializeService({instanceIdentifier:Ns})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ns){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ns){return this.instances.has(e)}getOptions(e=Ns){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:tD(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ns){return this.component?this.component.multipleInstances?e:Ns:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tD(t){return t===Ns?void 0:t}function nD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new eD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pe||(pe={}));const iD={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},sD=pe.INFO,oD={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},aD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=oD[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ou{constructor(e){this.name=e,this._logLevel=sD,this._logHandler=aD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}}const lD=(t,e)=>e.some(n=>t instanceof n);let W0,K0;function cD(){return W0||(W0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uD(){return K0||(K0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const H1=new WeakMap,jg=new WeakMap,G1=new WeakMap,wm=new WeakMap,w_=new WeakMap;function hD(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ji(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&H1.set(n,t)}).catch(()=>{}),w_.set(e,t),e}function dD(t){if(jg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});jg.set(t,e)}let Ug={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||G1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ji(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fD(t){Ug=t(Ug)}function pD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Im(this),e,...n);return G1.set(r,e.sort?e.sort():[e]),Ji(r)}:uD().includes(t)?function(...e){return t.apply(Im(this),e),Ji(H1.get(this))}:function(...e){return Ji(t.apply(Im(this),e))}}function mD(t){return typeof t=="function"?pD(t):(t instanceof IDBTransaction&&dD(t),lD(t,cD())?new Proxy(t,Ug):t)}function Ji(t){if(t instanceof IDBRequest)return hD(t);if(wm.has(t))return wm.get(t);const e=mD(t);return e!==t&&(wm.set(t,e),w_.set(e,t)),e}const Im=t=>w_.get(t);function W1(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Ji(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Ji(o.result),c.oldVersion,c.newVersion,Ji(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const gD=["get","getKey","getAll","getAllKeys","count"],yD=["put","add","delete","clear"],Em=new Map;function Q0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Em.get(e))return Em.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=yD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||gD.includes(n)))return;const s=async function(o,...a){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&c.done]))[0]};return Em.set(e,s),s}fD(t=>({...t,get:(e,n,r)=>Q0(e,n)||t.get(e,n,r),has:(e,n)=>!!Q0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(vD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function vD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bg="@firebase/app",Y0="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr=new Ou("@firebase/app"),wD="@firebase/app-compat",ID="@firebase/analytics-compat",ED="@firebase/analytics",TD="@firebase/app-check-compat",AD="@firebase/app-check",RD="@firebase/auth",SD="@firebase/auth-compat",bD="@firebase/database",xD="@firebase/data-connect",PD="@firebase/database-compat",kD="@firebase/functions",CD="@firebase/functions-compat",ND="@firebase/installations",DD="@firebase/installations-compat",OD="@firebase/messaging",LD="@firebase/messaging-compat",VD="@firebase/performance",MD="@firebase/performance-compat",FD="@firebase/remote-config",jD="@firebase/remote-config-compat",UD="@firebase/storage",BD="@firebase/storage-compat",$D="@firebase/firestore",zD="@firebase/ai",qD="@firebase/firestore-compat",HD="firebase",GD="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of="[DEFAULT]",WD={[Bg]:"fire-core",[wD]:"fire-core-compat",[ED]:"fire-analytics",[ID]:"fire-analytics-compat",[AD]:"fire-app-check",[TD]:"fire-app-check-compat",[RD]:"fire-auth",[SD]:"fire-auth-compat",[bD]:"fire-rtdb",[xD]:"fire-data-connect",[PD]:"fire-rtdb-compat",[kD]:"fire-fn",[CD]:"fire-fn-compat",[ND]:"fire-iid",[DD]:"fire-iid-compat",[OD]:"fire-fcm",[LD]:"fire-fcm-compat",[VD]:"fire-perf",[MD]:"fire-perf-compat",[FD]:"fire-rc",[jD]:"fire-rc-compat",[UD]:"fire-gcs",[BD]:"fire-gcs-compat",[$D]:"fire-fst",[qD]:"fire-fst-compat",[zD]:"fire-vertex","fire-js":"fire-js",[HD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=new Map,KD=new Map,$g=new Map;function J0(t,e){try{t.container.addComponent(e)}catch(n){Hr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Bn(t){const e=t.name;if($g.has(e))return Hr.debug(`There were multiple attempts to register component ${e}.`),!1;$g.set(e,t);for(const n of af.values())J0(n,t);for(const n of KD.values())J0(n,t);return!0}function sr(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function QD(t,e,n=of){sr(t,e).clearInstance(n)}function Me(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xi=new To("app","Firebase",YD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Rn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=GD;function K1(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:of,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Xi.create("bad-app-name",{appName:String(i)});if(n||(n=M1()),!n)throw Xi.create("no-options");const s=af.get(i);if(s){if(Un(n,s.options)&&Un(r,s.config))return s;throw Xi.create("duplicate-app",{appName:i})}const o=new rD(i);for(const c of $g.values())o.addComponent(c);const a=new JD(n,r,o);return af.set(i,a),a}function Lu(t=of){const e=af.get(t);if(!e&&t===of&&M1())return K1();if(!e)throw Xi.create("no-app",{appName:t});return e}function Bt(t,e,n){let r=WD[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hr.warn(o.join(" "));return}Bn(new Rn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="firebase-heartbeat-database",ZD=1,su="firebase-heartbeat-store";let Tm=null;function Q1(){return Tm||(Tm=W1(XD,ZD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(su)}catch(n){console.warn(n)}}}}).catch(t=>{throw Xi.create("idb-open",{originalErrorMessage:t.message})})),Tm}async function e2(t){try{const n=(await Q1()).transaction(su),r=await n.objectStore(su).get(Y1(t));return await n.done,r}catch(e){if(e instanceof Pn)Hr.warn(e.message);else{const n=Xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Hr.warn(n.message)}}}async function X0(t,e){try{const r=(await Q1()).transaction(su,"readwrite");await r.objectStore(su).put(e,Y1(t)),await r.done}catch(n){if(n instanceof Pn)Hr.warn(n.message);else{const r=Xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Hr.warn(r.message)}}}function Y1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=1024,n2=30;class r2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new s2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Z0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>n2){const o=o2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Hr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Z0(),{heartbeatsToSend:r,unsentEntries:i}=i2(this._heartbeatsCache.heartbeats),s=sf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Hr.warn(n),""}}}function Z0(){return new Date().toISOString().substring(0,10)}function i2(t,e=t2){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),eI(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),eI(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class s2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return v_()?q1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await e2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return X0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return X0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function eI(t){return sf(JSON.stringify({version:2,heartbeats:t})).length}function o2(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a2(t){Bn(new Rn("platform-logger",e=>new _D(e),"PRIVATE")),Bn(new Rn("heartbeat",e=>new r2(e),"PRIVATE")),Bt(Bg,Y0,t),Bt(Bg,Y0,"esm2020"),Bt("fire-js","")}a2("");var l2="firebase",c2="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bt(l2,c2,"app");const J1="@firebase/installations",I_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1=1e4,Z1=`w:${I_}`,eR="FIS_v2",u2="https://firebaseinstallations.googleapis.com/v1",h2=60*60*1e3,d2="installations",f2="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ao=new To(d2,f2,p2);function tR(t){return t instanceof Pn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR({projectId:t}){return`${u2}/projects/${t}/installations`}function rR(t){return{token:t.token,requestStatus:2,expiresIn:g2(t.expiresIn),creationTime:Date.now()}}async function iR(t,e){const r=(await e.json()).error;return ao.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function sR({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function m2(t,{refreshToken:e}){const n=sR(t);return n.append("Authorization",y2(e)),n}async function oR(t){const e=await t();return e.status>=500&&e.status<600?t():e}function g2(t){return Number(t.replace("s","000"))}function y2(t){return`${eR} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _2({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=nR(t),i=sR(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:eR,appId:t.appId,sdkVersion:Z1},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await oR(()=>fetch(r,a));if(c.ok){const u=await c.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:rR(u.authToken)}}else throw await iR("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=/^[cdef][\w-]{21}$/,zg="";function I2(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=E2(t);return w2.test(n)?n:zg}catch{return zg}}function E2(t){return v2(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=new Map;function cR(t,e){const n=Qf(t);uR(n,e),T2(n,e)}function uR(t,e){const n=lR.get(t);if(n)for(const r of n)r(e)}function T2(t,e){const n=A2();n&&n.postMessage({key:t,fid:e}),R2()}let qs=null;function A2(){return!qs&&"BroadcastChannel"in self&&(qs=new BroadcastChannel("[Firebase] FID Change"),qs.onmessage=t=>{uR(t.data.key,t.data.fid)}),qs}function R2(){lR.size===0&&qs&&(qs.close(),qs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2="firebase-installations-database",b2=1,lo="firebase-installations-store";let Am=null;function E_(){return Am||(Am=W1(S2,b2,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(lo)}}})),Am}async function lf(t,e){const n=Qf(t),i=(await E_()).transaction(lo,"readwrite"),s=i.objectStore(lo),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&cR(t,e.fid),e}async function hR(t){const e=Qf(t),r=(await E_()).transaction(lo,"readwrite");await r.objectStore(lo).delete(e),await r.done}async function Yf(t,e){const n=Qf(t),i=(await E_()).transaction(lo,"readwrite"),s=i.objectStore(lo),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&cR(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T_(t){let e;const n=await Yf(t.appConfig,r=>{const i=x2(r),s=P2(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===zg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function x2(t){const e=t||{fid:I2(),registrationStatus:0};return dR(e)}function P2(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(ao.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=k2(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:C2(t)}:{installationEntry:e}}async function k2(t,e){try{const n=await _2(t,e);return lf(t.appConfig,n)}catch(n){throw tR(n)&&n.customData.serverCode===409?await hR(t.appConfig):await lf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function C2(t){let e=await tI(t.appConfig);for(;e.registrationStatus===1;)await aR(100),e=await tI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await T_(t);return r||n}return e}function tI(t){return Yf(t,e=>{if(!e)throw ao.create("installation-not-found");return dR(e)})}function dR(t){return N2(t)?{fid:t.fid,registrationStatus:0}:t}function N2(t){return t.registrationStatus===1&&t.registrationTime+X1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D2({appConfig:t,heartbeatServiceProvider:e},n){const r=O2(t,n),i=m2(t,n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:Z1,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await oR(()=>fetch(r,a));if(c.ok){const u=await c.json();return rR(u)}else throw await iR("Generate Auth Token",c)}function O2(t,{fid:e}){return`${nR(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A_(t,e=!1){let n;const r=await Yf(t.appConfig,s=>{if(!fR(s))throw ao.create("not-registered");const o=s.authToken;if(!e&&M2(o))return s;if(o.requestStatus===1)return n=L2(t,e),s;{if(!navigator.onLine)throw ao.create("app-offline");const a=j2(s);return n=V2(t,a),a}});return n?await n:r.authToken}async function L2(t,e){let n=await nI(t.appConfig);for(;n.authToken.requestStatus===1;)await aR(100),n=await nI(t.appConfig);const r=n.authToken;return r.requestStatus===0?A_(t,e):r}function nI(t){return Yf(t,e=>{if(!fR(e))throw ao.create("not-registered");const n=e.authToken;return U2(n)?{...e,authToken:{requestStatus:0}}:e})}async function V2(t,e){try{const n=await D2(t,e),r={...e,authToken:n};return await lf(t.appConfig,r),n}catch(n){if(tR(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await hR(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await lf(t.appConfig,r)}throw n}}function fR(t){return t!==void 0&&t.registrationStatus===2}function M2(t){return t.requestStatus===2&&!F2(t)}function F2(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+h2}function j2(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function U2(t){return t.requestStatus===1&&t.requestTime+X1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B2(t){const e=t,{installationEntry:n,registrationPromise:r}=await T_(e);return r?r.catch(console.error):A_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $2(t,e=!1){const n=t;return await z2(n),(await A_(n,e)).token}async function z2(t){const{registrationPromise:e}=await T_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(t){if(!t||!t.options)throw Rm("App Configuration");if(!t.name)throw Rm("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Rm(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Rm(t){return ao.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR="installations",H2="installations-internal",G2=t=>{const e=t.getProvider("app").getImmediate(),n=q2(e),r=sr(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},W2=t=>{const e=t.getProvider("app").getImmediate(),n=sr(e,pR).getImmediate();return{getId:()=>B2(n),getToken:i=>$2(n,i)}};function K2(){Bn(new Rn(pR,G2,"PUBLIC")),Bn(new Rn(H2,W2,"PRIVATE"))}K2();Bt(J1,I_);Bt(J1,I_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="analytics",Q2="firebase_id",Y2="origin",J2=60*1e3,X2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",R_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un=new Ou("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},In=new To("analytics","Analytics",Z2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eO(t){if(!t.startsWith(R_)){const e=In.create("invalid-gtag-resource",{gtagURL:t});return un.warn(e.message),""}return t}function mR(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function tO(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function nO(t,e){const n=tO("firebase-js-sdk-policy",{createScriptURL:eO}),r=document.createElement("script"),i=`${R_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function rO(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function iO(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const c=(await mR(n)).find(u=>u.measurementId===i);c&&await e[c.appId]}}catch(a){un.error(a)}t("config",i,s)}async function sO(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await mR(n);for(const c of o){const u=a.find(f=>f.measurementId===c),h=u&&e[u.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){un.error(s)}}function oO(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,c]=o;await sO(t,e,n,a,c)}else if(s==="config"){const[a,c]=o;await iO(t,e,n,r,a,c)}else if(s==="consent"){const[a,c]=o;t("consent",a,c)}else if(s==="get"){const[a,c,u]=o;t("get",a,c,u)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){un.error(a)}}return i}function aO(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=oO(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function lO(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(R_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cO=30,uO=1e3;class hO{constructor(e={},n=uO){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const gR=new hO;function dO(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function fO(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:dO(n)},i=X2.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const c=await s.json();(o=c.error)!=null&&o.message&&(a=c.error.message)}catch{}throw In.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function pO(t,e=gR,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw In.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw In.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new yO;return setTimeout(async()=>{a.abort()},n!==void 0?n:J2),yR({appId:r,apiKey:i,measurementId:s},o,a,e)}async function yR(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=gR){var a;const{appId:s,measurementId:o}=t;try{await mO(r,e)}catch(c){if(o)return un.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:s,measurementId:o};throw c}try{const c=await fO(t);return i.deleteThrottleMetadata(s),c}catch(c){const u=c;if(!gO(u)){if(i.deleteThrottleMetadata(s),o)return un.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:s,measurementId:o};throw c}const h=Number((a=u==null?void 0:u.customData)==null?void 0:a.httpStatus)===503?G0(n,i.intervalMillis,cO):G0(n,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(s,f),un.debug(`Calling attemptFetch again in ${h} millis`),yR(t,f,r,i)}}function mO(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(In.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function gO(t){if(!(t instanceof Pn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class yO{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function _O(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o={...r,send_to:s};t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vO(){if(v_())try{await q1()}catch(t){return un.warn(In.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return un.warn(In.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function wO(t,e,n,r,i,s,o){const a=pO(t);a.then(p=>{n[p.measurementId]=p.appId,t.options.measurementId&&p.measurementId!==t.options.measurementId&&un.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>un.error(p)),e.push(a);const c=vO().then(p=>{if(p)return r.getId()}),[u,h]=await Promise.all([a,c]);lO(s)||nO(s,u.measurementId),i("js",new Date);const f=(o==null?void 0:o.config)??{};return f[Y2]="firebase",f.update=!0,h!=null&&(f[Q2]=h),i("config",u.measurementId,f),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e){this.app=e}_delete(){return delete bc[this.app.options.appId],Promise.resolve()}}let bc={},rI=[];const iI={};let Sm="dataLayer",EO="gtag",sI,_R,oI=!1;function TO(){const t=[];if(B1()&&t.push("This is a browser extension environment."),$N()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=In.create("invalid-analytics-context",{errorInfo:e});un.warn(n.message)}}function AO(t,e,n){TO();const r=t.options.appId;if(!r)throw In.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)un.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw In.create("no-api-key");if(bc[r]!=null)throw In.create("already-exists",{id:r});if(!oI){rO(Sm);const{wrappedGtag:s,gtagCore:o}=aO(bc,rI,iI,Sm,EO);_R=s,sI=o,oI=!0}return bc[r]=wO(t,rI,iI,e,sI,Sm,n),new IO(t)}function RO(t=Lu()){t=J(t);const e=sr(t,cf);return e.isInitialized()?e.getImmediate():SO(t)}function SO(t,e={}){const n=sr(t,cf);if(n.isInitialized()){const i=n.getImmediate();if(Un(e,n.getOptions()))return i;throw In.create("already-initialized")}return n.initialize({options:e})}function bO(t,e,n,r){t=J(t),_O(_R,bc[t.app.options.appId],e,n,r).catch(i=>un.error(i))}const aI="@firebase/analytics",lI="0.10.18";function xO(){Bn(new Rn(cf,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return AO(r,i,n)},"PUBLIC")),Bn(new Rn("analytics-internal",t,"PRIVATE")),Bt(aI,lI),Bt(aI,lI,"esm2020");function t(e){try{const n=e.getProvider(cf).getImmediate();return{logEvent:(r,i,s)=>bO(n,r,i,s)}}catch(n){throw In.create("interop-component-reg-failed",{reason:n})}}}xO();var cI="@firebase/ai",qg="2.2.1";/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va="AI",uI="us-central1",PO="firebasevertexai.googleapis.com",kO="v1beta",hI=qg,CO="gl-js",NO=180*1e3,DO="gemini-2.0-flash-lite";/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI=["user","model","function","system"],vR={HARM_SEVERITY_NEGLIGIBLE:"HARM_SEVERITY_NEGLIGIBLE",HARM_SEVERITY_LOW:"HARM_SEVERITY_LOW",HARM_SEVERITY_MEDIUM:"HARM_SEVERITY_MEDIUM",HARM_SEVERITY_HIGH:"HARM_SEVERITY_HIGH",HARM_SEVERITY_UNSUPPORTED:"HARM_SEVERITY_UNSUPPORTED"},fI={STOP:"STOP",MAX_TOKENS:"MAX_TOKENS",SAFETY:"SAFETY",RECITATION:"RECITATION",OTHER:"OTHER",BLOCKLIST:"BLOCKLIST",PROHIBITED_CONTENT:"PROHIBITED_CONTENT",SPII:"SPII",MALFORMED_FUNCTION_CALL:"MALFORMED_FUNCTION_CALL"},pI={TEXT:"TEXT",IMAGE:"IMAGE",AUDIO:"AUDIO"},mI={PREFER_ON_DEVICE:"prefer_on_device",ONLY_ON_DEVICE:"only_on_device",ONLY_IN_CLOUD:"only_in_cloud"};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const he={ERROR:"error",REQUEST_ERROR:"request-error",RESPONSE_ERROR:"response-error",FETCH_ERROR:"fetch-error",SESSION_CLOSED:"session-closed",INVALID_CONTENT:"invalid-content",API_NOT_ENABLED:"api-not-enabled",INVALID_SCHEMA:"invalid-schema",NO_API_KEY:"no-api-key",NO_APP_ID:"no-app-id",NO_MODEL:"no-model",NO_PROJECT_ID:"no-project-id",PARSE_FAILED:"parse-failed",UNSUPPORTED:"unsupported"};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr={VERTEX_AI:"VERTEX_AI",GOOGLE_AI:"GOOGLE_AI"};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.backendType=e}}class Vu extends wR{constructor(){super(Zr.GOOGLE_AI)}}class Jf extends wR{constructor(e=uI){super(Zr.VERTEX_AI),e?this.location=e:this.location=uI}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OO=class{constructor(e,n,r,i,s){this.app=e,this.backend=n,this.chromeAdapterFactory=s;const o=i==null?void 0:i.getImmediate({optional:!0}),a=r==null?void 0:r.getImmediate({optional:!0});this.auth=a||null,this.appCheck=o||null,n instanceof Jf?this.location=n.location:this.location=""}_delete(){return Promise.resolve()}set options(e){this._options=e}get options(){return this._options}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce extends Pn{constructor(e,n,r){const i=Va,s=`${i}/${e}`,o=`${i}: ${n} (${s})`;super(e,o),this.code=e,this.customErrorData=r,Error.captureStackTrace&&Error.captureStackTrace(this,ce),Object.setPrototypeOf(this,ce.prototype),this.toString=()=>o}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LO(t){if(t instanceof Vu)return`${Va}/googleai`;if(t instanceof Jf)return`${Va}/vertexai/${t.location}`;throw new ce(he.ERROR,`Invalid backend: ${JSON.stringify(t.backendType)}`)}function VO(t){const e=t.split("/");if(e[0]!==Va)throw new ce(he.ERROR,`Invalid instance identifier, unknown prefix '${e[0]}'`);switch(e[1]){case"vertexai":const r=e[2];if(!r)throw new ce(he.ERROR,`Invalid instance identifier, unknown location '${t}'`);return new Jf(r);case"googleai":return new Vu;default:throw new ce(he.ERROR,`Invalid instance identifier string: '${t}'`)}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,n){var r,i,s,o,a,c,u;if((i=(r=e.app)==null?void 0:r.options)!=null&&i.apiKey)if((o=(s=e.app)==null?void 0:s.options)!=null&&o.projectId)if((c=(a=e.app)==null?void 0:a.options)!=null&&c.appId){if(this._apiSettings={apiKey:e.app.options.apiKey,project:e.app.options.projectId,appId:e.app.options.appId,automaticDataCollectionEnabled:e.app.automaticDataCollectionEnabled,location:e.location,backend:e.backend},Me(e.app)&&e.app.settings.appCheckToken){const h=e.app.settings.appCheckToken;this._apiSettings.getAppCheckToken=()=>Promise.resolve({token:h})}else e.appCheck&&((u=e.options)!=null&&u.useLimitedUseAppCheckTokens?this._apiSettings.getAppCheckToken=()=>e.appCheck.getLimitedUseToken():this._apiSettings.getAppCheckToken=()=>e.appCheck.getToken());e.auth&&(this._apiSettings.getAuthToken=()=>e.auth.getToken()),this.model=xc.normalizeModelName(n,this._apiSettings.backend.backendType)}else throw new ce(he.NO_APP_ID,'The "appId" field is empty in the local Firebase config. Firebase AI requires this field to contain a valid app ID.');else throw new ce(he.NO_PROJECT_ID,'The "projectId" field is empty in the local Firebase config. Firebase AI requires this field to contain a valid project ID.');else throw new ce(he.NO_API_KEY,'The "apiKey" field is empty in the local Firebase config. Firebase AI requires this field to contain a valid API key.')}static normalizeModelName(e,n){return n===Zr.GOOGLE_AI?xc.normalizeGoogleAIModelName(e):xc.normalizeVertexAIModelName(e)}static normalizeGoogleAIModelName(e){return`models/${e}`}static normalizeVertexAIModelName(e){let n;return e.includes("/")?e.startsWith("models/")?n=`publishers/google/${e}`:n=e:n=`publishers/google/models/${e}`,n}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const en=new Ou("@firebase/vertexai");/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ou;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.PREDICT="predict"})(ou||(ou={}));class IR{constructor(e,n,r,i,s){this.model=e,this.task=n,this.apiSettings=r,this.stream=i,this.requestOptions=s}toString(){const e=new URL(this.baseUrl);return e.pathname=`/${this.apiVersion}/${this.modelPath}:${this.task}`,e.search=this.queryParams.toString(),e.toString()}get baseUrl(){var e;return((e=this.requestOptions)==null?void 0:e.baseUrl)||`https://${PO}`}get apiVersion(){return kO}get modelPath(){if(this.apiSettings.backend instanceof Vu)return`projects/${this.apiSettings.project}/${this.model}`;if(this.apiSettings.backend instanceof Jf)return`projects/${this.apiSettings.project}/locations/${this.apiSettings.backend.location}/${this.model}`;throw new ce(he.ERROR,`Invalid backend: ${JSON.stringify(this.apiSettings.backend)}`)}get queryParams(){const e=new URLSearchParams;return this.stream&&e.set("alt","sse"),e}}function MO(){const t=[];return t.push(`${CO}/${hI}`),t.push(`fire/${hI}`),t.join(" ")}async function FO(t){const e=new Headers;if(e.append("Content-Type","application/json"),e.append("x-goog-api-client",MO()),e.append("x-goog-api-key",t.apiSettings.apiKey),t.apiSettings.automaticDataCollectionEnabled&&e.append("X-Firebase-Appid",t.apiSettings.appId),t.apiSettings.getAppCheckToken){const n=await t.apiSettings.getAppCheckToken();n&&(e.append("X-Firebase-AppCheck",n.token),n.error&&en.warn(`Unable to obtain a valid App Check token: ${n.error.message}`))}if(t.apiSettings.getAuthToken){const n=await t.apiSettings.getAuthToken();n&&e.append("Authorization",`Firebase ${n.accessToken}`)}return e}async function jO(t,e,n,r,i,s){const o=new IR(t,e,n,r,s);return{url:o.toString(),fetchOptions:{method:"POST",headers:await FO(o),body:i}}}async function S_(t,e,n,r,i,s){const o=new IR(t,e,n,r,s);let a,c;try{const u=await jO(t,e,n,r,i,s),h=(s==null?void 0:s.timeout)!=null&&s.timeout>=0?s.timeout:NO,f=new AbortController;if(c=setTimeout(()=>f.abort(),h),u.fetchOptions.signal=f.signal,a=await fetch(u.url,u.fetchOptions),!a.ok){let p="",v;try{const b=await a.json();p=b.error.message,b.error.details&&(p+=` ${JSON.stringify(b.error.details)}`,v=b.error.details)}catch{}throw a.status===403&&v&&v.some(b=>b.reason==="SERVICE_DISABLED")&&v.some(b=>{var P,C;return(C=(P=b.links)==null?void 0:P[0])==null?void 0:C.description.includes("Google developers console API activation")})?new ce(he.API_NOT_ENABLED,`The Firebase AI SDK requires the Firebase AI API ('firebasevertexai.googleapis.com') to be enabled in your Firebase project. Enable this API by visiting the Firebase Console at https://console.firebase.google.com/project/${o.apiSettings.project}/genai/ and clicking "Get started". If you enabled this API recently, wait a few minutes for the action to propagate to our systems and then retry.`,{status:a.status,statusText:a.statusText,errorDetails:v}):new ce(he.FETCH_ERROR,`Error fetching from ${o}: [${a.status} ${a.statusText}] ${p}`,{status:a.status,statusText:a.statusText,errorDetails:v})}}catch(u){let h=u;throw u.code!==he.FETCH_ERROR&&u.code!==he.API_NOT_ENABLED&&u instanceof Error&&(h=new ce(he.ERROR,`Error fetching from ${o.toString()}: ${u.message}`),h.stack=u.stack),h}finally{c&&clearTimeout(c)}return a}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(t){if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&en.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),ER(t.candidates[0]))throw new ce(he.RESPONSE_ERROR,`Response error: ${Hs(t)}. Response body stored in error.response`,{response:t});return!0}else return!1}function uf(t){return t.candidates&&!t.candidates[0].hasOwnProperty("index")&&(t.candidates[0].index=0),UO(t)}function UO(t){return t.text=()=>{if(Wh(t))return gI(t,e=>!e.thought);if(t.promptFeedback)throw new ce(he.RESPONSE_ERROR,`Text not available. ${Hs(t)}`,{response:t});return""},t.thoughtSummary=()=>{if(Wh(t)){const e=gI(t,n=>!!n.thought);return e===""?void 0:e}else if(t.promptFeedback)throw new ce(he.RESPONSE_ERROR,`Thought summary not available. ${Hs(t)}`,{response:t})},t.inlineDataParts=()=>{if(Wh(t))return $O(t);if(t.promptFeedback)throw new ce(he.RESPONSE_ERROR,`Data not available. ${Hs(t)}`,{response:t})},t.functionCalls=()=>{if(Wh(t))return BO(t);if(t.promptFeedback)throw new ce(he.RESPONSE_ERROR,`Function call not available. ${Hs(t)}`,{response:t})},t}function gI(t,e){var r,i,s,o;const n=[];if((i=(r=t.candidates)==null?void 0:r[0].content)!=null&&i.parts)for(const a of(o=(s=t.candidates)==null?void 0:s[0].content)==null?void 0:o.parts)a.text&&e(a)&&n.push(a.text);return n.length>0?n.join(""):""}function BO(t){var n,r,i,s;const e=[];if((r=(n=t.candidates)==null?void 0:n[0].content)!=null&&r.parts)for(const o of(s=(i=t.candidates)==null?void 0:i[0].content)==null?void 0:s.parts)o.functionCall&&e.push(o.functionCall);if(e.length>0)return e}function $O(t){var n,r,i,s;const e=[];if((r=(n=t.candidates)==null?void 0:n[0].content)!=null&&r.parts)for(const o of(s=(i=t.candidates)==null?void 0:i[0].content)==null?void 0:s.parts)o.inlineData&&e.push(o);if(e.length>0)return e}const zO=[fI.RECITATION,fI.SAFETY];function ER(t){return!!t.finishReason&&zO.some(e=>e===t.finishReason)}function Hs(t){var n,r,i;let e="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)e+="Response was blocked",(n=t.promptFeedback)!=null&&n.blockReason&&(e+=` due to ${t.promptFeedback.blockReason}`),(r=t.promptFeedback)!=null&&r.blockReasonMessage&&(e+=`: ${t.promptFeedback.blockReasonMessage}`);else if((i=t.candidates)!=null&&i[0]){const s=t.candidates[0];ER(s)&&(e+=`Candidate was blocked due to ${s.finishReason}`,s.finishMessage&&(e+=`: ${s.finishMessage}`))}return e}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(t){var e,n;if((e=t.safetySettings)==null||e.forEach(r=>{if(r.method)throw new ce(he.UNSUPPORTED,"SafetySetting.method is not supported in the the Gemini Developer API. Please remove this property.")}),(n=t.generationConfig)!=null&&n.topK){const r=Math.round(t.generationConfig.topK);r!==t.generationConfig.topK&&(en.warn("topK in GenerationConfig has been rounded to the nearest integer to match the format for requests to the Gemini Developer API."),t.generationConfig.topK=r)}return t}function b_(t){return{candidates:t.candidates?HO(t.candidates):void 0,prompt:t.promptFeedback?GO(t.promptFeedback):void 0,usageMetadata:t.usageMetadata}}function qO(t,e){return{generateContentRequest:{model:e,...t}}}function HO(t){const e=[];let n;return e&&t.forEach(r=>{var o;let i;if(r.citationMetadata&&(i={citations:r.citationMetadata.citationSources}),r.safetyRatings&&(n=r.safetyRatings.map(a=>({...a,severity:a.severity??vR.HARM_SEVERITY_UNSUPPORTED,probabilityScore:a.probabilityScore??0,severityScore:a.severityScore??0}))),(o=r.content)!=null&&o.parts.some(a=>a==null?void 0:a.videoMetadata))throw new ce(he.UNSUPPORTED,"Part.videoMetadata is not supported in the Gemini Developer API. Please remove this property.");const s={index:r.index,content:r.content,finishReason:r.finishReason,finishMessage:r.finishMessage,safetyRatings:n,citationMetadata:i,groundingMetadata:r.groundingMetadata};e.push(s)}),e}function GO(t){const e=[];return t.safetyRatings.forEach(r=>{e.push({category:r.category,probability:r.probability,severity:r.severity??vR.HARM_SEVERITY_UNSUPPORTED,probabilityScore:r.probabilityScore??0,severityScore:r.severityScore??0,blocked:r.blocked})}),{blockReason:t.blockReason,safetyRatings:e,blockReasonMessage:t.blockReasonMessage}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function WO(t,e){const n=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),r=YO(n),[i,s]=r.tee();return{stream:QO(i,e),response:KO(s,e)}}async function KO(t,e){const n=[],r=t.getReader();for(;;){const{done:i,value:s}=await r.read();if(i){let o=JO(n);return e.backend.backendType===Zr.GOOGLE_AI&&(o=b_(o)),uf(o)}n.push(s)}}async function*QO(t,e){const n=t.getReader();for(;;){const{value:r,done:i}=await n.read();if(i)break;let s;e.backend.backendType===Zr.GOOGLE_AI?s=uf(b_(r)):s=uf(r),yield s}}function YO(t){const e=t.getReader();return new ReadableStream({start(r){let i="";return s();function s(){return e.read().then(({value:o,done:a})=>{if(a){if(i.trim()){r.error(new ce(he.PARSE_FAILED,"Failed to parse stream"));return}r.close();return}i+=o;let c=i.match(yI),u;for(;c;){try{u=JSON.parse(c[1])}catch{r.error(new ce(he.PARSE_FAILED,`Error parsing JSON response: "${c[1]}`));return}r.enqueue(u),i=i.substring(c[0].length),c=i.match(yI)}return s()})}}})}function JO(t){const e=t[t.length-1],n={promptFeedback:e==null?void 0:e.promptFeedback};for(const r of t)if(r.candidates)for(const i of r.candidates){const s=i.index||0;if(n.candidates||(n.candidates=[]),n.candidates[s]||(n.candidates[s]={index:i.index}),n.candidates[s].citationMetadata=i.citationMetadata,n.candidates[s].finishReason=i.finishReason,n.candidates[s].finishMessage=i.finishMessage,n.candidates[s].safetyRatings=i.safetyRatings,n.candidates[s].groundingMetadata=i.groundingMetadata,i.content&&i.content.parts){n.candidates[s].content||(n.candidates[s].content={role:i.content.role||"user",parts:[]});const o={};for(const a of i.content.parts){if(a.text!==void 0){if(a.text==="")continue;o.text=a.text}if(a.functionCall&&(o.functionCall=a.functionCall),Object.keys(o).length===0)throw new ce(he.INVALID_CONTENT,"Part should have at least one property, but there are none. This is likely caused by a malformed response from the backend.");n.candidates[s].content.parts.push(o)}}}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XO(t,e,n,r){return t.backend.backendType===Zr.GOOGLE_AI&&(n=TR(n)),S_(e,ou.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(n),r)}async function AR(t,e,n,r,i){let s;return r&&await r.isAvailable(n)?s=await r.generateContentStream(n):s=await XO(t,e,n,i),WO(s,t)}async function ZO(t,e,n,r){return t.backend.backendType===Zr.GOOGLE_AI&&(n=TR(n)),S_(e,ou.GENERATE_CONTENT,t,!1,JSON.stringify(n),r)}async function RR(t,e,n,r,i){let s;r&&await r.isAvailable(n)?s=await r.generateContent(n):s=await ZO(t,e,n,i);const o=await eL(s,t);return{response:uf(o)}}async function eL(t,e){const n=await t.json();return e.backend.backendType===Zr.GOOGLE_AI?b_(n):n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function Hg(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const n of t)typeof n=="string"?e.push({text:n}):e.push(n);return tL(e)}function tL(t){const e={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,i=!1;for(const s of t)"functionResponse"in s?(n.parts.push(s),i=!0):(e.parts.push(s),r=!0);if(r&&i)throw new ce(he.INVALID_CONTENT,"Within a single message, FunctionResponse cannot be mixed with other type of Part in the request for sending chat message.");if(!r&&!i)throw new ce(he.INVALID_CONTENT,"No Content is provided for sending chat message.");return r?e:n}function bm(t){let e;return t.contents?e=t:e={contents:[Hg(t)]},t.systemInstruction&&(e.systemInstruction=SR(t.systemInstruction)),e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=["text","inlineData","functionCall","functionResponse","thought","thoughtSignature"],nL={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","thought","thoughtSignature"],system:["text"]},vI={user:["model"],function:["model"],model:["user","function"],system:[]};function rL(t){let e=null;for(const n of t){const{role:r,parts:i}=n;if(!e&&r!=="user")throw new ce(he.INVALID_CONTENT,`First Content should be with role 'user', got ${r}`);if(!dI.includes(r))throw new ce(he.INVALID_CONTENT,`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(dI)}`);if(!Array.isArray(i))throw new ce(he.INVALID_CONTENT,"Content should have 'parts' property with an array of Parts");if(i.length===0)throw new ce(he.INVALID_CONTENT,"Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0,thought:0,thoughtSignature:0};for(const a of i)for(const c of _I)c in a&&(s[c]+=1);const o=nL[r];for(const a of _I)if(!o.includes(a)&&s[a]>0)throw new ce(he.INVALID_CONTENT,`Content with role '${r}' can't contain '${a}' part`);if(e&&!vI[r].includes(e.role))throw new ce(he.INVALID_CONTENT,`Content with role '${r}' can't follow '${e.role}'. Valid previous roles: ${JSON.stringify(vI)}`);e=n}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI="SILENT_ERROR";class iL{constructor(e,n,r,i,s){this.model=n,this.chromeAdapter=r,this.params=i,this.requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiSettings=e,i!=null&&i.history&&(rL(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e){var s,o,a,c,u;await this._sendPromise;const n=Hg(e),r={safetySettings:(s=this.params)==null?void 0:s.safetySettings,generationConfig:(o=this.params)==null?void 0:o.generationConfig,tools:(a=this.params)==null?void 0:a.tools,toolConfig:(c=this.params)==null?void 0:c.toolConfig,systemInstruction:(u=this.params)==null?void 0:u.systemInstruction,contents:[...this._history,n]};let i={};return this._sendPromise=this._sendPromise.then(()=>RR(this._apiSettings,this.model,r,this.chromeAdapter,this.requestOptions)).then(h=>{var f,p;if(h.response.candidates&&h.response.candidates.length>0){this._history.push(n);const v={parts:((f=h.response.candidates)==null?void 0:f[0].content.parts)||[],role:((p=h.response.candidates)==null?void 0:p[0].content.role)||"model"};this._history.push(v)}else{const v=Hs(h.response);v&&en.warn(`sendMessage() was unsuccessful. ${v}. Inspect response object for details.`)}i=h}),await this._sendPromise,i}async sendMessageStream(e){var s,o,a,c,u;await this._sendPromise;const n=Hg(e),r={safetySettings:(s=this.params)==null?void 0:s.safetySettings,generationConfig:(o=this.params)==null?void 0:o.generationConfig,tools:(a=this.params)==null?void 0:a.tools,toolConfig:(c=this.params)==null?void 0:c.toolConfig,systemInstruction:(u=this.params)==null?void 0:u.systemInstruction,contents:[...this._history,n]},i=AR(this._apiSettings,this.model,r,this.chromeAdapter,this.requestOptions);return this._sendPromise=this._sendPromise.then(()=>i).catch(h=>{throw new Error(wI)}).then(h=>h.response).then(h=>{if(h.candidates&&h.candidates.length>0){this._history.push(n);const f={...h.candidates[0].content};f.role||(f.role="model"),this._history.push(f)}else{const f=Hs(h);f&&en.warn(`sendMessageStream() was unsuccessful. ${f}. Inspect response object for details.`)}}).catch(h=>{h.message!==wI&&en.error(h)}),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sL(t,e,n,r){let i="";if(t.backend.backendType===Zr.GOOGLE_AI){const o=qO(n,e);i=JSON.stringify(o)}else i=JSON.stringify(n);return(await S_(e,ou.COUNT_TOKENS,t,!1,i,r)).json()}async function oL(t,e,n,r,i){return r&&await r.isAvailable(n)?(await r.countTokens(n)).json():sL(t,e,n,i)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL extends xc{constructor(e,n,r,i){super(e,n.model),this.chromeAdapter=i,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=SR(n.systemInstruction),this.requestOptions=r||{}}async generateContent(e){const n=bm(e);return RR(this._apiSettings,this.model,{generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,...n},this.chromeAdapter,this.requestOptions)}async generateContentStream(e){const n=bm(e);return AR(this._apiSettings,this.model,{generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,...n},this.chromeAdapter,this.requestOptions)}startChat(e){return new iL(this._apiSettings,this.model,this.chromeAdapter,{tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,generationConfig:this.generationConfig,safetySettings:this.safetySettings,...e},this.requestOptions)}async countTokens(e){const n=bm(e);return oL(this._apiSettings,this.model,n,this.chromeAdapter)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lL(t=Lu(),e){t=J(t);const n=sr(t,Va),r=(e==null?void 0:e.backend)??new Vu,i={useLimitedUseAppCheckTokens:(e==null?void 0:e.useLimitedUseAppCheckTokens)??!1},s=LO(r),o=n.getImmediate({identifier:s});return o.options=i,o}function cL(t,e,n){var o;const r=e;let i;if(r.mode?i=r.inCloudParams||{model:DO}:i=e,!i.model)throw new ce(he.NO_MODEL,"Must provide a model name. Example: getGenerativeModel({ model: 'my-model-name' })");const s=(o=t.chromeAdapterFactory)==null?void 0:o.call(t,r.mode,typeof window>"u"?void 0:window,r.onDeviceParams);return new aL(t,i,n,s)}var Vs;(function(t){t.UNAVAILABLE="unavailable",t.DOWNLOADABLE="downloadable",t.DOWNLOADING="downloading",t.AVAILABLE="available"})(Vs||(Vs={}));/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n,r={createOptions:{expectedInputs:[{type:"image"}]}}){this.languageModelProvider=e,this.mode=n,this.onDeviceParams=r,this.isDownloading=!1}async isAvailable(e){if(!this.mode)return en.debug("On-device inference unavailable because mode is undefined."),!1;if(this.mode===mI.ONLY_IN_CLOUD)return en.debug('On-device inference unavailable because mode is "only_in_cloud".'),!1;const n=await this.downloadIfAvailable();if(this.mode===mI.ONLY_ON_DEVICE){if(n===Vs.UNAVAILABLE)throw new ce(he.API_NOT_ENABLED,"Local LanguageModel API not available in this environment.");return(n===Vs.DOWNLOADABLE||n===Vs.DOWNLOADING)&&(en.debug("Waiting for download of LanguageModel to complete."),await this.downloadPromise),!0}return n!==Vs.AVAILABLE?(en.debug(`On-device inference unavailable because availability is "${n}".`),!1):Yn.isOnDeviceRequest(e)?!0:(en.debug("On-device inference unavailable because request is incompatible."),!1)}async generateContent(e){const n=await this.createSession(),r=await Promise.all(e.contents.map(Yn.toLanguageModelMessage)),i=await n.prompt(r,this.onDeviceParams.promptOptions);return Yn.toResponse(i)}async generateContentStream(e){const n=await this.createSession(),r=await Promise.all(e.contents.map(Yn.toLanguageModelMessage)),i=n.promptStreaming(r,this.onDeviceParams.promptOptions);return Yn.toStreamResponse(i)}async countTokens(e){throw new ce(he.REQUEST_ERROR,"Count Tokens is not yet available for on-device model.")}static isOnDeviceRequest(e){if(e.contents.length===0)return en.debug("Empty prompt rejected for on-device inference."),!1;for(const n of e.contents){if(n.role==="function")return en.debug('"Function" role rejected for on-device inference.'),!1;for(const r of n.parts)if(r.inlineData&&Yn.SUPPORTED_MIME_TYPES.indexOf(r.inlineData.mimeType)===-1)return en.debug(`Unsupported mime type "${r.inlineData.mimeType}" rejected for on-device inference.`),!1}return!0}async downloadIfAvailable(){var n;const e=await((n=this.languageModelProvider)==null?void 0:n.availability(this.onDeviceParams.createOptions));return e===Vs.DOWNLOADABLE&&this.download(),e}download(){var e;this.isDownloading||(this.isDownloading=!0,this.downloadPromise=(e=this.languageModelProvider)==null?void 0:e.create(this.onDeviceParams.createOptions).finally(()=>{this.isDownloading=!1}))}static async toLanguageModelMessage(e){const n=await Promise.all(e.parts.map(Yn.toLanguageModelMessageContent));return{role:Yn.toLanguageModelMessageRole(e.role),content:n}}static async toLanguageModelMessageContent(e){if(e.text)return{type:"text",value:e.text};if(e.inlineData){const r=await(await fetch(`data:${e.inlineData.mimeType};base64,${e.inlineData.data}`)).blob();return{type:"image",value:await createImageBitmap(r)}}throw new ce(he.REQUEST_ERROR,"Processing of this Part type is not currently supported.")}static toLanguageModelMessageRole(e){return e==="model"?"assistant":"user"}async createSession(){if(!this.languageModelProvider)throw new ce(he.UNSUPPORTED,"Chrome AI requested for unsupported browser version.");const e=await this.languageModelProvider.create(this.onDeviceParams.createOptions);return this.oldSession&&this.oldSession.destroy(),this.oldSession=e,e}static toResponse(e){return{json:async()=>({candidates:[{content:{parts:[{text:e}]}}]})}}static toStreamResponse(e){const n=new TextEncoder;return{body:e.pipeThrough(new TransformStream({transform(r,i){const s=JSON.stringify({candidates:[{content:{role:"model",parts:[{text:r}]}}]});i.enqueue(n.encode(`data: ${s}

`))}}))}}}Yn.SUPPORTED_MIME_TYPES=["image/jpeg","image/png"];function uL(t,e,n){if(typeof e<"u"&&t)return new Yn(e.LanguageModel,t,n)}function hL(t,{instanceIdentifier:e}){if(!e)throw new ce(he.ERROR,"AIService instance identifier is undefined.");const n=VO(e),r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new OO(r,n,i,s,uL)}function dL(){Bn(new Rn(Va,hL,"PUBLIC").setMultipleInstances(!0)),Bt(cI,qg),Bt(cI,qg,"esm2020")}dL();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A6={PHONE:"phone",TOTP:"totp"},R6={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},S6={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},b6={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},x6={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function bR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const P6=fL,pL=bR,xR=new To("auth","Firebase",bR()),k6={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf=new Ou("@firebase/auth");function mL(t,...e){hf.logLevel<=pe.WARN&&hf.warn(`Auth (${Ao}): ${t}`,...e)}function _d(t,...e){hf.logLevel<=pe.ERROR&&hf.error(`Auth (${Ao}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(t,...e){throw P_(t,...e)}function Kt(t,...e){return P_(t,...e)}function x_(t,e,n){const r={...pL(),[e]:n};return new To("auth","Firebase",r).create(e,{appName:t.name})}function Et(t){return x_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ll(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&hn(t,"argument-error"),x_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function P_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return xR.create(t,...e)}function q(t,e,...n){if(!t)throw P_(e,...n)}function fr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _d(e),new Error(e)}function Gr(t,e){t||fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function k_(){return II()==="http:"||II()==="https:"}function II(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(k_()||B1()||"connection"in navigator)?navigator.onLine:!0}function yL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Gr(n>e,"Short delay should be less than long delay!"),this.isMobile=FN()||UN()}get(){return gL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(t,e){Gr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],wL=new Mu(3e4,6e4);function je(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ue(t,e,n,r,i={}){return kR(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=al({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...s};return jN()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Xr(t.emulatorConfig.host)&&(u.credentials="include"),PR.fetch()(await CR(t,t.config.apiHost,n,a),u)})}async function kR(t,e,n){t._canInitEmulator=!1;const r={..._L,...e};try{const i=new EL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw dc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw dc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw dc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw dc(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw x_(t,h,u);hn(t,h)}}catch(i){if(i instanceof Pn)throw i;hn(t,"network-request-failed",{message:String(i)})}}async function ei(t,e,n,r,i={}){const s=await Ue(t,e,n,r,i);return"mfaPendingCredential"in s&&hn(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function CR(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?C_(t.config,i):`${t.config.apiScheme}://${i}`;return vL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function IL(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class EL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Kt(this.auth,"network-request-failed")),wL.get())})}}function dc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Kt(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EI(t){return t!==void 0&&t.getResponse!==void 0}function TI(t){return t!==void 0&&t.enterprise!==void 0}class NR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return IL(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TL(t){return(await Ue(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function DR(t,e){return Ue(t,"GET","/v2/recaptchaConfig",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AL(t,e){return Ue(t,"POST","/v1/accounts:delete",e)}async function RL(t,e){return Ue(t,"POST","/v1/accounts:update",e)}async function df(t,e){return Ue(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C6(t,e=!1){return J(t).getIdToken(e)}async function SL(t,e=!1){const n=J(t),r=await n.getIdToken(e),i=Xf(r);q(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Pc(xm(i.auth_time)),issuedAtTime:Pc(xm(i.iat)),expirationTime:Pc(xm(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function xm(t){return Number(t)*1e3}function Xf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return _d("JWT malformed, contained fewer than 3 sections"),null;try{const i=D1(n);return i?JSON.parse(i):(_d("Failed to decode base64 JWT payload"),null)}catch(i){return _d("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function AI(t){const e=Xf(t);return q(e,"internal-error"),q(typeof e.exp<"u","internal-error"),q(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wr(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Pn&&bL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function bL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pc(this.lastLoginAt),this.creationTime=Pc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lu(t){var f;const e=t.auth,n=await t.getIdToken(),r=await Wr(t,df(e,{idToken:n}));q(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?OR(i.providerUserInfo):[],o=kL(t.providerData,s),a=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Gg(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function PL(t){const e=J(t);await lu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function OR(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CL(t,e){const n=await kR(t,{},async()=>{const r=al({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await CR(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&Xr(t.emulatorConfig.host)&&(c.credentials="include"),PR.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function NL(t,e){return Ue(t,"POST","/v2/accounts:revokeToken",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){q(e.idToken,"internal-error"),q(typeof e.idToken<"u","internal-error"),q(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):AI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){q(e.length!==0,"internal-error");const n=AI(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(q(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await CL(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ta;return r&&(q(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(q(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(q(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ta,this.toJSON())}_performRefresh(){return fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(t,e){q(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class er{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new xL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Gg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Wr(this,this.stsTokenManager.getToken(this.auth,e));return q(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return SL(this,e)}reload(){return PL(this)}_assign(e){this!==e&&(q(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new er({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await lu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Me(this.auth.app))return Promise.reject(Et(this.auth));const e=await this.getIdToken();return await Wr(this,AL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:f,emailVerified:p,isAnonymous:v,providerData:b,stsTokenManager:P}=n;q(f&&P,e,"internal-error");const C=Ta.fromJSON(this.name,P);q(typeof f=="string",e,"internal-error"),Ei(r,e.name),Ei(i,e.name),q(typeof p=="boolean",e,"internal-error"),q(typeof v=="boolean",e,"internal-error"),Ei(s,e.name),Ei(o,e.name),Ei(a,e.name),Ei(c,e.name),Ei(u,e.name),Ei(h,e.name);const E=new er({uid:f,auth:e,email:i,emailVerified:p,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:C,createdAt:u,lastLoginAt:h});return b&&Array.isArray(b)&&(E.providerData=b.map(w=>({...w}))),c&&(E._redirectEventId=c),E}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ta;i.updateFromServerResponse(n);const s=new er({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await lu(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];q(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?OR(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ta;a.updateFromIdToken(r);const c=new er({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Gg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=new Map;function Lr(t){Gr(t instanceof Function,"Expected a class definition");let e=RI.get(t);return e?(Gr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,RI.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}LR.type="NONE";const SI=LR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t,e,n){return`firebase:${t}:${e}:${n}`}class Aa{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=vd(this.userKey,i.apiKey,s),this.fullPersistenceKey=vd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await df(this.auth,{idToken:e}).catch(()=>{});return n?er._fromGetAccountInfoResponse(this.auth,n,e):null}return er._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Aa(Lr(SI),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Lr(SI);const o=vd(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const h=await u._get(o);if(h){let f;if(typeof h=="string"){const p=await df(e,{idToken:h}).catch(()=>{});if(!p)break;f=await er._fromGetAccountInfoResponse(e,p,h)}else f=er._fromJSON(e,h);u!==s&&(a=f),s=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Aa(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new Aa(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(VR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BR(e))return"Blackberry";if($R(e))return"Webos";if(MR(e))return"Safari";if((e.includes("chrome/")||FR(e))&&!e.includes("edge/"))return"Chrome";if(UR(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function VR(t=pt()){return/firefox\//i.test(t)}function MR(t=pt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function FR(t=pt()){return/crios\//i.test(t)}function jR(t=pt()){return/iemobile/i.test(t)}function UR(t=pt()){return/android/i.test(t)}function BR(t=pt()){return/blackberry/i.test(t)}function $R(t=pt()){return/webos/i.test(t)}function N_(t=pt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function DL(t=pt()){var e;return N_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function OL(){return BN()&&document.documentMode===10}function zR(t=pt()){return N_(t)||UR(t)||$R(t)||BR(t)||/windows phone/i.test(t)||jR(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qR(t,e=[]){let n;switch(t){case"Browser":n=bI(pt());break;case"Worker":n=`${bI(pt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ao}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VL(t,e={}){return Ue(t,"GET","/v2/passwordPolicy",je(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML=6;class FL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??ML,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xI(this),this.idTokenSubscription=new xI(this),this.beforeStateQueue=new LL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Lr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Aa.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await df(this,{idToken:e}),r=await er._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Me(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return q(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await lu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Me(this.app))return Promise.reject(Et(this));const n=e?J(e):null;return n&&q(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&q(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Me(this.app)?Promise.reject(Et(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Me(this.app)?Promise.reject(Et(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Lr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await VL(this),n=new FL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new To("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await NL(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Lr(e)||this._popupRedirectResolver;q(n,this,"argument-error"),this.redirectPersistenceManager=await Aa.create(this,[Lr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(q(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Me(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&mL(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function et(t){return J(t)}class xI{constructor(e){this.auth=e,this.observer=null,this.addObserver=WN(n=>this.observer=n)}get next(){return q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function UL(t){Fu=t}function D_(t){return Fu.loadJS(t)}function BL(){return Fu.recaptchaV2Script}function $L(){return Fu.recaptchaEnterpriseScript}function zL(){return Fu.gapiScript}function HR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=500,HL=6e4,Kh=1e12;class GL{constructor(e){this.auth=e,this.counter=Kh,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new QL(e,this.auth.name,n||{})),this.counter++,r}reset(e){var r;const n=e||Kh;(r=this._widgets.get(n))==null||r.delete(),this._widgets.delete(n)}getResponse(e){var r;const n=e||Kh;return((r=this._widgets.get(n))==null?void 0:r.getResponse())||""}async execute(e){var r;const n=e||Kh;return(r=this._widgets.get(n))==null||r.execute(),""}}class WL{constructor(){this.enterprise=new KL}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class KL{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class QL{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;q(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=YL(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},HL)},qL))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function YL(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}const JL="recaptcha-enterprise",kc="NO_RECAPTCHA";class GR{constructor(e){this.type=JL,this.auth=et(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{DR(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new NR(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})})}function i(s,o,a){const c=window.grecaptcha;TI(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(kc)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new WL().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&TI(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=$L();c.length!==0&&(c+=a),D_(c).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Zl(t,e,n,r=!1,i=!1){const s=new GR(t);let o;if(i)o=kc;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Zi(t,e,n,r,i){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Zl(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Zl(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(a)});else if(i==="PHONE_PROVIDER")if((o=t._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const a=await Zl(t,e,n);return r(t,a).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())==null?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const h=await Zl(t,e,n,!1,!0);return r(t,h)}return Promise.reject(c)})}else{const a=await Zl(t,e,n,!1,!0);return r(t,a)}else return Promise.reject(i+" provider is not supported.")}async function WR(t){const e=et(t),n=await DR(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new NR(n);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new GR(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XL(t,e){const n=sr(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Un(s,e??{}))return i;hn(i,"already-initialized")}return n.initialize({options:e})}function ZL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Lr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function eV(t,e,n){const r=et(t);q(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=KR(e),{host:o,port:a}=tV(e),c=a===null?"":`:${a}`,u={url:`${s}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){q(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),q(Un(u,r.config.emulator)&&Un(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Xr(o)?(Kf(`${s}//${o}${c}`),__("Auth",!0)):i||nV()}function KR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function tV(t){const e=KR(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:PI(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:PI(o)}}}function PI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nV(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return fr("not implemented")}_getIdTokenResponse(e){return fr("not implemented")}_linkToIdToken(e,n){return fr("not implemented")}_getReauthenticationResolver(e){return fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QR(t,e){return Ue(t,"POST","/v1/accounts:resetPassword",je(t,e))}async function rV(t,e){return Ue(t,"POST","/v1/accounts:update",e)}async function iV(t,e){return Ue(t,"POST","/v1/accounts:signUp",e)}async function sV(t,e){return Ue(t,"POST","/v1/accounts:update",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oV(t,e){return ei(t,"POST","/v1/accounts:signInWithPassword",je(t,e))}async function Zf(t,e){return Ue(t,"POST","/v1/accounts:sendOobCode",je(t,e))}async function aV(t,e){return Zf(t,e)}async function lV(t,e){return Zf(t,e)}async function cV(t,e){return Zf(t,e)}async function uV(t,e){return Zf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hV(t,e){return ei(t,"POST","/v1/accounts:signInWithEmailLink",je(t,e))}async function dV(t,e){return ei(t,"POST","/v1/accounts:signInWithEmailLink",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu extends ju{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new cu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new cu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zi(e,n,"signInWithPassword",oV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return hV(e,{email:this._email,oobCode:this._password});default:hn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zi(e,r,"signUpPassword",iV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return dV(e,{idToken:n,email:this._email,oobCode:this._password});default:hn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jr(t,e){return ei(t,"POST","/v1/accounts:signInWithIdp",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV="http://localhost";class Kr extends ju{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Kr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):hn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new Kr(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return jr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,jr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,jr(e,n)}buildRequest(){const e={requestUri:fV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=al(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kI(t,e){return Ue(t,"POST","/v1/accounts:sendVerificationCode",je(t,e))}async function pV(t,e){return ei(t,"POST","/v1/accounts:signInWithPhoneNumber",je(t,e))}async function mV(t,e){const n=await ei(t,"POST","/v1/accounts:signInWithPhoneNumber",je(t,e));if(n.temporaryProof)throw dc(t,"account-exists-with-different-credential",n);return n}const gV={USER_NOT_FOUND:"user-not-found"};async function yV(t,e){const n={...e,operation:"REAUTH"};return ei(t,"POST","/v1/accounts:signInWithPhoneNumber",je(t,n),gV)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys extends ju{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Ys({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Ys({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return pV(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return mV(e,{idToken:n,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return yV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new Ys({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _V(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function vV(t){const e=uc(hc(t)).link,n=e?uc(hc(e)).deep_link_id:null,r=uc(hc(t)).deep_link_id;return(r?uc(hc(r)).link:null)||r||n||e||t}class Uu{constructor(e){const n=uc(hc(e)),r=n.apiKey??null,i=n.oobCode??null,s=_V(n.mode??null);q(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=vV(e);try{return new Uu(n)}catch{return null}}}function N6(t){return Uu.parseLink(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(){this.providerId=Ro.PROVIDER_ID}static credential(e,n){return cu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Uu.parseLink(n);return q(r,"argument-error"),cu._fromEmailAndCode(e,r.code,r.tenantId)}}Ro.PROVIDER_ID="password";Ro.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ro.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl extends ti{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class wd extends cl{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return q("providerId"in n&&"signInMethod"in n,"argument-error"),Kr._fromParams(n)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return q(e.idToken||e.accessToken,"argument-error"),Kr._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return wd.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return wd.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!n&&!s||!a)return null;try{return new wd(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends cl{constructor(){super("facebook.com")}static credential(e){return Kr._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ci.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends cl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Kr._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ni.credential(n,r)}catch{return null}}}Ni.GOOGLE_SIGN_IN_METHOD="google.com";Ni.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends cl{constructor(){super("github.com")}static credential(e){return Kr._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Di.credential(e.oauthAccessToken)}catch{return null}}}Di.GITHUB_SIGN_IN_METHOD="github.com";Di.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV="http://localhost";class uu extends ju{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return jr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,jr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,jr(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new uu(r,s)}static _create(e,n){return new uu(e,n)}buildRequest(){return{requestUri:wV,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV="saml.";class Wg extends ti{constructor(e){q(e.startsWith(IV),"argument-error"),super(e)}static credentialFromResult(e){return Wg.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Wg.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=uu.fromJSON(e);return q(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return uu._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi extends cl{constructor(){super("twitter.com")}static credential(e,n){return Kr._fromParams({providerId:Oi.PROVIDER_ID,signInMethod:Oi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Oi.credentialFromTaggedObject(e)}static credentialFromError(e){return Oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Oi.credential(n,r)}catch{return null}}}Oi.TWITTER_SIGN_IN_METHOD="twitter.com";Oi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YR(t,e){return ei(t,"POST","/v1/accounts:signUp",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await er._fromIdTokenResponse(e,r,i),o=CI(r);return new $n({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=CI(r);return new $n({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function CI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EV(t){var i;if(Me(t.app))return Promise.reject(Et(t));const e=et(t);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new $n({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await YR(e,{returnSecureToken:!0}),r=await $n._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends Pn{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,ff.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new ff(e,n,r,i)}}function JR(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ff._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XR(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D6(t,e){const n=J(t);await ep(!0,n,e);const{providerUserInfo:r}=await RL(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=XR(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function O_(t,e,n=!1){const r=await Wr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return $n._forOperation(t,"link",r)}async function ep(t,e,n){await lu(e);const r=XR(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";q(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZR(t,e,n=!1){const{auth:r}=t;if(Me(r.app))return Promise.reject(Et(r));const i="reauthenticate";try{const s=await Wr(t,JR(r,i,e,t),n);q(s.idToken,r,"internal-error");const o=Xf(s.idToken);q(o,r,"internal-error");const{sub:a}=o;return q(t.uid===a,r,"user-mismatch"),$n._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&hn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eS(t,e,n=!1){if(Me(t.app))return Promise.reject(Et(t));const r="signIn",i=await JR(t,r,e),s=await $n._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function L_(t,e){return eS(et(t),e)}async function TV(t,e){const n=J(t);return await ep(!1,n,e.providerId),O_(n,e)}async function AV(t,e){return ZR(J(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RV(t,e){return ei(t,"POST","/v1/accounts:signInWithCustomToken",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O6(t,e){if(Me(t.app))return Promise.reject(Et(t));const n=et(t),r=await RV(n,{token:e,returnSecureToken:!0}),i=await $n._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?V_._fromServerResponse(e,n):"totpInfo"in n?M_._fromServerResponse(e,n):hn(e,"internal-error")}}class V_ extends Bu{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new V_(n)}}class M_ extends Bu{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new M_(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(t,e,n){var r;q(((r=n.url)==null?void 0:r.length)>0,t,"invalid-continue-uri"),q(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),q(typeof n.linkDomain>"u"||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(q(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(q(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F_(t){const e=et(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function L6(t,e,n){const r=et(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&tp(r,i,n),await Zi(r,i,"getOobCode",lV,"EMAIL_PASSWORD_PROVIDER")}async function V6(t,e,n){await QR(J(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&F_(t),r})}async function M6(t,e){await sV(J(t),{oobCode:e})}async function SV(t,e){const n=J(t),r=await QR(n,{oobCode:e}),i=r.requestType;switch(q(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":q(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":q(r.mfaInfo,n,"internal-error");default:q(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Bu._fromServerResponse(et(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function F6(t,e){const{data:n}=await SV(J(t),e);return n.email}async function j6(t,e,n){if(Me(t.app))return Promise.reject(Et(t));const r=et(t),o=await Zi(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",YR,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&F_(t),c}),a=await $n._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function U6(t,e,n){return Me(t.app)?Promise.reject(Et(t)):L_(J(t),Ro.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&F_(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B6(t,e,n){const r=et(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){q(a.handleCodeInApp,r,"argument-error"),a&&tp(r,o,a)}s(i,n),await Zi(r,i,"getOobCode",cV,"EMAIL_PASSWORD_PROVIDER")}function $6(t,e){const n=Uu.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function z6(t,e,n){if(Me(t.app))return Promise.reject(Et(t));const r=J(t),i=Ro.credentialWithLink(e,n||au());return q(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),L_(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bV(t,e){return Ue(t,"POST","/v1/accounts:createAuthUri",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q6(t,e){const n=k_()?au():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await bV(J(t),r);return i||[]}async function H6(t,e){const n=J(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&tp(n.auth,i,e);const{email:s}=await aV(n.auth,i);s!==t.email&&await t.reload()}async function G6(t,e,n){const r=J(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&tp(r.auth,s,n);const{email:o}=await uV(r.auth,s);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xV(t,e){return Ue(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=J(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Wr(r,xV(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function K6(t,e){const n=J(t);return Me(n.auth.app)?Promise.reject(Et(n.auth)):tS(n,e,null)}function Q6(t,e){return tS(J(t),null,e)}async function tS(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await Wr(t,rV(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PV(t){var i,s;if(!t)return null;const{providerId:e}=t,n=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},r=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(t!=null&&t.idToken)){const o=(s=(i=Xf(t.idToken))==null?void 0:i.firebase)==null?void 0:s.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new Ra(r,a)}}if(!e)return null;switch(e){case"facebook.com":return new kV(r,n);case"github.com":return new CV(r,n);case"google.com":return new NV(r,n);case"twitter.com":return new DV(r,n,t.screenName||null);case"custom":case"anonymous":return new Ra(r,null);default:return new Ra(r,e,n)}}class Ra{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class nS extends Ra{constructor(e,n,r,i){super(e,n,r),this.username=i}}class kV extends Ra{constructor(e,n){super(e,"facebook.com",n)}}class CV extends nS{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class NV extends Ra{constructor(e,n){super(e,"google.com",n)}}class DV extends nS{constructor(e,n,r){super(e,"twitter.com",n,r)}}function Y6(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:PV(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J6(t,e){return J(t).setPersistence(e)}function X6(t){return WR(t)}async function Z6(t,e){return et(t).validatePassword(e)}function OV(t,e,n,r){return J(t).onIdTokenChanged(e,n,r)}function LV(t,e,n){return J(t).beforeAuthStateChanged(e,n)}function VV(t,e,n,r){return J(t).onAuthStateChanged(e,n,r)}function e5(t){J(t).useDeviceLanguage()}function t5(t,e){return J(t).updateCurrentUser(e)}function n5(t){return J(t).signOut()}function r5(t,e){return et(t).revokeAccessToken(e)}async function i5(t){return J(t).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new Gs("enroll",e,n)}static _fromMfaPendingCredential(e){return new Gs("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if((n=e.multiFactorSession)!=null&&n.pendingCredential)return Gs._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return Gs._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=et(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Bu._fromServerResponse(r,a));q(i.mfaPendingCredential,r,"internal-error");const o=Gs._fromMfaPendingCredential(i.mfaPendingCredential);return new j_(o,s,async a=>{const c=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const u={...i,idToken:c.idToken,refreshToken:c.refreshToken};switch(n.operationType){case"signIn":const h=await $n._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(h.user),h;case"reauthenticate":return q(n.user,r,"internal-error"),$n._forOperation(n.user,n.operationType,u);default:hn(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function s5(t,e){var i;const n=J(t),r=e;return q(e.customData.operationType,n,"argument-error"),q((i=r.customData._serverResponse)==null?void 0:i.mfaPendingCredential,n,"argument-error"),j_._fromError(n,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(t,e){return Ue(t,"POST","/v2/accounts/mfaEnrollment:start",je(t,e))}function MV(t,e){return Ue(t,"POST","/v2/accounts/mfaEnrollment:finalize",je(t,e))}function FV(t,e){return Ue(t,"POST","/v2/accounts/mfaEnrollment:start",je(t,e))}function jV(t,e){return Ue(t,"POST","/v2/accounts/mfaEnrollment:finalize",je(t,e))}function UV(t,e){return Ue(t,"POST","/v2/accounts/mfaEnrollment:withdraw",je(t,e))}class U_{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Bu._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new U_(e)}async getSession(){return Gs._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await Wr(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Wr(this.user,UV(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Pm=new WeakMap;function o5(t){const e=J(t);return Pm.has(e)||Pm.set(e,U_._fromUser(e)),Pm.get(e)}const pf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(pf,"1"),this.storage.removeItem(pf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=1e3,$V=10;class iS extends rS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);OL()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$V):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},BV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}iS.type="LOCAL";const zV=iS;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV=1e3;function km(t){var r;const e=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${e}=([^;]+)`);return((r=document.cookie.match(n))==null?void 0:r[1])??null}function Cm(t){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${t.split(":")[3]}`}class sS{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;const n=new URL(`${window.location.origin}/__cookies__`);return n.searchParams.set("finalTarget",e),n}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,n){}async _get(e){if(!this._isAvailable())return null;const n=Cm(e);if(window.cookieStore){const r=await window.cookieStore.get(n);return r==null?void 0:r.value}return km(n)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;const r=Cm(e);document.cookie=`${r}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,n){if(!this._isAvailable())return;const r=Cm(e);if(window.cookieStore){const a=u=>{const h=u.changed.find(p=>p.name===r);h&&n(h.value),u.deleted.find(p=>p.name===r)&&n(null)},c=()=>window.cookieStore.removeEventListener("change",a);return this.listenerUnsubscribes.set(n,c),window.cookieStore.addEventListener("change",a)}let i=km(r);const s=setInterval(()=>{const a=km(r);a!==i&&(n(a),i=a)},qV),o=()=>clearInterval(s);this.listenerUnsubscribes.set(n,o)}_removeListener(e,n){const r=this.listenerUnsubscribes.get(n);r&&(r(),this.listenerUnsubscribes.delete(n))}}sS.type="COOKIE";const a5=sS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS extends rS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}oS.type="SESSION";const aS=oS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new np(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),c=await HV(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}np.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const u=rp("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(h),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(){return window}function WV(t){lt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(){return typeof lt().WorkerGlobalScope<"u"&&typeof lt().importScripts=="function"}async function KV(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function QV(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function YV(){return B_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS="firebaseLocalStorageDb",JV=1,mf="firebaseLocalStorage",cS="fbase_key";class $u{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ip(t,e){return t.transaction([mf],e?"readwrite":"readonly").objectStore(mf)}function XV(){const t=indexedDB.deleteDatabase(lS);return new $u(t).toPromise()}function Kg(){const t=indexedDB.open(lS,JV);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(mf,{keyPath:cS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(mf)?e(r):(r.close(),await XV(),e(await Kg()))})})}async function DI(t,e,n){const r=ip(t,!0).put({[cS]:e,value:n});return new $u(r).toPromise()}async function ZV(t,e){const n=ip(t,!1).get(e),r=await new $u(n).toPromise();return r===void 0?null:r.value}function OI(t,e){const n=ip(t,!0).delete(e);return new $u(n).toPromise()}const eM=800,tM=3;class uS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Kg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>tM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return B_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=np._getInstance(YV()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await KV(),!this.activeServiceWorker)return;this.sender=new GV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||QV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kg();return await DI(e,pf,"1"),await OI(e,pf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>DI(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>ZV(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>OI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=ip(i,!1).getAll();return new $u(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uS.type="LOCAL";const nM=uS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LI(t,e){return Ue(t,"POST","/v2/accounts/mfaSignIn:start",je(t,e))}function rM(t,e){return Ue(t,"POST","/v2/accounts/mfaSignIn:finalize",je(t,e))}function iM(t,e){return Ue(t,"POST","/v2/accounts/mfaSignIn:finalize",je(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm=HR("rcb"),sM=new Mu(3e4,6e4);class oM{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=lt().grecaptcha)!=null&&e.render)}load(e,n=""){return q(aM(n),e,"argument-error"),this.shouldResolveImmediately(n)&&EI(lt().grecaptcha)?Promise.resolve(lt().grecaptcha):new Promise((r,i)=>{const s=lt().setTimeout(()=>{i(Kt(e,"network-request-failed"))},sM.get());lt()[Nm]=()=>{lt().clearTimeout(s),delete lt()[Nm];const a=lt().grecaptcha;if(!a||!EI(a)){i(Kt(e,"internal-error"));return}const c=a.render;a.render=(u,h)=>{const f=c(u,h);return this.counter++,f},this.hostLanguage=n,r(a)};const o=`${BL()}?${al({onload:Nm,render:"explicit",hl:n})}`;D_(o).catch(()=>{clearTimeout(s),i(Kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!((n=lt().grecaptcha)!=null&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function aM(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class lM{async load(e){return new GL(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc="recaptcha",cM={theme:"light",type:"image"};class l5{constructor(e,n,r={...cM}){this.parameters=r,this.type=Cc,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=et(e),this.isInvisible=this.parameters.size==="invisible",q(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;q(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new lM:new oM,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){q(!this.parameters.sitekey,this.auth,"argument-error"),q(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),q(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=lt()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){q(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){q(k_()&&!B_(),this.auth,"internal-error"),await uM(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await TL(this.auth);q(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return q(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function uM(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Ys._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function c5(t,e,n){if(Me(t.app))return Promise.reject(Et(t));const r=et(t),i=await sp(r,e,J(n));return new $_(i,s=>L_(r,s))}async function u5(t,e,n){const r=J(t);await ep(!1,r,"phone");const i=await sp(r.auth,e,J(n));return new $_(i,s=>TV(r,s))}async function h5(t,e,n){const r=J(t);if(Me(r.auth.app))return Promise.reject(Et(r.auth));const i=await sp(r.auth,e,J(n));return new $_(i,s=>AV(r,s))}async function sp(t,e,n){var r;if(!t._getRecaptchaConfig())try{await WR(t)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const s=i.session;if("phoneNumber"in i){q(s.type==="enroll",t,"internal-error");const o={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Zi(t,o,"mfaSmsEnrollment",async(h,f)=>{if(f.phoneEnrollmentInfo.captchaResponse===kc){q((n==null?void 0:n.type)===Cc,h,"argument-error");const p=await Dm(h,f,n);return NI(h,p)}return NI(h,f)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).phoneSessionInfo.sessionInfo}else{q(s.type==="signin",t,"internal-error");const o=((r=i.multiFactorHint)==null?void 0:r.uid)||i.multiFactorUid;q(o,t,"missing-multi-factor-info");const a={mfaPendingCredential:s.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Zi(t,a,"mfaSmsSignIn",async(f,p)=>{if(p.phoneSignInInfo.captchaResponse===kc){q((n==null?void 0:n.type)===Cc,f,"argument-error");const v=await Dm(f,p,n);return LI(f,v)}return LI(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Zi(t,s,"sendVerificationCode",async(u,h)=>{if(h.captchaResponse===kc){q((n==null?void 0:n.type)===Cc,u,"argument-error");const f=await Dm(u,h,n);return kI(u,f)}return kI(u,h)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).sessionInfo}}finally{n==null||n._reset()}}async function d5(t,e){const n=J(t);if(Me(n.auth.app))return Promise.reject(Et(n.auth));await O_(n,e)}async function Dm(t,e,n){q(n.type===Cc,t,"argument-error");const r=await n.verify();q(typeof r=="string",t,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,a=i.phoneEnrollmentInfo.clientType,c=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:a,recaptchaVersion:c}}),i}else if("phoneSignInInfo"in i){const s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,a=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:a}}),i}else return Object.assign(i,{recaptchaToken:r}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e){this.providerId=Sa.PROVIDER_ID,this.auth=et(e)}verifyPhoneNumber(e,n){return sp(this.auth,e,J(n))}static credential(e,n){return Ys._fromVerification(e,n)}static credentialFromResult(e){const n=e;return Sa.credentialFromTaggedObject(n)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Ys._fromTokenResponse(n,r):null}}Sa.PROVIDER_ID="phone";Sa.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t,e){return e?Lr(e):(q(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_ extends ju{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return jr(e,this._buildIdpRequest())}_linkToIdToken(e,n){return jr(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return jr(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function hM(t){return eS(t.auth,new z_(t),t.bypassAuthState)}function dM(t){const{auth:e,user:n}=t;return q(n,e,"internal-error"),ZR(n,new z_(t),t.bypassAuthState)}async function fM(t){const{auth:e,user:n}=t;return q(n,e,"internal-error"),O_(n,new z_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hM;case"linkViaPopup":case"linkViaRedirect":return fM;case"reauthViaPopup":case"reauthViaRedirect":return dM;default:hn(this.auth,"internal-error")}}resolve(e){Gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Gr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pM=new Mu(2e3,1e4);async function f5(t,e,n){if(Me(t.app))return Promise.reject(Kt(t,"operation-not-supported-in-this-environment"));const r=et(t);ll(t,e,ti);const i=So(r,n);return new Vr(r,"signInViaPopup",e,i).executeNotNull()}async function p5(t,e,n){const r=J(t);if(Me(r.auth.app))return Promise.reject(Kt(r.auth,"operation-not-supported-in-this-environment"));ll(r.auth,e,ti);const i=So(r.auth,n);return new Vr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function m5(t,e,n){const r=J(t);ll(r.auth,e,ti);const i=So(r.auth,n);return new Vr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class Vr extends hS{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Vr.currentPopupAction&&Vr.currentPopupAction.cancel(),Vr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return q(e,this.auth,"internal-error"),e}async onExecution(){Gr(this.filter.length===1,"Popup operations only handle one event");const e=rp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,pM.get())};e()}}Vr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mM="pendingRedirect",Id=new Map;class gM extends hS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Id.get(this.auth._key());if(!e){try{const r=await yM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Id.set(this.auth._key(),e)}return this.bypassAuthState||Id.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yM(t,e){const n=fS(e),r=dS(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function q_(t,e){return dS(t)._set(fS(e),"true")}function _M(t,e){Id.set(t._key(),e)}function dS(t){return Lr(t._redirectPersistence)}function fS(t){return vd(mM,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g5(t,e,n){return vM(t,e,n)}async function vM(t,e,n){if(Me(t.app))return Promise.reject(Et(t));const r=et(t);ll(t,e,ti),await r._initializationPromise;const i=So(r,n);return await q_(i,r),i._openRedirect(r,e,"signInViaRedirect")}function y5(t,e,n){return wM(t,e,n)}async function wM(t,e,n){const r=J(t);if(ll(r.auth,e,ti),Me(r.auth.app))return Promise.reject(Et(r.auth));await r.auth._initializationPromise;const i=So(r.auth,n);await q_(i,r.auth);const s=await mS(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function _5(t,e,n){return IM(t,e,n)}async function IM(t,e,n){const r=J(t);ll(r.auth,e,ti),await r.auth._initializationPromise;const i=So(r.auth,n);await ep(!1,r,e.providerId),await q_(i,r.auth);const s=await mS(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function v5(t,e){return await et(t)._initializationPromise,pS(t,e,!1)}async function pS(t,e,n=!1){if(Me(t.app))return Promise.reject(Et(t));const r=et(t),i=So(r,e),o=await new gM(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function mS(t){const e=rp(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM=10*60*1e3;class TM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!AM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!gS(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Kt(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EM&&this.cachedEventUids.clear(),this.cachedEventUids.has(VI(e))}saveEventToCache(e){this.cachedEventUids.add(VI(e)),this.lastProcessedEventTime=Date.now()}}function VI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function gS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function AM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RM(t,e={}){return Ue(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bM=/^https?/;async function xM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await RM(t);for(const n of e)try{if(PM(n))return}catch{}hn(t,"unauthorized-domain")}function PM(t){const e=au(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!bM.test(n))return!1;if(SM.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kM=new Mu(3e4,6e4);function MI(){const t=lt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function CM(t){return new Promise((e,n)=>{var i,s,o;function r(){MI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{MI(),n(Kt(t,"network-request-failed"))},timeout:kM.get()})}if((s=(i=lt().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=lt().gapi)!=null&&o.load)r();else{const a=HR("iframefcb");return lt()[a]=()=>{gapi.load?r():n(Kt(t,"network-request-failed"))},D_(`${zL()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Ed=null,e})}let Ed=null;function NM(t){return Ed=Ed||CM(t),Ed}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DM=new Mu(5e3,15e3),OM="__/auth/iframe",LM="emulator/auth/iframe",VM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},MM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function FM(t){const e=t.config;q(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?C_(e,LM):`https://${t.config.authDomain}/${OM}`,r={apiKey:e.apiKey,appName:t.name,v:Ao},i=MM.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${al(r).slice(1)}`}async function jM(t){const e=await NM(t),n=lt().gapi;return q(n,t,"internal-error"),e.open({where:document.body,url:FM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VM,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Kt(t,"network-request-failed"),a=lt().setTimeout(()=>{s(o)},DM.get());function c(){lt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},BM=500,$M=600,zM="_blank",qM="http://localhost";class FI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function HM(t,e,n,r=BM,i=$M){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...UM,width:r.toString(),height:i.toString(),top:s,left:o},u=pt().toLowerCase();n&&(a=FR(u)?zM:n),VR(u)&&(e=e||qM,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[v,b])=>`${p}${v}=${b},`,"");if(DL(u)&&a!=="_self")return GM(e||"",a),new FI(null);const f=window.open(e||"",a,h);q(f,t,"popup-blocked");try{f.focus()}catch{}return new FI(f)}function GM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WM="__/auth/handler",KM="emulator/auth/handler",QM=encodeURIComponent("fac");async function jI(t,e,n,r,i,s){q(t.config.authDomain,t,"auth-domain-config-required"),q(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ao,eventId:i};if(e instanceof ti){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",GN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries(s||{}))o[h]=f}if(e instanceof cl){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),u=c?`#${QM}=${encodeURIComponent(c)}`:"";return`${YM(t)}?${al(a).slice(1)}${u}`}function YM({config:t}){return t.emulator?C_(t,KM):`https://${t.authDomain}/${WM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om="webStorageSupport";class JM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=aS,this._completeRedirectFn=pS,this._overrideRedirectResult=_M}async _openPopup(e,n,r,i){var o;Gr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await jI(e,n,r,au(),i);return HM(e,s,rp())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await jI(e,n,r,au(),i);return WV(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Gr(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await jM(e),r=new TM(e);return n.register("authEvent",i=>(q(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Om,{type:Om},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Om];s!==void 0&&n(!!s),hn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=xM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return zR()||MR()||N_()}}const XM=JM;class yS{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return fr("unexpected MultiFactorSessionType")}}}class H_ extends yS{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new H_(e)}_finalizeEnroll(e,n,r){return MV(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return rM(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class ZM{constructor(){}static assertion(e){return H_._fromCredential(e)}}ZM.FACTOR_ID="phone";class e4{static assertionForEnrollment(e,n){return hu._fromSecret(e,n)}static assertionForSignIn(e,n){return hu._fromEnrollmentId(e,n)}static async generateSecret(e){var i;const n=e;q(typeof((i=n.user)==null?void 0:i.auth)<"u","internal-error");const r=await FV(n.user.auth,{idToken:n.credential,totpEnrollmentInfo:{}});return G_._fromStartTotpMfaEnrollmentResponse(r,n.user.auth)}}e4.FACTOR_ID="totp";class hu extends yS{constructor(e,n,r){super("totp"),this.otp=e,this.enrollmentId=n,this.secret=r}static _fromSecret(e,n){return new hu(n,void 0,e)}static _fromEnrollmentId(e,n){return new hu(n,e)}async _finalizeEnroll(e,n,r){return q(typeof this.secret<"u",e,"argument-error"),jV(e,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,n){q(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return iM(e,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class G_{constructor(e,n,r,i,s,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=s}static _fromStartTotpMfaEnrollmentResponse(e,n){return new G_(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,n)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,n){var i;let r=!1;return(Qh(e)||Qh(n))&&(r=!0),r&&(Qh(e)&&(e=((i=this.auth.currentUser)==null?void 0:i.email)||"unknownuser"),Qh(n)&&(n=this.auth.name)),`otpauth://totp/${n}:${e}?secret=${this.secretKey}&issuer=${n}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Qh(t){return typeof t>"u"||(t==null?void 0:t.length)===0}var UI="@firebase/auth",BI="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function r4(t){Bn(new Rn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;q(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qR(t)},u=new jL(r,i,s,c);return ZL(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Bn(new Rn("auth-internal",e=>{const n=et(e.getProvider("auth").getImmediate());return(r=>new t4(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bt(UI,BI,n4(t)),Bt(UI,BI,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=5*60,s4=F1("authIdTokenMaxAge")||i4;let $I=null;const o4=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>s4)return;const i=n==null?void 0:n.token;$I!==i&&($I=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function a4(t=Lu()){const e=sr(t,"auth");if(e.isInitialized())return e.getImmediate();const n=XL(t,{popupRedirectResolver:XM,persistence:[nM,zV,aS]}),r=F1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=o4(s.toString());LV(n,o,()=>o(n.currentUser)),OV(n,a=>o(a))}}const i=L1("auth");return i&&eV(n,`http://${i}`),n}function l4(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}UL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Kt("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",l4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});r4("Browser");var zI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var es,_S;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,_){function S(){}S.prototype=_.prototype,A.D=_.prototype,A.prototype=new S,A.prototype.constructor=A,A.C=function(T,k,N){for(var x=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)x[Rt-2]=arguments[Rt];return _.prototype[k].apply(T,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,_,S){S||(S=0);var T=Array(16);if(typeof _=="string")for(var k=0;16>k;++k)T[k]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(k=0;16>k;++k)T[k]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=A.g[0],S=A.g[1],k=A.g[2];var N=A.g[3],x=_+(N^S&(k^N))+T[0]+3614090360&4294967295;_=S+(x<<7&4294967295|x>>>25),x=N+(k^_&(S^k))+T[1]+3905402710&4294967295,N=_+(x<<12&4294967295|x>>>20),x=k+(S^N&(_^S))+T[2]+606105819&4294967295,k=N+(x<<17&4294967295|x>>>15),x=S+(_^k&(N^_))+T[3]+3250441966&4294967295,S=k+(x<<22&4294967295|x>>>10),x=_+(N^S&(k^N))+T[4]+4118548399&4294967295,_=S+(x<<7&4294967295|x>>>25),x=N+(k^_&(S^k))+T[5]+1200080426&4294967295,N=_+(x<<12&4294967295|x>>>20),x=k+(S^N&(_^S))+T[6]+2821735955&4294967295,k=N+(x<<17&4294967295|x>>>15),x=S+(_^k&(N^_))+T[7]+4249261313&4294967295,S=k+(x<<22&4294967295|x>>>10),x=_+(N^S&(k^N))+T[8]+1770035416&4294967295,_=S+(x<<7&4294967295|x>>>25),x=N+(k^_&(S^k))+T[9]+2336552879&4294967295,N=_+(x<<12&4294967295|x>>>20),x=k+(S^N&(_^S))+T[10]+4294925233&4294967295,k=N+(x<<17&4294967295|x>>>15),x=S+(_^k&(N^_))+T[11]+2304563134&4294967295,S=k+(x<<22&4294967295|x>>>10),x=_+(N^S&(k^N))+T[12]+1804603682&4294967295,_=S+(x<<7&4294967295|x>>>25),x=N+(k^_&(S^k))+T[13]+4254626195&4294967295,N=_+(x<<12&4294967295|x>>>20),x=k+(S^N&(_^S))+T[14]+2792965006&4294967295,k=N+(x<<17&4294967295|x>>>15),x=S+(_^k&(N^_))+T[15]+1236535329&4294967295,S=k+(x<<22&4294967295|x>>>10),x=_+(k^N&(S^k))+T[1]+4129170786&4294967295,_=S+(x<<5&4294967295|x>>>27),x=N+(S^k&(_^S))+T[6]+3225465664&4294967295,N=_+(x<<9&4294967295|x>>>23),x=k+(_^S&(N^_))+T[11]+643717713&4294967295,k=N+(x<<14&4294967295|x>>>18),x=S+(N^_&(k^N))+T[0]+3921069994&4294967295,S=k+(x<<20&4294967295|x>>>12),x=_+(k^N&(S^k))+T[5]+3593408605&4294967295,_=S+(x<<5&4294967295|x>>>27),x=N+(S^k&(_^S))+T[10]+38016083&4294967295,N=_+(x<<9&4294967295|x>>>23),x=k+(_^S&(N^_))+T[15]+3634488961&4294967295,k=N+(x<<14&4294967295|x>>>18),x=S+(N^_&(k^N))+T[4]+3889429448&4294967295,S=k+(x<<20&4294967295|x>>>12),x=_+(k^N&(S^k))+T[9]+568446438&4294967295,_=S+(x<<5&4294967295|x>>>27),x=N+(S^k&(_^S))+T[14]+3275163606&4294967295,N=_+(x<<9&4294967295|x>>>23),x=k+(_^S&(N^_))+T[3]+4107603335&4294967295,k=N+(x<<14&4294967295|x>>>18),x=S+(N^_&(k^N))+T[8]+1163531501&4294967295,S=k+(x<<20&4294967295|x>>>12),x=_+(k^N&(S^k))+T[13]+2850285829&4294967295,_=S+(x<<5&4294967295|x>>>27),x=N+(S^k&(_^S))+T[2]+4243563512&4294967295,N=_+(x<<9&4294967295|x>>>23),x=k+(_^S&(N^_))+T[7]+1735328473&4294967295,k=N+(x<<14&4294967295|x>>>18),x=S+(N^_&(k^N))+T[12]+2368359562&4294967295,S=k+(x<<20&4294967295|x>>>12),x=_+(S^k^N)+T[5]+4294588738&4294967295,_=S+(x<<4&4294967295|x>>>28),x=N+(_^S^k)+T[8]+2272392833&4294967295,N=_+(x<<11&4294967295|x>>>21),x=k+(N^_^S)+T[11]+1839030562&4294967295,k=N+(x<<16&4294967295|x>>>16),x=S+(k^N^_)+T[14]+4259657740&4294967295,S=k+(x<<23&4294967295|x>>>9),x=_+(S^k^N)+T[1]+2763975236&4294967295,_=S+(x<<4&4294967295|x>>>28),x=N+(_^S^k)+T[4]+1272893353&4294967295,N=_+(x<<11&4294967295|x>>>21),x=k+(N^_^S)+T[7]+4139469664&4294967295,k=N+(x<<16&4294967295|x>>>16),x=S+(k^N^_)+T[10]+3200236656&4294967295,S=k+(x<<23&4294967295|x>>>9),x=_+(S^k^N)+T[13]+681279174&4294967295,_=S+(x<<4&4294967295|x>>>28),x=N+(_^S^k)+T[0]+3936430074&4294967295,N=_+(x<<11&4294967295|x>>>21),x=k+(N^_^S)+T[3]+3572445317&4294967295,k=N+(x<<16&4294967295|x>>>16),x=S+(k^N^_)+T[6]+76029189&4294967295,S=k+(x<<23&4294967295|x>>>9),x=_+(S^k^N)+T[9]+3654602809&4294967295,_=S+(x<<4&4294967295|x>>>28),x=N+(_^S^k)+T[12]+3873151461&4294967295,N=_+(x<<11&4294967295|x>>>21),x=k+(N^_^S)+T[15]+530742520&4294967295,k=N+(x<<16&4294967295|x>>>16),x=S+(k^N^_)+T[2]+3299628645&4294967295,S=k+(x<<23&4294967295|x>>>9),x=_+(k^(S|~N))+T[0]+4096336452&4294967295,_=S+(x<<6&4294967295|x>>>26),x=N+(S^(_|~k))+T[7]+1126891415&4294967295,N=_+(x<<10&4294967295|x>>>22),x=k+(_^(N|~S))+T[14]+2878612391&4294967295,k=N+(x<<15&4294967295|x>>>17),x=S+(N^(k|~_))+T[5]+4237533241&4294967295,S=k+(x<<21&4294967295|x>>>11),x=_+(k^(S|~N))+T[12]+1700485571&4294967295,_=S+(x<<6&4294967295|x>>>26),x=N+(S^(_|~k))+T[3]+2399980690&4294967295,N=_+(x<<10&4294967295|x>>>22),x=k+(_^(N|~S))+T[10]+4293915773&4294967295,k=N+(x<<15&4294967295|x>>>17),x=S+(N^(k|~_))+T[1]+2240044497&4294967295,S=k+(x<<21&4294967295|x>>>11),x=_+(k^(S|~N))+T[8]+1873313359&4294967295,_=S+(x<<6&4294967295|x>>>26),x=N+(S^(_|~k))+T[15]+4264355552&4294967295,N=_+(x<<10&4294967295|x>>>22),x=k+(_^(N|~S))+T[6]+2734768916&4294967295,k=N+(x<<15&4294967295|x>>>17),x=S+(N^(k|~_))+T[13]+1309151649&4294967295,S=k+(x<<21&4294967295|x>>>11),x=_+(k^(S|~N))+T[4]+4149444226&4294967295,_=S+(x<<6&4294967295|x>>>26),x=N+(S^(_|~k))+T[11]+3174756917&4294967295,N=_+(x<<10&4294967295|x>>>22),x=k+(_^(N|~S))+T[2]+718787259&4294967295,k=N+(x<<15&4294967295|x>>>17),x=S+(N^(k|~_))+T[9]+3951481745&4294967295,A.g[0]=A.g[0]+_&4294967295,A.g[1]=A.g[1]+(k+(x<<21&4294967295|x>>>11))&4294967295,A.g[2]=A.g[2]+k&4294967295,A.g[3]=A.g[3]+N&4294967295}r.prototype.u=function(A,_){_===void 0&&(_=A.length);for(var S=_-this.blockSize,T=this.B,k=this.h,N=0;N<_;){if(k==0)for(;N<=S;)i(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<_;)if(T[k++]=A.charCodeAt(N++),k==this.blockSize){i(this,T),k=0;break}}else for(;N<_;)if(T[k++]=A[N++],k==this.blockSize){i(this,T),k=0;break}}this.h=k,this.o+=_},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var _=1;_<A.length-8;++_)A[_]=0;var S=8*this.o;for(_=A.length-8;_<A.length;++_)A[_]=S&255,S/=256;for(this.u(A),A=Array(16),_=S=0;4>_;++_)for(var T=0;32>T;T+=8)A[S++]=this.g[_]>>>T&255;return A};function s(A,_){var S=a;return Object.prototype.hasOwnProperty.call(S,A)?S[A]:S[A]=_(A)}function o(A,_){this.h=_;for(var S=[],T=!0,k=A.length-1;0<=k;k--){var N=A[k]|0;T&&N==_||(S[k]=N,T=!1)}this.g=S}var a={};function c(A){return-128<=A&&128>A?s(A,function(_){return new o([_|0],0>_?-1:0)}):new o([A|0],0>A?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return f;if(0>A)return C(u(-A));for(var _=[],S=1,T=0;A>=S;T++)_[T]=A/S|0,S*=4294967296;return new o(_,0)}function h(A,_){if(A.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(A.charAt(0)=="-")return C(h(A.substring(1),_));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=u(Math.pow(_,8)),T=f,k=0;k<A.length;k+=8){var N=Math.min(8,A.length-k),x=parseInt(A.substring(k,k+N),_);8>N?(N=u(Math.pow(_,N)),T=T.j(N).add(u(x))):(T=T.j(S),T=T.add(u(x)))}return T}var f=c(0),p=c(1),v=c(16777216);t=o.prototype,t.m=function(){if(P(this))return-C(this).m();for(var A=0,_=1,S=0;S<this.g.length;S++){var T=this.i(S);A+=(0<=T?T:4294967296+T)*_,_*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(b(this))return"0";if(P(this))return"-"+C(this).toString(A);for(var _=u(Math.pow(A,6)),S=this,T="";;){var k=V(S,_).g;S=E(S,k.j(_));var N=((0<S.g.length?S.g[0]:S.h)>>>0).toString(A);if(S=k,b(S))return N+T;for(;6>N.length;)N="0"+N;T=N+T}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function b(A){if(A.h!=0)return!1;for(var _=0;_<A.g.length;_++)if(A.g[_]!=0)return!1;return!0}function P(A){return A.h==-1}t.l=function(A){return A=E(this,A),P(A)?-1:b(A)?0:1};function C(A){for(var _=A.g.length,S=[],T=0;T<_;T++)S[T]=~A.g[T];return new o(S,~A.h).add(p)}t.abs=function(){return P(this)?C(this):this},t.add=function(A){for(var _=Math.max(this.g.length,A.g.length),S=[],T=0,k=0;k<=_;k++){var N=T+(this.i(k)&65535)+(A.i(k)&65535),x=(N>>>16)+(this.i(k)>>>16)+(A.i(k)>>>16);T=x>>>16,N&=65535,x&=65535,S[k]=x<<16|N}return new o(S,S[S.length-1]&-2147483648?-1:0)};function E(A,_){return A.add(C(_))}t.j=function(A){if(b(this)||b(A))return f;if(P(this))return P(A)?C(this).j(C(A)):C(C(this).j(A));if(P(A))return C(this.j(C(A)));if(0>this.l(v)&&0>A.l(v))return u(this.m()*A.m());for(var _=this.g.length+A.g.length,S=[],T=0;T<2*_;T++)S[T]=0;for(T=0;T<this.g.length;T++)for(var k=0;k<A.g.length;k++){var N=this.i(T)>>>16,x=this.i(T)&65535,Rt=A.i(k)>>>16,Jt=A.i(k)&65535;S[2*T+2*k]+=x*Jt,w(S,2*T+2*k),S[2*T+2*k+1]+=N*Jt,w(S,2*T+2*k+1),S[2*T+2*k+1]+=x*Rt,w(S,2*T+2*k+1),S[2*T+2*k+2]+=N*Rt,w(S,2*T+2*k+2)}for(T=0;T<_;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=_;T<2*_;T++)S[T]=0;return new o(S,0)};function w(A,_){for(;(A[_]&65535)!=A[_];)A[_+1]+=A[_]>>>16,A[_]&=65535,_++}function R(A,_){this.g=A,this.h=_}function V(A,_){if(b(_))throw Error("division by zero");if(b(A))return new R(f,f);if(P(A))return _=V(C(A),_),new R(C(_.g),C(_.h));if(P(_))return _=V(A,C(_)),new R(C(_.g),_.h);if(30<A.g.length){if(P(A)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var S=p,T=_;0>=T.l(A);)S=B(S),T=B(T);var k=$(S,1),N=$(T,1);for(T=$(T,2),S=$(S,2);!b(T);){var x=N.add(T);0>=x.l(A)&&(k=k.add(S),N=x),T=$(T,1),S=$(S,1)}return _=E(A,k.j(_)),new R(k,_)}for(k=f;0<=A.l(_);){for(S=Math.max(1,Math.floor(A.m()/_.m())),T=Math.ceil(Math.log(S)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),N=u(S),x=N.j(_);P(x)||0<x.l(A);)S-=T,N=u(S),x=N.j(_);b(N)&&(N=p),k=k.add(N),A=E(A,x)}return new R(k,A)}t.A=function(A){return V(this,A).h},t.and=function(A){for(var _=Math.max(this.g.length,A.g.length),S=[],T=0;T<_;T++)S[T]=this.i(T)&A.i(T);return new o(S,this.h&A.h)},t.or=function(A){for(var _=Math.max(this.g.length,A.g.length),S=[],T=0;T<_;T++)S[T]=this.i(T)|A.i(T);return new o(S,this.h|A.h)},t.xor=function(A){for(var _=Math.max(this.g.length,A.g.length),S=[],T=0;T<_;T++)S[T]=this.i(T)^A.i(T);return new o(S,this.h^A.h)};function B(A){for(var _=A.g.length+1,S=[],T=0;T<_;T++)S[T]=A.i(T)<<1|A.i(T-1)>>>31;return new o(S,A.h)}function $(A,_){var S=_>>5;_%=32;for(var T=A.g.length-S,k=[],N=0;N<T;N++)k[N]=0<_?A.i(N+S)>>>_|A.i(N+S+1)<<32-_:A.i(N+S);return new o(k,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_S=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,es=o}).apply(typeof zI<"u"?zI:typeof self<"u"?self:typeof window<"u"?window:{});var Yh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vS,fc,wS,Td,Qg,IS,ES,TS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,d,m){return l==Array.prototype||l==Object.prototype||(l[d]=m.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yh=="object"&&Yh];for(var d=0;d<l.length;++d){var m=l[d];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function i(l,d){if(d)e:{var m=r;l=l.split(".");for(var y=0;y<l.length-1;y++){var D=l[y];if(!(D in m))break e;m=m[D]}l=l[l.length-1],y=m[l],d=d(y),d!=y&&d!=null&&e(m,l,{configurable:!0,writable:!0,value:d})}}function s(l,d){l instanceof String&&(l+="");var m=0,y=!1,D={next:function(){if(!y&&m<l.length){var M=m++;return{value:d(M,l[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.values",function(l){return l||function(){return s(this,function(d,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var d=typeof l;return d=d!="object"?d:l?Array.isArray(l)?"array":d:"null",d=="array"||d=="object"&&typeof l.length=="number"}function u(l){var d=typeof l;return d=="object"&&l!=null||d=="function"}function h(l,d,m){return l.call.apply(l.bind,arguments)}function f(l,d,m){if(!l)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,y),l.apply(d,D)}}return function(){return l.apply(d,arguments)}}function p(l,d,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,p.apply(null,arguments)}function v(l,d){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),l.apply(this,y)}}function b(l,d){function m(){}m.prototype=d.prototype,l.aa=d.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(y,D,M){for(var W=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)W[ke-2]=arguments[ke];return d.prototype[D].apply(y,W)}}function P(l){const d=l.length;if(0<d){const m=Array(d);for(let y=0;y<d;y++)m[y]=l[y];return m}return[]}function C(l,d){for(let m=1;m<arguments.length;m++){const y=arguments[m];if(c(y)){const D=l.length||0,M=y.length||0;l.length=D+M;for(let W=0;W<M;W++)l[D+W]=y[W]}else l.push(y)}}class E{constructor(d,m){this.i=d,this.j=m,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function w(l){return/^[\s\xa0]*$/.test(l)}function R(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function V(l){return V[" "](l),l}V[" "]=function(){};var B=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function $(l,d,m){for(const y in l)d.call(m,l[y],y,l)}function A(l,d){for(const m in l)d.call(void 0,l[m],m,l)}function _(l){const d={};for(const m in l)d[m]=l[m];return d}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(l,d){let m,y;for(let D=1;D<arguments.length;D++){y=arguments[D];for(m in y)l[m]=y[m];for(let M=0;M<S.length;M++)m=S[M],Object.prototype.hasOwnProperty.call(y,m)&&(l[m]=y[m])}}function k(l){var d=1;l=l.split(":");const m=[];for(;0<d&&l.length;)m.push(l.shift()),d--;return l.length&&m.push(l.join(":")),m}function N(l){a.setTimeout(()=>{throw l},0)}function x(){var l=te;let d=null;return l.g&&(d=l.g,l.g=l.g.next,l.g||(l.h=null),d.next=null),d}class Rt{constructor(){this.h=this.g=null}add(d,m){const y=Jt.get();y.set(d,m),this.h?this.h.next=y:this.g=y,this.h=y}}var Jt=new E(()=>new ws,l=>l.reset());class ws{constructor(){this.next=this.g=this.h=null}set(d,m){this.h=d,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let kn,K=!1,te=new Rt,oe=()=>{const l=a.Promise.resolve(void 0);kn=()=>{l.then(be)}};var be=()=>{for(var l;l=x();){try{l.h.call(l.g)}catch(m){N(m)}var d=Jt;d.j(l),100>d.h&&(d.h++,l.next=d.g,d.g=l)}K=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function xe(l,d){this.type=l,this.g=this.target=d,this.defaultPrevented=!1}xe.prototype.h=function(){this.defaultPrevented=!0};var ht=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,d=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};a.addEventListener("test",m,d),a.removeEventListener("test",m,d)}catch{}return l}();function Nt(l,d){if(xe.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,y=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=d,d=l.relatedTarget){if(B){e:{try{V(d.nodeName);var D=!0;break e}catch{}D=!1}D||(d=null)}}else m=="mouseover"?d=l.fromElement:m=="mouseout"&&(d=l.toElement);this.relatedTarget=d,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Cn[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Nt.aa.h.call(this)}}b(Nt,xe);var Cn={2:"touch",3:"pen",4:"mouse"};Nt.prototype.h=function(){Nt.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Dt="closure_listenable_"+(1e6*Math.random()|0),ih=0;function Lp(l,d,m,y,D){this.listener=l,this.proxy=null,this.src=d,this.type=m,this.capture=!!y,this.ha=D,this.key=++ih,this.da=this.fa=!1}function Ar(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Rr(l){this.src=l,this.g={},this.h=0}Rr.prototype.add=function(l,d,m,y,D){var M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);var W=oi(l,d,y,D);return-1<W?(d=l[W],m||(d.fa=!1)):(d=new Lp(d,this.src,M,!!y,D),d.fa=m,l.push(d)),d};function qn(l,d){var m=d.type;if(m in l.g){var y=l.g[m],D=Array.prototype.indexOf.call(y,d,void 0),M;(M=0<=D)&&Array.prototype.splice.call(y,D,1),M&&(Ar(d),l.g[m].length==0&&(delete l.g[m],l.h--))}}function oi(l,d,m,y){for(var D=0;D<l.length;++D){var M=l[D];if(!M.da&&M.listener==d&&M.capture==!!m&&M.ha==y)return D}return-1}var ai="closure_lm_"+(1e6*Math.random()|0),Is={};function sh(l,d,m,y,D){if(y&&y.once)return or(l,d,m,y,D);if(Array.isArray(d)){for(var M=0;M<d.length;M++)sh(l,d[M],m,y,D);return null}return m=dn(m),l&&l[Dt]?l.K(d,m,u(y)?!!y.capture:!!y,D):li(l,d,m,!1,y,D)}function li(l,d,m,y,D,M){if(!d)throw Error("Invalid event type");var W=u(D)?!!D.capture:!!D,ke=El(l);if(ke||(l[ai]=ke=new Rr(l)),m=ke.add(d,m,y,W,M),m.proxy)return m;if(y=Il(),m.proxy=y,y.src=l,y.listener=m,l.addEventListener)ht||(D=W),D===void 0&&(D=!1),l.addEventListener(d.toString(),y,D);else if(l.attachEvent)l.attachEvent(oh(d.toString()),y);else if(l.addListener&&l.removeListener)l.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Il(){function l(m){return d.call(l.src,l.listener,m)}const d=Oo;return l}function or(l,d,m,y,D){if(Array.isArray(d)){for(var M=0;M<d.length;M++)or(l,d[M],m,y,D);return null}return m=dn(m),l&&l[Dt]?l.L(d,m,u(y)?!!y.capture:!!y,D):li(l,d,m,!0,y,D)}function ci(l,d,m,y,D){if(Array.isArray(d))for(var M=0;M<d.length;M++)ci(l,d[M],m,y,D);else y=u(y)?!!y.capture:!!y,m=dn(m),l&&l[Dt]?(l=l.i,d=String(d).toString(),d in l.g&&(M=l.g[d],m=oi(M,m,y,D),-1<m&&(Ar(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete l.g[d],l.h--)))):l&&(l=El(l))&&(d=l.g[d.toString()],l=-1,d&&(l=oi(d,m,y,D)),(m=-1<l?d[l]:null)&&Do(m))}function Do(l){if(typeof l!="number"&&l&&!l.da){var d=l.src;if(d&&d[Dt])qn(d.i,l);else{var m=l.type,y=l.proxy;d.removeEventListener?d.removeEventListener(m,y,l.capture):d.detachEvent?d.detachEvent(oh(m),y):d.addListener&&d.removeListener&&d.removeListener(y),(m=El(d))?(qn(m,l),m.h==0&&(m.src=null,d[ai]=null)):Ar(l)}}}function oh(l){return l in Is?Is[l]:Is[l]="on"+l}function Oo(l,d){if(l.da)l=!0;else{d=new Nt(d,this);var m=l.listener,y=l.ha||l.src;l.fa&&Do(l),l=m.call(y,d)}return l}function El(l){return l=l[ai],l instanceof Rr?l:null}var Sr="__closure_events_fn_"+(1e9*Math.random()>>>0);function dn(l){return typeof l=="function"?l:(l[Sr]||(l[Sr]=function(d){return l.handleEvent(d)}),l[Sr])}function Qe(){ye.call(this),this.i=new Rr(this),this.M=this,this.F=null}b(Qe,ye),Qe.prototype[Dt]=!0,Qe.prototype.removeEventListener=function(l,d,m,y){ci(this,l,d,m,y)};function Pe(l,d){var m,y=l.F;if(y)for(m=[];y;y=y.F)m.push(y);if(l=l.M,y=d.type||d,typeof d=="string")d=new xe(d,l);else if(d instanceof xe)d.target=d.target||l;else{var D=d;d=new xe(y,l),T(d,D)}if(D=!0,m)for(var M=m.length-1;0<=M;M--){var W=d.g=m[M];D=ui(W,y,!0,d)&&D}if(W=d.g=l,D=ui(W,y,!0,d)&&D,D=ui(W,y,!1,d)&&D,m)for(M=0;M<m.length;M++)W=d.g=m[M],D=ui(W,y,!1,d)&&D}Qe.prototype.N=function(){if(Qe.aa.N.call(this),this.i){var l=this.i,d;for(d in l.g){for(var m=l.g[d],y=0;y<m.length;y++)Ar(m[y]);delete l.g[d],l.h--}}this.F=null},Qe.prototype.K=function(l,d,m,y){return this.i.add(String(l),d,!1,m,y)},Qe.prototype.L=function(l,d,m,y){return this.i.add(String(l),d,!0,m,y)};function ui(l,d,m,y){if(d=l.i.g[String(d)],!d)return!0;d=d.concat();for(var D=!0,M=0;M<d.length;++M){var W=d[M];if(W&&!W.da&&W.capture==m){var ke=W.listener,St=W.ha||W.src;W.fa&&qn(l.i,W),D=ke.call(St,y)!==!1&&D}}return D&&!y.defaultPrevented}function Lo(l,d,m){if(typeof l=="function")m&&(l=p(l,m));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(l,d||0)}function Vo(l){l.g=Lo(()=>{l.g=null,l.i&&(l.i=!1,Vo(l))},l.l);const d=l.h;l.h=null,l.m.apply(null,d)}class br extends ye{constructor(d,m){super(),this.m=d,this.l=m,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Vo(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xr(l){ye.call(this),this.h=l,this.g={}}b(xr,ye);var Tl=[];function Al(l){$(l.g,function(d,m){this.g.hasOwnProperty(m)&&Do(d)},l),l.g={}}xr.prototype.N=function(){xr.aa.N.call(this),Al(this)},xr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mo=a.JSON.stringify,ah=a.JSON.parse,lh=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function fn(){}fn.prototype.h=null;function ch(l){return l.h||(l.h=l.i())}function Rl(){}var hi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Sl(){xe.call(this,"d")}b(Sl,xe);function Es(){xe.call(this,"c")}b(Es,xe);var ar={},uh=null;function Ts(){return uh=uh||new Qe}ar.La="serverreachability";function bl(l){xe.call(this,ar.La,l)}b(bl,xe);function di(l){const d=Ts();Pe(d,new bl(d))}ar.STAT_EVENT="statevent";function xl(l,d){xe.call(this,ar.STAT_EVENT,l),this.stat=d}b(xl,xe);function yt(l){const d=Ts();Pe(d,new xl(d,l))}ar.Ma="timingevent";function Pl(l,d){xe.call(this,ar.Ma,l),this.size=d}b(Pl,xe);function fi(l,d){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},d)}function pi(){this.g=!0}pi.prototype.xa=function(){this.g=!1};function hh(l,d,m,y,D,M){l.info(function(){if(l.g)if(M)for(var W="",ke=M.split("&"),St=0;St<ke.length;St++){var we=ke[St].split("=");if(1<we.length){var Ot=we[0];we=we[1];var Lt=Ot.split("_");W=2<=Lt.length&&Lt[1]=="type"?W+(Ot+"="+we+"&"):W+(Ot+"=redacted&")}}else W=null;else W=M;return"XMLHTTP REQ ("+y+") [attempt "+D+"]: "+d+`
`+m+`
`+W})}function dh(l,d,m,y,D,M,W){l.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+D+"]: "+d+`
`+m+`
`+M+" "+W})}function mi(l,d,m,y){l.info(function(){return"XMLHTTP TEXT ("+d+"): "+Mp(l,m)+(y?" "+y:"")})}function Vp(l,d){l.info(function(){return"TIMEOUT: "+d})}pi.prototype.info=function(){};function Mp(l,d){if(!l.g)return d;if(!d)return null;try{var m=JSON.parse(d);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var y=m[l];if(!(2>y.length)){var D=y[1];if(Array.isArray(D)&&!(1>D.length)){var M=D[0];if(M!="noop"&&M!="stop"&&M!="close")for(var W=1;W<D.length;W++)D[W]=""}}}}return Mo(m)}catch{return d}}var Fo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},kl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},jo;function As(){}b(As,fn),As.prototype.g=function(){return new XMLHttpRequest},As.prototype.i=function(){return{}},jo=new As;function Hn(l,d,m,y){this.j=l,this.i=d,this.l=m,this.R=y||1,this.U=new xr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fh}function fh(){this.i=null,this.g="",this.h=!1}var Rs={},Cl={};function Uo(l,d,m){l.L=1,l.v=Xt(ae(d)),l.m=m,l.P=!0,ph(l,null)}function ph(l,d){l.F=Date.now(),Bo(l),l.A=ae(l.v);var m=l.A,y=l.R;Array.isArray(y)||(y=[String(y)]),aw(m.i,"t",y),l.C=0,m=l.j.J,l.h=new fh,l.g=Rw(l.j,m?d:null,!l.m),0<l.O&&(l.M=new br(p(l.Y,l,l.g),l.O)),d=l.U,m=l.g,y=l.ca;var D="readystatechange";Array.isArray(D)||(D&&(Tl[0]=D.toString()),D=Tl);for(var M=0;M<D.length;M++){var W=sh(m,D[M],y||d.handleEvent,!1,d.h||d);if(!W)break;d.g[W.key]=W}d=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,d)):(l.u="GET",l.g.ea(l.A,l.u,null,d)),di(),hh(l.i,l.u,l.A,l.l,l.R,l.m)}Hn.prototype.ca=function(l){l=l.target;const d=this.M;d&&kr(l)==3?d.j():this.Y(l)},Hn.prototype.Y=function(l){try{if(l==this.g)e:{const Lt=kr(this.g);var d=this.g.Ba();const qo=this.g.Z();if(!(3>Lt)&&(Lt!=3||this.g&&(this.h.h||this.g.oa()||pw(this.g)))){this.J||Lt!=4||d==7||(d==8||0>=qo?di(3):di(2)),Dl(this);var m=this.g.Z();this.X=m;t:if(Nl(this)){var y=pw(this.g);l="";var D=y.length,M=kr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Pr(this),Ss(this);var W="";break t}this.h.i=new a.TextDecoder}for(d=0;d<D;d++)this.h.h=!0,l+=this.h.i.decode(y[d],{stream:!(M&&d==D-1)});y.length=0,this.h.g+=l,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=m==200,dh(this.i,this.u,this.A,this.l,this.R,Lt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var ke,St=this.g;if((ke=St.g?St.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(ke)){var we=ke;break t}}we=null}if(m=we)mi(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ol(this,m);else{this.o=!1,this.s=3,yt(12),Pr(this),Ss(this);break e}}if(this.P){m=!0;let Wn;for(;!this.J&&this.C<W.length;)if(Wn=Fp(this,W),Wn==Cl){Lt==4&&(this.s=4,yt(14),m=!1),mi(this.i,this.l,null,"[Incomplete Response]");break}else if(Wn==Rs){this.s=4,yt(15),mi(this.i,this.l,W,"[Invalid Chunk]"),m=!1;break}else mi(this.i,this.l,Wn,null),Ol(this,Wn);if(Nl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Lt!=4||W.length!=0||this.h.h||(this.s=1,yt(16),m=!1),this.o=this.o&&m,!m)mi(this.i,this.l,W,"[Invalid Chunked Response]"),Pr(this),Ss(this);else if(0<W.length&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.ba&&!Ot.M&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),qp(Ot),Ot.M=!0,yt(11))}}else mi(this.i,this.l,W,null),Ol(this,W);Lt==4&&Pr(this),this.o&&!this.J&&(Lt==4?Iw(this.j,this):(this.o=!1,Bo(this)))}else FP(this.g),m==400&&0<W.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),Pr(this),Ss(this)}}}catch{}finally{}};function Nl(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Fp(l,d){var m=l.C,y=d.indexOf(`
`,m);return y==-1?Cl:(m=Number(d.substring(m,y)),isNaN(m)?Rs:(y+=1,y+m>d.length?Cl:(d=d.slice(y,y+m),l.C=y+m,d)))}Hn.prototype.cancel=function(){this.J=!0,Pr(this)};function Bo(l){l.S=Date.now()+l.I,mh(l,l.I)}function mh(l,d){if(l.B!=null)throw Error("WatchDog timer not null");l.B=fi(p(l.ba,l),d)}function Dl(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Hn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Vp(this.i,this.A),this.L!=2&&(di(),yt(17)),Pr(this),this.s=2,Ss(this)):mh(this,this.S-l)};function Ss(l){l.j.G==0||l.J||Iw(l.j,l)}function Pr(l){Dl(l);var d=l.M;d&&typeof d.ma=="function"&&d.ma(),l.M=null,Al(l.U),l.g&&(d=l.g,l.g=null,d.abort(),d.ma())}function Ol(l,d){try{var m=l.j;if(m.G!=0&&(m.g==l||Ie(m.h,l))){if(!l.K&&Ie(m.h,l)&&m.G==3){try{var y=m.Da.g.parse(d)}catch{y=null}if(Array.isArray(y)&&y.length==3){var D=y;if(D[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)Sh(m),Ah(m);else break e;zp(m),yt(18)}}else m.za=D[1],0<m.za-m.T&&37500>D[2]&&m.F&&m.v==0&&!m.C&&(m.C=fi(p(m.Za,m),6e3));if(1>=_h(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else bs(m,11)}else if((l.K||m.g==l)&&Sh(m),!w(d))for(D=m.Da.g.parse(d),d=0;d<D.length;d++){let we=D[d];if(m.T=we[0],we=we[1],m.G==2)if(we[0]=="c"){m.K=we[1],m.ia=we[2];const Ot=we[3];Ot!=null&&(m.la=Ot,m.j.info("VER="+m.la));const Lt=we[4];Lt!=null&&(m.Aa=Lt,m.j.info("SVER="+m.Aa));const qo=we[5];qo!=null&&typeof qo=="number"&&0<qo&&(y=1.5*qo,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;const Wn=l.g;if(Wn){const xh=Wn.g?Wn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xh){var M=y.h;M.g||xh.indexOf("spdy")==-1&&xh.indexOf("quic")==-1&&xh.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Ll(M,M.h),M.h=null))}if(y.D){const Hp=Wn.g?Wn.g.getResponseHeader("X-HTTP-Session-Id"):null;Hp&&(y.ya=Hp,ve(y.I,y.D,Hp))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var W=l;if(y.qa=Aw(y,y.J?y.ia:null,y.W),W.K){Vl(y.h,W);var ke=W,St=y.L;St&&(ke.I=St),ke.B&&(Dl(ke),Bo(ke)),y.g=W}else vw(y);0<m.i.length&&Rh(m)}else we[0]!="stop"&&we[0]!="close"||bs(m,7);else m.G==3&&(we[0]=="stop"||we[0]=="close"?we[0]=="stop"?bs(m,7):$p(m):we[0]!="noop"&&m.l&&m.l.ta(we),m.v=0)}}di(4)}catch{}}var jp=class{constructor(l,d){this.g=l,this.map=d}};function gh(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function yh(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function _h(l){return l.h?1:l.g?l.g.size:0}function Ie(l,d){return l.h?l.h==d:l.g?l.g.has(d):!1}function Ll(l,d){l.g?l.g.add(d):l.h=d}function Vl(l,d){l.h&&l.h==d?l.h=null:l.g&&l.g.has(d)&&l.g.delete(d)}gh.prototype.cancel=function(){if(this.i=Ml(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ml(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let d=l.i;for(const m of l.g.values())d=d.concat(m.D);return d}return P(l.i)}function vh(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var d=[],m=l.length,y=0;y<m;y++)d.push(l[y]);return d}d=[],m=0;for(y in l)d[m++]=l[y];return d}function I(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var d=[];l=l.length;for(var m=0;m<l;m++)d.push(m);return d}d=[],m=0;for(const y in l)d[m++]=y;return d}}}function F(l,d){if(l.forEach&&typeof l.forEach=="function")l.forEach(d,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,d,void 0);else for(var m=I(l),y=vh(l),D=y.length,M=0;M<D;M++)d.call(void 0,y[M],m&&m[M],l)}var Q=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function re(l,d){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var y=l[m].indexOf("="),D=null;if(0<=y){var M=l[m].substring(0,y);D=l[m].substring(y+1)}else M=l[m];d(M,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function ne(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof ne){this.h=l.h,Oe(this,l.j),this.o=l.o,this.g=l.g,ot(this,l.s),this.l=l.l;var d=l.i,m=new jl;m.i=d.i,d.g&&(m.g=new Map(d.g),m.h=d.h),nt(this,m),this.m=l.m}else l&&(d=String(l).match(Q))?(this.h=!1,Oe(this,d[1]||"",!0),this.o=Gn(d[2]||""),this.g=Gn(d[3]||"",!0),ot(this,d[4]),this.l=Gn(d[5]||"",!0),nt(this,d[6]||"",!0),this.m=Gn(d[7]||"")):(this.h=!1,this.i=new jl(null,this.h))}ne.prototype.toString=function(){var l=[],d=this.j;d&&l.push(Nn(d,gi,!0),":");var m=this.g;return(m||d=="file")&&(l.push("//"),(d=this.o)&&l.push(Nn(d,gi,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(Nn(m,m.charAt(0)=="/"?Up:wh,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",Nn(m,kP)),l.join("")};function ae(l){return new ne(l)}function Oe(l,d,m){l.j=m?Gn(d,!0):d,l.j&&(l.j=l.j.replace(/:$/,""))}function ot(l,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);l.s=d}else l.s=null}function nt(l,d,m){d instanceof jl?(l.i=d,CP(l.i,l.h)):(m||(d=Nn(d,PP)),l.i=new jl(d,l.h))}function ve(l,d,m){l.i.set(d,m)}function Xt(l){return ve(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Gn(l,d){return l?d?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Nn(l,d,m){return typeof l=="string"?(l=encodeURI(l).replace(d,Fl),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Fl(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var gi=/[#\/\?@]/g,wh=/[#\?:]/g,Up=/[#\?]/g,PP=/[#\?@]/g,kP=/#/g;function jl(l,d){this.h=this.g=null,this.i=l||null,this.j=!!d}function yi(l){l.g||(l.g=new Map,l.h=0,l.i&&re(l.i,function(d,m){l.add(decodeURIComponent(d.replace(/\+/g," ")),m)}))}t=jl.prototype,t.add=function(l,d){yi(this),this.i=null,l=$o(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(d),this.h+=1,this};function sw(l,d){yi(l),d=$o(l,d),l.g.has(d)&&(l.i=null,l.h-=l.g.get(d).length,l.g.delete(d))}function ow(l,d){return yi(l),d=$o(l,d),l.g.has(d)}t.forEach=function(l,d){yi(this),this.g.forEach(function(m,y){m.forEach(function(D){l.call(d,D,y,this)},this)},this)},t.na=function(){yi(this);const l=Array.from(this.g.values()),d=Array.from(this.g.keys()),m=[];for(let y=0;y<d.length;y++){const D=l[y];for(let M=0;M<D.length;M++)m.push(d[y])}return m},t.V=function(l){yi(this);let d=[];if(typeof l=="string")ow(this,l)&&(d=d.concat(this.g.get($o(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)d=d.concat(l[m])}return d},t.set=function(l,d){return yi(this),this.i=null,l=$o(this,l),ow(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[d]),this.h+=1,this},t.get=function(l,d){return l?(l=this.V(l),0<l.length?String(l[0]):d):d};function aw(l,d,m){sw(l,d),0<m.length&&(l.i=null,l.g.set($o(l,d),P(m)),l.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],d=Array.from(this.g.keys());for(var m=0;m<d.length;m++){var y=d[m];const M=encodeURIComponent(String(y)),W=this.V(y);for(y=0;y<W.length;y++){var D=M;W[y]!==""&&(D+="="+encodeURIComponent(String(W[y]))),l.push(D)}}return this.i=l.join("&")};function $o(l,d){return d=String(d),l.j&&(d=d.toLowerCase()),d}function CP(l,d){d&&!l.j&&(yi(l),l.i=null,l.g.forEach(function(m,y){var D=y.toLowerCase();y!=D&&(sw(this,y),aw(this,D,m))},l)),l.j=d}function NP(l,d){const m=new pi;if(a.Image){const y=new Image;y.onload=v(_i,m,"TestLoadImage: loaded",!0,d,y),y.onerror=v(_i,m,"TestLoadImage: error",!1,d,y),y.onabort=v(_i,m,"TestLoadImage: abort",!1,d,y),y.ontimeout=v(_i,m,"TestLoadImage: timeout",!1,d,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=l}else d(!1)}function DP(l,d){const m=new pi,y=new AbortController,D=setTimeout(()=>{y.abort(),_i(m,"TestPingServer: timeout",!1,d)},1e4);fetch(l,{signal:y.signal}).then(M=>{clearTimeout(D),M.ok?_i(m,"TestPingServer: ok",!0,d):_i(m,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),_i(m,"TestPingServer: error",!1,d)})}function _i(l,d,m,y,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),y(m)}catch{}}function OP(){this.g=new lh}function LP(l,d,m){const y=m||"";try{F(l,function(D,M){let W=D;u(D)&&(W=Mo(D)),d.push(y+M+"="+encodeURIComponent(W))})}catch(D){throw d.push(y+"type="+encodeURIComponent("_badmap")),D}}function Ih(l){this.l=l.Ub||null,this.j=l.eb||!1}b(Ih,fn),Ih.prototype.g=function(){return new Eh(this.l,this.j)},Ih.prototype.i=function(l){return function(){return l}}({});function Eh(l,d){Qe.call(this),this.D=l,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(Eh,Qe),t=Eh.prototype,t.open=function(l,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=d,this.readyState=1,Bl(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(d.body=l),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ul(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Bl(this)),this.g&&(this.readyState=3,Bl(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;lw(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function lw(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var d=l.value?l.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!l.done}))&&(this.response=this.responseText+=d)}l.done?Ul(this):Bl(this),this.readyState==3&&lw(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Ul(this))},t.Qa=function(l){this.g&&(this.response=l,Ul(this))},t.ga=function(){this.g&&Ul(this)};function Ul(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Bl(l)}t.setRequestHeader=function(l,d){this.u.append(l,d)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],d=this.h.entries();for(var m=d.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=d.next();return l.join(`\r
`)};function Bl(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Eh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function cw(l){let d="";return $(l,function(m,y){d+=y,d+=":",d+=m,d+=`\r
`}),d}function Bp(l,d,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=cw(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):ve(l,d,m))}function Ye(l){Qe.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Ye,Qe);var VP=/^https?$/i,MP=["POST","PUT"];t=Ye.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,d,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);d=d?d.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jo.g(),this.v=this.o?ch(this.o):ch(jo),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(d,String(l),!0),this.B=!1}catch(M){uw(this,M);return}if(l=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var D in y)m.set(D,y[D]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const M of y.keys())m.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),D=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(MP,d,void 0))||y||D||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,W]of m)this.g.setRequestHeader(M,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{fw(this),this.u=!0,this.g.send(l),this.u=!1}catch(M){uw(this,M)}};function uw(l,d){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=d,l.m=5,hw(l),Th(l)}function hw(l){l.A||(l.A=!0,Pe(l,"complete"),Pe(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Pe(this,"complete"),Pe(this,"abort"),Th(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Th(this,!0)),Ye.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?dw(this):this.bb())},t.bb=function(){dw(this)};function dw(l){if(l.h&&typeof o<"u"&&(!l.v[1]||kr(l)!=4||l.Z()!=2)){if(l.u&&kr(l)==4)Lo(l.Ea,0,l);else if(Pe(l,"readystatechange"),kr(l)==4){l.h=!1;try{const W=l.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var m;if(!(m=d)){var y;if(y=W===0){var D=String(l.D).match(Q)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),y=!VP.test(D?D.toLowerCase():"")}m=y}if(m)Pe(l,"complete"),Pe(l,"success");else{l.m=6;try{var M=2<kr(l)?l.g.statusText:""}catch{M=""}l.l=M+" ["+l.Z()+"]",hw(l)}}finally{Th(l)}}}}function Th(l,d){if(l.g){fw(l);const m=l.g,y=l.v[0]?()=>{}:null;l.g=null,l.v=null,d||Pe(l,"ready");try{m.onreadystatechange=y}catch{}}}function fw(l){l.I&&(a.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function kr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<kr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var d=this.g.responseText;return l&&d.indexOf(l)==0&&(d=d.substring(l.length)),ah(d)}};function pw(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function FP(l){const d={};l=(l.g&&2<=kr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<l.length;y++){if(w(l[y]))continue;var m=k(l[y]);const D=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=d[D]||[];d[D]=M,M.push(m)}A(d,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $l(l,d,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||d}function mw(l){this.Aa=0,this.i=[],this.j=new pi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$l("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$l("baseRetryDelayMs",5e3,l),this.cb=$l("retryDelaySeedMs",1e4,l),this.Wa=$l("forwardChannelMaxRetries",2,l),this.wa=$l("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new gh(l&&l.concurrentRequestLimit),this.Da=new OP,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=mw.prototype,t.la=8,t.G=1,t.connect=function(l,d,m,y){yt(0),this.W=l,this.H=d||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=Aw(this,null,this.W),Rh(this)};function $p(l){if(gw(l),l.G==3){var d=l.U++,m=ae(l.I);if(ve(m,"SID",l.K),ve(m,"RID",d),ve(m,"TYPE","terminate"),zl(l,m),d=new Hn(l,l.j,d),d.L=2,d.v=Xt(ae(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=d.v,m=!0),m||(d.g=Rw(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Bo(d)}Tw(l)}function Ah(l){l.g&&(qp(l),l.g.cancel(),l.g=null)}function gw(l){Ah(l),l.u&&(a.clearTimeout(l.u),l.u=null),Sh(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function Rh(l){if(!yh(l.h)&&!l.s){l.s=!0;var d=l.Ga;kn||oe(),K||(kn(),K=!0),te.add(d,l),l.B=0}}function jP(l,d){return _h(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=d.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=fi(p(l.Ga,l,d),Ew(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const D=new Hn(this,this.j,l);let M=this.o;if(this.S&&(M?(M=_(M),T(M,this.S)):M=this.S),this.m!==null||this.O||(D.H=M,M=null),this.P)e:{for(var d=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(d+=y,4096<d){d=m;break e}if(d===4096||m===this.i.length-1){d=m+1;break e}}d=1e3}else d=1e3;d=_w(this,D,d),m=ae(this.I),ve(m,"RID",l),ve(m,"CVER",22),this.D&&ve(m,"X-HTTP-Session-Id",this.D),zl(this,m),M&&(this.O?d="headers="+encodeURIComponent(String(cw(M)))+"&"+d:this.m&&Bp(m,this.m,M)),Ll(this.h,D),this.Ua&&ve(m,"TYPE","init"),this.P?(ve(m,"$req",d),ve(m,"SID","null"),D.T=!0,Uo(D,m,null)):Uo(D,m,d),this.G=2}}else this.G==3&&(l?yw(this,l):this.i.length==0||yh(this.h)||yw(this))};function yw(l,d){var m;d?m=d.l:m=l.U++;const y=ae(l.I);ve(y,"SID",l.K),ve(y,"RID",m),ve(y,"AID",l.T),zl(l,y),l.m&&l.o&&Bp(y,l.m,l.o),m=new Hn(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),d&&(l.i=d.D.concat(l.i)),d=_w(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Ll(l.h,m),Uo(m,y,d)}function zl(l,d){l.H&&$(l.H,function(m,y){ve(d,y,m)}),l.l&&F({},function(m,y){ve(d,y,m)})}function _w(l,d,m){m=Math.min(l.i.length,m);var y=l.l?p(l.l.Na,l.l,l):null;e:{var D=l.i;let M=-1;for(;;){const W=["count="+m];M==-1?0<m?(M=D[0].g,W.push("ofs="+M)):M=0:W.push("ofs="+M);let ke=!0;for(let St=0;St<m;St++){let we=D[St].g;const Ot=D[St].map;if(we-=M,0>we)M=Math.max(0,D[St].g-100),ke=!1;else try{LP(Ot,W,"req"+we+"_")}catch{y&&y(Ot)}}if(ke){y=W.join("&");break e}}}return l=l.i.splice(0,m),d.D=l,y}function vw(l){if(!l.g&&!l.u){l.Y=1;var d=l.Fa;kn||oe(),K||(kn(),K=!0),te.add(d,l),l.v=0}}function zp(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=fi(p(l.Fa,l),Ew(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,ww(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=fi(p(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),Ah(this),ww(this))};function qp(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function ww(l){l.g=new Hn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var d=ae(l.qa);ve(d,"RID","rpc"),ve(d,"SID",l.K),ve(d,"AID",l.T),ve(d,"CI",l.F?"0":"1"),!l.F&&l.ja&&ve(d,"TO",l.ja),ve(d,"TYPE","xmlhttp"),zl(l,d),l.m&&l.o&&Bp(d,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=Xt(ae(d)),m.m=null,m.P=!0,ph(m,l)}t.Za=function(){this.C!=null&&(this.C=null,Ah(this),zp(this),yt(19))};function Sh(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Iw(l,d){var m=null;if(l.g==d){Sh(l),qp(l),l.g=null;var y=2}else if(Ie(l.h,d))m=d.D,Vl(l.h,d),y=1;else return;if(l.G!=0){if(d.o)if(y==1){m=d.m?d.m.length:0,d=Date.now()-d.F;var D=l.B;y=Ts(),Pe(y,new Pl(y,m)),Rh(l)}else vw(l);else if(D=d.s,D==3||D==0&&0<d.X||!(y==1&&jP(l,d)||y==2&&zp(l)))switch(m&&0<m.length&&(d=l.h,d.i=d.i.concat(m)),D){case 1:bs(l,5);break;case 4:bs(l,10);break;case 3:bs(l,6);break;default:bs(l,2)}}}function Ew(l,d){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*d}function bs(l,d){if(l.j.info("Error code "+d),d==2){var m=p(l.fb,l),y=l.Xa;const D=!y;y=new ne(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Oe(y,"https"),Xt(y),D?NP(y.toString(),m):DP(y.toString(),m)}else yt(2);l.G=0,l.l&&l.l.sa(d),Tw(l),gw(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function Tw(l){if(l.G=0,l.ka=[],l.l){const d=Ml(l.h);(d.length!=0||l.i.length!=0)&&(C(l.ka,d),C(l.ka,l.i),l.h.i.length=0,P(l.i),l.i.length=0),l.l.ra()}}function Aw(l,d,m){var y=m instanceof ne?ae(m):new ne(m);if(y.g!="")d&&(y.g=d+"."+y.g),ot(y,y.s);else{var D=a.location;y=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;var M=new ne(null);y&&Oe(M,y),d&&(M.g=d),D&&ot(M,D),m&&(M.l=m),y=M}return m=l.D,d=l.ya,m&&d&&ve(y,m,d),ve(y,"VER",l.la),zl(l,y),y}function Rw(l,d,m){if(d&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=l.Ca&&!l.pa?new Ye(new Ih({eb:m})):new Ye(l.pa),d.Ha(l.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sw(){}t=Sw.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function bh(){}bh.prototype.g=function(l,d){return new pn(l,d)};function pn(l,d){Qe.call(this),this.g=new mw(d),this.l=l,this.h=d&&d.messageUrlParams||null,l=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(l?l["X-WebChannel-Content-Type"]=d.messageContentType:l={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(l?l["X-WebChannel-Client-Profile"]=d.va:l={"X-WebChannel-Client-Profile":d.va}),this.g.S=l,(l=d&&d.Sb)&&!w(l)&&(this.g.m=l),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!w(d)&&(this.g.D=d,l=this.h,l!==null&&d in l&&(l=this.h,d in l&&delete l[d])),this.j=new zo(this)}b(pn,Qe),pn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pn.prototype.close=function(){$p(this.g)},pn.prototype.o=function(l){var d=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=Mo(l),l=m);d.i.push(new jp(d.Ya++,l)),d.G==3&&Rh(d)},pn.prototype.N=function(){this.g.l=null,delete this.j,$p(this.g),delete this.g,pn.aa.N.call(this)};function bw(l){Sl.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var d=l.__sm__;if(d){e:{for(const m in d){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,d=d!==null&&l in d?d[l]:void 0),this.data=d}else this.data=l}b(bw,Sl);function xw(){Es.call(this),this.status=1}b(xw,Es);function zo(l){this.g=l}b(zo,Sw),zo.prototype.ua=function(){Pe(this.g,"a")},zo.prototype.ta=function(l){Pe(this.g,new bw(l))},zo.prototype.sa=function(l){Pe(this.g,new xw)},zo.prototype.ra=function(){Pe(this.g,"b")},bh.prototype.createWebChannel=bh.prototype.g,pn.prototype.send=pn.prototype.o,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,TS=function(){return new bh},ES=function(){return Ts()},IS=ar,Qg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fo.NO_ERROR=0,Fo.TIMEOUT=8,Fo.HTTP_ERROR=6,Td=Fo,kl.COMPLETE="complete",wS=kl,Rl.EventType=hi,hi.OPEN="a",hi.CLOSE="b",hi.ERROR="c",hi.MESSAGE="d",Qe.prototype.listen=Qe.prototype.K,fc=Rl,Ye.prototype.listenOnce=Ye.prototype.L,Ye.prototype.getLastError=Ye.prototype.Ka,Ye.prototype.getLastErrorCode=Ye.prototype.Ba,Ye.prototype.getStatus=Ye.prototype.Z,Ye.prototype.getResponseJson=Ye.prototype.Oa,Ye.prototype.getResponseText=Ye.prototype.oa,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Ha,vS=Ye}).apply(typeof Yh<"u"?Yh:typeof self<"u"?self:typeof window<"u"?window:{});const qI="@firebase/firestore",HI="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wt.UNAUTHENTICATED=new wt(null),wt.GOOGLE_CREDENTIALS=new wt("google-credentials-uid"),wt.FIRST_PARTY=new wt("first-party-uid"),wt.MOCK_USER=new wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ul="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is=new Ou("@firebase/firestore");function ea(){return is.logLevel}function w5(t){is.setLogLevel(t)}function U(t,...e){if(is.logLevel<=pe.DEBUG){const n=e.map(W_);is.debug(`Firestore (${ul}): ${t}`,...n)}}function it(t,...e){if(is.logLevel<=pe.ERROR){const n=e.map(W_);is.error(`Firestore (${ul}): ${t}`,...n)}}function zn(t,...e){if(is.logLevel<=pe.WARN){const n=e.map(W_);is.warn(`Firestore (${ul}): ${t}`,...n)}}function W_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,AS(t,r,n)}function AS(t,e,n){let r=`FIRESTORE (${ul}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw it(r),new Error(r)}function Z(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||AS(e,i,r)}function I5(t,e){t||Y(57014,e)}function G(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends Pn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class c4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(wt.UNAUTHENTICATED))}shutdown(){}}class u4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class h4{constructor(e){this.t=e,this.currentUser=wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Z(this.o===void 0,42304);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new Tt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Tt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Tt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Z(typeof r.accessToken=="string",31837,{l:r}),new RS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string",2055,{h:e}),new wt(e)}}class d4{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=wt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class f4{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new d4(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Yg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class p4{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Me(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Z(this.o===void 0,3512);const r=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Yg(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Z(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Yg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class E5{getToken(){return Promise.resolve(new Yg(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=m4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function se(t,e){return t<e?-1:t>e?1:0}function Jg(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Lm(i)===Lm(s)?se(i,s):Lm(i)?1:-1}return se(t.length,e.length)}const g4=55296,y4=57343;function Lm(t){const e=t.charCodeAt(0);return e>=g4&&e<=y4}function Ma(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function SS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="__name__";class ur{constructor(e,n,r){n===void 0?n=0:n>e.length&&Y(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Y(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ur.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ur?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=ur.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return se(e.length,n.length)}static compareSegments(e,n){const r=ur.isNumericId(e),i=ur.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?ur.extractNumericId(e).compare(ur.extractNumericId(n)):Jg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return es.fromString(e.substring(4,e.length-2))}}class ue extends ur{construct(e,n,r){return new ue(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new j(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ue(n)}static emptyPath(){return new ue([])}}const _4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ze extends ur{construct(e,n,r){return new ze(e,n,r)}static isValidIdentifier(e){return _4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ze.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Xg}static keyField(){return new ze([Xg])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new j(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new j(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new j(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new j(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ze(n)}static emptyPath(){return new ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.path=e}static fromPath(e){return new H(ue.fromString(e))}static fromName(e){return new H(ue.fromString(e).popFirst(5))}static empty(){return new H(ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new H(new ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t,e,n){if(!n)throw new j(L.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function v4(t,e,n,r){if(e===!0&&r===!0)throw new j(L.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function GI(t){if(!H.isDocumentKey(t))throw new j(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function WI(t){if(H.isDocumentKey(t))throw new j(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function op(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Y(12329,{type:typeof t})}function de(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new j(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=op(t);throw new j(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function xS(t,e){if(e<=0)throw new j(L.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(t,e){const n={typeString:t};return e&&(n.value=e),n}function bo(t,e){if(!bS(t))throw new j(L.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new j(L.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI=-62135596800,QI=1e6;class Ee{static now(){return Ee.fromMillis(Date.now())}static fromDate(e){return Ee.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*QI);return new Ee(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new j(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new j(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<KI)throw new j(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/QI}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ee._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(bo(e,Ee._jsonSchema))return new Ee(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-KI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ee._jsonSchemaVersion="firestore/timestamp/1.0",Ee._jsonSchema={type:ut("string",Ee._jsonSchemaVersion),seconds:ut("number"),nanoseconds:ut("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{static fromTimestamp(e){return new ee(e)}static min(){return new ee(new Ee(0,0))}static max(){return new ee(new Ee(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa=-1;class ja{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Zg(t){return t.fields.find(e=>e.kind===2)}function Ds(t){return t.fields.filter(e=>e.kind!==2)}function w4(t,e){let n=se(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=I4(t.fields[r],e.fields[r]),n!==0)return n;return se(t.fields.length,e.fields.length)}ja.UNKNOWN_ID=-1;class Js{constructor(e,n){this.fieldPath=e,this.kind=n}}function I4(t,e){const n=ze.comparator(t.fieldPath,e.fieldPath);return n!==0?n:se(t.kind,e.kind)}class Ua{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ua(0,Sn.min())}}function PS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ee.fromTimestamp(r===1e9?new Ee(n+1,0):new Ee(n,r));return new Sn(i,H.empty(),e)}function kS(t){return new Sn(t.readTime,t.key,Fa)}class Sn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Sn(ee.min(),H.empty(),Fa)}static max(){return new Sn(ee.max(),H.empty(),Fa)}}function Y_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=H.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ps(t){if(t.code!==L.FAILED_PRECONDITION||t.message!==CS)throw t;U("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Y(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(i=>i?O.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new O((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const u=c;n(e[u]).next(h=>{o[u]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new O((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn="SimpleDb";class ap{static open(e,n,r,i){try{return new ap(n,e.transaction(i,r))}catch(s){throw new Nc(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Tt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new Nc(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=J_(r.target.error);this.S.reject(new Nc(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(U(gn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new T4(n)}}class vr{static delete(e){return U(gn,"Removing database:",e),Ms(O1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!v_())return!1;if(vr.F())return!0;const e=pt(),n=vr.M(e),r=0<n&&n<10,i=DS(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,vr.M(pt())===12.2&&it("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(U(gn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Nc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new j(L.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new j(L.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Nc(e,o))},i.onupgradeneeded=s=>{U(gn,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{U(gn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=ap.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),O.reject(u))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){const c=a,u=c.name!=="FirebaseError"&&o<3;if(U(gn,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function DS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class E4{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ms(this.U.delete())}}class Nc extends j{constructor(e,n){super(L.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ms(t){return t.name==="IndexedDbTransactionError"}class T4{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(U(gn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(U(gn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ms(r)}add(e){return U(gn,"ADD",this.store.name,e,e),Ms(this.store.add(e))}get(e){return Ms(this.store.get(e)).next(n=>(n===void 0&&(n=null),U(gn,"GET",this.store.name,e,n),n))}delete(e){return U(gn,"DELETE",this.store.name,e),Ms(this.store.delete(e))}count(){return U(gn,"COUNT",this.store.name),Ms(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new O((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,c)=>{o.push(c)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new O((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){U(gn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new O((r,i)=>{n.onerror=s=>{const o=J_(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new O((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const c=new E4(a),u=n(a.primaryKey,a.value,c);if(u instanceof O){const h=u.catch(f=>(c.done(),O.reject(f)));r.push(h)}c.isDone?i():c.G===null?a.continue():a.continue(c.G)}}).next(()=>O.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ms(t){return new O((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=J_(r.target.error);n(i)}})}let YI=!1;function J_(t){const e=vr.M(pt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new j("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return YI||(YI=!0,setTimeout(()=>{throw r},0)),r}}return t}const Dc="IndexBackfiller";class A4{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){U(Dc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();U(Dc,`Documents written: ${n}`)}catch(n){ms(n)?U(Dc,"Ignoring IndexedDB error during index backfill: ",n):await ps(n)}await this.re(6e4)})}}class R4{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return O.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return U(Dc,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(U(Dc,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=kS(s);Y_(o,r)>0&&(r=o)}),new Sn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}rn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=-1;function zu(t){return t==null}function du(t){return t===0&&1/t==-1/0}function OS(t){return typeof t=="number"&&Number.isInteger(t)&&!du(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf="";function $t(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=JI(e)),e=S4(t.get(n),e);return JI(e)}function S4(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case gf:n+="";break;default:n+=s}}return n}function JI(t){return t+gf+""}function pr(t){const e=t.length;if(Z(e>=2,64408,{path:t}),e===2)return Z(t.charAt(0)===gf&&t.charAt(1)==="",56145,{path:t}),ue.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(gf,s);switch((o<0||o>n)&&Y(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:Y(61167,{path:t})}s=o+2}return new ue(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os="remoteDocuments",qu="owner",Wo="owner",fu="mutationQueues",b4="userId",Xn="mutations",XI="batchId",Ws="userMutationsIndex",ZI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t,e){return[t,$t(e)]}function LS(t,e,n){return[t,$t(e),n]}const x4={},Ba="documentMutations",yf="remoteDocumentsV14",P4=["prefixPath","collectionGroup","readTime","documentId"],Rd="documentKeyIndex",k4=["prefixPath","collectionGroup","documentId"],VS="collectionGroupIndex",C4=["collectionGroup","readTime","prefixPath","documentId"],pu="remoteDocumentGlobal",ey="remoteDocumentGlobalKey",$a="targets",MS="queryTargetsIndex",N4=["canonicalId","targetId"],za="targetDocuments",D4=["targetId","path"],X_="documentTargetsIndex",O4=["path","targetId"],_f="targetGlobalKey",Xs="targetGlobal",mu="collectionParents",L4=["collectionId","parent"],qa="clientMetadata",V4="clientId",lp="bundles",M4="bundleId",cp="namedQueries",F4="name",Z_="indexConfiguration",j4="indexId",ty="collectionGroupIndex",U4="collectionGroup",Oc="indexState",B4=["indexId","uid"],FS="sequenceNumberIndex",$4=["uid","sequenceNumber"],Lc="indexEntries",z4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],jS="documentKeyIndex",q4=["indexId","uid","orderedDocumentKey"],up="documentOverlays",H4=["userId","collectionPath","documentId"],ny="collectionPathOverlayIndex",G4=["userId","collectionPath","largestBatchId"],US="collectionGroupOverlayIndex",W4=["userId","collectionGroup","largestBatchId"],ev="globals",K4="name",BS=[fu,Xn,Ba,Os,$a,qu,Xs,za,qa,pu,mu,lp,cp],Q4=[...BS,up],$S=[fu,Xn,Ba,yf,$a,qu,Xs,za,qa,pu,mu,lp,cp,up],zS=$S,tv=[...zS,Z_,Oc,Lc],Y4=tv,qS=[...tv,ev],J4=qS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry extends NS{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function gt(t,e){const n=G(t);return vr.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function HS(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function GS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e,n){this.comparator=e,this.root=n||xt.EMPTY}insert(e,n){return new De(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,xt.BLACK,null,null))}remove(e){return new De(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jh(this.root,e,this.comparator,!0)}}class Jh{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??xt.RED,this.left=i??xt.EMPTY,this.right=s??xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new xt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return xt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Y(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Y(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Y(27949);return e+(this.isRed()?0:1)}}xt.EMPTY=null,xt.RED=!0,xt.BLACK=!1;xt.EMPTY=new class{constructor(){this.size=0}get key(){throw Y(57766)}get value(){throw Y(16141)}get color(){throw Y(16727)}get left(){throw Y(29726)}get right(){throw Y(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new xt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.comparator=e,this.data=new De(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new tE(this.data.getIterator())}getIteratorFrom(e){return new tE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Re(this.comparator);return n.data=e,n}}class tE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ko(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new sn([])}unionWith(e){let n=new Re(ze.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new sn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ma(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A5(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new WS("Invalid base64 string: "+s):s}}(e);return new Xe(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Xe(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xe.EMPTY_BYTE_STRING=new Xe("");const X4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qr(t){if(Z(!!t,39018),typeof t=="string"){let e=0;const n=X4.exec(t);if(Z(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Be(t.seconds),nanos:Be(t.nanos)}}function Be(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Yr(t){return typeof t=="string"?Xe.fromBase64String(t):Xe.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS="server_timestamp",QS="__type__",YS="__previous_value__",JS="__local_write_time__";function hp(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[QS])==null?void 0:r.stringValue)===KS}function dp(t){const e=t.mapValue.fields[YS];return hp(e)?dp(e):e}function gu(t){const e=Qr(t.mapValue.fields[JS].timestampValue);return new Ee(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,n,r,i,s,o,a,c,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const yu="(default)";class co{constructor(e,n){this.projectId=e,this.database=n||yu}static empty(){return new co("","")}get isDefaultDatabase(){return this.database===yu}isEqual(e){return e instanceof co&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nv="__type__",XS="__max__",Ui={mapValue:{fields:{__type__:{stringValue:XS}}}},rv="__vector__",Ha="value",Sd={nullValue:"NULL_VALUE"};function ss(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?hp(t)?4:ZS(t)?9007199254740991:fp(t)?10:11:Y(28295,{value:t})}function Tr(t,e){if(t===e)return!0;const n=ss(t);if(n!==ss(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gu(t).isEqual(gu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Qr(i.timestampValue),a=Qr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Yr(i.bytesValue).isEqual(Yr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Be(i.geoPointValue.latitude)===Be(s.geoPointValue.latitude)&&Be(i.geoPointValue.longitude)===Be(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Be(i.integerValue)===Be(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Be(i.doubleValue),a=Be(s.doubleValue);return o===a?du(o)===du(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ma(t.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(eE(o)!==eE(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Tr(o[c],a[c])))return!1;return!0}(t,e);default:return Y(52216,{left:t})}}function _u(t,e){return(t.values||[]).find(n=>Tr(n,e))!==void 0}function os(t,e){if(t===e)return 0;const n=ss(t),r=ss(e);if(n!==r)return se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Be(s.integerValue||s.doubleValue),c=Be(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return nE(t.timestampValue,e.timestampValue);case 4:return nE(gu(t),gu(e));case 5:return Jg(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Yr(s),c=Yr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const h=se(a[u],c[u]);if(h!==0)return h}return se(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=se(Be(s.latitude),Be(o.latitude));return a!==0?a:se(Be(s.longitude),Be(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return rE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var p,v,b,P;const a=s.fields||{},c=o.fields||{},u=(p=a[Ha])==null?void 0:p.arrayValue,h=(v=c[Ha])==null?void 0:v.arrayValue,f=se(((b=u==null?void 0:u.values)==null?void 0:b.length)||0,((P=h==null?void 0:h.values)==null?void 0:P.length)||0);return f!==0?f:rE(u,h)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ui.mapValue&&o===Ui.mapValue)return 0;if(s===Ui.mapValue)return 1;if(o===Ui.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const p=Jg(c[f],h[f]);if(p!==0)return p;const v=os(a[c[f]],u[h[f]]);if(v!==0)return v}return se(c.length,h.length)}(t.mapValue,e.mapValue);default:throw Y(23264,{he:n})}}function nE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);const n=Qr(t),r=Qr(e),i=se(n.seconds,r.seconds);return i!==0?i:se(n.nanos,r.nanos)}function rE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=os(n[i],r[i]);if(s)return s}return se(n.length,r.length)}function Ga(t){return iy(t)}function iy(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Qr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Yr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return H.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=iy(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${iy(n.fields[o])}`;return i+"}"}(t.mapValue):Y(61005,{value:t})}function bd(t){switch(ss(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dp(t);return e?16+bd(e):16;case 5:return 2*t.stringValue.length;case 6:return Yr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+bd(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return gs(r.fields,(s,o)=>{i+=s.length+bd(o)}),i}(t.mapValue);default:throw Y(13486,{value:t})}}function uo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function sy(t){return!!t&&"integerValue"in t}function vu(t){return!!t&&"arrayValue"in t}function iE(t){return!!t&&"nullValue"in t}function sE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xd(t){return!!t&&"mapValue"in t}function fp(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[nv])==null?void 0:r.stringValue)===rv}function Vc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return gs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Vc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Vc(t.arrayValue.values[n]);return e}return{...t}}function ZS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===XS}const eb={mapValue:{fields:{[nv]:{stringValue:rv},[Ha]:{arrayValue:{}}}}};function eF(t){return"nullValue"in t?Sd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?uo(co.empty(),H.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?fp(t)?eb:{mapValue:{}}:Y(35942,{value:t})}function tF(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?uo(co.empty(),H.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?eb:"mapValue"in t?fp(t)?{mapValue:{}}:Ui:Y(61959,{value:t})}function oE(t,e){const n=os(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function aE(t,e){const n=os(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.value=e}static empty(){return new Pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!xd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vc(n)}setAll(e){let n=ze.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Vc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());xd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Tr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];xd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){gs(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Pt(Vc(this.value))}}function tb(t){const e=[];return gs(t.fields,(n,r)=>{const i=new ze([n]);if(xd(r)){const s=tb(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new sn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ve(e,0,ee.min(),ee.min(),ee.min(),Pt.empty(),0)}static newFoundDocument(e,n,r,i){return new Ve(e,1,n,ee.min(),r,i,0)}static newNoDocument(e,n){return new Ve(e,2,n,ee.min(),ee.min(),Pt.empty(),0)}static newUnknownDocument(e,n){return new Ve(e,3,n,ee.min(),ee.min(),Pt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ve&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ve(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n){this.position=e,this.inclusive=n}}function lE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=H.comparator(H.fromName(o.referenceValue),n.key):r=os(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function cE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Tr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n="asc"){this.field=e,this.dir=n}}function nF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{}class me extends nb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new rF(e,n,r):n==="array-contains"?new oF(e,r):n==="in"?new lb(e,r):n==="not-in"?new aF(e,r):n==="array-contains-any"?new lF(e,r):new me(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new iF(e,r):new sF(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(os(n,this.value)):n!==null&&ss(this.value)===ss(n)&&this.matchesComparison(os(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Te extends nb{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Te(e,n)}matches(e){return Wa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Wa(t){return t.op==="and"}function oy(t){return t.op==="or"}function iv(t){return rb(t)&&Wa(t)}function rb(t){for(const e of t.filters)if(e instanceof Te)return!1;return!0}function ay(t){if(t instanceof me)return t.field.canonicalString()+t.op.toString()+Ga(t.value);if(iv(t))return t.filters.map(e=>ay(e)).join(",");{const e=t.filters.map(n=>ay(n)).join(",");return`${t.op}(${e})`}}function ib(t,e){return t instanceof me?function(r,i){return i instanceof me&&r.op===i.op&&r.field.isEqual(i.field)&&Tr(r.value,i.value)}(t,e):t instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&ib(o,i.filters[a]),!0):!1}(t,e):void Y(19439)}function sb(t,e){const n=t.filters.concat(e);return Te.create(n,t.op)}function ob(t){return t instanceof me?function(n){return`${n.field.canonicalString()} ${n.op} ${Ga(n.value)}`}(t):t instanceof Te?function(n){return n.op.toString()+" {"+n.getFilters().map(ob).join(" ,")+"}"}(t):"Filter"}class rF extends me{constructor(e,n,r){super(e,n,r),this.key=H.fromName(r.referenceValue)}matches(e){const n=H.comparator(e.key,this.key);return this.matchesComparison(n)}}class iF extends me{constructor(e,n){super(e,"in",n),this.keys=ab("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class sF extends me{constructor(e,n){super(e,"not-in",n),this.keys=ab("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function ab(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>H.fromName(r.referenceValue))}class oF extends me{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return vu(n)&&_u(n.arrayValue,this.value)}}class lb extends me{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&_u(this.value.arrayValue,n)}}class aF extends me{constructor(e,n){super(e,"not-in",n)}matches(e){if(_u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!_u(this.value.arrayValue,n)}}class lF extends me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!vu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>_u(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function ly(t,e=null,n=[],r=[],i=null,s=null,o=null){return new cF(t,e,n,r,i,s,o)}function ho(t){const e=G(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ay(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),zu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ga(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ga(r)).join(",")),e.Te=n}return e.Te}function Hu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!nF(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ib(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!cE(t.startAt,e.startAt)&&cE(t.endAt,e.endAt)}function vf(t){return H.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function wf(t,e){return t.filters.filter(n=>n instanceof me&&n.field.isEqual(e))}function uE(t,e,n){let r=Sd,i=!0;for(const s of wf(t,e)){let o=Sd,a=!0;switch(s.op){case"<":case"<=":o=eF(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Sd}oE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];oE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function hE(t,e,n){let r=Ui,i=!0;for(const s of wf(t,e)){let o=Ui,a=!0;switch(s.op){case">=":case">":o=tF(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ui}aE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];aE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function cb(t,e,n,r,i,s,o,a){return new ni(t,e,n,r,i,s,o,a)}function hl(t){return new ni(t)}function dE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function sv(t){return t.collectionGroup!==null}function ba(t){const e=G(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Re(ze.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new wu(s,r))}),n.has(ze.keyField().canonicalString())||e.Ie.push(new wu(ze.keyField(),r))}return e.Ie}function zt(t){const e=G(t);return e.Ee||(e.Ee=hb(e,ba(t))),e.Ee}function ub(t){const e=G(t);return e.de||(e.de=hb(e,t.explicitOrderBy)),e.de}function hb(t,e){if(t.limitType==="F")return ly(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new wu(i.field,s)});const n=t.endAt?new as(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new as(t.startAt.position,t.startAt.inclusive):null;return ly(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function cy(t,e){const n=t.filters.concat([e]);return new ni(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function If(t,e,n){return new ni(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gu(t,e){return Hu(zt(t),zt(e))&&t.limitType===e.limitType}function db(t){return`${ho(zt(t))}|lt:${t.limitType}`}function ta(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>ob(i)).join(", ")}]`),zu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ga(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ga(i)).join(",")),`Target(${r})`}(zt(t))}; limitType=${t.limitType})`}function Wu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):H.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of ba(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){const u=lE(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,ba(r),i)||r.endAt&&!function(o,a,c){const u=lE(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,ba(r),i))}(t,e)}function fb(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function pb(t){return(e,n)=>{let r=!1;for(const i of ba(t)){const s=uF(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function uF(t,e,n){const r=t.field.isKeyField()?H.comparator(e.key,n.key):function(s,o,a){const c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?os(c,u):Y(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Y(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){gs(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return GS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF=new De(H.comparator);function on(){return hF}const mb=new De(H.comparator);function pc(...t){let e=mb;for(const n of t)e=e.insert(n.key,n);return e}function gb(t){let e=mb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function mr(){return Mc()}function yb(){return Mc()}function Mc(){return new ri(t=>t.toString(),(t,e)=>t.isEqual(e))}const dF=new De(H.comparator),fF=new Re(H.comparator);function le(...t){let e=fF;for(const n of t)e=e.add(n);return e}const pF=new Re(se);function ov(){return pF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:du(e)?"-0":e}}function _b(t){return{integerValue:""+t}}function vb(t,e){return OS(e)?_b(e):av(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(){this._=void 0}}function mF(t,e,n){return t instanceof Ka?function(i,s){const o={fields:{[QS]:{stringValue:KS},[JS]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&hp(s)&&(s=dp(s)),s&&(o.fields[YS]=s),{mapValue:o}}(n,e):t instanceof fo?Ib(t,e):t instanceof po?Eb(t,e):function(i,s){const o=wb(i,s),a=fE(o)+fE(i.Ae);return sy(o)&&sy(i.Ae)?_b(a):av(i.serializer,a)}(t,e)}function gF(t,e,n){return t instanceof fo?Ib(t,e):t instanceof po?Eb(t,e):n}function wb(t,e){return t instanceof Qa?function(r){return sy(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ka extends pp{}class fo extends pp{constructor(e){super(),this.elements=e}}function Ib(t,e){const n=Tb(e);for(const r of t.elements)n.some(i=>Tr(i,r))||n.push(r);return{arrayValue:{values:n}}}class po extends pp{constructor(e){super(),this.elements=e}}function Eb(t,e){let n=Tb(e);for(const r of t.elements)n=n.filter(i=>!Tr(i,r));return{arrayValue:{values:n}}}class Qa extends pp{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function fE(t){return Be(t.integerValue||t.doubleValue)}function Tb(t){return vu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,n){this.field=e,this.transform=n}}function yF(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof fo&&i instanceof fo||r instanceof po&&i instanceof po?Ma(r.elements,i.elements,Tr):r instanceof Qa&&i instanceof Qa?Tr(r.Ae,i.Ae):r instanceof Ka&&i instanceof Ka}(t.transform,e.transform)}class _F{constructor(e,n){this.version=e,this.transformResults=n}}class qe{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new qe}static exists(e){return new qe(void 0,e)}static updateTime(e){return new qe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Pd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mp{}function Ab(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new fl(t.key,qe.none()):new dl(t.key,t.data,qe.none());{const n=t.data,r=Pt.empty();let i=new Re(ze.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ii(t.key,r,new sn(i.toArray()),qe.none())}}function vF(t,e,n){t instanceof dl?function(i,s,o){const a=i.value.clone(),c=mE(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ii?function(i,s,o){if(!Pd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=mE(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Rb(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Fc(t,e,n,r){return t instanceof dl?function(s,o,a,c){if(!Pd(s.precondition,o))return a;const u=s.value.clone(),h=gE(s.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ii?function(s,o,a,c){if(!Pd(s.precondition,o))return a;const u=gE(s.fieldTransforms,c,o),h=o.data;return h.setAll(Rb(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return Pd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function wF(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=wb(r.transform,i||null);s!=null&&(n===null&&(n=Pt.empty()),n.set(r.field,s))}return n||null}function pE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ma(r,i,(s,o)=>yF(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class dl extends mp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ii extends mp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Rb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function mE(t,e,n){const r=new Map;Z(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,gF(o,a,n[i]))}return r}function gE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,mF(s,o,e))}return r}class fl extends mp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lv extends mp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&vF(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=yb();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const c=Ab(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),le())}isEqual(e){return this.batchId===e.batchId&&Ma(this.mutations,e.mutations,(n,r)=>pE(n,r))&&Ma(this.baseMutations,e.baseMutations,(n,r)=>pE(n,r))}}class uv{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Z(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return dF}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new uv(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var at,ge;function bb(t){switch(t){case L.OK:return Y(64938);case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0;default:return Y(15467,{code:t})}}function xb(t){if(t===void 0)return it("GRPC error has no .code"),L.UNKNOWN;switch(t){case at.OK:return L.OK;case at.CANCELLED:return L.CANCELLED;case at.UNKNOWN:return L.UNKNOWN;case at.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case at.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case at.INTERNAL:return L.INTERNAL;case at.UNAVAILABLE:return L.UNAVAILABLE;case at.UNAUTHENTICATED:return L.UNAUTHENTICATED;case at.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case at.NOT_FOUND:return L.NOT_FOUND;case at.ALREADY_EXISTS:return L.ALREADY_EXISTS;case at.PERMISSION_DENIED:return L.PERMISSION_DENIED;case at.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case at.ABORTED:return L.ABORTED;case at.OUT_OF_RANGE:return L.OUT_OF_RANGE;case at.UNIMPLEMENTED:return L.UNIMPLEMENTED;case at.DATA_LOSS:return L.DATA_LOSS;default:return Y(39323,{code:t})}}(ge=at||(at={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jc=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF=new es([4294967295,4294967295],0);function yE(t){const e=Pb().encode(t),n=new _S;return n.update(e),new Uint8Array(n.digest())}function _E(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new es([n,r],0),new es([i,s],0)]}class dv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new mc(`Invalid padding: ${n}`);if(r<0)throw new mc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new mc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=es.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(es.fromNumber(r)));return i.compare(EF)===1&&(i=new es([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=yE(e),[r,i]=_E(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new dv(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=yE(e),[r,i]=_E(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Yu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Qu(ee.min(),i,new De(se),on(),le())}}class Yu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Yu(r,n,le(),le(),le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class kb{constructor(e,n){this.targetId=e,this.Ce=n}}class Cb{constructor(e,n,r=Xe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class vE{constructor(){this.ve=0,this.Fe=wE(),this.Me=Xe.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=le(),n=le(),r=le();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Y(38017,{changeType:s})}}),new Yu(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=wE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Z(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class TF{constructor(e){this.Ge=e,this.ze=new Map,this.je=on(),this.Je=Xh(),this.He=Xh(),this.Ye=new De(se)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Y(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(vf(s))if(r===0){const o=new H(s.path);this.et(n,o,Ve.newNoDocument(o,ee.min()))}else Z(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}jc==null||jc.lt(function(h,f,p,v,b){var E,w,R;const P={localCacheCount:h,existenceFilterCount:f.count,databaseId:p.database,projectId:p.projectId},C=f.unchangedNames;return C&&(P.bloomFilter={applied:b===0,hashCount:(C==null?void 0:C.hashCount)??0,bitmapLength:((w=(E=C==null?void 0:C.bits)==null?void 0:E.bitmap)==null?void 0:w.length)??0,padding:((R=C==null?void 0:C.bits)==null?void 0:R.padding)??0,mightContain:V=>(v==null?void 0:v.mightContain(V))??!1}),P}(o,e.Ce,this.Ge.ht(),a,c))}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Yr(r).toUint8Array()}catch(c){if(c instanceof WS)return zn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new dv(o,i,s)}catch(c){return zn(c instanceof mc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&vf(a.target)){const c=new H(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Ve.newNoDocument(c,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=le();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Qu(e,n,this.Ye,this.je,r);return this.je=on(),this.Je=Xh(),this.He=Xh(),this.Ye=new De(se),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new vE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Re(se),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Re(se),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||U("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new vE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Xh(){return new De(H.comparator)}function wE(){return new De(H.comparator)}const AF=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),RF=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),SF=(()=>({and:"AND",or:"OR"}))();class bF{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function uy(t,e){return t.useProto3Json||zu(e)?e:{value:e}}function Ya(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Nb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xF(t,e){return Ya(t,e.toTimestamp())}function st(t){return Z(!!t,49232),ee.fromTimestamp(function(n){const r=Qr(n);return new Ee(r.seconds,r.nanos)}(t))}function fv(t,e){return hy(t,e).canonicalString()}function hy(t,e){const n=function(i){return new ue(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Db(t){const e=ue.fromString(t);return Z($b(e),10190,{key:e.toString()}),e}function Iu(t,e){return fv(t.databaseId,e.path)}function wr(t,e){const n=Db(e);if(n.get(1)!==t.databaseId.projectId)throw new j(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new j(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new H(Vb(n))}function Ob(t,e){return fv(t.databaseId,e)}function Lb(t){const e=Db(t);return e.length===4?ue.emptyPath():Vb(e)}function dy(t){return new ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vb(t){return Z(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function IE(t,e,n){return{name:Iu(t,e),fields:n.value.mapValue.fields}}function gp(t,e,n){const r=wr(t,e.name),i=st(e.updateTime),s=e.createTime?st(e.createTime):ee.min(),o=new Pt({mapValue:{fields:e.fields}}),a=Ve.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function PF(t,e){return"found"in e?function(r,i){Z(!!i.found,43571),i.found.name,i.found.updateTime;const s=wr(r,i.found.name),o=st(i.found.updateTime),a=i.found.createTime?st(i.found.createTime):ee.min(),c=new Pt({mapValue:{fields:i.found.fields}});return Ve.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){Z(!!i.missing,3894),Z(!!i.readTime,22933);const s=wr(r,i.missing),o=st(i.readTime);return Ve.newNoDocument(s,o)}(t,e):Y(7234,{result:e})}function kF(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Y(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(Z(h===void 0||typeof h=="string",58123),Xe.fromBase64String(h||"")):(Z(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xe.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?L.UNKNOWN:xb(u.code);return new j(h,u.message||"")}(o);n=new Cb(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=wr(t,r.document.name),s=st(r.document.updateTime),o=r.document.createTime?st(r.document.createTime):ee.min(),a=new Pt({mapValue:{fields:r.document.fields}}),c=Ve.newFoundDocument(i,s,o,a),u=r.targetIds||[],h=r.removedTargetIds||[];n=new kd(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=wr(t,r.document),s=r.readTime?st(r.readTime):ee.min(),o=Ve.newNoDocument(i,s),a=r.removedTargetIds||[];n=new kd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=wr(t,r.document),s=r.removedTargetIds||[];n=new kd([],s,i,null)}else{if(!("filter"in e))return Y(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new IF(i,s),a=r.targetId;n=new kb(a,o)}}return n}function Eu(t,e){let n;if(e instanceof dl)n={update:IE(t,e.key,e.value)};else if(e instanceof fl)n={delete:Iu(t,e.key)};else if(e instanceof ii)n={update:IE(t,e.key,e.data),updateMask:VF(e.fieldMask)};else{if(!(e instanceof lv))return Y(16599,{Vt:e.type});n={verify:Iu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Ka)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof fo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof po)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Qa)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Y(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:xF(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Y(27497)}(t,e.precondition)),n}function fy(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?qe.updateTime(st(s.updateTime)):s.exists!==void 0?qe.exists(s.exists):qe.none()}(e.currentDocument):qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)Z(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Ka;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];c=new fo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];c=new po(h)}else"increment"in a?c=new Qa(o,a.increment):Y(16584,{proto:a});const u=ze.fromServerFormat(a.fieldPath);return new Ku(u,c)}(t,i)):[];if(e.update){e.update.name;const i=wr(t,e.update.name),s=new Pt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new sn(u.map(h=>ze.fromServerFormat(h)))}(e.updateMask);return new ii(i,s,o,n,r)}return new dl(i,s,n,r)}if(e.delete){const i=wr(t,e.delete);return new fl(i,n)}if(e.verify){const i=wr(t,e.verify);return new lv(i,n)}return Y(1463,{proto:e})}function CF(t,e){return t&&t.length>0?(Z(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?st(i.updateTime):st(s);return o.isEqual(ee.min())&&(o=st(s)),new _F(o,i.transformResults||[])}(n,e))):[]}function Mb(t,e){return{documents:[Ob(t,e.path)]}}function yp(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ob(t,i);const s=function(u){if(u.length!==0)return Bb(Te.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(h=>function(p){return{field:Li(p.field),direction:DF(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=uy(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function Fb(t,e,n,r){const{ft:i,parent:s}=yp(t,e),o={},a=[];let c=0;return n.forEach(u=>{const h=r?u.alias:"aggregate_"+c++;o[h]=u.alias,u.aggregateType==="count"?a.push({alias:h,count:{}}):u.aggregateType==="avg"?a.push({alias:h,avg:{field:Li(u.fieldPath)}}):u.aggregateType==="sum"&&a.push({alias:h,sum:{field:Li(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function jb(t){let e=Lb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Z(r===1,65062);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const p=Ub(f);return p instanceof Te&&iv(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(b){return new wu(na(b.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,zu(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(f){const p=!!f.before,v=f.values||[];return new as(v,p)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const p=!f.before,v=f.values||[];return new as(v,p)}(n.endAt)),cb(e,i,o,s,a,"F",c,u)}function NF(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ub(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=na(n.unaryFilter.field);return me.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=na(n.unaryFilter.field);return me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=na(n.unaryFilter.field);return me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=na(n.unaryFilter.field);return me.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Y(61313);default:return Y(60726)}}(t):t.fieldFilter!==void 0?function(n){return me.create(na(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Y(58110);default:return Y(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Te.create(n.compositeFilter.filters.map(r=>Ub(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Y(1026)}}(n.compositeFilter.op))}(t):Y(30097,{filter:t})}function DF(t){return AF[t]}function OF(t){return RF[t]}function LF(t){return SF[t]}function Li(t){return{fieldPath:t.canonicalString()}}function na(t){return ze.fromServerFormat(t.fieldPath)}function Bb(t){return t instanceof me?function(n){if(n.op==="=="){if(sE(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NAN"}};if(iE(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(sE(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NOT_NAN"}};if(iE(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Li(n.field),op:OF(n.op),value:n.value}}}(t):t instanceof Te?function(n){const r=n.getFilters().map(i=>Bb(i));return r.length===1?r[0]:{compositeFilter:{op:LF(n.op),filters:r}}}(t):Y(54877,{filter:t})}function VF(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $b(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,n,r,i,s=ee.min(),o=ee.min(),a=Xe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Mr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Mr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e){this.yt=e}}function MF(t,e){let n;if(e.document)n=gp(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=H.fromSegments(e.noDocument.path),i=go(e.noDocument.readTime);n=Ve.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y(56709);{const r=H.fromSegments(e.unknownDocument.path),i=go(e.unknownDocument.version);n=Ve.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Ee(i[0],i[1]);return ee.fromTimestamp(s)}(e.readTime)),n}function EE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ef(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Iu(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ya(s,o.version.toTimestamp()),createTime:Ya(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mo(e.version)};else{if(!e.isUnknownDocument())return Y(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:mo(e.version)}}return r}function Ef(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function go(t){const e=new Ee(t.seconds,t.nanoseconds);return ee.fromTimestamp(e)}function Fs(t,e){const n=(e.baseMutations||[]).map(s=>fy(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>fy(t.yt,s)),i=Ee.fromMillis(e.localWriteTimeMs);return new cv(e.batchId,i,n,r)}function gc(t){const e=go(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?go(t.lastLimboFreeSnapshotVersion):ee.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return Z(o===1,1966,{count:o}),zt(hl(Lb(s.documents[0])))}(t.query):function(s){return zt(jb(s))}(t.query),new Mr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Xe.fromBase64String(t.resumeToken))}function qb(t,e){const n=mo(e.snapshotVersion),r=mo(e.lastLimboFreeSnapshotVersion);let i;i=vf(e.target)?Mb(t.yt,e.target):yp(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ho(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function _p(t){const e=jb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?If(e,e.limit,"L"):e}function Vm(t,e){return new hv(e.largestBatchId,fy(t.yt,e.overlayMutation))}function TE(t,e){const n=e.path.lastSegment();return[t,$t(e.path.popLast()),n]}function AE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:mo(r.readTime),documentKey:$t(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{getBundleMetadata(e,n){return RE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:go(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return RE(e).put(function(i){return{bundleId:i.id,createTime:mo(st(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return SE(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:_p(s.bundledQuery),readTime:go(s.readTime)}}(r)})}saveNamedQuery(e,n){return SE(e).put(function(i){return{name:i.name,readTime:mo(st(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function RE(t){return gt(t,lp)}function SE(t){return gt(t,cp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new vp(e,r)}getOverlay(e,n){return ec(e).get(TE(this.userId,n)).next(r=>r?Vm(this.serializer,r):null)}getOverlays(e,n){const r=mr();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new hv(n,o);i.push(this.St(e,a))}),O.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add($t(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ec(e).Z(ny,a))}),O.waitFor(s)}getOverlaysForCollection(e,n,r){const i=mr(),s=$t(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ec(e).J(ny,o).next(a=>{for(const c of a){const u=Vm(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=mr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return ec(e).ee({index:US,range:a},(c,u,h)=>{const f=Vm(this.serializer,u);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>s)}St(e,n){return ec(e).put(function(i,s,o){const[a,c,u]=TE(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Eu(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function ec(t){return gt(t,up)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{bt(e){return gt(e,ev)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Xe.fromUint8Array(r):Xe.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(Be(e.integerValue));else if("doubleValue"in e){const r=Be(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),du(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Qr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Yr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?ZS(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):fp(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Y(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=Ha,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(Be(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),H.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}js.Kt=new js;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=255;function UF(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function bE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=UF(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class BF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=bE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=bE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(Qo),this.sn(255)}_n(){this.an(Qo),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Qo?(this.sn(Qo),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Qo?(this.an(Qo),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class $F{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class zF{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class tc{constructor(){this.cn=new BF,this.ln=new $F(this.cn),this.hn=new zF(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new Us(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:Cd(this.En),directionalValue:Cd(this.dn),orderedDocumentKey:Cd(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ti(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=xE(t.En,e.En),n!==0?n:(n=xE(t.dn,e.dn),n!==0?n:H.comparator(t.In,e.In)))}function xE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Cd(t){return z1()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function PE(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class kE{constructor(e){this.mn=new Re((n,r)=>ze.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(Z(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Zg(e);if(n!==void 0&&!this.wn(n))return!1;const r=Ds(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const c=r[s];if(!this.Sn(a,c)||!this.bn(this.fn[o++],c))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Re(ze.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Js(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Js(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Js(r.field,r.dir==="asc"?0:1)));return new ja(ja.UNKNOWN_ID,this.collectionId,n,Ua.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hb(t){var n,r;if(Z(t instanceof me||t instanceof Te,20012),t instanceof me){if(t instanceof lb){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>me.create(t.field,"==",s)))||[];return Te.create(i,"or")}return t}const e=t.filters.map(i=>Hb(i));return Te.create(e,t.op)}function qF(t){if(t.getFilters().length===0)return[];const e=gy(Hb(t));return Z(Gb(e),7391),py(e)||my(e)?[e]:e.getFilters()}function py(t){return t instanceof me}function my(t){return t instanceof Te&&iv(t)}function Gb(t){return py(t)||my(t)||function(n){if(n instanceof Te&&oy(n)){for(const r of n.getFilters())if(!py(r)&&!my(r))return!1;return!0}return!1}(t)}function gy(t){if(Z(t instanceof me||t instanceof Te,34018),t instanceof me)return t;if(t.filters.length===1)return gy(t.filters[0]);const e=t.filters.map(r=>gy(r));let n=Te.create(e,t.op);return n=Tf(n),Gb(n)?n:(Z(n instanceof Te,64498),Z(Wa(n),40251),Z(n.filters.length>1,57927),n.filters.reduce((r,i)=>pv(r,i)))}function pv(t,e){let n;return Z(t instanceof me||t instanceof Te,38388),Z(e instanceof me||e instanceof Te,25473),n=t instanceof me?e instanceof me?function(i,s){return Te.create([i,s],"and")}(t,e):CE(t,e):e instanceof me?CE(e,t):function(i,s){if(Z(i.filters.length>0&&s.filters.length>0,48005),Wa(i)&&Wa(s))return sb(i,s.getFilters());const o=oy(i)?i:s,a=oy(i)?s:i,c=o.filters.map(u=>pv(u,a));return Te.create(c,"or")}(t,e),Tf(n)}function CE(t,e){if(Wa(e))return sb(e,t.getFilters());{const n=e.filters.map(r=>pv(t,r));return Te.create(n,"or")}}function Tf(t){if(Z(t instanceof me||t instanceof Te,11850),t instanceof me)return t;const e=t.getFilters();if(e.length===1)return Tf(e[0]);if(rb(t))return t;const n=e.map(i=>Tf(i)),r=[];return n.forEach(i=>{i instanceof me?r.push(i):i instanceof Te&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(){this.Cn=new mv}addToCollectionParentIndex(e,n){return this.Cn.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(Sn.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(Sn.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class mv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Re(ue.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE="IndexedDbIndexManager",Zh=new Uint8Array(0);class GF{constructor(e,n){this.databaseId=n,this.vn=new mv,this.Fn=new ri(r=>ho(r),(r,i)=>Hu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:$t(i)};return DE(e).put(s)}return O.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[SS(n),""],!1,!0);return DE(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(pr(o.parent))}return r})}addFieldIndex(e,n){const r=nc(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Jo(e);return s.next(a=>{o.put(AE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=nc(e),i=Jo(e),s=Yo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=nc(e),r=Yo(e),i=Jo(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return O.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new kE(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Yo(e);let i=!0;const s=new Map;return O.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=le();const a=[];return O.forEach(s,(c,u)=>{U(NE,`Using index ${function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(c)} to execute ${ho(n)}`);const h=function(R,V){const B=Zg(V);if(B===void 0)return null;for(const $ of wf(R,B.fieldPath))switch($.op){case"array-contains-any":return $.value.arrayValue.values||[];case"array-contains":return[$.value]}return null}(u,c),f=function(R,V){const B=new Map;for(const $ of Ds(V))for(const A of wf(R,$.fieldPath))switch(A.op){case"==":case"in":B.set($.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return B.set($.fieldPath.canonicalString(),A.value),Array.from(B.values())}return null}(u,c),p=function(R,V){const B=[];let $=!0;for(const A of Ds(V)){const _=A.kind===0?uE(R,A.fieldPath,R.startAt):hE(R,A.fieldPath,R.startAt);B.push(_.value),$&&($=_.inclusive)}return new as(B,$)}(u,c),v=function(R,V){const B=[];let $=!0;for(const A of Ds(V)){const _=A.kind===0?hE(R,A.fieldPath,R.endAt):uE(R,A.fieldPath,R.endAt);B.push(_.value),$&&($=_.inclusive)}return new as(B,$)}(u,c),b=this.On(c,u,p),P=this.On(c,u,v),C=this.Nn(c,u,f),E=this.Bn(c.indexId,h,b,p.inclusive,P,v.inclusive,C);return O.forEach(E,w=>r.Y(w,n.limit).next(R=>{R.forEach(V=>{const B=H.fromSegments(V.documentKey);o.has(B)||(o=o.add(B),a.push(B))})}))}).next(()=>a)}return O.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=qF(Te.create(e.filters,"and")).map(r=>ly(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,s.length),u=c/(n!=null?n.length:1),h=[];for(let f=0;f<c;++f){const p=n?this.Ln(n[f/u]):Zh,v=this.kn(e,p,r[f%u],i),b=this.qn(e,p,s[f%u],o),P=a.map(C=>this.kn(e,p,C,!0));h.push(...this.createRange(v,b,P))}return h}kn(e,n,r,i){const s=new Us(e,H.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new Us(e,H.empty(),n,r);return i?s.An():s}xn(e,n){const r=new kE(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return O.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Re(ze.comparator),h=!1;for(const f of c.filters)for(const p of f.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?h=!0:u=u.add(p.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new tc;for(const i of Ds(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);js.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new tc;return js.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new tc;return js.Kt.Dt(uo(this.databaseId,n),r.Pn(function(s){const o=Ds(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new tc);let s=0;for(const o of Ds(e)){const a=r[s++];for(const c of i)if(this.Un(n,o.fieldPath)&&vu(a))i=this.Kn(i,o,a);else{const u=c.Pn(o.kind);js.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const c=new tc;c.seed(a.un()),js.Kt.Dt(o,c.Pn(n.kind)),s.push(c)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=nc(e),i=Jo(e);return(n?r.J(ty,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return O.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(h,f){const p=f?new Ua(f.sequenceNumber,new Sn(go(f.readTime),new H(pr(f.documentKey)),f.largestBatchId)):Ua.empty(),v=h.fields.map(([b,P])=>new Js(ze.fromServerFormat(b),P));return new ja(h.indexId,h.collectionGroup,v,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:se(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=nc(e),s=Jo(e);return this.Gn(e).next(o=>i.J(ty,IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,c=>s.put(AE(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),O.forEach(a,c=>this.zn(e,i,c).next(u=>{const h=this.jn(s,c);return u.isEqual(h)?O.resolve():this.Jn(e,s,c,u,h)}))))})}Hn(e,n,r,i){return Yo(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return Yo(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=Yo(e);let s=new Re(Ti);return i.ee({index:jS,range:IDBKeyRange.only([r.indexId,this.uid,Cd(this.$n(r,n))])},(o,a)=>{s=s.add(new Us(r.indexId,n,PE(a.arrayValue),PE(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Re(Ti);const i=this.Qn(n,e);if(i==null)return r;const s=Zg(n);if(s!=null){const o=e.data.field(s.fieldPath);if(vu(o))for(const a of o.arrayValue.values||[])r=r.add(new Us(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new Us(n.indexId,e.key,Zh,i));return r}Jn(e,n,r,i,s){U(NE,"Updating index entries for document '%s'",n.key);const o=[];return function(c,u,h,f,p){const v=c.getIterator(),b=u.getIterator();let P=Ko(v),C=Ko(b);for(;P||C;){let E=!1,w=!1;if(P&&C){const R=h(P,C);R<0?w=!0:R>0&&(E=!0)}else P!=null?w=!0:E=!0;E?(f(C),C=Ko(b)):w?(p(P),P=Ko(v)):(P=Ko(v),C=Ko(b))}}(i,s,Ti,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),O.waitFor(o)}Gn(e){let n=1;return Jo(e).ee({index:FS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ti(o,a)).filter((o,a,c)=>!a||Ti(o,c[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ti(o,e),c=Ti(o,n);if(a===0)i[0]=e.An();else if(a>0&&c<0)i.push(o),i.push(o.An());else if(c>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,Zh,H.empty()),c=i[o+1].Vn(this.uid,Zh,H.empty());s.push(IDBKeyRange.bound(a,c))}return s}Zn(e,n){return Ti(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(OE)}getMinOffset(e,n){return O.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||Y(44426))).next(OE)}}function DE(t){return gt(t,mu)}function Yo(t){return gt(t,Lc)}function nc(t){return gt(t,Z_)}function Jo(t){return gt(t,Oc)}function OE(t){Z(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Y_(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Sn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Wb=41943040;class jt{static withCacheSize(e){return new jt(e,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(t,e,n){const r=t.store(Xn),i=t.store(Ba),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.ee({range:o},(h,f,p)=>(a++,p.delete()));s.push(c.next(()=>{Z(a===1,47070,{batchId:n.batchId})}));const u=[];for(const h of n.mutations){const f=LS(e,h.key.path,n.batchId);s.push(i.delete(f)),u.push(h.key)}return O.waitFor(s).next(()=>u)}function Af(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Y(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jt.DEFAULT_COLLECTION_PERCENTILE=10,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jt.DEFAULT=new jt(Wb,jt.DEFAULT_COLLECTION_PERCENTILE,jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jt.DISABLED=new jt(-1,0,0);class wp{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){Z(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new wp(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ai(e).ee({index:Ws,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=ra(e),o=Ai(e);return o.add({}).next(a=>{Z(typeof a=="number",49019);const c=new cv(a,n,r,i),u=function(v,b,P){const C=P.baseMutations.map(w=>Eu(v.yt,w)),E=P.mutations.map(w=>Eu(v.yt,w));return{userId:b,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:C,mutations:E}}(this.serializer,this.userId,c),h=[];let f=new Re((p,v)=>se(p.canonicalString(),v.canonicalString()));for(const p of i){const v=LS(this.userId,p.key.path,a);f=f.add(p.key.path.popLast()),h.push(o.put(u)),h.push(s.put(v,x4))}return f.forEach(p=>{h.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Xn[a]=c.keys()}),O.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Ai(e).get(n).next(r=>r?(Z(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Fs(this.serializer,r)):null)}er(e,n){return this.Xn[n]?O.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ai(e).ee({index:Ws,range:i},(o,a,c)=>{a.userId===this.userId&&(Z(a.batchId>=r,47524,{tr:r}),s=Fs(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=ts;return Ai(e).ee({index:Ws,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,ts],[this.userId,Number.POSITIVE_INFINITY]);return Ai(e).J(Ws,n).next(r=>r.map(i=>Fs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ad(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ra(e).ee({range:i},(o,a,c)=>{const[u,h,f]=o,p=pr(h);if(u===this.userId&&n.path.isEqual(p))return Ai(e).get(f).next(v=>{if(!v)throw Y(61480,{nr:o,batchId:f});Z(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:f}),s.push(Fs(this.serializer,v))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(se);const i=[];return n.forEach(s=>{const o=Ad(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=ra(e).ee({range:a},(u,h,f)=>{const[p,v,b]=u,P=pr(v);p===this.userId&&s.path.isEqual(P)?r=r.add(b):f.done()});i.push(c)}),O.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Ad(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Re(se);return ra(e).ee({range:o},(c,u,h)=>{const[f,p,v]=c,b=pr(p);f===this.userId&&r.isPrefixOf(b)?b.length===i&&(a=a.add(v)):h.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ai(e).get(s).next(o=>{if(o===null)throw Y(35274,{batchId:s});Z(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Fs(this.serializer,o))}))}),O.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return Kb(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),O.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ra(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const c=pr(s[1]);i.push(c)}else a.done()}).next(()=>{Z(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return Qb(e,this.userId,n)}_r(e){return Yb(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:ts,lastStreamToken:""})}}function Qb(t,e,n){const r=Ad(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return ra(t).ee({range:s,X:!0},(a,c,u)=>{const[h,f,p]=a;h===e&&f===i&&(o=!0),u.done()}).next(()=>o)}function Ai(t){return gt(t,Xn)}function ra(t){return gt(t,Ba)}function Yb(t){return gt(t,fu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new yo(0)}static cr(){return new yo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new yo(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>ee.fromTimestamp(new Ee(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Xo(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(Z(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Xo(e).ee((o,a)=>{const c=gc(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>O.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Xo(e).ee((r,i)=>{const s=gc(i);n(s)})}lr(e){return VE(e).get(_f).next(n=>(Z(n!==null,2888),n))}hr(e,n){return VE(e).put(_f,n)}Pr(e,n){return Xo(e).put(qb(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ho(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Xo(e).ee({range:i,index:MS},(o,a,c)=>{const u=gc(a);Hu(n,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Vi(e);return n.forEach(o=>{const a=$t(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(i)}removeMatchingKeys(e,n,r){const i=Vi(e);return O.forEach(n,s=>{const o=$t(s.path);return O.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Vi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Vi(e);let s=le();return i.ee({range:r,X:!0},(o,a,c)=>{const u=pr(o[1]),h=new H(u);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=$t(n.path),i=IDBKeyRange.bound([r],[SS(r)],!1,!0);let s=0;return Vi(e).ee({index:X_,X:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return Xo(e).get(n).next(r=>r?gc(r):null)}}function Xo(t){return gt(t,$a)}function VE(t){return gt(t,Xs)}function Vi(t){return gt(t,za)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME="LruGarbageCollector",Jb=1048576;function FE([t,e],[n,r]){const i=se(t,n);return i===0?se(e,r):i}class KF{constructor(e){this.Ir=e,this.buffer=new Re(FE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();FE(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Xb{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){U(ME,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ms(n)?U(ME,"Ignoring IndexedDB error during garbage collection: ",n):await ps(n)}await this.Vr(3e5)})}}class QF{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return O.resolve(rn.ce);const r=new KF(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(LE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),LE):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),ea()<=pe.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function Zb(t,e){return new QF(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,n){this.db=e,this.garbageCollector=Zb(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return ed(e,r)}removeReference(e,n,r){return ed(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ed(e,n)}br(e,n){return function(i,s){let o=!1;return Yb(i).te(a=>Qb(i,a,s).next(c=>(c&&(o=!0),O.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const c=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ee.min()),Vi(e).delete(function(f){return[0,$t(f.path)]}(o))))});i.push(c)}}).next(()=>O.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ed(e,n)}Sr(e,n){const r=Vi(e);let i,s=rn.ce;return r.ee({index:X_},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==rn.ce&&n(new H(pr(i)),s),s=u,i=c):s=rn.ce}).next(()=>{s!==rn.ce&&n(new H(pr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ed(t,e){return Vi(t).put(function(r,i){return{targetId:0,path:$t(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(){this.changes=new ri(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ve.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ps(e).put(r)}removeEntry(e,n,r){return Ps(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ef(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Ve.newInvalidDocument(n);return Ps(e).ee({index:Rd,range:IDBKeyRange.only(rc(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:Ve.newInvalidDocument(n)};return Ps(e).ee({index:Rd,range:IDBKeyRange.only(rc(n))},(i,s)=>{r={document:this.Cr(n,s),size:Af(s)}}).next(()=>r)}getEntries(e,n){let r=on();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=on(),i=new De(H.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,Af(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return O.resolve();let i=new Re(BE);n.forEach(c=>i=i.add(c));const s=IDBKeyRange.bound(rc(i.first()),rc(i.last())),o=i.getIterator();let a=o.getNext();return Ps(e).ee({index:Rd,range:s},(c,u,h)=>{const f=H.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&BE(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?h.j(rc(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ef(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ps(e).J(IDBKeyRange.bound(a,c,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let h=on();for(const f of u){const p=this.Cr(H.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);p.isFoundDocument()&&(Wu(n,p)||i.has(p.key))&&(h=h.insert(p.key,p))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=on();const o=UE(n,r),a=UE(n,Sn.max());return Ps(e).ee({index:VS,range:IDBKeyRange.bound(o,a,!0)},(c,u,h)=>{const f=this.Cr(H.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new XF(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return jE(e).get(ey).next(n=>(Z(!!n,20021),n))}Dr(e,n){return jE(e).put(ey,n)}Cr(e,n){if(n){const r=MF(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ee.min())))return r}return Ve.newInvalidDocument(e)}}function tx(t){return new JF(t)}class XF extends ex{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new ri(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Re((s,o)=>se(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=EE(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=Af(c);r+=u-a.size,n.push(this.Nr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){const c=EE(this.Nr.serializer,o.convertToNoDocument(ee.min()));n.push(this.Nr.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function jE(t){return gt(t,pu)}function Ps(t){return gt(t,yf)}function rc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function UE(t,e){const n=e.documentKey.path.toArray();return[t,Ef(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function BE(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=se(n[s],r[s]),i)return i;return i=se(n.length,r.length),i||(i=se(n[n.length-2],r[r.length-2]),i||se(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Fc(r.mutation,i,sn.empty(),Ee.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,le()).next(()=>r))}getLocalViewOfDocuments(e,n,r=le()){const i=mr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=pc();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=mr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,le()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=on();const o=Mc(),a=function(){return Mc()}();return n.forEach((c,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof ii)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Fc(h.mutation,u,h.mutation.getFieldMask(),Ee.now())):o.set(u.key,sn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>a.set(u,new ZF(h,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Mc();let i=new De((o,a)=>o-a),s=le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let h=r.get(c)||sn.empty();h=a.applyToLocalView(u,h),r.set(c,h);const f=(i.get(a.batchId)||le()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,h=c.value,f=yb();h.forEach(p=>{if(!s.has(p)){const v=Ab(n.get(p),r.get(p));v!==null&&f.set(p,v),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return H.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):sv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):O.resolve(mr());let a=Fa,c=s;return o.next(u=>O.forEach(u,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,le())).next(h=>({batchId:a,changes:gb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new H(n)).next(r=>{let i=pc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=pc();return this.indexManager.getCollectionParents(e,s).next(a=>O.forEach(a,c=>{const u=function(f,p){return new ni(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(h=>{h.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,Ve.newInvalidDocument(h)))});let a=pc();return o.forEach((c,u)=>{const h=s.get(c);h!==void 0&&Fc(h.mutation,u,sn.empty(),Ee.now()),Wu(n,u)&&(a=a.insert(c,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return O.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:st(i.createTime)}}(n)),O.resolve()}getNamedQuery(e,n){return O.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:_p(i.bundledQuery),readTime:st(i.readTime)}}(n)),O.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(){this.overlays=new De(H.comparator),this.qr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=mr();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const i=mr(),s=n.length+1,o=new H(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return O.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new De((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=mr(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=mr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=i)););return O.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new hv(n,r));let s=this.qr.get(n);s===void 0&&(s=le(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n3{constructor(){this.sessionToken=Xe.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,O.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(){this.Qr=new Re(_t.$r),this.Ur=new Re(_t.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new _t(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new _t(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new H(new ue([])),r=new _t(n,e),i=new _t(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new H(new ue([])),r=new _t(n,e),i=new _t(n,e+1);let s=le();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new _t(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class _t{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return H.comparator(e.key,n.key)||se(e.Yr,n.Yr)}static Kr(e,n){return se(e.Yr,n.Yr)||H.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r3{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Re(_t.$r)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new cv(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new _t(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?ts:this.tr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new _t(n,0),i=new _t(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(se);return n.forEach(i=>{const s=new _t(i,0),o=new _t(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),O.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;H.isDocumentKey(s)||(s=s.child(""));const o=new _t(new H(s),0);let a=new Re(se);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.Yr)),!0)},o),O.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Z(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return O.forEach(n.mutations,i=>{const s=new _t(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new _t(n,0),i=this.Zr.firstAfterOrEqual(r);return O.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(e){this.ri=e,this.docs=function(){return new De(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():Ve.newInvalidDocument(n))}getEntries(e,n){let r=on();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ve.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=on();const o=n.path,a=new H(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Y_(kS(h),r)<=0||(i.has(h.key)||Wu(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Y(9500)}ii(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new s3(this)}getSize(e){return O.resolve(this.size)}}class s3 extends ex{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{constructor(e){this.persistence=e,this.si=new ri(n=>ho(n),Hu),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.oi=0,this._i=new gv,this.targetCount=0,this.ai=yo.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),O.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new yo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.Pr(n),O.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),O.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,n){this.ui={},this.overlays={},this.ci=new rn(0),this.li=!1,this.li=!0,this.hi=new n3,this.referenceDelegate=e(this),this.Pi=new o3(this),this.indexManager=new HF,this.remoteDocumentCache=function(i){return new i3(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new zb(n),this.Ii=new e3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new t3,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new r3(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){U("MemoryPersistence","Starting transaction:",e);const i=new a3(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return O.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class a3 extends NS{constructor(e){super(),this.currentSequenceNumber=e}}class Ip{constructor(e){this.persistence=e,this.Ri=new gv,this.Vi=null}static mi(e){return new Ip(e)}get fi(){if(this.Vi)return this.Vi;throw Y(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),O.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.fi,r=>{const i=H.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,ee.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return O.or([()=>O.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Rf{constructor(e,n){this.persistence=e,this.pi=new ri(r=>$t(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Zb(this,n)}static mi(e,n){return new Rf(e,n)}Ei(){}di(e){return O.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return O.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?O.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ee.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),O.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=bd(e.data.value)),n}br(e,n,r){return O.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return O.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e){this.serializer=e}k(e,n,r,i){const s=new ap("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore(qu)}(e),function(c){c.createObjectStore(fu,{keyPath:b4}),c.createObjectStore(Xn,{keyPath:XI,autoIncrement:!0}).createIndex(Ws,ZI,{unique:!0}),c.createObjectStore(Ba)}(e),$E(e),function(c){c.createObjectStore(Os)}(e));let o=O.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore(za),c.deleteObjectStore($a),c.deleteObjectStore(Xs)}(e),$E(e)),o=o.next(()=>function(c){const u=c.store(Xs),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ee.min().toTimestamp(),targetCount:0};return u.put(_f,h)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(Xn).J().next(f=>{c.deleteObjectStore(Xn),c.createObjectStore(Xn,{keyPath:XI,autoIncrement:!0}).createIndex(Ws,ZI,{unique:!0});const p=u.store(Xn),v=f.map(b=>p.put(b));return O.waitFor(v)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore(qa,{keyPath:V4})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore(pu)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(lp,{keyPath:M4})})(e),function(c){c.createObjectStore(cp,{keyPath:F4})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore(up,{keyPath:H4});u.createIndex(ny,G4,{unique:!1}),u.createIndex(US,W4,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore(yf,{keyPath:P4});u.createIndex(Rd,k4),u.createIndex(VS,C4)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Os))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore(Z_,{keyPath:j4,autoIncrement:!0}).createIndex(ty,U4,{unique:!1}),c.createObjectStore(Oc,{keyPath:B4}).createIndex(FS,$4,{unique:!1}),c.createObjectStore(Lc,{keyPath:z4}).createIndex(jS,q4,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(Oc).clear()}).next(()=>{n.objectStore(Lc).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(ev,{keyPath:K4})})(e)})),r<18&&i>=18&&z1()&&(o=o.next(()=>{n.objectStore(Oc).clear()}).next(()=>{n.objectStore(Lc).clear()})),o}wi(e){let n=0;return e.store(Os).ee((r,i)=>{n+=Af(i)}).next(()=>{const r={byteSize:n};return e.store(pu).put(ey,r)})}yi(e){const n=e.store(fu),r=e.store(Xn);return n.J().next(i=>O.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,ts],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Ws,o).next(a=>O.forEach(a,c=>{Z(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=Fs(this.serializer,c);return Kb(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(za),r=e.store(Os);return e.store(Xs).get(_f).next(i=>{const s=[];return r.ee((o,a)=>{const c=new ue(o),u=function(f){return[0,$t(f)]}(c);s.push(n.get(u).next(h=>h?O.resolve():(f=>n.put({targetId:0,path:$t(f),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>O.waitFor(s))})}bi(e,n){e.createObjectStore(mu,{keyPath:L4});const r=n.store(mu),i=new mv,s=o=>{if(i.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:$t(c)})}};return n.store(Os).ee({X:!0},(o,a)=>{const c=new ue(o);return s(c.popLast())}).next(()=>n.store(Ba).ee({X:!0},([o,a,c],u)=>{const h=pr(a);return s(h.popLast())}))}Di(e){const n=e.store($a);return n.ee((r,i)=>{const s=gc(i),o=qb(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Os),i=[];return r.ee((s,o)=>{const a=n.store(yf),c=function(f){return f.document?new H(ue.fromString(f.document.name).popFirst(5)):f.noDocument?H.fromSegments(f.noDocument.path):f.unknownDocument?H.fromSegments(f.unknownDocument.path):Y(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>O.waitFor(i))}Fi(e,n){const r=n.store(Xn),i=tx(this.serializer),s=new yv(Ip.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(c=>{let u=a.get(c.userId)??le();Fs(this.serializer,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),O.forEach(a,(c,u)=>{const h=new wt(u),f=vp.wt(this.serializer,h),p=s.getIndexManager(h),v=wp.wt(h,this.serializer,p,s.referenceDelegate);return new nx(i,v,f,p).recalculateAndSaveOverlaysForDocumentKeys(new ry(n,rn.ce),c).next()})})}}function $E(t){t.createObjectStore(za,{keyPath:D4}).createIndex(X_,O4,{unique:!0}),t.createObjectStore($a,{keyPath:"targetId"}).createIndex(MS,N4,{unique:!0}),t.createObjectStore(Xs)}const Ri="IndexedDbPersistence",Mm=18e5,Fm=5e3,jm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rx="main";class _v{constructor(e,n,r,i,s,o,a,c,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=p=>Promise.resolve(),!_v.v())throw new j(L.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new YF(this,i),this.$i=n+rx,this.serializer=new zb(c),this.Ui=new vr(this.$i,this.Ni,new l3(this.serializer)),this.hi=new jF,this.Pi=new WF(this.referenceDelegate,this.serializer),this.remoteDocumentCache=tx(this.serializer),this.Ii=new FF,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&it(Ri,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new j(L.FAILED_PRECONDITION,jm);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new rn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>td(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(ms(e))return U(Ri,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U(Ri,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return ic(e).get(Wo).next(n=>O.resolve(this.es(n)))}ts(e){return td(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Mm)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=gt(n,qa);return r.J().next(i=>{const s=this.ss(i,Mm),o=i.filter(a=>s.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?O.resolve(!0):ic(e).get(Wo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Fm)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new j(L.FAILED_PRECONDITION,jm);return!1}}return!(!this.networkEnabled||!this.inForeground)||td(e).J().next(r=>this.ss(r,Fm).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&U(Ri,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[qu,qa],e=>{const n=new ry(e,rn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>td(e).J().next(n=>this.ss(n,Mm).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return wp.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new GF(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){U(Ri,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===18?J4:c===17?qS:c===16?Y4:c===15?tv:c===14?zS:c===13?$S:c===12?Q4:c===11?BS:void Y(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new ry(a,this.ci?this.ci.next():rn.ce),n==="readwrite-primary"?this.Hi(o).next(c=>!!c||this.Yi(o)).next(c=>{if(!c)throw it(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new j(L.FAILED_PRECONDITION,CS);return r(o)}).next(c=>this.Xi(o).next(()=>c)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return ic(e).get(Wo).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,Fm)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new j(L.FAILED_PRECONDITION,jm)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ic(e).put(Wo,n)}static v(){return vr.v()}Zi(e){const n=ic(e);return n.get(Wo).next(r=>this.es(r)?(U(Ri,"Releasing primary lease."),n.delete(Wo)):O.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(it(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;$1()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return U(Ri,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return it(Ri,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){it("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ic(t){return gt(t,qu)}function td(t){return gt(t,qa)}function vv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=le(),i=le();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new wv(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return $1()?8:DS(pt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new c3;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(ea()<=pe.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",ta(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),O.resolve()):(ea()<=pe.DEBUG&&U("QueryEngine","Query:",ta(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(ea()<=pe.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",ta(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zt(n))):O.resolve())}ys(e,n){if(dE(n))return O.resolve(null);let r=zt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=If(n,null,"F"),r=zt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=le(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.Ds(n,a);return this.Cs(n,u,o,c.readTime)?this.ys(e,If(n,null,"F")):this.vs(e,u,n,c)}))})))}ws(e,n,r,i){return dE(n)||i.isEqual(ee.min())?O.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?O.resolve(null):(ea()<=pe.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ta(n)),this.vs(e,o,n,PS(i,Fa)).next(a=>a))})}Ds(e,n){let r=new Re(pb(e));return n.forEach((i,s)=>{Wu(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return ea()<=pe.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",ta(n)),this.ps.getDocumentsMatchingQuery(e,n,Sn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="LocalStore",u3=3e8;class h3{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new De(se),this.xs=new ri(s=>ho(s),Hu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nx(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function sx(t,e,n,r){return new h3(t,e,n,r)}async function ox(t,e){const n=G(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let c=le();for(const u of i){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function d3(t,e){const n=G(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,c,u,h){const f=u.batch,p=f.keys();let v=O.resolve();return p.forEach(b=>{v=v.next(()=>h.getEntry(c,b)).next(P=>{const C=u.docVersions.get(b);Z(C!==null,48541),P.version.compareTo(C)<0&&(f.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),h.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=le();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function ax(t){const e=G(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function f3(t,e){const n=G(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((h,f)=>{const p=i.get(f);if(!p)return;a.push(n.Pi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,h.addedDocuments,f)));let v=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(Xe.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),i=i.insert(f,v),function(P,C,E){return P.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=u3?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(p,v,h)&&a.push(n.Pi.updateTargetData(s,v))});let c=on(),u=le();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(lx(s,o,e.documentUpdates).next(h=>{c=h.ks,u=h.qs})),!r.isEqual(ee.min())){const h=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.Ms=i,s))}function lx(t,e,n){let r=le(),i=le();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=on();return n.forEach((a,c)=>{const u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ee.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):U(Iv,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{ks:o,qs:i}})}function p3(t,e){const n=G(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ts),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ja(t,e){const n=G(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Mr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function Xa(t,e,n){const r=G(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ms(o))throw o;U(Iv,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Sf(t,e,n){const r=G(t);let i=ee.min(),s=le();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,h){const f=G(c),p=f.xs.get(h);return p!==void 0?O.resolve(f.Ms.get(p)):f.Pi.getTargetData(u,h)}(r,o,zt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:ee.min(),n?s:le())).next(a=>(hx(r,fb(e),a),{documents:a,Qs:s})))}function cx(t,e){const n=G(t),r=G(n.Pi),i=n.Ms.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.At(s,e).next(o=>o?o.target:null))}function ux(t,e){const n=G(t),r=n.Os.get(e)||ee.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.Ns.getAllFromCollectionGroup(i,e,PS(r,Fa),Number.MAX_SAFE_INTEGER)).then(i=>(hx(n,e,i),i))}function hx(t,e,n){let r=t.Os.get(e)||ee.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}async function m3(t,e,n,r){const i=G(t);let s=le(),o=on();for(const u of n){const h=e.$s(u.metadata.name);u.document&&(s=s.add(h));const f=e.Us(u);f.setReadTime(e.Ks(u.metadata.readTime)),o=o.insert(h,f)}const a=i.Ns.newChangeBuffer({trackRemovals:!0}),c=await Ja(i,function(h){return zt(hl(ue.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>lx(u,a,o).next(h=>(a.apply(u),h)).next(h=>i.Pi.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Pi.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,h.ks,h.qs)).next(()=>h.ks)))}async function g3(t,e,n=le()){const r=await Ja(t,zt(_p(e.bundledQuery))),i=G(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=st(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ii.saveNamedQuery(s,e);const a=r.withResumeToken(Xe.EMPTY_BYTE_STRING,o);return i.Ms=i.Ms.insert(a.targetId,a),i.Pi.updateTargetData(s,a).next(()=>i.Pi.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Pi.addMatchingKeys(s,n,r.targetId)).next(()=>i.Ii.saveNamedQuery(s,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="firestore_clients";function zE(t,e){return`${dx}_${t}_${e}`}const fx="firestore_mutations";function qE(t,e,n){let r=`${fx}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const px="firestore_targets";function Um(t,e){return`${px}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr="SharedClientState";class bf{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ws(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new j(i.error.code,i.error.message))),o?new bf(e,n,i.state,s):(it(hr,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Uc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ws(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new j(r.error.code,r.error.message))),s?new Uc(e,r.state,i):(it(hr,`Failed to parse target state for ID '${e}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class xf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ws(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=ov();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=OS(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new xf(e,s):(it(hr,`Failed to parse client data for instance '${e}': ${n}`),null)}}class Ev{constructor(e,n){this.clientId=e,this.onlineState=n}static Ws(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Ev(n.clientId,n.onlineState):(it(hr,`Failed to parse online state: ${e}`),null)}}class yy{constructor(){this.activeTargetIds=ov()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Bm{constructor(e,n,r,i,s){this.window=e,this.Mi=n,this.persistenceKey=r,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new De(se),this.started=!1,this.Xs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.eo=zE(this.persistenceKey,this.Js),this.no=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new yy),this.ro=new RegExp(`^${dx}_${o}_([^_]*)$`),this.io=new RegExp(`^${fx}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${px}_${o}_(\\d+)$`),this.oo=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this._o=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const i=this.getItem(zE(this.persistenceKey,r));if(i){const s=xf.Ws(r,i);s&&(this.Zs=this.Zs.insert(s.clientId,s))}}this.ao();const n=this.storage.getItem(this.oo);if(n){const r=this.uo(n);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let n=!1;return this.Zs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,n,r){this.ho(e,n,r),this.Po(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Um(this.persistenceKey,e));if(i){const s=Uc.Ws(e,i);s&&(r=s.state)}}return n&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Um(this.persistenceKey,e))}updateQueryState(e,n,r){this.Io(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Po(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return U(hr,"READ",e,n),n}setItem(e,n){U(hr,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){U(hr,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const n=e;if(n.storageArea===this.storage){if(U(hr,"EVENT",n.key,n.newValue),n.key===this.eo)return void it("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.ro.test(n.key)){if(n.newValue==null){const r=this.Ro(n.key);return this.Vo(r,null)}{const r=this.mo(n.key,n.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(this.so.test(n.key)){if(n.newValue!==null){const r=this.yo(n.key,n.newValue);if(r)return this.wo(r)}}else if(n.key===this.oo){if(n.newValue!==null){const r=this.uo(n.newValue);if(r)return this.co(r)}}else if(n.key===this.no){const r=function(s){let o=rn.ce;if(s!=null)try{const a=JSON.parse(s);Z(typeof a=="number",30636,{So:s}),o=a}catch(a){it(hr,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==rn.ce&&this.sequenceNumberHandler(r)}else if(n.key===this._o){const r=this.bo(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Do(i)))}}}else this.Xs.push(n)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,n,r){const i=new bf(this.currentUser,e,n,r),s=qE(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Gs())}Po(e){const n=qE(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Eo(e){const n={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(n))}Io(e,n,r){const i=Um(this.persistenceKey,e),s=new Uc(e,n,r);this.setItem(i,s.Gs())}Ao(e){const n=JSON.stringify(Array.from(e));this.setItem(this._o,n)}Ro(e){const n=this.ro.exec(e);return n?n[1]:null}mo(e,n){const r=this.Ro(e);return xf.Ws(r,n)}fo(e,n){const r=this.io.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return bf.Ws(new wt(s),i,n)}yo(e,n){const r=this.so.exec(e),i=Number(r[1]);return Uc.Ws(i,n)}uo(e){return Ev.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);U(hr,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,n){const r=n?this.Zs.insert(e,n):this.Zs.remove(e),i=this.lo(this.Zs),s=this.lo(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.Fo(o,a).then(()=>{this.Zs=r})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let n=ov();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class mx{constructor(){this.Mo=new yy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="ConnectivityMonitor";class GE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){U(HE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){U(HE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nd=null;function _y(){return nd===null?nd=function(){return 268435456+Math.round(2147483648*Math.random())}():nd++,"0x"+nd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $m="RestConnection",_3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class v3{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===yu?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=_y(),a=this.zo(e,n.toUriEncodedString());U($m,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,s);const{host:u}=new URL(a),h=Xr(u);return this.Jo(e,a,c,r,h).then(f=>(U($m,`Received RPC '${e}' ${o}: `,f),f),f=>{throw zn($m,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ul}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=_3[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w3{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft="WebChannelConnection";class I3 extends v3{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=_y();return new Promise((a,c)=>{const u=new vS;u.setWithCredentials(!0),u.listenOnce(wS.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Td.NO_ERROR:const f=u.getResponseJson();U(Ft,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Td.TIMEOUT:U(Ft,`RPC '${e}' ${o} timed out`),c(new j(L.DEADLINE_EXCEEDED,"Request time out"));break;case Td.HTTP_ERROR:const p=u.getStatus();if(U(Ft,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const b=v==null?void 0:v.error;if(b&&b.status&&b.message){const P=function(E){const w=E.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(w)>=0?w:L.UNKNOWN}(b.status);c(new j(P,b.message))}else c(new j(L.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new j(L.UNAVAILABLE,"Connection failed."));break;default:Y(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{U(Ft,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(i);U(Ft,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",h,r,15)})}T_(e,n,r){const i=_y(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=TS(),a=ES(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=s.join("");U(Ft,`Creating RPC '${e}' stream ${i}: ${h}`,c);const f=o.createWebChannel(h,c);this.I_(f);let p=!1,v=!1;const b=new w3({Yo:C=>{v?U(Ft,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(p||(U(Ft,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),U(Ft,`RPC '${e}' stream ${i} sending:`,C),f.send(C))},Zo:()=>f.close()}),P=(C,E,w)=>{C.listen(E,R=>{try{w(R)}catch(V){setTimeout(()=>{throw V},0)}})};return P(f,fc.EventType.OPEN,()=>{v||(U(Ft,`RPC '${e}' stream ${i} transport opened.`),b.o_())}),P(f,fc.EventType.CLOSE,()=>{v||(v=!0,U(Ft,`RPC '${e}' stream ${i} transport closed`),b.a_(),this.E_(f))}),P(f,fc.EventType.ERROR,C=>{v||(v=!0,zn(Ft,`RPC '${e}' stream ${i} transport errored. Name:`,C.name,"Message:",C.message),b.a_(new j(L.UNAVAILABLE,"The operation could not be completed")))}),P(f,fc.EventType.MESSAGE,C=>{var E;if(!v){const w=C.data[0];Z(!!w,16349);const R=w,V=(R==null?void 0:R.error)||((E=R[0])==null?void 0:E.error);if(V){U(Ft,`RPC '${e}' stream ${i} received error:`,V);const B=V.status;let $=function(S){const T=at[S];if(T!==void 0)return xb(T)}(B),A=V.message;$===void 0&&($=L.INTERNAL,A="Unknown error status: "+B+" with message "+V.message),v=!0,b.a_(new j($,A)),f.close()}else U(Ft,`RPC '${e}' stream ${i} received:`,w),b.u_(w)}}),P(a,IS.STAT_EVENT,C=>{C.stat===Qg.PROXY?U(Ft,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===Qg.NOPROXY&&U(Ft,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.__()},0),b}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(){return typeof window<"u"?window:null}function Nd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(t){return new bF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="PersistentStream";class yx{constructor(e,n,r,i,s,o,a,c){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Tv(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===L.RESOURCE_EXHAUSTED?(it(n.toString()),it("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===L.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new j(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return U(WE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(U(WE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class E3 extends yx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=kF(this.serializer,e),r=function(s){if(!("targetChange"in s))return ee.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ee.min():o.readTime?st(o.readTime):ee.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=dy(this.serializer),n.addTarget=function(s,o){let a;const c=o.target;if(a=vf(c)?{documents:Mb(s,c)}:{query:yp(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Nb(s,o.resumeToken);const u=uy(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ee.min())>0){a.readTime=Ya(s,o.snapshotVersion.toTimestamp());const u=uy(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=NF(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=dy(this.serializer),n.removeTarget=e,this.q_(n)}}class T3 extends yx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Z(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Z(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Z(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=CF(e.writeResults,e.commitTime),r=st(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=dy(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Eu(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{}class R3 extends A3{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new j(L.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,hy(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new j(L.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,hy(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new j(L.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class S3{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(it(n),this.aa=!1):U("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="RemoteStore";class b3{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ys(this)&&(U(_o,"Restarting streams for network reachability change."),await async function(c){const u=G(c);u.Ea.add(4),await pl(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Ju(u)}(this))})}),this.Ra=new S3(r,i)}}async function Ju(t){if(ys(t))for(const e of t.da)await e(!0)}async function pl(t){for(const e of t.da)await e(!1)}function Ep(t,e){const n=G(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Sv(n)?Rv(n):gl(n).O_()&&Av(n,e))}function Za(t,e){const n=G(t),r=gl(n);n.Ia.delete(e),r.O_()&&_x(n,e),n.Ia.size===0&&(r.O_()?r.L_():ys(n)&&n.Ra.set("Unknown"))}function Av(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}gl(t).Y_(e)}function _x(t,e){t.Va.Ue(e),gl(t).Z_(e)}function Rv(t){t.Va=new TF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),gl(t).start(),t.Ra.ua()}function Sv(t){return ys(t)&&!gl(t).x_()&&t.Ia.size>0}function ys(t){return G(t).Ea.size===0}function vx(t){t.Va=void 0}async function x3(t){t.Ra.set("Online")}async function P3(t){t.Ia.forEach((e,n)=>{Av(t,e)})}async function k3(t,e){vx(t),Sv(t)?(t.Ra.ha(e),Rv(t)):t.Ra.set("Unknown")}async function C3(t,e,n){if(t.Ra.set("Online"),e instanceof Cb&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){U(_o,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Pf(t,r)}else if(e instanceof kd?t.Va.Ze(e):e instanceof kb?t.Va.st(e):t.Va.tt(e),!n.isEqual(ee.min()))try{const r=await ax(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.Ia.get(u);h&&s.Ia.set(u,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{const h=s.Ia.get(c);if(!h)return;s.Ia.set(c,h.withResumeToken(Xe.EMPTY_BYTE_STRING,h.snapshotVersion)),_x(s,c);const f=new Mr(h.target,c,u,h.sequenceNumber);Av(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){U(_o,"Failed to raise snapshot:",r),await Pf(t,r)}}async function Pf(t,e,n){if(!ms(e))throw e;t.Ea.add(1),await pl(t),t.Ra.set("Offline"),n||(n=()=>ax(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{U(_o,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ju(t)})}function wx(t,e){return e().catch(n=>Pf(t,n,e))}async function ml(t){const e=G(t),n=ls(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ts;for(;N3(e);)try{const i=await p3(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,D3(e,i)}catch(i){await Pf(e,i)}Ix(e)&&Ex(e)}function N3(t){return ys(t)&&t.Ta.length<10}function D3(t,e){t.Ta.push(e);const n=ls(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Ix(t){return ys(t)&&!ls(t).x_()&&t.Ta.length>0}function Ex(t){ls(t).start()}async function O3(t){ls(t).ra()}async function L3(t){const e=ls(t);for(const n of t.Ta)e.ea(n.mutations)}async function V3(t,e,n){const r=t.Ta.shift(),i=uv.from(r,e,n);await wx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await ml(t)}async function M3(t,e){e&&ls(t).X_&&await async function(r,i){if(function(o){return bb(o)&&o!==L.ABORTED}(i.code)){const s=r.Ta.shift();ls(r).B_(),await wx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await ml(r)}}(t,e),Ix(t)&&Ex(t)}async function KE(t,e){const n=G(t);n.asyncQueue.verifyOperationInProgress(),U(_o,"RemoteStore received new credentials");const r=ys(n);n.Ea.add(3),await pl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ju(n)}async function vy(t,e){const n=G(t);e?(n.Ea.delete(2),await Ju(n)):e||(n.Ea.add(2),await pl(n),n.Ra.set("Unknown"))}function gl(t){return t.ma||(t.ma=function(n,r,i){const s=G(n);return s.sa(),new E3(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:x3.bind(null,t),t_:P3.bind(null,t),r_:k3.bind(null,t),H_:C3.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Sv(t)?Rv(t):t.Ra.set("Unknown")):(await t.ma.stop(),vx(t))})),t.ma}function ls(t){return t.fa||(t.fa=function(n,r,i){const s=G(n);return s.sa(),new T3(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:O3.bind(null,t),r_:M3.bind(null,t),ta:L3.bind(null,t),na:V3.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await ml(t)):(await t.fa.stop(),t.Ta.length>0&&(U(_o,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Tt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new bv(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yl(t,e){if(it("AsyncQueue",`${e}: ${t}`),ms(t))return new j(L.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{static emptySet(e){return new Zs(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||H.comparator(n.key,r.key):(n,r)=>H.comparator(n.key,r.key),this.keyedMap=pc(),this.sortedSet=new De(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Zs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Zs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(){this.ga=new De(H.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Y(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class vo{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new vo(e,n,Zs.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class j3{constructor(){this.queries=YE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=G(n),s=i.queries;i.queries=YE(),s.forEach((o,a)=>{for(const c of a.Sa)c.onError(r)})})(this,new j(L.ABORTED,"Firestore shutting down"))}}function YE(){return new ri(t=>db(t),Gu)}async function xv(t,e){const n=G(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new F3,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=yl(o,`Initialization of query '${ta(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&kv(n)}async function Pv(t,e){const n=G(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function U3(t,e){const n=G(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&kv(n)}function B3(t,e,n){const r=G(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function kv(t){t.Ca.forEach(e=>{e.next()})}var wy,JE;(JE=wy||(wy={})).Ma="default",JE.Cache="cache";class Cv{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new vo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=vo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==wy.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e,n){this.Qa=e,this.byteLength=n}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e){this.serializer=e}$s(e){return wr(this.serializer,e)}Us(e){return e.metadata.exists?gp(this.serializer,e.document,!1):Ve.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return st(e)}}class Nv{constructor(e,n){this.Ua=e,this.serializer=n,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=Ax(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++n;const r=ue.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,{...this.progress}):null}za(e){const n=new Map,r=new XE(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.$s(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||le()).add(s);n.set(o,a)}}return n}async ja(e){const n=await m3(e,new XE(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const i of this.Ka)await g3(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:n}}}function Ax(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(e){this.key=e}}class Sx{constructor(e){this.key=e}}class bx{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=le(),this.mutatedKeys=le(),this.eu=pb(e),this.tu=new Zs(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new QE,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const p=i.get(h),v=Wu(this.query,f)?f:null,b=!!p&&this.mutatedKeys.has(p.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let C=!1;p&&v?p.data.isEqual(v.data)?b!==P&&(r.track({type:3,doc:v}),C=!0):this.su(p,v)||(r.track({type:2,doc:v}),C=!0,(c&&this.eu(v,c)>0||u&&this.eu(v,u)<0)&&(a=!0)):!p&&v?(r.track({type:0,doc:v}),C=!0):p&&!v&&(r.track({type:1,doc:p}),C=!0,(c||u)&&(a=!0)),C&&(v?(o=o.add(v),s=P?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,f)=>function(v,b){const P=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y(20277,{Rt:C})}};return P(v)-P(b)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new vo(this.query,e.tu,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new QE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=le(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new Sx(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new Rx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=le();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return vo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const _s="SyncEngine";class $3{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class z3{constructor(e){this.key=e,this.hu=!1}}class q3{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ri(a=>db(a),Gu),this.Iu=new Map,this.Eu=new Set,this.du=new De(H.comparator),this.Au=new Map,this.Ru=new gv,this.Vu={},this.mu=new Map,this.fu=yo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function H3(t,e,n=!0){const r=Tp(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await xx(r,e,n,!0),i}async function G3(t,e){const n=Tp(t);await xx(n,e,!0,!1)}async function xx(t,e,n,r){const i=await Ja(t.localStore,zt(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Dv(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Ep(t.remoteStore,i),a}async function Dv(t,e,n,r,i){t.pu=(f,p,v)=>async function(P,C,E,w){let R=C.view.ru(E);R.Cs&&(R=await Sf(P.localStore,C.query,!1).then(({documents:A})=>C.view.ru(A,R)));const V=w&&w.targetChanges.get(C.targetId),B=w&&w.targetMismatches.get(C.targetId)!=null,$=C.view.applyChanges(R,P.isPrimaryClient,V,B);return Iy(P,C.targetId,$.au),$.snapshot}(t,f,p,v);const s=await Sf(t.localStore,e,!0),o=new bx(e,s.Qs),a=o.ru(s.documents),c=Yu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);Iy(t,n,u.au);const h=new $3(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function W3(t,e,n){const r=G(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Gu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Xa(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Za(r.remoteStore,i.targetId),el(r,i.targetId)}).catch(ps)):(el(r,i.targetId),await Xa(r.localStore,i.targetId,!0))}async function K3(t,e){const n=G(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Za(n.remoteStore,r.targetId))}async function Q3(t,e,n){const r=Mv(t);try{const i=await function(o,a){const c=G(o),u=Ee.now(),h=a.reduce((v,b)=>v.add(b.key),le());let f,p;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let b=on(),P=le();return c.Ns.getEntries(v,h).next(C=>{b=C,b.forEach((E,w)=>{w.isValidDocument()||(P=P.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,b)).next(C=>{f=C;const E=[];for(const w of a){const R=wF(w,f.get(w.key).overlayedDocument);R!=null&&E.push(new ii(w.key,R,tb(R.value.mapValue),qe.exists(!0)))}return c.mutationQueue.addMutationBatch(v,u,E,a)}).next(C=>{p=C;const E=C.applyToLocalDocumentSet(f,P);return c.documentOverlayCache.saveOverlays(v,C.batchId,E)})}).then(()=>({batchId:p.batchId,changes:gb(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new De(se)),u=u.insert(a,c),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await si(r,i.changes),await ml(r.remoteStore)}catch(i){const s=yl(i,"Failed to persist write");n.reject(s)}}async function Px(t,e){const n=G(t);try{const r=await f3(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(Z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Z(o.hu,14607):i.removedDocuments.size>0&&(Z(o.hu,42227),o.hu=!1))}),await si(n,r,e)}catch(r){await ps(r)}}function ZE(t,e,n){const r=G(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const c=G(o);c.onlineState=a;let u=!1;c.queries.forEach((h,f)=>{for(const p of f.Sa)p.va(a)&&(u=!0)}),u&&kv(c)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Y3(t,e,n){const r=G(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new De(H.comparator);o=o.insert(s,Ve.newNoDocument(s,ee.min()));const a=le().add(s),c=new Qu(ee.min(),new Map,new De(se),o,a);await Px(r,c),r.du=r.du.remove(s),r.Au.delete(e),Vv(r)}else await Xa(r.localStore,e,!1).then(()=>el(r,e,n)).catch(ps)}async function J3(t,e){const n=G(t),r=e.batch.batchId;try{const i=await d3(n.localStore,e);Lv(n,r,null),Ov(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await si(n,i)}catch(i){await ps(i)}}async function X3(t,e,n){const r=G(t);try{const i=await function(o,a){const c=G(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>(Z(f!==null,37113),h=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,e);Lv(r,e,n),Ov(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await si(r,i)}catch(i){await ps(i)}}async function Z3(t,e){const n=G(t);ys(n.remoteStore)||U(_s,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=G(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===ts)return void e.resolve();const i=n.mu.get(r)||[];i.push(e),n.mu.set(r,i)}catch(r){const i=yl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Ov(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Lv(t,e,n){const r=G(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function el(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||kx(t,r)})}function kx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Za(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Vv(t))}function Iy(t,e,n){for(const r of n)r instanceof Rx?(t.Ru.addReference(r.key,e),ej(t,r)):r instanceof Sx?(U(_s,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||kx(t,r.key)):Y(19791,{wu:r})}function ej(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(U(_s,"New document in limbo: "+n),t.Eu.add(r),Vv(t))}function Vv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new H(ue.fromString(e)),r=t.fu.next();t.Au.set(r,new z3(n)),t.du=t.du.insert(n,r),Ep(t.remoteStore,new Mr(zt(hl(n.path)),r,"TargetPurposeLimboResolution",rn.ce))}}async function si(t,e,n){const r=G(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(u=>{var h;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){i.push(u);const f=wv.As(c.targetId,u);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(c,u){const h=G(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(u,p=>O.forEach(p.Es,v=>h.persistence.referenceDelegate.addReference(f,p.targetId,v)).next(()=>O.forEach(p.ds,v=>h.persistence.referenceDelegate.removeReference(f,p.targetId,v)))))}catch(f){if(!ms(f))throw f;U(Iv,"Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const v=h.Ms.get(p),b=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(b);h.Ms=h.Ms.insert(p,P)}}}(r.localStore,s))}async function tj(t,e){const n=G(t);if(!n.currentUser.isEqual(e)){U(_s,"User change. New user:",e.toKey());const r=await ox(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(c=>{c.reject(new j(L.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await si(n,r.Ls)}}function nj(t,e){const n=G(t),r=n.Au.get(e);if(r&&r.hu)return le().add(r.key);{let i=le();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}async function rj(t,e){const n=G(t),r=await Sf(n.localStore,e.query,!0),i=e.view.cu(r);return n.isPrimaryClient&&Iy(n,e.targetId,i.au),i}async function ij(t,e){const n=G(t);return ux(n.localStore,e).then(r=>si(n,r))}async function sj(t,e,n,r){const i=G(t),s=await function(a,c){const u=G(a),h=G(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>h.er(f,c).next(p=>p?u.localDocuments.getDocuments(f,p):O.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await ml(i.remoteStore):n==="acknowledged"||n==="rejected"?(Lv(i,e,r||null),Ov(i,e),function(a,c){G(G(a).mutationQueue).ir(c)}(i.localStore,e)):Y(6720,"Unknown batchState",{Su:n}),await si(i,s)):U(_s,"Cannot apply mutation batch with id: "+e)}async function oj(t,e){const n=G(t);if(Tp(n),Mv(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await eT(n,r.toArray());n.gu=!0,await vy(n.remoteStore,!0);for(const s of i)Ep(n.remoteStore,s)}else if(e===!1&&n.gu!==!1){const r=[];let i=Promise.resolve();n.Iu.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(el(n,o),Xa(n.localStore,o,!0))),Za(n.remoteStore,o)}),await i,await eT(n,r),function(o){const a=G(o);a.Au.forEach((c,u)=>{Za(a.remoteStore,u)}),a.Ru.Jr(),a.Au=new Map,a.du=new De(H.comparator)}(n),n.gu=!1,await vy(n.remoteStore,!1)}}async function eT(t,e,n){const r=G(t),i=[],s=[];for(const o of e){let a;const c=r.Iu.get(o);if(c&&c.length!==0){a=await Ja(r.localStore,zt(c[0]));for(const u of c){const h=r.Tu.get(u),f=await rj(r,h);f.snapshot&&s.push(f.snapshot)}}else{const u=await cx(r.localStore,o);a=await Ja(r.localStore,u),await Dv(r,Cx(u),o,!1,a.resumeToken)}i.push(a)}return r.Pu.H_(s),i}function Cx(t){return cb(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function aj(t){return function(n){return G(G(n).persistence).Ts()}(G(t).localStore)}async function lj(t,e,n,r){const i=G(t);if(i.gu)return void U(_s,"Ignoring unexpected query state notification.");const s=i.Iu.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await ux(i.localStore,fb(s[0])),a=Qu.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Xe.EMPTY_BYTE_STRING);await si(i,o,a);break}case"rejected":await Xa(i.localStore,e,!0),el(i,e,r);break;default:Y(64155,n)}}async function cj(t,e,n){const r=Tp(t);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){U(_s,"Adding an already active target "+i);continue}const s=await cx(r.localStore,i),o=await Ja(r.localStore,s);await Dv(r,Cx(s),o.targetId,!1,o.resumeToken),Ep(r.remoteStore,o)}for(const i of n)r.Iu.has(i)&&await Xa(r.localStore,i,!1).then(()=>{Za(r.remoteStore,i),el(r,i)}).catch(ps)}}function Tp(t){const e=G(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Px.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Y3.bind(null,e),e.Pu.H_=U3.bind(null,e.eventManager),e.Pu.yu=B3.bind(null,e.eventManager),e}function Mv(t){const e=G(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=J3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=X3.bind(null,e),e}function uj(t,e,n){const r=G(t);(async function(s,o,a){try{const c=await o.getMetadata();if(await function(v,b){const P=G(v),C=st(b.createTime);return P.persistence.runTransaction("hasNewerBundle","readonly",E=>P.Ii.getBundleMetadata(E,b.id)).then(E=>!!E&&E.createTime.compareTo(C)>=0)}(s.localStore,c))return await o.close(),a._completeWith(function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(Ax(c));const u=new Nv(c,o.serializer);let h=await o.bu();for(;h;){const p=await u.Ga(h);p&&a._updateProgress(p),h=await o.bu()}const f=await u.ja(s.localStore);return await si(s,f.Ha,void 0),await function(v,b){const P=G(v);return P.persistence.runTransaction("Save bundle","readwrite",C=>P.Ii.saveBundleMetadata(C,b))}(s.localStore,c),a._completeWith(f.progress),Promise.resolve(f.Ja)}catch(c){return zn(_s,`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class tl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return sx(this.persistence,new ix,e.initialUser,this.serializer)}Cu(e){return new yv(Ip.mi,this.serializer)}Du(e){return new mx}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tl.provider={build:()=>new tl};class Fv extends tl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Z(this.persistence.referenceDelegate instanceof Rf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Xb(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?jt.withCacheSize(this.cacheSizeBytes):jt.DEFAULT;return new yv(r=>Rf.mi(r,n),this.serializer)}}class jv extends tl{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Mv(this.xu.syncEngine),await ml(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return sx(this.persistence,new ix,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new Xb(r,e.asyncQueue,n)}Mu(e,n){const r=new R4(n,this.persistence);return new A4(e.asyncQueue,r)}Cu(e){const n=vv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jt.withCacheSize(this.cacheSizeBytes):jt.DEFAULT;return new _v(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,gx(),Nd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new mx}}class Nx extends jv{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof Bm&&(this.sharedClientState.syncEngine={Co:sj.bind(null,n),vo:lj.bind(null,n),Fo:cj.bind(null,n),Ts:aj.bind(null,n),Do:ij.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await oj(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=gx();if(!Bm.v(n))throw new j(L.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=vv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Bm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class cs{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ZE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tj.bind(null,this.syncEngine),await vy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new j3}()}createDatastore(e){const n=xo(e.databaseInfo.databaseId),r=function(s){return new I3(s)}(e.databaseInfo);return function(s,o,a,c){return new R3(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new b3(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>ZE(this.syncEngine,n,0),function(){return GE.v()?new GE:new y3}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,h){const f=new q3(i,s,o,a,c,u);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=G(i);U(_o,"RemoteStore shutting down."),s.Ea.add(5),await pl(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}cs.provider={build:()=>new cs};function tT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):it("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e,n){this.Bu=e,this.serializer=n,this.metadata=new Tt,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))},r=>this.metadata.reject(r))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const n=this.Lu.decode(e),r=Number(n);isNaN(r)&&this.Qu(`length string (${n}) is not valid number`);const i=await this.$u(r);return new Tx(JSON.parse(i),e.length+r)}Uu(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const n=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n){this.bundleData=e,this.serializer=n,this.cursor=0,this.elements=[];let r=this.bu();if(!r||!r.$a())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r==null?void 0:r.Qa)}`);this.metadata=r;do r=this.bu(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),n=this.$u(e);return new Tx(JSON.parse(n),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new j(L.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let n=this.cursor;for(;n<this.bundleData.length;){if(this.bundleData[n]==="{"){if(n===e)throw new Error("First character is a bracket and not a number");return this.cursor=n,Number(this.bundleData.slice(e,n))}n++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new j(L.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const o=G(i),a={documents:s.map(f=>Iu(o.serializer,f))},c=await o.Ho("BatchGetDocuments",o.serializer.databaseId,ue.emptyPath(),a,s.length),u=new Map;c.forEach(f=>{const p=PF(o.serializer,f);u.set(p.key.toString(),p)});const h=[];return s.forEach(f=>{const p=u.get(f.toString());Z(!!p,55234,{key:f}),h.push(p)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new fl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=H.fromPath(r);this.mutations.push(new lv(i,this.precondition(i)))}),await async function(r,i){const s=G(r),o={writes:i.map(a=>Eu(s.serializer,a))};await s.Go("Commit",s.serializer.databaseId,ue.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Y(50498,{Gu:e.constructor.name});n=ee.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new j(L.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ee.min())?qe.exists(!1):qe.updateTime(n):qe.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ee.min()))throw new j(L.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qe.updateTime(n)}return qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new Tv(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new fj(this.datastore),n=this.Hu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Yu(i)}))}).catch(r=>{this.Yu(r)})})}Hu(e){try{const n=this.updateFunction(e);return!zu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!bb(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="FirestoreClient";class mj{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=wt.UNAUTHENTICATED,this.clientId=K_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{U(us,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(U(us,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Tt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=yl(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function zm(t,e){t.asyncQueue.verifyOperationInProgress(),U(us,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await ox(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function nT(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Uv(t);U(us,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>KE(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>KE(e.remoteStore,i)),t._onlineComponents=e}async function Uv(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){U(us,"Using user provided OfflineComponentProvider");try{await zm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===L.FAILED_PRECONDITION||i.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;zn("Error using user provided cache. Falling back to memory cache: "+n),await zm(t,new tl)}}else U(us,"Using default OfflineComponentProvider"),await zm(t,new Fv(void 0));return t._offlineComponents}async function Rp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(U(us,"Using user provided OnlineComponentProvider"),await nT(t,t._uninitializedComponentsProvider._online)):(U(us,"Using default OnlineComponentProvider"),await nT(t,new cs))),t._onlineComponents}function Dx(t){return Uv(t).then(e=>e.persistence)}function _l(t){return Uv(t).then(e=>e.localStore)}function Ox(t){return Rp(t).then(e=>e.remoteStore)}function Bv(t){return Rp(t).then(e=>e.syncEngine)}function Lx(t){return Rp(t).then(e=>e.datastore)}async function nl(t){const e=await Rp(t),n=e.eventManager;return n.onListen=H3.bind(null,e.syncEngine),n.onUnlisten=W3.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=G3.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=K3.bind(null,e.syncEngine),n}function gj(t){return t.asyncQueue.enqueue(async()=>{const e=await Dx(t),n=await Ox(t);return e.setNetworkEnabled(!0),function(i){const s=G(i);return s.Ea.delete(0),Ju(s)}(n)})}function yj(t){return t.asyncQueue.enqueue(async()=>{const e=await Dx(t),n=await Ox(t);return e.setNetworkEnabled(!1),async function(i){const s=G(i);s.Ea.add(0),await pl(s),s.Ra.set("Offline")}(n)})}function _j(t,e){const n=new Tt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(u,h){const f=G(u);return f.persistence.runTransaction("read document","readonly",p=>f.localDocuments.getDocument(p,h))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new j(L.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=yl(a,`Failed to get document '${s} from cache`);o.reject(c)}}(await _l(t),e,n)),n.promise}function Vx(t,e,n={}){const r=new Tt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,u){const h=new Ap({next:p=>{h.Nu(),o.enqueueAndForget(()=>Pv(s,f));const v=p.docs.has(a);!v&&p.fromCache?u.reject(new j(L.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&p.fromCache&&c&&c.source==="server"?u.reject(new j(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new Cv(hl(a.path),h,{includeMetadataChanges:!0,qa:!0});return xv(s,f)}(await nl(t),t.asyncQueue,e,n,r)),r.promise}function vj(t,e){const n=new Tt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await Sf(i,s,!0),c=new bx(s,a.Qs),u=c.ru(a.documents),h=c.applyChanges(u,!1);o.resolve(h.snapshot)}catch(a){const c=yl(a,`Failed to execute query '${s} against cache`);o.reject(c)}}(await _l(t),e,n)),n.promise}function Mx(t,e,n={}){const r=new Tt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,u){const h=new Ap({next:p=>{h.Nu(),o.enqueueAndForget(()=>Pv(s,f)),p.fromCache&&c.source==="server"?u.reject(new j(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new Cv(a,h,{includeMetadataChanges:!0,qa:!0});return xv(s,f)}(await nl(t),t.asyncQueue,e,n,r)),r.promise}function wj(t,e,n){const r=new Tt;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await Lx(t);r.resolve(async function(o,a,c){var P;const u=G(o),{request:h,gt:f,parent:p}=Fb(u.serializer,ub(a),c);u.connection.$o||delete h.parent;const v=(await u.Ho("RunAggregationQuery",u.serializer.databaseId,p,h,1)).filter(C=>!!C.result);Z(v.length===1,64727);const b=(P=v[0].result)==null?void 0:P.aggregateFields;return Object.keys(b).reduce((C,E)=>(C[f[E]]=b[E],C),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}function Ij(t,e){const n=new Ap(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){G(i).Ca.add(s),s.next()}(await nl(t),n)),()=>{n.Nu(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){G(i).Ca.delete(s)}(await nl(t),n))}}function Ej(t,e,n,r){const i=function(o,a){let c;return c=typeof o=="string"?Pb().encode(o):o,function(h,f){return new hj(h,f)}(function(h,f){if(h instanceof Uint8Array)return tT(h,f);if(h instanceof ArrayBuffer)return tT(new Uint8Array(h),f);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,xo(e));t.asyncQueue.enqueueAndForget(async()=>{uj(await Bv(t),i,r)})}function Tj(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=G(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Ii.getNamedQuery(o,i))}(await _l(t),e))}function Fx(t,e){return function(r,i){return new dj(r,i)}(t,e)}function Aj(t,e){return t.asyncQueue.enqueue(async()=>async function(r,i){const s=G(r),o=s.indexManager,a=[];return s.persistence.runTransaction("Configure indexes","readwrite",c=>o.getFieldIndexes(c).next(u=>function(f,p,v,b,P){f=[...f],p=[...p],f.sort(v),p.sort(v);const C=f.length,E=p.length;let w=0,R=0;for(;w<E&&R<C;){const V=v(f[R],p[w]);V<0?P(f[R++]):V>0?b(p[w++]):(w++,R++)}for(;w<E;)b(p[w++]);for(;R<C;)P(f[R++])}(u,i,w4,h=>{a.push(o.addFieldIndex(c,h))},h=>{a.push(o.deleteFieldIndex(c,h))})).next(()=>O.waitFor(a)))}(await _l(t),e))}function Rj(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){G(r).Fs.Vs=i}(await _l(t),e))}function Sj(t){return t.asyncQueue.enqueue(async()=>function(n){const r=G(n),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",s=>i.deleteAllFieldIndexes(s))}(await _l(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="firestore.googleapis.com",iT=!0;class sT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new j(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ux,this.ssl=iT}else this.host=e.host,this.ssl=e.ssl??iT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Wb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Jb)throw new j(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}v4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jx(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new j(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new j(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new j(L.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xu{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new j(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new j(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new c4;switch(r.type){case"firstParty":return new f4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new j(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=rT.get(n);r&&(U("ComponentProvider","Removing Datastore"),rT.delete(n),r.terminate())}(this),Promise.resolve()}}function bj(t,e,n,r={}){var u;t=de(t,Xu);const i=Xr(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(Kf(`https://${a}`),__("Firestore",!0)),s.host!==Ux&&s.host!==a&&zn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:i,emulatorOptions:r};if(!Un(c,o)&&(t._setSettings(c),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=wt.MOCK_USER;else{h=j1(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new j(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new wt(p)}t._authCredentials=new u4(new RS(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new At(this.firestore,e,this._query)}}class Se{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ir(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Se(this.firestore,e,this._key)}toJSON(){return{type:Se._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(bo(n,Se._jsonSchema))return new Se(e,r||null,new H(ue.fromString(n.referencePath)))}}Se._jsonSchemaVersion="firestore/documentReference/1.0",Se._jsonSchema={type:ut("string",Se._jsonSchemaVersion),referencePath:ut("string")};class Ir extends At{constructor(e,n,r){super(e,n,hl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Se(this.firestore,null,new H(e))}withConverter(e){return new Ir(this.firestore,e,this._path)}}function Zu(t,e,...n){if(t=J(t),Q_("collection","path",e),t instanceof Xu){const r=ue.fromString(e,...n);return WI(r),new Ir(t,null,r)}{if(!(t instanceof Se||t instanceof Ir))throw new j(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ue.fromString(e,...n));return WI(r),new Ir(t.firestore,null,r)}}function R5(t,e){if(t=de(t,Xu),Q_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new j(L.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(t,null,function(r){return new ni(ue.emptyPath(),r)}(e))}function eo(t,e,...n){if(t=J(t),arguments.length===1&&(e=K_.newId()),Q_("doc","path",e),t instanceof Xu){const r=ue.fromString(e,...n);return GI(r),new Se(t,null,new H(r))}{if(!(t instanceof Se||t instanceof Ir))throw new j(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ue.fromString(e,...n));return GI(r),new Se(t.firestore,t instanceof Ir?t.converter:null,new H(r))}}function S5(t,e){return t=J(t),e=J(e),(t instanceof Se||t instanceof Ir)&&(e instanceof Se||e instanceof Ir)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Bx(t,e){return t=J(t),e=J(e),t instanceof At&&e instanceof At&&t.firestore===e.firestore&&Gu(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="AsyncQueue";class aT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Tv(this,"async_queue_retry"),this._c=()=>{const r=Nd();r&&U(oT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Nd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Nd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Tt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ms(e))throw e;U(oT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,it("INTERNAL UNHANDLED ERROR: ",lT(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=bv.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Y(47125,{Pc:lT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function lT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class xj{constructor(){this._progressObserver={},this._taskCompletionResolver=new Tt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5=-1;class Ce extends Xu{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new aT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aT(e),this._firestoreClient=void 0,await e}}}function x5(t,e,n){n||(n=yu);const r=sr(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Un(s,e))return i;throw new j(L.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new j(L.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Jb)throw new j(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Xr(e.host)&&Kf(e.host),r.initialize({options:e,instanceIdentifier:n})}function Pj(t,e){const n=typeof t=="object"?t:Lu(),r=typeof t=="string"?t:e||yu,i=sr(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=V1("firestore");s&&bj(i,...s)}return i}function Ke(t){if(t._terminated)throw new j(L.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||$x(t),t._firestoreClient}function $x(t){var r,i,s;const e=t._freezeSettings(),n=function(a,c,u,h){return new Z4(a,c,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,jx(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new mj(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(t._componentsProvider))}function P5(t,e){zn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return zx(t,cs.provider,{build:r=>new jv(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function k5(t){zn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();zx(t,cs.provider,{build:n=>new Nx(n,e.cacheSizeBytes)})}function zx(t,e,n){if((t=de(t,Ce))._firestoreClient||t._terminated)throw new j(L.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new j(L.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},$x(t)}function C5(t){if(t._initialized&&!t._terminated)throw new j(L.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Tt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!vr.v())return Promise.resolve();const i=r+rx;await vr.delete(i)}(vv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function N5(t){return function(n){const r=new Tt;return n.asyncQueue.enqueueAndForget(async()=>Z3(await Bv(n),r)),r.promise}(Ke(t=de(t,Ce)))}function D5(t){return gj(Ke(t=de(t,Ce)))}function O5(t){return yj(Ke(t=de(t,Ce)))}function L5(t){return QD(t.app,"firestore",t._databaseId.database),t._delete()}function cT(t,e){const n=Ke(t=de(t,Ce)),r=new xj;return Ej(n,t._databaseId,e,r),r}function kj(t,e){return Tj(Ke(t=de(t,Ce)),e).then(n=>n?new At(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class Cj{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yn(Xe.fromBase64String(e))}catch(n){throw new j(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new yn(Xe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(bo(e,yn._jsonSchema))return yn.fromBase64String(e.bytes)}}yn._jsonSchemaVersion="firestore/bytes/1.0",yn._jsonSchema={type:ut("string",yn._jsonSchemaVersion),bytes:ut("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new j(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function V5(){return new Po(Xg)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new j(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new j(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Er._jsonSchemaVersion}}static fromJSON(e){if(bo(e,Er._jsonSchema))return new Er(e.latitude,e.longitude)}}Er._jsonSchemaVersion="firestore/geoPoint/1.0",Er._jsonSchema={type:ut("string",Er._jsonSchemaVersion),latitude:ut("number"),longitude:ut("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:rr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(bo(e,rr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new rr(e.vectorValues);throw new j(L.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}rr._jsonSchemaVersion="firestore/vectorValue/1.0",rr._jsonSchema={type:ut("string",rr._jsonSchemaVersion),vectorValues:ut("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=/^__.*__$/;class Dj{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ii(e,this.data,this.fieldMask,n,this.fieldTransforms):new dl(e,this.data,n,this.fieldTransforms)}}class qx{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ii(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Hx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y(40011,{Ac:t})}}class Sp{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Sp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return kf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Hx(this.Ac)&&Nj.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Oj{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||xo(e)}Cc(e,n,r,i=!1){return new Sp({Ac:e,methodName:n,Dc:r,path:ze.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Co(t){const e=t._freezeSettings(),n=xo(t._databaseId);return new Oj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bp(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);Kv("Data must be an object, but it was:",o,r);const a=Kx(r,o);let c,u;if(s.merge)c=new sn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const p=Au(e,f,n);if(!o.contains(p))throw new j(L.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Yx(h,p)||h.push(p)}c=new sn(h),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new Dj(new Pt(a),c,u)}class eh extends ko{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof eh}}function Gx(t,e,n){return new Sp({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class $v extends ko{_toFieldTransform(e){return new Ku(e.path,new Ka)}isEqual(e){return e instanceof $v}}class zv extends ko{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=Gx(this,e,!0),r=this.vc.map(s=>No(s,n)),i=new fo(r);return new Ku(e.path,i)}isEqual(e){return e instanceof zv&&Un(this.vc,e.vc)}}class qv extends ko{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=Gx(this,e,!0),r=this.vc.map(s=>No(s,n)),i=new po(r);return new Ku(e.path,i)}isEqual(e){return e instanceof qv&&Un(this.vc,e.vc)}}class Hv extends ko{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new Qa(e.serializer,vb(e.serializer,this.Fc));return new Ku(e.path,n)}isEqual(e){return e instanceof Hv&&this.Fc===e.Fc}}function Gv(t,e,n,r){const i=t.Cc(1,e,n);Kv("Data must be an object, but it was:",i,r);const s=[],o=Pt.empty();gs(r,(c,u)=>{const h=xp(e,c,n);u=J(u);const f=i.yc(h);if(u instanceof eh)s.push(h);else{const p=No(u,f);p!=null&&(s.push(h),o.set(h,p))}});const a=new sn(s);return new qx(o,a,i.fieldTransforms)}function Wv(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[Au(e,r,n)],c=[i];if(s.length%2!=0)throw new j(L.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(Au(e,s[p])),c.push(s[p+1]);const u=[],h=Pt.empty();for(let p=a.length-1;p>=0;--p)if(!Yx(u,a[p])){const v=a[p];let b=c[p];b=J(b);const P=o.yc(v);if(b instanceof eh)u.push(v);else{const C=No(b,P);C!=null&&(u.push(v),h.set(v,C))}}const f=new sn(u);return new qx(h,f,o.fieldTransforms)}function Wx(t,e,n,r=!1){return No(n,t.Cc(r?4:3,e))}function No(t,e){if(Qx(t=J(t)))return Kv("Unsupported field value:",e,t),Kx(t,e);if(t instanceof ko)return function(r,i){if(!Hx(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let c=No(a,i.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=J(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ee.fromDate(r);return{timestampValue:Ya(i.serializer,s)}}if(r instanceof Ee){const s=new Ee(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ya(i.serializer,s)}}if(r instanceof Er)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof yn)return{bytesValue:Nb(i.serializer,r._byteString)};if(r instanceof Se){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:fv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof rr)return function(o,a){return{mapValue:{fields:{[nv]:{stringValue:rv},[Ha]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return av(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${op(r)}`)}(t,e)}function Kx(t,e){const n={};return GS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gs(t,(r,i)=>{const s=No(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Qx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ee||t instanceof Er||t instanceof yn||t instanceof Se||t instanceof ko||t instanceof rr)}function Kv(t,e,n){if(!Qx(n)||!bS(n)){const r=op(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Au(t,e,n){if((e=J(e))instanceof Po)return e._internalPath;if(typeof e=="string")return xp(t,e);throw kf("Field path arguments must be of type string or ",t,!1,void 0,n)}const Lj=new RegExp("[~\\*/\\[\\]]");function xp(t,e,n){if(e.search(Lj)>=0)throw kf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Po(...e.split("."))._internalPath}catch{throw kf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function kf(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new j(L.INVALID_ARGUMENT,a+t+c)}function Yx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Se(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Vj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Pp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Vj extends Ru{data(){return super.data()}}function Pp(t,e){return typeof e=="string"?xp(t,e):e instanceof Po?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new j(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Qv{}class th extends Qv{}function Xx(t,e,...n){let r=[];e instanceof Qv&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof vl).length,a=s.filter(c=>c instanceof nh).length;if(o>1||o>0&&a>0)throw new j(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class nh extends th{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new nh(e,n,r)}_apply(e){const n=this._parse(e);return tP(e._query,n),new At(e.firestore,e.converter,cy(e._query,n))}_parse(e){const n=Co(e.firestore);return function(s,o,a,c,u,h,f){let p;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new j(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){hT(f,h);const b=[];for(const P of f)b.push(uT(c,s,P));p={arrayValue:{values:b}}}else p=uT(c,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||hT(f,h),p=Wx(a,o,f,h==="in"||h==="not-in");return me.create(u,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function M5(t,e,n){const r=e,i=Pp("where",t);return nh._create(i,r,n)}class vl extends Qv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new vl(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Te.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const c of a)tP(o,c),o=cy(o,c)}(e._query,n),new At(e.firestore,e.converter,cy(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function F5(...t){return t.forEach(e=>nP("or",e)),vl._create("or",t)}function j5(...t){return t.forEach(e=>nP("and",e)),vl._create("and",t)}class Yv extends th{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Yv(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new j(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new j(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wu(s,o)}(e._query,this._field,this._direction);return new At(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ni(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Zx(t,e="asc"){const n=e,r=Pp("orderBy",t);return Yv._create(r,n)}class kp extends th{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new kp(e,n,r)}_apply(e){return new At(e.firestore,e.converter,If(e._query,this._limit,this._limitType))}}function U5(t){return xS("limit",t),kp._create("limit",t,"F")}function B5(t){return xS("limitToLast",t),kp._create("limitToLast",t,"L")}class Cp extends th{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Cp(e,n,r)}_apply(e){const n=eP(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new ni(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function $5(...t){return Cp._create("startAt",t,!0)}function z5(...t){return Cp._create("startAfter",t,!1)}class Np extends th{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Np(e,n,r)}_apply(e){const n=eP(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new ni(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function q5(...t){return Np._create("endBefore",t,!1)}function H5(...t){return Np._create("endAt",t,!0)}function eP(t,e,n,r){if(n[0]=J(n[0]),n[0]instanceof Ru)return function(s,o,a,c,u){if(!c)throw new j(L.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of ba(s))if(f.field.isKeyField())h.push(uo(o,c.key));else{const p=c.data.field(f.field);if(hp(p))throw new j(L.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const v=f.field.canonicalString();throw new j(L.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(p)}return new as(h,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Co(t.firestore);return function(o,a,c,u,h,f){const p=o.explicitOrderBy;if(h.length>p.length)throw new j(L.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let b=0;b<h.length;b++){const P=h[b];if(p[b].field.isKeyField()){if(typeof P!="string")throw new j(L.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof P}`);if(!sv(o)&&P.indexOf("/")!==-1)throw new j(L.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${P}' contains a slash.`);const C=o.path.child(ue.fromString(P));if(!H.isDocumentKey(C))throw new j(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${C}' is not because it contains an odd number of segments.`);const E=new H(C);v.push(uo(a,E))}else{const C=Wx(c,u,P);v.push(C)}}return new as(v,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function uT(t,e,n){if(typeof(n=J(n))=="string"){if(n==="")throw new j(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sv(e)&&n.indexOf("/")!==-1)throw new j(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ue.fromString(n));if(!H.isDocumentKey(r))throw new j(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return uo(t,new H(r))}if(n instanceof Se)return uo(t,n._key);throw new j(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${op(n)}.`)}function hT(t,e){if(!Array.isArray(t)||t.length===0)throw new j(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tP(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new j(L.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new j(L.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function nP(t,e){if(!(e instanceof nh||e instanceof vl))throw new j(L.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class rP{convertValue(e,n="none"){switch(ss(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Y(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return gs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[Ha].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>Be(o.doubleValue));return new rr(n)}convertGeoPoint(e){return new Er(Be(e.latitude),Be(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=dp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(gu(e));default:return null}}convertTimestamp(e){const n=Qr(e);return new Ee(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ue.fromString(e);Z($b(r),9688,{name:e});const i=new co(r.get(1),r.get(3)),s=new H(r.popFirst(5));return i.isEqual(n)||it(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Jv extends rP{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Se(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G5(t){return new Tu("sum",Au("sum",t))}function W5(t){return new Tu("avg",Au("average",t))}function Mj(){return new Tu("count")}function K5(t,e){var n,r;return t instanceof Tu&&e instanceof Tu&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)==null?void 0:n.canonicalString())===((r=e._internalFieldPath)==null?void 0:r.canonicalString())}function Q5(t,e){return Bx(t.query,e.query)&&Un(t.data(),e.data())}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP="NOT SUPPORTED";class Bi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class En extends Ru{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Dd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Pp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new j(L.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=En._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}function Y5(t,e,n){if(bo(e,En._jsonSchema)){if(e.bundle===iP)throw new j(L.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=xo(t._databaseId),i=Fx(e.bundle,r),s=i.Wu(),o=new Nv(i.getMetadata(),r);for(const h of s)o.Ga(h);const a=o.documents;if(a.length!==1)throw new j(L.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);const c=gp(r,a[0].document),u=new H(ue.fromString(e.bundleName));return new En(t,new Jv(t),u,c,new Bi(!1,!1),n||null)}}En._jsonSchemaVersion="firestore/documentSnapshot/1.0",En._jsonSchema={type:ut("string",En._jsonSchemaVersion),bundleSource:ut("string","DocumentSnapshot"),bundleName:ut("string"),bundle:ut("string")};class Dd extends En{data(e={}){return super.data(e)}}class Tn{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Bi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Dd(this._firestore,this._userDataWriter,r.key,r,new Bi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new j(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const c=new Dd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Bi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const c=new Dd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Bi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Fj(a.type),doc:c,oldIndex:u,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new j(L.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Tn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=K_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function J5(t,e,n){if(bo(e,Tn._jsonSchema)){if(e.bundle===iP)throw new j(L.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=xo(t._databaseId),i=Fx(e.bundle,r),s=i.Wu(),o=new Nv(i.getMetadata(),r);for(const p of s)o.Ga(p);if(o.queries.length!==1)throw new j(L.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);const a=_p(o.queries[0].bundledQuery),c=o.documents;let u=new Zs;c.map(p=>{const v=gp(r,p.document);u=u.add(v)});const h=vo.fromInitialDocuments(a,u,le(),!1,!1),f=new At(t,n||null,a);return new Tn(t,new Jv(t),f,h)}}function Fj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y(61501,{type:t})}}function X5(t,e){return t instanceof En&&e instanceof En?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Tn&&e instanceof Tn&&t._firestore===e._firestore&&Bx(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jj(t){t=de(t,Se);const e=de(t.firestore,Ce);return Vx(Ke(e),t._key).then(n=>Xv(e,t,n))}Tn._jsonSchemaVersion="firestore/querySnapshot/1.0",Tn._jsonSchema={type:ut("string",Tn._jsonSchemaVersion),bundleSource:ut("string","QuerySnapshot"),bundleName:ut("string"),bundle:ut("string")};class vs extends rP{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Se(this.firestore,null,n)}}function Z5(t){t=de(t,Se);const e=de(t.firestore,Ce),n=Ke(e),r=new vs(e);return _j(n,t._key).then(i=>new En(e,r,t._key,i,new Bi(i!==null&&i.hasLocalMutations,!0),t.converter))}function e9(t){t=de(t,Se);const e=de(t.firestore,Ce);return Vx(Ke(e),t._key,{source:"server"}).then(n=>Xv(e,t,n))}function sP(t){t=de(t,At);const e=de(t.firestore,Ce),n=Ke(e),r=new vs(e);return Jx(t._query),Mx(n,t._query).then(i=>new Tn(e,r,t,i))}function t9(t){t=de(t,At);const e=de(t.firestore,Ce),n=Ke(e),r=new vs(e);return vj(n,t._query).then(i=>new Tn(e,r,t,i))}function n9(t){t=de(t,At);const e=de(t.firestore,Ce),n=Ke(e),r=new vs(e);return Mx(n,t._query,{source:"server"}).then(i=>new Tn(e,r,t,i))}function Op(t,e,n){t=de(t,Se);const r=de(t.firestore,Ce),i=Dp(t.converter,e,n);return rh(r,[bp(Co(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,qe.none())])}function r9(t,e,n,...r){t=de(t,Se);const i=de(t.firestore,Ce),s=Co(i);let o;return o=typeof(e=J(e))=="string"||e instanceof Po?Wv(s,"updateDoc",t._key,e,n,r):Gv(s,"updateDoc",t._key,e),rh(i,[o.toMutation(t._key,qe.exists(!0))])}function i9(t){return rh(de(t.firestore,Ce),[new fl(t._key,qe.none())])}function s9(t,e){const n=de(t.firestore,Ce),r=eo(t),i=Dp(t.converter,e);return rh(n,[bp(Co(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,qe.exists(!1))]).then(()=>r)}function Ey(t,...e){var c,u,h;t=J(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||xa(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(xa(e[r])){const f=e[r];e[r]=(c=f.next)==null?void 0:c.bind(f),e[r+1]=(u=f.error)==null?void 0:u.bind(f),e[r+2]=(h=f.complete)==null?void 0:h.bind(f)}let s,o,a;if(t instanceof Se)o=de(t.firestore,Ce),a=hl(t._key.path),s={next:f=>{e[r]&&e[r](Xv(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=de(t,At);o=de(f.firestore,Ce),a=f._query;const p=new vs(o);s={next:v=>{e[r]&&e[r](new Tn(o,p,f,v))},error:e[r+1],complete:e[r+2]},Jx(t._query)}return function(p,v,b,P){const C=new Ap(P),E=new Cv(v,C,b);return p.asyncQueue.enqueueAndForget(async()=>xv(await nl(p),E)),()=>{C.Nu(),p.asyncQueue.enqueueAndForget(async()=>Pv(await nl(p),E))}}(Ke(o),a,i,s)}function o9(t,e,...n){const r=J(t),i=function(c){const u={bundle:"",bundleName:"",bundleSource:""},h=["bundle","bundleName","bundleSource"];for(const f of h){if(!(f in c)){u.error=`snapshotJson missing required field: ${f}`;break}const p=c[f];if(typeof p!="string"){u.error=`snapshotJson field '${f}' must be a string.`;break}if(p.length===0){u.error=`snapshotJson field '${f}' cannot be an empty string.`;break}f==="bundle"?u.bundle=p:f==="bundleName"?u.bundleName=p:f==="bundleSource"&&(u.bundleSource=p)}return u}(e);if(i.error)throw new j(L.INVALID_ARGUMENT,i.error);let s,o=0;if(typeof n[o]!="object"||xa(n[o])||(s=n[o++]),i.bundleSource==="QuerySnapshot"){let a=null;if(typeof n[o]=="object"&&xa(n[o])){const c=n[o++];a={next:c.next,error:c.error,complete:c.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(u,h,f,p,v){let b,P=!1;return cT(u,h.bundle).then(()=>kj(u,h.bundleName)).then(E=>{E&&!P&&(v&&E.withConverter(v),b=Ey(E,f||{},p))}).catch(E=>(p.error&&p.error(E),()=>{})),()=>{P||(P=!0,b&&b())}}(r,i,s,a,n[o])}if(i.bundleSource==="DocumentSnapshot"){let a=null;if(typeof n[o]=="object"&&xa(n[o])){const c=n[o++];a={next:c.next,error:c.error,complete:c.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(u,h,f,p,v){let b,P=!1;return cT(u,h.bundle).then(()=>{if(!P){const E=new Se(u,v||null,H.fromPath(h.bundleName));b=Ey(E,f||{},p)}}).catch(E=>(p.error&&p.error(E),()=>{})),()=>{P||(P=!0,b&&b())}}(r,i,s,a,n[o])}throw new j(L.INVALID_ARGUMENT,`unsupported bundle source: ${i.bundleSource}`)}function a9(t,e){return Ij(Ke(t=de(t,Ce)),xa(e)?e:{next:e})}function rh(t,e){return function(r,i){const s=new Tt;return r.asyncQueue.enqueueAndForget(async()=>Q3(await Bv(r),i,s)),s.promise}(Ke(t),e)}function Xv(t,e,n){const r=n.docs.get(e._key),i=new vs(t);return new En(t,i,e._key,r,new Bi(n.hasPendingWrites,n.fromCache),e.converter)}function l9(t){return Uj(t,{count:Mj()})}function Uj(t,e){const n=de(t.firestore,Ce),r=Ke(n),i=HS(e,(s,o)=>new Sb(o,s.aggregateType,s._internalFieldPath));return wj(r,t._query,i).then(s=>function(a,c,u){const h=new vs(a);return new Cj(c,h,u)}(n,t,s))}class Bj{constructor(e){this.kind="memory",this._onlineComponentProvider=cs.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new Fv(void 0)}}toJSON(){return{kind:this.kind}}}class $j{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=Wj(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class zj{constructor(){this.kind="memoryEager",this._offlineComponentProvider=tl.provider}toJSON(){return{kind:this.kind}}}class qj{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Fv(e)}}toJSON(){return{kind:this.kind}}}function c9(){return new zj}function u9(t){return new qj(t==null?void 0:t.cacheSizeBytes)}function h9(t){return new Bj(t)}function d9(t){return new $j(t)}class Hj{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=cs.provider,this._offlineComponentProvider={build:n=>new jv(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Gj{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=cs.provider,this._offlineComponentProvider={build:n=>new Nx(n,e==null?void 0:e.cacheSizeBytes)}}}function Wj(t){return new Hj(t==null?void 0:t.forceOwnership)}function f9(){return new Gj}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Co(e)}set(e,n,r){this._verifyNotCommitted();const i=$i(e,this._firestore),s=Dp(i.converter,n,r),o=bp(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,qe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=$i(e,this._firestore);let o;return o=typeof(n=J(n))=="string"||n instanceof Po?Wv(this._dataReader,"WriteBatch.update",s._key,n,r,i):Gv(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,qe.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=$i(e,this._firestore);return this._mutations=this._mutations.concat(new fl(n._key,qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new j(L.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $i(t,e){if((t=J(t)).firestore!==e)throw new j(L.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Co(e)}get(e){const n=$i(e,this._firestore),r=new Jv(this._firestore);return this._transaction.lookup([n._key]).then(i=>{if(!i||i.length!==1)return Y(24041);const s=i[0];if(s.isFoundDocument())return new Ru(this._firestore,r,s.key,s,n.converter);if(s.isNoDocument())return new Ru(this._firestore,r,n._key,null,n.converter);throw Y(18433,{doc:s})})}set(e,n,r){const i=$i(e,this._firestore),s=Dp(i.converter,n,r),o=bp(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,n,r,...i){const s=$i(e,this._firestore);let o;return o=typeof(n=J(n))=="string"||n instanceof Po?Wv(this._dataReader,"Transaction.update",s._key,n,r,i):Gv(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(e){const n=$i(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj extends Yj{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=$i(e,this._firestore),r=new vs(this._firestore);return super.get(e).then(i=>new En(this._firestore,r,n._key,i._document,new Bi(!1,!1),n.converter))}}function p9(t,e,n){t=de(t,Ce);const r={...Kj,...n};return function(s){if(s.maxAttempts<1)throw new j(L.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const c=new Tt;return s.asyncQueue.enqueueAndForget(async()=>{const u=await Lx(s);new pj(s.asyncQueue,u,a,o,c).ju()}),c.promise}(Ke(t),i=>e(new Jj(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m9(){return new eh("deleteField")}function g9(){return new $v("serverTimestamp")}function y9(...t){return new zv("arrayUnion",t)}function _9(...t){return new qv("arrayRemove",t)}function v9(t){return new Hv("increment",t)}function w9(t){return new rr(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I9(t){return Ke(t=de(t,Ce)),new Qj(t,e=>rh(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E9(t,e){const n=Ke(t=de(t,Ce));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return zn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(s){const o=typeof s=="string"?function(u){try{return JSON.parse(u)}catch(h){throw new j(L.INVALID_ARGUMENT,"Failed to parse JSON: "+(h==null?void 0:h.message))}}(s):s,a=[];if(Array.isArray(o.indexes))for(const c of o.indexes){const u=dT(c,"collectionGroup"),h=[];if(Array.isArray(c.fields))for(const f of c.fields){const p=xp("setIndexConfiguration",dT(f,"fieldPath"));f.arrayConfig==="CONTAINS"?h.push(new Js(p,2)):f.order==="ASCENDING"?h.push(new Js(p,0)):f.order==="DESCENDING"&&h.push(new Js(p,1))}a.push(new ja(ja.UNKNOWN_ID,u,h,Ua.empty()))}return a}(e);return Aj(n,r)}function dT(t,e){if(typeof t[e]!="string")throw new j(L.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function T9(t){var i;t=de(t,Ce);const e=fT.get(t);if(e)return e;if(((i=Ke(t)._uninitializedComponentsProvider)==null?void 0:i._offline.kind)!=="persistent")return null;const r=new Xj(t);return fT.set(t,r),r}function A9(t){oP(t,!0)}function R9(t){oP(t,!1)}function S9(t){Sj(Ke(t._firestore)).then(e=>U("deleting all persistent cache indexes succeeded")).catch(e=>zn("deleting all persistent cache indexes failed",e))}function oP(t,e){Rj(Ke(t._firestore),e).then(n=>U(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>zn(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const fT=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b9(t){var r;const e=Ke(de(t.firestore,Ce)),n=(r=e._onlineComponents)==null?void 0:r.datastore.serializer;return n===void 0?null:yp(n,zt(t._query)).ft}function x9(t,e){var s;const n=HS(e,(o,a)=>new Sb(a,o.aggregateType,o._internalFieldPath)),r=Ke(de(t.firestore,Ce)),i=(s=r._onlineComponents)==null?void 0:s.datastore.serializer;return i===void 0?null:Fb(i,ub(t._query),n,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P9{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return Zv.instance.onExistenceFilterMismatch(e)}}class Zv{constructor(){this.Mc=new Map}static get instance(){return rd||(rd=new Zv,function(n){if(jc)throw new Error("a TestingHooksSpi instance is already set");jc=n}(rd)),rd}lt(e){this.Mc.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Mc;return r.set(n,e),()=>r.delete(n)}}let rd=null;(function(e,n=!0){(function(i){ul=i})(Ao),Bn(new Rn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Ce(new h4(r.getProvider("auth-internal")),new p4(o,r.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new j(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new co(u.options.projectId,h)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Bt(qI,HI,e),Bt(qI,HI,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP="firebasestorage.googleapis.com",lP="storageBucket",Zj=2*60*1e3,eU=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt extends Pn{constructor(e,n,r=0){super(qm(e),`Firebase Storage: ${n} (${qm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,tt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ze;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ze||(Ze={}));function qm(t){return"storage/"+t}function ew(){const t="An unknown error occurred, please check the error payload for server response.";return new tt(Ze.UNKNOWN,t)}function tU(t){return new tt(Ze.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function nU(t){return new tt(Ze.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function rU(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new tt(Ze.UNAUTHENTICATED,t)}function iU(){return new tt(Ze.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function sU(t){return new tt(Ze.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function oU(){return new tt(Ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function aU(){return new tt(Ze.CANCELED,"User canceled the upload/download.")}function lU(t){return new tt(Ze.INVALID_URL,"Invalid URL '"+t+"'.")}function cU(t){return new tt(Ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function uU(){return new tt(Ze.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+lP+"' property when initializing the app?")}function hU(){return new tt(Ze.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function dU(){return new tt(Ze.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function fU(t){return new tt(Ze.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ty(t){return new tt(Ze.INVALID_ARGUMENT,t)}function cP(){return new tt(Ze.APP_DELETED,"The Firebase app was deleted.")}function pU(t){return new tt(Ze.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bc(t,e){return new tt(Ze.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function sc(t){throw new tt(Ze.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=vn.makeFromUrl(e,n)}catch{return new vn(e,"")}if(r.path==="")return r;throw cU(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function u(V){V.path_=decodeURIComponent(V.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${h}/b/${i}/o${p}`,"i"),b={bucket:1,path:3},P=n===aP?"(?:storage.googleapis.com|storage.cloud.google.com)":n,C="([^?#]*)",E=new RegExp(`^https?://${P}/${i}/${C}`,"i"),R=[{regex:a,indices:c,postModify:s},{regex:v,indices:b,postModify:u},{regex:E,indices:{bucket:1,path:2},postModify:u}];for(let V=0;V<R.length;V++){const B=R[V],$=B.regex.exec(e);if($){const A=$[B.indices.bucket];let _=$[B.indices.path];_||(_=""),r=new vn(A,_),B.postModify(r);break}}if(r==null)throw lU(e);return r}}class mU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gU(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let u=!1;function h(...C){u||(u=!0,e.apply(null,C))}function f(C){i=setTimeout(()=>{i=null,t(v,c())},C)}function p(){s&&clearTimeout(s)}function v(C,...E){if(u){p();return}if(C){p(),h.call(null,C,...E);return}if(c()||o){p(),h.call(null,C,...E);return}r<64&&(r*=2);let R;a===1?(a=2,R=0):R=(r+Math.random())*1e3,f(R)}let b=!1;function P(C){b||(b=!0,p(),!u&&(i!==null?(C||(a=2),clearTimeout(i),f(0)):C||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,P(!0)},n),P}function yU(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _U(t){return t!==void 0}function vU(t){return typeof t=="object"&&!Array.isArray(t)}function tw(t){return typeof t=="string"||t instanceof String}function pT(t){return nw()&&t instanceof Blob}function nw(){return typeof Blob<"u"}function mT(t,e,n,r){if(r<e)throw Ty(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Ty(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function uP(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var to;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(to||(to={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IU{constructor(e,n,r,i,s,o,a,c,u,h,f,p=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,P)=>{this.resolve_=b,this.reject_=P,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new id(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===to.NO_ERROR,c=s.getStatus();if(!a||wU(c,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===to.ABORT;r(!1,new id(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new id(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());_U(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=ew();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){const c=this.appDelete_?cP():aU();o(c)}else{const c=oU();o(c)}};this.canceled_?n(!1,new id(!1,null,!0)):this.backoffId_=gU(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&yU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class id{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function EU(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function TU(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function AU(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RU(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function SU(t,e,n,r,i,s,o=!0,a=!1){const c=uP(t.urlParams),u=t.url+c,h=Object.assign({},t.headers);return AU(h,e),EU(h,n),TU(h,s),RU(h,r),new IU(u,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function xU(...t){const e=bU();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(nw())return new Blob(t);throw new tt(Ze.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function PU(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kU(t){if(typeof atob>"u")throw fU("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Hm{constructor(e,n){this.data=e,this.contentType=n||null}}function CU(t,e){switch(t){case gr.RAW:return new Hm(hP(e));case gr.BASE64:case gr.BASE64URL:return new Hm(dP(t,e));case gr.DATA_URL:return new Hm(DU(e),OU(e))}throw ew()}function hP(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function NU(t){let e;try{e=decodeURIComponent(t)}catch{throw Bc(gr.DATA_URL,"Malformed data URL.")}return hP(e)}function dP(t,e){switch(t){case gr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Bc(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case gr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Bc(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=kU(e)}catch(i){throw i.message.includes("polyfill")?i:Bc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class fP{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Bc(gr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=LU(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function DU(t){const e=new fP(t);return e.base64?dP(gr.BASE64,e.rest):NU(e.rest)}function OU(t){return new fP(t).contentType}function LU(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,n){let r=0,i="";pT(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(pT(this.data_)){const r=this.data_,i=PU(r,e,n);return i===null?null:new Mi(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Mi(r,!0)}}static getBlob(...e){if(nw()){const n=e.map(r=>r instanceof Mi?r.data_:r);return new Mi(xU.apply(null,n))}else{const n=e.map(o=>tw(o)?CU(gr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Mi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(t){let e;try{e=JSON.parse(t)}catch{return null}return vU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function MU(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function mP(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FU(t,e){return e}class Ht{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||FU}}let sd=null;function jU(t){return!tw(t)||t.length<2?t:mP(t)}function gP(){if(sd)return sd;const t=[];t.push(new Ht("bucket")),t.push(new Ht("generation")),t.push(new Ht("metageneration")),t.push(new Ht("name","fullPath",!0));function e(s,o){return jU(o)}const n=new Ht("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Ht("size");return i.xform=r,t.push(i),t.push(new Ht("timeCreated")),t.push(new Ht("updated")),t.push(new Ht("md5Hash",null,!0)),t.push(new Ht("cacheControl",null,!0)),t.push(new Ht("contentDisposition",null,!0)),t.push(new Ht("contentEncoding",null,!0)),t.push(new Ht("contentLanguage",null,!0)),t.push(new Ht("contentType",null,!0)),t.push(new Ht("metadata","customMetadata",!0)),sd=t,sd}function UU(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new vn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function BU(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return UU(r,t),r}function yP(t,e,n){const r=pP(e);return r===null?null:BU(t,r,n)}function $U(t,e,n,r){const i=pP(e);if(i===null||!tw(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const h=t.bucket,f=t.fullPath,p="/b/"+o(h)+"/o/"+o(f),v=rw(p,n,r),b=uP({alt:"media",token:u});return v+b})[0]}function zU(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class _P{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(t){if(!t)throw ew()}function qU(t,e){function n(r,i){const s=yP(t,i,e);return vP(s!==null),s}return n}function HU(t,e){function n(r,i){const s=yP(t,i,e);return vP(s!==null),$U(s,i,t.host,t._protocol)}return n}function wP(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=iU():i=rU():n.getStatus()===402?i=nU(t.bucket):n.getStatus()===403?i=sU(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function GU(t){const e=wP(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=tU(t.path)),s.serverResponse=i.serverResponse,s}return n}function WU(t,e,n){const r=e.fullServerUrl(),i=rw(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new _P(i,s,HU(t,n),o);return a.errorHandler=GU(e),a}function KU(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function QU(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=KU(null,e)),r}function YU(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let R="";for(let V=0;V<2;V++)R=R+Math.random().toString().slice(2);return R}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const u=QU(e,r,i),h=zU(u,n),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",v=Mi.getBlob(f,r,p);if(v===null)throw hU();const b={name:u.fullPath},P=rw(s,t.host,t._protocol),C="POST",E=t.maxUploadRetryTime,w=new _P(P,C,qU(t,n),E);return w.urlParams=b,w.headers=o,w.body=v.uploadData(),w.errorHandler=wP(e),w}class JU{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=to.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=to.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=to.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw sc("cannot .send() more than once");if(Xr(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw sc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw sc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw sc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw sc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class XU extends JU{initXhr(){this.xhr_.responseType="text"}}function IP(){return new XU}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,n){this._service=e,n instanceof vn?this._location=n:this._location=vn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new wo(e,n)}get root(){const e=new vn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return mP(this._location.path)}get storage(){return this._service}get parent(){const e=VU(this._location.path);if(e===null)return null;const n=new vn(this._location.bucket,e);return new wo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw pU(e)}}function ZU(t,e,n){t._throwIfRoot("uploadBytes");const r=YU(t.storage,t._location,gP(),new Mi(e,!0),n);return t.storage.makeRequestWithTokens(r,IP).then(i=>({metadata:i,ref:t}))}function e6(t){t._throwIfRoot("getDownloadURL");const e=WU(t.storage,t._location,gP());return t.storage.makeRequestWithTokens(e,IP).then(n=>{if(n===null)throw dU();return n})}function t6(t,e){const n=MU(t._location.path,e),r=new vn(t._location.bucket,n);return new wo(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){return/^[A-Za-z]+:\/\//.test(t)}function r6(t,e){return new wo(t,e)}function EP(t,e){if(t instanceof iw){const n=t;if(n._bucket==null)throw uU();const r=new wo(n,n._bucket);return e!=null?EP(r,e):r}else return e!==void 0?t6(t,e):t}function i6(t,e){if(e&&n6(e)){if(t instanceof iw)return r6(t,e);throw Ty("To use ref(service, url), the first argument must be a Storage instance.")}else return EP(t,e)}function gT(t,e){const n=e==null?void 0:e[lP];return n==null?null:vn.makeFromBucketSpec(n,t)}function s6(t,e,n,r={}){t.host=`${e}:${n}`;const i=Xr(e);i&&(Kf(`https://${t.host}/b`),__("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:j1(s,t.app.options.projectId))}class iw{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=aP,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Zj,this._maxUploadRetryTime=eU,this._requests=new Set,i!=null?this._bucket=vn.makeFromBucketSpec(i,this._host):this._bucket=gT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vn.makeFromBucketSpec(this._url,e):this._bucket=gT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){mT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){mT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Me(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new wo(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new mU(cP());{const o=SU(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const yT="@firebase/storage",_T="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP="storage";function Su(t,e,n){return t=J(t),ZU(t,e,n)}function bu(t){return t=J(t),e6(t)}function xu(t,e){return t=J(t),i6(t,e)}function o6(t=Lu(),e){t=J(t);const r=sr(t,TP).getImmediate({identifier:e}),i=V1("storage");return i&&a6(r,...i),r}function a6(t,e,n,r={}){s6(t,e,n,r)}function l6(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new iw(n,r,i,e,Ao)}function c6(){Bn(new Rn(TP,l6,"PUBLIC").setMultipleInstances(!0)),Bt(yT,_T,""),Bt(yT,_T,"esm2020")}c6();const u6={apiKey:"AIzaSyDexERfe7htllA1aq7vlbnyQAmfgjx6HnI",authDomain:"moomhe-6de30.firebaseapp.com",projectId:"moomhe-6de30",storageBucket:"moomhe-6de30.firebasestorage.app",messagingSenderId:"951714207506",appId:"1:951714207506:web:0e3a50f5d663095e4345cb",measurementId:"G-6PHVQNPHNL"},wl=K1(u6),h6=RO(wl),xi=a4(wl),Ur=Pj(wl),rl=o6(wl),d6=lL(wl,{backend:new Vu}),f6=cL(d6,{model:"gemini-2.5-flash-image-preview",generationConfig:{responseModalities:[pI.TEXT,pI.IMAGE]}});async function AP(t){return{inlineData:{data:await new Promise(n=>{const r=new FileReader;r.onloadend=()=>n(r.result.split(",")[1]),r.readAsDataURL(t)}),mimeType:t.type}}}async function p6(t){const n=await(await fetch(t)).blob();return new File([n],"image.jpg",{type:n.type})}async function RP(){try{return(await EV(xi)).user}catch(t){throw console.error("Error signing in:",t),t}}async function Ls(t){const e={uid:t.uid,lastActive:new Date,os:navigator.platform,userAgent:navigator.userAgent,createdAt:t.metadata.creationTime,isAnonymous:t.isAnonymous};try{return await Op(eo(Ur,"users",t.uid),e,{merge:!0}),e}catch(n){throw console.error("Error creating/updating user:",n),n}}function SP(t,e=200,n=200){return new Promise((r,i)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>{try{const o=document.createElement("canvas"),a=o.getContext("2d");let{width:c,height:u}=s;c>u?c>e&&(u=u*e/c,c=e):u>n&&(c=c*n/u,u=n),o.width=c,o.height=u,a.drawImage(s,0,0,c,u),o.toBlob(h=>{h?r(h):i(new Error("Failed to create thumbnail blob"))},"image/jpeg",.8)}catch(o){console.error("Error creating thumbnail:",o),i(o)}},s.onerror=()=>{i(new Error("Failed to load image for thumbnail creation"))},s.src=t})}async function m6(t,e,n){try{const i=await(await fetch(e)).blob();let s;try{s=await SP(e)}catch(P){console.warn("Failed to create thumbnail, using original image:",P),s=i}const o=Date.now(),a=`image_${o}.jpg`,c=`thumbnail_${o}.jpg`,u=xu(rl,`userHistory/${t}/${a}`),h=await Su(u,i),f=await bu(h.ref),p=xu(rl,`userHistory/${t}/${c}`),v=await Su(p,s),b=await bu(v.ref);return{downloadURL:f,thumbnailURL:b,filename:a,thumbnailFilename:c,timestamp:o}}catch(r){throw console.error("Error uploading image:",r),r}}async function g6(t,e){try{const n=await new Promise(b=>{const P=new FileReader;P.onload=()=>b(P.result),P.readAsDataURL(e)});let r;try{r=await SP(n)}catch(b){console.warn("Failed to create thumbnail, using original image:",b),r=e}const i=Date.now(),s=e.name.split(".").pop()||"jpg",o=`upload_${i}.${s}`,a=`upload_thumbnail_${i}.jpg`,c=xu(rl,`userHistory/${t}/${o}`),u=await Su(c,e),h=await bu(u.ref),f=xu(rl,`userHistory/${t}/${a}`),p=await Su(f,r),v=await bu(p.ref);return{downloadURL:h,thumbnailURL:v,filename:o,thumbnailFilename:a,timestamp:i}}catch(n){throw console.error("Error uploading user image:",n),n}}async function y6(t,e){try{const{downloadURL:n,thumbnailURL:r,filename:i,thumbnailFilename:s,timestamp:o}=await m6(t,e.imageUrl,e.prompt),a={storageUrl:n,thumbnailUrl:r,filename:i,thumbnailFilename:s,prompt:e.prompt,timestamp:e.timestamp,createdAt:new Date,userId:t,type:"generated"},c=eo(Zu(Ur,"userHistory"));return await Op(c,a),{id:c.id,...a}}catch(n){throw console.error("Error saving image to history:",n),n}}async function bP(t,e,n=""){try{const{downloadURL:r,thumbnailURL:i,filename:s,thumbnailFilename:o,timestamp:a}=await g6(t,e),c={storageUrl:r,thumbnailUrl:i,filename:s,thumbnailFilename:o,prompt:n||`Uploaded: ${e.name}`,timestamp:new Date().toLocaleString("he-IL"),createdAt:new Date,userId:t,type:"uploaded"},u=eo(Zu(Ur,"userHistory"));return await Op(u,c),{id:u.id,...c}}catch(r){throw console.error("Error saving upload to history:",r),r}}async function _6(t){try{const e=Zu(Ur,"userHistory"),n=Xx(e,Zx("createdAt","desc")),r=await sP(n),i=[];return r.forEach(s=>{const o=s.data();if(o.userId===t&&!o.isError){const a={id:s.id,...o};o.result&&o.result.storageUrl&&(a.storageUrl=o.result.storageUrl,a.thumbnailUrl=o.result.thumbnailUrl,a.filename=o.result.filename,a.thumbnailFilename=o.result.thumbnailFilename),o.objects&&(a.objects=o.objects),i.push(a)}}),i}catch(e){return console.error("Error loading user history:",e),[]}}async function ia(t,e=1,n=5){try{const r=Zu(Ur,"userHistory"),i=Xx(r,Zx("createdAt","desc")),s=await sP(i),o=[];s.forEach(f=>{const p=f.data();if(p.userId===t&&!p.isError){const v={id:f.id,...p};p.result&&p.result.storageUrl&&(v.storageUrl=p.result.storageUrl,v.thumbnailUrl=p.result.thumbnailUrl,v.filename=p.result.filename,v.thumbnailFilename=p.result.thumbnailFilename),p.objects&&(v.objects=p.objects),o.push(v)}});const a=(e-1)*n,c=e*n,u=o.slice(a,c),h=c<o.length;return{history:u,hasMore:h}}catch(r){return console.error("Error loading paginated user history:",r),{history:[],hasMore:!1}}}async function xP(t,e){try{const r=await(await fetch(e)).blob(),i=Date.now(),s=`temp_${i}.jpg`,o=xu(rl,`temp/${t}/${s}`),a=await Su(o,r),c=await bu(a.ref);return setTimeout(()=>{try{console.log(" Cleanup scheduled for temporary file:",s)}catch(u){console.error("Error during cleanup:",u)}},36e5),{downloadURL:c,filename:s,timestamp:i}}catch(n){throw console.error("Error uploading image for sharing:",n),n}}const v6=Object.freeze(Object.defineProperty({__proto__:null,analytics:h6,app:wl,auth:xi,createOrUpdateUser:Ls,db:Ur,fileToGenerativePart:AP,loadUserHistory:_6,loadUserHistoryPaginated:ia,model:f6,saveImageToHistory:y6,saveUploadToHistory:bP,signInUser:RP,storage:rl,uploadImageForSharing:xP,urlToFile:p6},Symbol.toStringTag,{value:"Module"}));class w6{constructor(){Pw(this,"waitForRequestCompletion",async(e,n=6e4)=>new Promise((r,i)=>{const s=setTimeout(()=>{this.activeRequests.delete(e),i(new Error("Request timeout"))},n),o=Ey(eo(Ur,"userHistory",e),a=>{if(!a.exists()){clearTimeout(s),o(),i(new Error("Request document not found"));return}const c=a.data();c.isDone&&(clearTimeout(s),o(),this.activeRequests.delete(e),c.isError?i(new Error(c.error||"Request failed")):r(c.result))},a=>{clearTimeout(s),o(),this.activeRequests.delete(e),i(a)});this.activeRequests.set(e,o)}));this.activeRequests=new Map}async submitImageGenerationRequest(e,n,r,i=null){try{const s=await e.getIdToken(),o={type:"request",requestType:"imageGeneration",userId:e.uid,authToken:s,prompt:n,imageData:r,objectImageData:i,isDone:!1,isError:!1,createdAt:new Date},a=eo(Zu(Ur,"userHistory"));return await Op(a,o),a.id}catch(s){throw console.error("Error submitting image generation request:",s),s}}async submitObjectDetectionRequest(e,n,r=null){try{const i=await e.getIdToken(),s=await fetch("https://us-central1-moomhe-6de30.cloudfunctions.net/detectObjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageData:n,authToken:i,historyId:r})});if(!s.ok){const a=await s.json();throw new Error(a.error||"Object detection failed")}const o=await s.json();if(!o.success)throw new Error(o.error||"Object detection failed");return o}catch(i){throw console.error("Error submitting object detection request:",i),i}}cancelRequest(e){const n=this.activeRequests.get(e);n&&(n(),this.activeRequests.delete(e))}async getUserGenerationCount(e){try{const n=new Date,r=`${String(n.getMonth()+1).padStart(2,"0")}-${n.getFullYear()}`,i=eo(Ur,"genCount",r,"users",e),s=await jj(i);if(s.exists()){const o=s.data();return{count:o.count||0,limit:o.limit||50}}else return{count:0,limit:50}}catch(n){return console.error("Error getting user generation count:",n),{count:0,limit:50}}}async canMakeRequest(e){const{count:n,limit:r}=await this.getUserGenerationCount(e);return n<r}}const Zo=new w6;function I6(){var Vl,Ml,vh;const[t,e]=ie.useState("  "),[n,r]=ie.useState(null),[i,s]=ie.useState("/assets/design_img.jpg"),[o,a]=ie.useState(!1),[c,u]=ie.useState(!1),[h,f]=ie.useState(!1),[p,v]=ie.useState(!1),[b,P]=ie.useState(!1),[C,E]=ie.useState(!1),[w,R]=ie.useState(!1),[V,B]=ie.useState(!1),[$,A]=ie.useState(!1),[_,S]=ie.useState([]),[T,k]=ie.useState(null),[N,x]=ie.useState(!1),[Rt,Jt]=ie.useState(!1),[ws,kn]=ie.useState(!1),[K,te]=ie.useState([]),[oe,be]=ie.useState(!1),[ye,xe]=ie.useState(null),[ht,Nt]=ie.useState(""),[Cn,Dt]=ie.useState(16/9),[ih,Lp]=ie.useState(""),[Ar,Rr]=ie.useState(null),[qn,oi]=ie.useState(null),[ai,Is]=ie.useState(!1),[sh,li]=ie.useState(1),[Il,or]=ie.useState(!0),[ci,Do]=ie.useState(!1),[oh,Oo]=ie.useState(!1),[El,Sr]=ie.useState(!1),[dn,Qe]=ie.useState("signup"),[Pe,ui]=ie.useState(""),[Lo,Vo]=ie.useState(""),[br,xr]=ie.useState(""),[Tl,Al]=ie.useState(!1),[Mo,ah]=ie.useState(!1),lh=ie.useRef(null),fn=ie.useRef(null),ch=ie.useRef(null);ie.useEffect(()=>{const I=VV(xi,async F=>{if(F){k(F),x(!0),await Ls(F),Jt(!0);try{const Q=await ia(F.uid,1,5);S(Q.history),or(Q.hasMore)}finally{Jt(!1)}}else try{const Q=await RP();k(Q),x(!0),await Ls(Q)}catch(Q){console.error("Failed to sign in anonymously:",Q)}});return()=>I()},[]),ie.useEffect(()=>{if(!(window.innerWidth<1024)){const F=Es[t]||[];te(F),console.log("Loaded default objects for category:",t,F)}},[t]);const Rl=["  "," ","  "," "," "," ",""],hi={"  ":Gh," ":$0," ":Xl," ":SN," ":_m,"  ":EN,:AN},Sl={"  ":"/assets/design_img.jpg"," ":"/assets/balcony_img.jpg"," ":"/assets/makeup_img.jpg"," ":"/assets/product_img.jpg"," ":"/assets/profile_img.jpg","  ":"/assets/car_img.jpg",:"/assets/tattoo_img.jpg"},Es={"  ":[" "," "," ","  ","  "," "," "," "," "," "," "," "]," ":[" '"," "," "," "," ","  ","  "," "," "," "," "," "]," ":["  "," "," "," "]," ":[" "," "]," ":[" "," ","' '"," "," "],"  ":[" "," "," "," "," "," "],:[" "," "," "," ''"," "]},ar={"  ":[{name:" ",action:()=>R(!w),icon:IN},{name:"/",action:()=>E(!C),icon:Ii},{name:" ",action:()=>u(!c),icon:Zt},{name:"",action:()=>f(!h),icon:xs},{name:"",action:()=>v(!p),icon:RN},{name:"",action:()=>P(!b),icon:bN},{name:"/",action:()=>B(!V),icon:Gh},{name:"",action:()=>A(!$),icon:TN}]," ":[{name:" ",action:()=>R(!w),icon:Zt},{name:"/",action:()=>E(!C),icon:Ii},{name:" ",action:()=>u(!c),icon:Zt},{name:"",action:()=>f(!h),icon:xs},{name:" ",action:()=>Ie("Add beautiful plants and flowers to this garden"),icon:$0},{name:" ",action:()=>Ie("Enhance the outdoor lighting"),icon:Dn}],"  ":[{name:" ",action:()=>R(!w),icon:Zt},{name:"/",action:()=>E(!C),icon:Ii},{name:" ",action:()=>u(!c),icon:Zt},{name:"",action:()=>f(!h),icon:xs},{name:" ",action:()=>Ie("Enhance the lighting and reflections on this vehicle"),icon:Dn},{name:" ",action:()=>Ie("Add accessories and modifications to this vehicle"),icon:Go}],:[{name:" ",action:()=>R(!w),icon:Zt},{name:"/",action:()=>E(!C),icon:Ii},{name:" ",action:()=>u(!c),icon:Zt},{name:"",action:()=>f(!h),icon:xs},{name:" ",action:()=>Ie("Enhance the lighting to show the tattoo details"),icon:Dn},{name:" ",action:()=>Ie("Add more details and shading to this tattoo"),icon:Go}]," ":[{name:" ",action:()=>R(!w),icon:Zt},{name:"/",action:()=>E(!C),icon:Ii},{name:" ",action:()=>u(!c),icon:Zt},{name:"",action:()=>f(!h),icon:xs},{name:" ",action:()=>Ie("Enhance the lighting for better makeup visibility"),icon:Dn},{name:" ",action:()=>Ie("Add more makeup and beauty enhancements"),icon:Xl}]," ":[{name:" ",action:()=>R(!w),icon:Zt},{name:"/",action:()=>E(!C),icon:Ii},{name:" ",action:()=>u(!c),icon:Zt},{name:"",action:()=>f(!h),icon:xs},{name:" ",action:()=>Ie("Enhance the product lighting and presentation"),icon:Dn},{name:" ",action:()=>Ie("Add product details and features"),icon:Go}]," ":[{name:" ",action:()=>R(!w),icon:Zt},{name:"/",action:()=>E(!C),icon:Ii},{name:" ",action:()=>u(!c),icon:Zt},{name:"",action:()=>f(!h),icon:xs},{name:" ",action:()=>Ie("Enhance the portrait lighting"),icon:Dn},{name:" ",action:()=>Ie("Add a professional background"),icon:Go}]},uh=async I=>{const F=I.target.files[0];if(F){const Q=new FileReader;Q.onload=async re=>{if(r(re.target.result),s(re.target.result),Dt(16/9),xe(null),N&&T){Jt(!0);try{const ne=await bP(T.uid,F,`Uploaded: ${F.name}`),ae=ne.id;console.log("Upload result ID:",ae),console.log("Upload result:",ne);const Oe=await ia(T.uid,1,5);S(Oe.history),li(1),or(Oe.hasMore),xe(ae),console.log("Set current history ID to newly uploaded image:",ae),console.log("Current history after reload:",Oe.history.map(nt=>({id:nt.id,prompt:nt.prompt}))),window.innerWidth<1024||(console.log("About to detect objects for history ID:",ae),Uo(re.target.result,ae))}catch(ne){console.error("Failed to save upload to Firebase:",ne)}finally{Jt(!1)}}else if(!(window.innerWidth<1024)){const ae=Es[t]||[];te(ae)}},Q.readAsDataURL(F)}},Ts=()=>{lh.current.click()},bl=async()=>{try{let I=i;if(I.startsWith("https://firebasestorage.googleapis.com/")){const F=document.createElement("a");F.href=I,F.download="moomhe-design.png",F.target="_blank",document.body.appendChild(F),F.click(),document.body.removeChild(F)}else{const Q=await(await fetch(I)).blob(),re=window.URL.createObjectURL(Q),ne=document.createElement("a");ne.href=re,ne.download="moomhe-design.png",document.body.appendChild(ne),ne.click(),document.body.removeChild(ne),window.URL.revokeObjectURL(re)}}catch(I){console.error("Download failed:",I);try{window.open(i,"_blank")}catch(F){console.error("Fallback download also failed:",F),alert("  .  .")}}},di=async()=>{try{let I=i;const F=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(I.startsWith("data:"))try{a(!0);const{downloadURL:Q}=await xP((T==null?void 0:T.uid)||"anonymous",I);I=Q,console.log(" Image uploaded to temporary storage:",Q)}catch(Q){console.error("Error uploading image to Firebase:",Q),alert("  .  .");return}finally{a(!1)}if(F){const Q=`whatsapp://send?text=    MoomHe: ${encodeURIComponent(I)}`;window.open(Q,"_blank")}else{const Q=`https://web.whatsapp.com/send?text=    MoomHe: ${encodeURIComponent(I)}`;window.open(Q,"_blank")}}catch(I){console.error("WhatsApp share failed:",I),alert("  .  .")}},xl=I=>{e(I);const F=Sl[I];if(F&&(s(F),Dt(16/9),xe(null),!(window.innerWidth<1024))){const re=Es[I]||[];te(re),console.log("Loaded default objects for category:",I,re)}},yt=I=>{const F=I.storageUrl||I.imageUrl;if(s(F),Dt(16/9),xe(I.id),I.objects){let Q=I.objects;if(Array.isArray(I.objects)&&I.objects.length>0){const re=I.objects[0];typeof re=="string"&&re.includes(",")&&(Q=re.split(",").map(ne=>ne.trim()).filter(ne=>ne.length>0))}else typeof I.objects=="string"&&(Q=I.objects.split(",").map(re=>re.trim()).filter(re=>re.length>0));Q.length>0?(te(Q),console.log("Loaded objects from history entry:",Q)):(te([]),console.log("No valid objects found in history entry"))}else te([]),console.log("No objects field in history entry")},Pl=()=>{o||kn(!0)},fi=I=>{const F=I.target,Q=F.naturalWidth/F.naturalHeight;Dt(Q)},pi=async I=>{const F=I.target.files[0];if(F){const Q=new FileReader;Q.onload=re=>{Rr(re.target.result),oi(F)},Q.readAsDataURL(F)}},hh=()=>{fn.current.click()},dh=()=>{Rr(null),oi(null),fn.current&&(fn.current.value="")},mi=async I=>{if(I.preventDefault(),!(!Pe||!br)){if(dn==="signup"&&Pe!==Lo){alert("   .  .");return}Al(!0);try{if(dn==="signup")if(T&&T.isAnonymous){const{linkWithCredential:Q,EmailAuthProvider:re}=await wi(()=>import("./index.esm-021345a4.js"),[]),ne=re.credential(Pe,br);try{const ae=await Q(T,ne);await Ls(ae.user),alert("  !    .")}catch(ae){if(ae.code==="auth/email-already-in-use"){const{createUserWithEmailAndPassword:Oe}=await wi(()=>import("./index.esm-021345a4.js"),[]),ot=await Oe(xi,Pe,br);await Mp(T.uid,ot.user.uid),await Ls(ot.user),alert("  !      .")}else throw ae}}else{const{createUserWithEmailAndPassword:Q}=await wi(()=>import("./index.esm-021345a4.js"),[]),re=await Q(xi,Pe,br);await Ls(re.user),alert("  !")}else{const{signInWithEmailAndPassword:F}=await wi(()=>import("./index.esm-021345a4.js"),[]),Q=await F(xi,Pe,br);await Ls(Q.user),alert(" !")}Oo(!1),ui(""),Vo(""),xr(""),Qe("signup")}catch(F){console.error("Authentication error:",F),F.code==="auth/email-already-in-use"?(alert("   .   ."),Qe("login")):F.code==="auth/user-not-found"?(alert("  .    ."),Qe("signup")):F.code==="auth/wrong-password"?alert(" .  ."):F.code==="auth/weak-password"?alert("  .     6 ."):alert(" .  .")}finally{Al(!1)}}},Vp=async()=>{if(!Pe){alert("    .");return}ah(!0);try{const{sendPasswordResetEmail:I}=await wi(()=>import("./index.esm-021345a4.js"),[]);await I(xi,Pe),alert("     .")}catch(I){console.error("Password reset error:",I),I.code==="auth/user-not-found"?alert("    ."):alert("   .  .")}finally{ah(!1)}},Mp=async(I,F)=>{try{const{collection:Q,query:re,where:ne,getDocs:ae,doc:Oe,setDoc:ot,deleteDoc:nt}=await wi(()=>import("./index.esm-1b688088.js"),[]),{db:ve}=await wi(()=>Promise.resolve().then(()=>v6),void 0),Xt=Q(ve,"userHistory"),Gn=re(Xt,ne("userId","==",I)),Nn=await ae(Gn),Fl=[];if(Nn.forEach(gi=>{const wh=gi.data();wh.userId=F;const Up=Oe(Q(ve,"userHistory"));Fl.push(ot(Up,wh)),Fl.push(nt(gi.ref))}),await Promise.all(Fl),console.log(`Migrated ${Nn.size} history entries from ${I} to ${F}`),N){const gi=await ia(F,1,5);S(gi.history),li(1),or(gi.hasMore)}}catch(Q){console.error("Error migrating user data:",Q)}},Fo=async()=>{try{const{signOut:I}=await wi(()=>import("./index.esm-021345a4.js"),[]);await I(xi),S([]),te([]),k(null),x(!1),Sr(!1),window.location.reload()}catch(I){console.error("Logout error:",I),alert(" .  .")}},kl=async()=>{if(!(!N||!T||ci||!Il)){Do(!0);try{const I=sh+1,F=await ia(T.uid,I,5);F.history.length>0?(S(Q=>[...Q,...F.history]),li(I),or(F.hasMore)):or(!1)}catch(I){console.error("Failed to load more history:",I)}finally{Do(!1)}}};ie.useEffect(()=>{const I=F=>{ai&&!F.target.closest(".mobile-dropdown")&&Is(!1)};return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[ai]);const jo=I=>{const F=String(I.getDate()).padStart(2,"0"),Q=String(I.getMonth()+1).padStart(2,"0"),re=String(I.getFullYear()).slice(-2);return`${F}/${Q}/${re}`},As=I=>{if(/^\d{2}\/\d{2}\/\d{2}$/.test(I))return I;try{const F=new Date(I);if(!isNaN(F.getTime()))return jo(F)}catch{console.warn("Failed to parse timestamp:",I)}return I},Hn=()=>{kn(!1)},fh=I=>{Ie(I)},Rs=async()=>{if(ht.trim()){if(N&&T&&!await Zo.canMakeRequest(T.uid)){alert("   .    .");return}a(!0);try{const I=ht;let F=I;qn&&(F=`  , ${I}`),console.log(" Final prompt for AI:",F),await Ll(F),Nt(""),Rr(null),oi(null),fn.current&&(fn.current.value="")}catch(I){console.error("Custom prompt failed:",I),alert("  .  .")}finally{a(!1)}}},Cl=async I=>{if(I){if(!ye){console.log("No current history ID available for object detection");return}return console.log("detectObjects called with currentHistoryId:",ye),console.log("detectObjects called with imageUrl:",I),Uo(I,ye)}},Uo=async(I,F)=>{if(!(!I||!F)){console.log("detectObjectsWithId called with historyId:",F),console.log("detectObjectsWithId called with imageUrl:",I),be(!0);try{if(N&&T&&!await Zo.canMakeRequest(T.uid)){alert("   .    ."),be(!1);return}let Q=I;if(I.startsWith("/assets/")||I.startsWith("./assets/"))try{const ae=await(await fetch(I)).blob();Q=await new Promise(ot=>{const nt=new FileReader;nt.onload=()=>ot(nt.result),nt.readAsDataURL(ae)})}catch(ne){throw console.error("Error converting local image to data URL:",ne),new Error("Failed to load the image for object detection")}console.log("Submitting object detection request for history ID:",F);const re=await Zo.submitObjectDetectionRequest(T,Q,F);if(console.log("Object detection result:",re),console.log("Objects will be saved to history ID:",F),re&&re.objects){console.log("Raw objects from server:",re.objects),console.log("Type of objects:",typeof re.objects);let ne=re.objects;if(Array.isArray(re.objects)&&re.objects.length>0){console.log("Objects is array, checking first element...");const ae=re.objects[0];typeof ae=="string"&&ae.includes(",")?(console.log("First element is comma-separated string, parsing..."),ne=ae.split(",").map(Oe=>Oe.trim()).filter(Oe=>Oe.length>0),console.log("Parsed objects array:",ne)):console.log("Using array as-is:",ne)}else typeof re.objects=="string"?(console.log("Parsing string objects..."),ne=re.objects.split(",").map(ae=>ae.trim()).filter(ae=>ae.length>0),console.log("Parsed objects array:",ne)):console.log("Objects is already an array:",ne);te(ne),console.log("Final detected objects:",ne),F&&_.length>0&&(S(ae=>ae.map(Oe=>Oe.id===F?{...Oe,objects:ne}:Oe)),console.log("Updated local imageHistory with detected objects for ID:",F,ne))}else te([])}catch(Q){console.error("Object detection failed:",Q),te([]),alert("  .  .")}finally{be(!1)}}},ph={:"#C1121C",:"#FF7514",:"#E5BE01",:"#287233",:"#1E2460",:"#6D3F5B",:"#78858B"," ":"#F4F4F4"},Nl={:[{name:"Flame red",value:"flame red",hex:"#C1121C",ral:"RAL 3000"},{name:"Signal red",value:"signal red",hex:"#A52019",ral:"RAL 3001"},{name:"Carmine red",value:"carmine red",hex:"#A2231D",ral:"RAL 3002"},{name:"Ruby red",value:"ruby red",hex:"#9B111E",ral:"RAL 3003"},{name:"Purple red",value:"purple red",hex:"#75151E",ral:"RAL 3004"},{name:"Wine red",value:"wine red",hex:"#5E2129",ral:"RAL 3005"},{name:"Black red",value:"black red",hex:"#412227",ral:"RAL 3007"},{name:"Oxide red",value:"oxide red",hex:"#642424",ral:"RAL 3009"},{name:"Brown red",value:"brown red",hex:"#781F19",ral:"RAL 3011"},{name:"Beige red",value:"beige red",hex:"#C1876B",ral:"RAL 3012"},{name:"Tomato red",value:"tomato red",hex:"#A12312",ral:"RAL 3013"},{name:"Antique pink",value:"antique pink",hex:"#D36E70",ral:"RAL 3014"},{name:"Light pink",value:"light pink",hex:"#EA899A",ral:"RAL 3015"},{name:"Coral red",value:"coral red",hex:"#B32821",ral:"RAL 3016"},{name:"Rose",value:"rose",hex:"#E63244",ral:"RAL 3017"},{name:"Strawberry red",value:"strawberry red",hex:"#D53032",ral:"RAL 3018"},{name:"Traffic red",value:"traffic red",hex:"#CC0605",ral:"RAL 3020"},{name:"Salmon pink",value:"salmon pink",hex:"#D95030",ral:"RAL 3022"},{name:"Raspberry red",value:"raspberry red",hex:"#C51D34",ral:"RAL 3027"},{name:"Orient red",value:"orient red",hex:"#B32428",ral:"RAL 3031"}],:[{name:"Red orange",value:"red orange",hex:"#C93C20",ral:"RAL 2001"},{name:"Vermilion",value:"vermilion",hex:"#CB2821",ral:"RAL 2002"},{name:"Pastel orange",value:"pastel orange",hex:"#FF7514",ral:"RAL 2003"},{name:"Pure orange",value:"pure orange",hex:"#F44611",ral:"RAL 2004"},{name:"Bright red orange",value:"bright red orange",hex:"#F75E25",ral:"RAL 2008"},{name:"Traffic orange",value:"traffic orange",hex:"#F54021",ral:"RAL 2009"},{name:"Signal orange",value:"signal orange",hex:"#D84B20",ral:"RAL 2010"},{name:"Deep orange",value:"deep orange",hex:"#EC7C26",ral:"RAL 2011"},{name:"Salmon range",value:"salmon range",hex:"#E55137",ral:"RAL 2012"}],:[{name:"Green beige",value:"green beige",hex:"#BEBD7F",ral:"RAL 1000"},{name:"Beige",value:"beige",hex:"#C2B078",ral:"RAL 1001"},{name:"Sand yellow",value:"sand yellow",hex:"#C6A664",ral:"RAL 1002"},{name:"Signal yellow",value:"signal yellow",hex:"#E5BE01",ral:"RAL 1003"},{name:"Golden yellow",value:"golden yellow",hex:"#CDA434",ral:"RAL 1004"},{name:"Honey yellow",value:"honey yellow",hex:"#A98307",ral:"RAL 1005"},{name:"Maize yellow",value:"maize yellow",hex:"#E4A010",ral:"RAL 1006"},{name:"Daffodil yellow",value:"daffodil yellow",hex:"#DC9D00",ral:"RAL 1007"},{name:"Brown beige",value:"brown beige",hex:"#8A6642",ral:"RAL 1011"},{name:"Lemon yellow",value:"lemon yellow",hex:"#C7B446",ral:"RAL 1012"},{name:"Oyster white",value:"oyster white",hex:"#EAE6CA",ral:"RAL 1013"},{name:"Ivory",value:"ivory",hex:"#E1CC4F",ral:"RAL 1014"},{name:"Light ivory",value:"light ivory",hex:"#E6D690",ral:"RAL 1015"},{name:"Sulfur yellow",value:"sulfur yellow",hex:"#EDFF21",ral:"RAL 1016"},{name:"Saffron yellow",value:"saffron yellow",hex:"#F5D033",ral:"RAL 1017"},{name:"Zinc yellow",value:"zinc yellow",hex:"#F8F32B",ral:"RAL 1018"},{name:"Grey beige",value:"grey beige",hex:"#a28f7a",ral:"RAL 1019"},{name:"Olive yellow",value:"olive yellow",hex:"#999950",ral:"RAL 1020"},{name:"Rape yellow",value:"rape yellow",hex:"#F3DA0B",ral:"RAL 1021"},{name:"Traffic yellow",value:"traffic yellow",hex:"#FAD201",ral:"RAL 1023"},{name:"Ochre yellow",value:"ochre yellow",hex:"#AEA04B",ral:"RAL 1024"},{name:"Curry",value:"curry",hex:"#9D9101",ral:"RAL 1027"},{name:"Melon yellow",value:"melon yellow",hex:"#F4A900",ral:"RAL 1028"},{name:"Broom yellow",value:"broom yellow",hex:"#D6AE01",ral:"RAL 1032"},{name:"Dahlia yellow",value:"dahlia yellow",hex:"#F3A505",ral:"RAL 1033"},{name:"Pastel yellow",value:"pastel yellow",hex:"#EFA94A",ral:"RAL 1034"},{name:"Sun yellow",value:"sun yellow",hex:"#F39F18",ral:"RAL 1037"}],:[{name:"Patina green",value:"patina green",hex:"#316650",ral:"RAL 6000"},{name:"Emerald green",value:"emerald green",hex:"#287233",ral:"RAL 6001"},{name:"Leaf green",value:"leaf green",hex:"#2D572C",ral:"RAL 6002"},{name:"Olive green",value:"olive green",hex:"#424632",ral:"RAL 6003"},{name:"Blue green",value:"blue green",hex:"#1F3A3D",ral:"RAL 6004"},{name:"Moss green",value:"moss green",hex:"#2F4538",ral:"RAL 6005"},{name:"Bottle green",value:"bottle green",hex:"#343B29",ral:"RAL 6007"},{name:"Brown green",value:"brown green",hex:"#39352A",ral:"RAL 6008"},{name:"Fir green",value:"fir green",hex:"#31372B",ral:"RAL 6009"},{name:"Grass green",value:"grass green",hex:"#35682D",ral:"RAL 6010"},{name:"Reseda green",value:"reseda green",hex:"#587246",ral:"RAL 6011"},{name:"Black green",value:"black green",hex:"#343E40",ral:"RAL 6012"},{name:"Reed green",value:"reed green",hex:"#6C7156",ral:"RAL 6013"},{name:"Yellow olive",value:"yellow olive",hex:"#47402E",ral:"RAL 6014"},{name:"Black olive",value:"black olive",hex:"#3B3C36",ral:"RAL 6015"},{name:"Turquoise green",value:"turquoise green",hex:"#1E5945",ral:"RAL 6016"},{name:"May green",value:"may green",hex:"#4C9141",ral:"RAL 6017"},{name:"Yellow green",value:"yellow green",hex:"#57A639",ral:"RAL 6018"},{name:"Pastel green",value:"pastel green",hex:"#BDECB6",ral:"RAL 6019"},{name:"Chrome green",value:"chrome green",hex:"#2E3A23",ral:"RAL 6020"},{name:"Pale green",value:"pale green",hex:"#89AC76",ral:"RAL 6021"},{name:"Olive drab",value:"olive drab",hex:"#25221B",ral:"RAL 6022"},{name:"Traffic green",value:"traffic green",hex:"#308446",ral:"RAL 6024"},{name:"Fern green",value:"fern green",hex:"#3D642D",ral:"RAL 6025"},{name:"Opal green",value:"opal green",hex:"#015D52",ral:"RAL 6026"},{name:"Light green",value:"light green",hex:"#84C3BE",ral:"RAL 6027"},{name:"Pine green",value:"pine green",hex:"#2C5545",ral:"RAL 6028"},{name:"Mint green",value:"mint green",hex:"#20603D",ral:"RAL 6029"},{name:"Signal green",value:"signal green",hex:"#317F43",ral:"RAL 6032"},{name:"Mint turquoise",value:"mint turquoise",hex:"#497E76",ral:"RAL 6033"},{name:"Pastel turquoise",value:"pastel turquoise",hex:"#7FB5B5",ral:"RAL 6034"}],:[{name:"Violet blue",value:"violet blue",hex:"#354D73",ral:"RAL 5000"},{name:"Green blue",value:"green blue",hex:"#1F3438",ral:"RAL 5001"},{name:"Ultramarine blue",value:"ultramarine blue",hex:"#20214F",ral:"RAL 5002"},{name:"Saphire blue",value:"saphire blue",hex:"#1D1E33",ral:"RAL 5003"},{name:"Black blue",value:"black blue",hex:"#18171C",ral:"RAL 5004"},{name:"Signal blue",value:"signal blue",hex:"#1E2460",ral:"RAL 5005"},{name:"Brillant blue",value:"brillant blue",hex:"#3E5F8A",ral:"RAL 5007"},{name:"Grey blue",value:"grey blue",hex:"#26252D",ral:"RAL 5008"},{name:"Azure blue",value:"azure blue",hex:"#225f78",ral:"RAL 5009"},{name:"Gentian blue",value:"gentian blue",hex:"#0E294B",ral:"RAL 5010"},{name:"Steel blue",value:"steel blue",hex:"#231A24",ral:"RAL 5011"},{name:"Light blue",value:"light blue",hex:"#3B83BD",ral:"RAL 5012"},{name:"Cobalt blue",value:"cobalt blue",hex:"#1E213D",ral:"RAL 5013"},{name:"Pigeon blue",value:"pigeon blue",hex:"#606E8C",ral:"RAL 5014"},{name:"Sky blue",value:"sky blue",hex:"#2271B3",ral:"RAL 5015"},{name:"Traffic blue",value:"traffic blue",hex:"#063971",ral:"RAL 5017"},{name:"Turquoise blue",value:"turquoise blue",hex:"#3F888F",ral:"RAL 5018"},{name:"Capri blue",value:"capri blue",hex:"#1B5583",ral:"RAL 5019"},{name:"Ocean blue",value:"ocean blue",hex:"#1D334A",ral:"RAL 5020"},{name:"Water blue",value:"water blue",hex:"#256D7B",ral:"RAL 5021"},{name:"Night blue",value:"night blue",hex:"#252850",ral:"RAL 5022"},{name:"Distant blue",value:"distant blue",hex:"#49678D",ral:"RAL 5023"},{name:"Pastel blue",value:"pastel blue",hex:"#5D9B9B",ral:"RAL 5024"}],:[{name:"Red lilac",value:"red lilac",hex:"#6D3F5B",ral:"RAL 4001"},{name:"Red violet",value:"red violet",hex:"#922B3E",ral:"RAL 4002"},{name:"Heather violet",value:"heather violet",hex:"#DE4C8A",ral:"RAL 4003"},{name:"Claret violet",value:"claret violet",hex:"#641C34",ral:"RAL 4004"},{name:"Blue lilac",value:"blue lilac",hex:"#6C4675",ral:"RAL 4005"},{name:"Traffic purple",value:"traffic purple",hex:"#A03472",ral:"RAL 4006"},{name:"Purple violet",value:"purple violet",hex:"#4A192C",ral:"RAL 4007"},{name:"Signal violet",value:"signal violet",hex:"#924E7D",ral:"RAL 4008"},{name:"Pastel violet",value:"pastel violet",hex:"#A18594",ral:"RAL 4009"},{name:"Telemagenta",value:"telemagenta",hex:"#CF3476",ral:"RAL 4010"}],:[{name:"Squirrel grey",value:"squirrel grey",hex:"#78858B",ral:"RAL 7000"},{name:"Silver grey",value:"silver grey",hex:"#8A9597",ral:"RAL 7001"},{name:"Olive grey",value:"olive grey",hex:"#7E7B52",ral:"RAL 7002"},{name:"Moss grey",value:"moss grey",hex:"#6C7059",ral:"RAL 7003"},{name:"Signal grey",value:"signal grey",hex:"#969992",ral:"RAL 7004"},{name:"Mouse grey",value:"mouse grey",hex:"#646B63",ral:"RAL 7005"},{name:"Beige grey",value:"beige grey",hex:"#6D6552",ral:"RAL 7006"},{name:"Khaki grey",value:"khaki grey",hex:"#6A5F31",ral:"RAL 7008"},{name:"Green grey",value:"green grey",hex:"#4D5645",ral:"RAL 7009"},{name:"Tarpaulin grey",value:"tarpaulin grey",hex:"#4C514A",ral:"RAL 7010"},{name:"Iron grey",value:"iron grey",hex:"#434B4D",ral:"RAL 7011"},{name:"Basalt grey",value:"basalt grey",hex:"#4E5754",ral:"RAL 7012"},{name:"Brown grey",value:"brown grey",hex:"#464531",ral:"RAL 7013"},{name:"Slate grey",value:"slate grey",hex:"#434750",ral:"RAL 7015"},{name:"Anthracite grey",value:"anthracite grey",hex:"#293133",ral:"RAL 7016"},{name:"Black grey",value:"black grey",hex:"#23282B",ral:"RAL 7021"},{name:"Umbra grey",value:"umbra grey",hex:"#332F2C",ral:"RAL 7022"},{name:"Concrete grey",value:"concrete grey",hex:"#686C5E",ral:"RAL 7023"},{name:"Graphite grey",value:"graphite grey",hex:"#474A51",ral:"RAL 7024"},{name:"Granite grey",value:"granite grey",hex:"#2F353B",ral:"RAL 7026"},{name:"Stone grey",value:"stone grey",hex:"#8B8C7A",ral:"RAL 7030"},{name:"Blue grey",value:"blue grey",hex:"#8B8C7A",ral:"RAL 7031"},{name:"Pebble grey",value:"pebble grey",hex:"#B8B799",ral:"RAL 7032"},{name:"Cement grey",value:"cement grey",hex:"#7D8471",ral:"RAL 7033"},{name:"Yellow grey",value:"yellow grey",hex:"#8F8B66",ral:"RAL 7034"},{name:"Light grey",value:"light grey",hex:"#D7D7D7",ral:"RAL 7035"},{name:"Platinum grey",value:"platinum grey",hex:"#7F7679",ral:"RAL 7036"},{name:"Dusty grey",value:"dusty grey",hex:"#7D7F7D",ral:"RAL 7037"},{name:"Agate grey",value:"agate grey",hex:"#B5B8B1",ral:"RAL 7038"},{name:"Quartz grey",value:"quartz grey",hex:"#6C6960",ral:"RAL 7039"},{name:"Window grey",value:"window grey",hex:"#9DA1AA",ral:"RAL 7040"},{name:"Traffic grey A",value:"traffic grey A",hex:"#8D948D",ral:"RAL 7042"},{name:"Traffic grey B",value:"traffic grey B",hex:"#4E5452",ral:"RAL 7043"},{name:"Silk grey",value:"silk grey",hex:"#CAC4B0",ral:"RAL 7044"},{name:"Telegrey 1",value:"telegrey 1",hex:"#909090",ral:"RAL 7045"},{name:"Telegrey 2",value:"telegrey 2",hex:"#82898F",ral:"RAL 7046"},{name:"Telegrey 4",value:"telegrey 4",hex:"#D0D0D0",ral:"RAL 7047"}]," ":[{name:"Cream",value:"cream",hex:"#FDF4E3",ral:"RAL 9001"},{name:"Grey white",value:"grey white",hex:"#E7EBDA",ral:"RAL 9002"},{name:"Signal white",value:"signal white",hex:"#F4F4F4",ral:"RAL 9003"},{name:"Signal black",value:"signal black",hex:"#282828",ral:"RAL 9004"},{name:"Jet black",value:"jet black",hex:"#0A0A0A",ral:"RAL 9005"},{name:"Pure white",value:"pure white",hex:"#FFFFFF",ral:"RAL 9010"},{name:"Graphite black",value:"graphite black",hex:"#1C1C1C",ral:"RAL 9011"},{name:"Traffic white",value:"traffic white",hex:"#F6F6F6",ral:"RAL 9016"},{name:"Traffic black",value:"traffic black",hex:"#1E1E1E",ral:"RAL 9017"},{name:"Papyrus white",value:"papyrus white",hex:"#D7D7D7",ral:"RAL 9018"}]},Fp=I=>{u(!1);const F=`  ${I.ral}  `;console.log(" Color Selection - Prompt being added to input:",F),console.log(" Selected color:",I.ral,I.name),Ie(F)},Bo=[{name:" ",value:"bird's eye view",icon:"",prompt:"     "},{name:" ",value:"left angle",icon:"",prompt:"   45  "},{name:" ",value:"right angle",icon:"",prompt:"   45  "},{name:" ",value:"zoom in",icon:"+",prompt:"     "},{name:" ",value:"zoom out",icon:"-",prompt:"       "},{name:" ",value:"back view",icon:"",prompt:"       180 "}],mh=[{name:" ",value:"recessed lighting",prompt:"  "},{name:"",value:"pendant lights",prompt:" "},{name:" ",value:"chandeliers",prompt:"  "},{name:" ",value:"table lamps",prompt:"  "},{name:" ",value:"floor lamps",prompt:"  "},{name:" ",value:"wall sconces",prompt:"  "},{name:" ",value:"track lighting",prompt:"  "},{name:" ",value:"ceiling fixtures",prompt:"  "},{name:" ",value:"under-cabinet lighting",prompt:"  "},{name:" ",value:"string lights",prompt:"  "},{name:"",value:"day",prompt:"    "},{name:"",value:"night",prompt:"    "},{name:"",value:"sunset",prompt:"    "},{name:"",value:"sunrise",prompt:"    "}],Dl=[{name:"",value:"sofa",prompt:" "},{name:" ",value:"sectional sofa",prompt:"  "},{name:"",value:"armchair",prompt:" "},{name:" ",value:"accent chair",prompt:"  "},{name:" ",value:"dining chair",prompt:"  "},{name:"",value:"bar stool",prompt:" "},{name:" ",value:"single bed",prompt:"  "},{name:" ",value:"double bed",prompt:"  "},{name:"",value:"beanbag",prompt:" "},{name:"",value:"ottoman",prompt:" "},{name:"",value:"bench",prompt:" "},{name:" ",value:"coffee table",prompt:"  "},{name:" ",value:"end table",prompt:"  "},{name:" ",value:"nightstand",prompt:"  "},{name:" ",value:"dining table",prompt:"  "},{name:" ",value:"desk",prompt:"  "},{name:"",value:"dresser",prompt:" "},{name:" ",value:"wardrobe",prompt:"  "},{name:" ",value:"bookcase",prompt:"  "},{name:" ",value:"tv stand",prompt:"  "},{name:" ",value:"cabinetry",prompt:"  "}],Ss=[{name:"  ",value:"repair everything",prompt:"  "},{name:"   ",value:"fix and repair everything",prompt:"   "},{name:"  ",value:"mess up everything",prompt:"  "},{name:"   ",value:"destroy and cause damage to everything",prompt:"   "}],Pr=[{name:"",value:"minimalist",prompt:"     - , ,  "},{name:"",value:"bohemian",prompt:"     - , , "},{name:"",value:"industrial",prompt:"     -   "},{name:"  ",value:"mid-century modern",prompt:"       - , , "},{name:"",value:"scandinavian",prompt:"     - , , "},{name:"",value:"traditional",prompt:"     - , , "},{name:" ",value:"modern farmhouse",prompt:"      - , , "},{name:"",value:"contemporary",prompt:"     - , , "},{name:"",value:"coastal",prompt:"     - , , "},{name:" ",value:"art deco",prompt:"      - , , "}],Ol=I=>{f(!1),console.log(" Angle Selection - Prompt being added to input:",I.prompt),console.log(" Selected angle:",I.name,I.value),Ie(I.prompt)},jp=I=>{v(!1),console.log(" Lighting Selection - Prompt being added to input:",I.prompt),console.log(" Selected lighting:",I.name,I.value),Ie(I.prompt)},gh=I=>{P(!1),console.log(" Furniture Selection - Prompt being added to input:",I.prompt),console.log(" Selected furniture:",I.name,I.value),Ie(I.prompt)},yh=I=>{E(!1),console.log(" Repairs Selection - Prompt being added to input:",I.prompt),console.log(" Selected repair:",I.name,I.value),Ie(I.prompt)},_h=I=>{R(!1),console.log(" Style Selection - Prompt being added to input:",I.prompt),console.log(" Selected style:",I.name,I.value),Ie(I.prompt)},Ie=I=>{const F=ht.trim();let Q;F?F.endsWith(" ")?Q=`${F}${I}`:Q=`${F}, ${I}`:Q=I,Nt(Q)},Ll=async I=>{var F,Q,re;if(i){a(!0);try{if(console.log(" AI Image Alteration - Prompt being sent:",I),console.log(" Main image URL:",i),console.log(" Object image available:",!!qn),N&&T&&!await Zo.canMakeRequest(T.uid)){alert("   .    ."),a(!1);return}let ne=i;if(i.startsWith("/assets/")||i.startsWith("./assets/"))try{const ve=await(await fetch(i)).blob();ne=await new Promise(Gn=>{const Nn=new FileReader;Nn.onload=()=>Gn(Nn.result),Nn.readAsDataURL(ve)})}catch(nt){throw console.error("Error converting local image to data URL:",nt),new Error("Failed to load the default image")}let ae=null;qn?(console.log(" Processing object image file:",qn.name,qn.type,qn.size),ae=await AP(qn),console.log(" Object image processed successfully:",!!ae)):console.log(" No object image file available");const Oe=await Zo.submitImageGenerationRequest(T,I,ne,ae),ot=await Zo.waitForRequestCompletion(Oe);if(console.log("AI Service result:",ot),ot&&ot.storageUrl){const nt=ot.storageUrl,ve={imageUrl:nt,prompt:I,timestamp:jo(new Date)};if(N&&T){Jt(!0);try{const Xt=await ia(T.uid,1,5);S(Xt.history),li(1),or(Xt.hasMore)}catch(Xt){console.error("Failed to reload history from Firebase:",Xt)}finally{Jt(!1)}}else{const Xt={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...ve};S(Gn=>[Xt,...Gn]),li(1),or(!0)}s(nt),Dt(16/9),xe(null),Rr(null),oi(null),fn.current&&(fn.current.value="")}else alert("   .       .")}catch(ne){console.error("AI processing failed:",ne),(F=ne.message)!=null&&F.includes("limit reached")||(Q=ne.message)!=null&&Q.includes(" ")?alert("   .    ."):(re=ne.message)!=null&&re.includes("timeout")?alert("    .  ."):alert("  .       .")}finally{a(!1)}}};return g.jsxs("div",{className:"min-h-screen bg-background",children:[g.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"hidden md:flex justify-between items-center py-3",children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx("img",{src:"/Logo.png",alt:"MoomHe Logo",className:"h-16 w-auto"}),g.jsx("span",{className:"mr-2 text-sm text-gray-500",children:"  "})]}),g.jsx("div",{className:"flex items-center space-x-4",children:g.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 rounded-full flex items-center gap-2 px-4 py-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:o,onClick:()=>{T&&!T.isAnonymous?Sr(!0):Oo(!0)},children:T&&!T.isAnonymous?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),g.jsx("span",{className:"text-sm",children:T.email})]}):g.jsxs(g.Fragment,{children:[g.jsx(_m,{className:"w-5 h-5"}),""]})})})]}),g.jsx("div",{className:"md:hidden py-3",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("div",{className:"flex items-center",children:g.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 rounded-full flex items-center gap-2 px-3 py-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm",disabled:o,onClick:()=>{T&&!T.isAnonymous?Sr(!0):Oo(!0)},children:T&&!T.isAnonymous?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),g.jsx("span",{className:"text-xs",children:T.email})]}):g.jsxs(g.Fragment,{children:[g.jsx(_m,{className:"w-4 h-4"}),""]})})}),g.jsx("div",{className:"flex items-center",children:g.jsx("img",{src:"/Logo.png",alt:"MoomHe Logo",className:"h-12 w-auto"})}),g.jsx("div",{className:"flex items-center",children:g.jsxs("div",{className:"relative mobile-dropdown",children:[g.jsxs("button",{onClick:()=>Is(!ai),className:"btn-secondary flex items-center",disabled:o,children:[g.jsx("span",{className:"text-sm",children:t}),g.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ai&&g.jsx("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50 max-h-80 overflow-y-auto",children:Rl.map(I=>{const F=hi[I];return g.jsxs("button",{onClick:()=>{xl(I),Is(!1)},className:`w-full flex items-center px-4 py-3 text-right hover:bg-gray-50 transition-colors duration-200 ${t===I?"bg-blue-50 text-blue-600":"text-gray-700"}`,children:[g.jsx(F,{className:"w-4 h-4 ml-3"}),g.jsx("span",{className:"text-sm font-medium",children:I})]},I)})})]})})]})}),g.jsx("div",{className:"hidden md:flex space-x-reverse space-x-1 pb-3 overflow-x-auto scrollbar-hide",children:Rl.map(I=>{const F=hi[I];return g.jsxs("button",{onClick:()=>xl(I),disabled:o,className:`flex-shrink-0 px-4 py-2 rounded-lg font-medium transition-all duration-200 text-sm flex items-center disabled:opacity-50 disabled:cursor-not-allowed ${t===I?"bg-accent text-white shadow-lg":"bg-white text-text hover:bg-gray-50 border border-gray-200"}`,children:[g.jsx(F,{className:"w-4 h-4 ml-2"}),I]},I)})})]})}),g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-8",children:[g.jsxs("div",{className:"block lg:hidden",children:[g.jsx("div",{className:"mb-6 -mt-4",children:g.jsxs("div",{className:"bg-white shadow-sm border-b border-gray-200 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-4",children:[g.jsxs("div",{className:"relative mb-4",children:[g.jsx("div",{className:"w-full rounded-lg shadow-lg overflow-hidden transition-all duration-300",style:{aspectRatio:Cn,maxHeight:"50vh"},children:g.jsx("img",{src:i,alt:"Main room design",onClick:Pl,onLoad:fi,className:`w-full h-full object-contain rounded-lg transition-all duration-300 cursor-pointer hover:opacity-90 ${o?"blur-sm cursor-not-allowed":""}`})}),g.jsxs("button",{onClick:Ts,disabled:o,className:"absolute top-3 right-3 bg-blue-500/70 hover:bg-blue-500/90 text-white px-3 py-2 rounded-lg text-xs font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm flex items-center gap-1",children:[g.jsx(z0,{className:"w-3 h-3"})," "]}),o&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-lg",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-6 h-6 border-2 border-white/50 border-b-white rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]}),g.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[g.jsxs("div",{className:"flex-1 relative",children:[g.jsx("input",{type:"text",value:ht,onChange:I=>Nt(I.target.value),placeholder:" ...",disabled:o,className:"w-full px-3 py-2 pr-8 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",onKeyPress:I=>{I.key==="Enter"&&Rs()}}),ht&&g.jsx("button",{onClick:()=>Nt(""),disabled:o,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsx("button",{onClick:Rs,disabled:o||!ht.trim(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:g.jsx("span",{className:"text-sm font-medium",children:""})})]}),g.jsxs("div",{className:"relative",children:[g.jsxs("div",{className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2 mb-4",ref:I=>{I&&I.addEventListener("scroll",()=>{const F=I.scrollWidth>I.clientWidth,Q=I.scrollLeft<=5,re=I.scrollLeft+I.clientWidth>=I.scrollWidth-5,ne=I.parentElement.querySelector(".fade-overlay-left"),ae=I.parentElement.querySelector(".fade-overlay-right");ne&&(ne.style.opacity=F&&!re?"1":"0"),ae&&(ae.style.opacity=F&&!Q?"1":"0")})},children:[g.jsxs("button",{onClick:o?void 0:hh,disabled:o,className:"flex-shrink-0 btn-secondary border-2 border-dashed border-blue-400 hover:border-blue-500 hover:bg-blue-50 flex items-center text-sm px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[Ar?g.jsxs("div",{className:"relative w-4 h-4 ml-2",children:[g.jsx("img",{src:Ar,alt:"Object to add",className:"w-full h-full object-cover rounded border border-gray-300"}),g.jsx("button",{onClick:I=>{I.stopPropagation(),dh()},disabled:o,className:"absolute -top-1 -right-1 bg-red-500 hover:bg-red-600 text-white rounded-full w-3 h-3 flex items-center justify-center text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}):g.jsx(Go,{className:"w-4 h-4 text-blue-500 ml-2"}),g.jsx("span",{className:"text-blue-600",children:" "})]}),(Vl=ar[t])==null?void 0:Vl.map((I,F)=>g.jsxs("button",{onClick:I.action,disabled:o,className:"flex-shrink-0 btn-secondary flex items-center text-sm px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(I.icon,{className:"w-4 h-4 ml-2"}),I.name]},F))]}),g.jsx("div",{className:"fade-overlay-left absolute top-0 left-0 w-8 h-full bg-gradient-to-r from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"}),g.jsx("div",{className:"fade-overlay-right absolute top-0 right-0 w-8 h-full bg-gradient-to-l from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"})]}),g.jsx("input",{ref:fn,type:"file",accept:"image/*",onChange:pi,className:"hidden"}),g.jsxs("div",{className:"flex gap-2 mt-4",children:[g.jsxs("button",{onClick:bl,disabled:o,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[g.jsx(U0,{className:"w-4 h-4 ml-2"}),""]}),g.jsxs("button",{onClick:di,disabled:o,className:"flex-1 bg-green-500 hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[g.jsx(B0,{className:"w-4 h-4 ml-2"}),""]})]})]})}),g.jsx("input",{ref:lh,type:"file",accept:"image/*",onChange:uh,className:"hidden"}),g.jsx("div",{className:"space-y-4",children:g.jsxs("div",{className:"card p-4 relative",children:[g.jsxs("h3",{className:"text-lg font-semibold text-text mb-3 flex items-center",children:[g.jsx("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),""]}),g.jsx("div",{className:`transition-opacity duration-300 ${Rt||o?"opacity-50 pointer-events-none":""}`,children:(_||[]).length===0?g.jsxs("div",{className:"text-center py-6",children:[g.jsx("div",{className:"text-gray-400 mb-2",children:g.jsx(Xl,{className:"w-6 h-6 mx-auto"})}),g.jsx("p",{className:"text-sm text-gray-500",children:"  "}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"   "})]}):g.jsxs("div",{className:"relative",children:[g.jsxs("div",{ref:ch,className:"flex gap-3 overflow-x-auto scrollbar-visible pb-2",onScroll:I=>{const{scrollLeft:F,scrollWidth:Q,clientWidth:re}=I.target;F+re>=Q-10&&Il&&!ci&&kl();const ne=Q>re,ae=F<=5,Oe=F+re>=Q-5,ot=I.target.parentElement.querySelector(".image-fade-overlay-left"),nt=I.target.parentElement.querySelector(".image-fade-overlay-right");ot&&(ot.style.opacity=ne&&!Oe?"1":"0"),nt&&(nt.style.opacity=ne&&!ae?"1":"0")},children:[(_||[]).map(I=>g.jsxs("div",{onClick:()=>yt(I),className:"cursor-pointer group flex-shrink-0 w-24",children:[g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:I.thumbnailUrl||I.storageUrl||I.imageUrl,alt:"History entry",className:"w-24 h-24 object-cover rounded-lg group-hover:opacity-80 transition-opacity duration-200"}),g.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-200 rounded-lg"})]}),g.jsxs("div",{className:"mt-1",children:[g.jsx("p",{className:"text-xs text-gray-600 truncate",title:I.prompt||"No prompt",children:I.prompt&&I.prompt.length>15?`${I.prompt.substring(0,15)}...`:I.prompt||"No prompt"}),g.jsx("p",{className:"text-xs text-gray-400",children:As(I.timestamp)})]})]},I.id)),ci&&g.jsx("div",{className:"flex-shrink-0 flex items-center justify-center w-24",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})})]}),g.jsx("div",{className:"image-fade-overlay-left absolute top-0 left-0 w-6 h-full bg-gradient-to-r from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"}),g.jsx("div",{className:"image-fade-overlay-right absolute top-0 right-0 w-6 h-full bg-gradient-to-l from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"})]})}),Rt&&g.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-xl flex items-center justify-center",children:g.jsx("div",{className:"relative",children:g.jsx("div",{className:"w-8 h-8 border-4 border-gray-300 border-t-purple-500 rounded-full animate-spin"})})})]})})]}),g.jsxs("div",{className:"hidden lg:grid grid-cols-1 lg:grid-cols-4 gap-8",children:[g.jsx("div",{className:"lg:col-span-1 lg:order-1",children:g.jsxs("div",{className:"card p-4 relative",children:[g.jsx("h3",{className:"text-lg font-semibold text-text mb-3",children:""}),g.jsx("div",{className:`transition-opacity duration-300 ${Rt||o?"opacity-50 pointer-events-none":""}`,children:(_||[]).length===0?g.jsxs("div",{className:"text-center py-8",children:[g.jsx("div",{className:"text-gray-400 mb-2",children:g.jsx(Xl,{className:"w-8 h-8 mx-auto"})}),g.jsx("p",{className:"text-sm text-gray-500",children:"  "}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"   "})]}):g.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-visible",onScroll:I=>{const{scrollTop:F,scrollHeight:Q,clientHeight:re}=I.target;F+re>=Q-10&&Il&&!ci&&kl()},children:[(_||[]).map(I=>g.jsxs("div",{onClick:()=>yt(I),className:"cursor-pointer group",children:[g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:I.thumbnailUrl||I.storageUrl||I.imageUrl,alt:"History entry",className:"w-full h-24 object-cover rounded-lg group-hover:opacity-80 transition-opacity duration-200"}),g.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-200 rounded-lg"})]}),g.jsxs("div",{className:"mt-2",children:[g.jsx("p",{className:"text-xs text-gray-600 truncate",title:I.prompt||"No prompt",children:I.prompt&&I.prompt.length>30?`${I.prompt.substring(0,30)}...`:I.prompt||"No prompt"}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:As(I.timestamp)})]})]},I.id)),ci&&g.jsx("div",{className:"flex justify-center py-4",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})})]})}),Rt&&g.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-xl flex items-center justify-center",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-purple-500 rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-400 border-b-purple-600 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]})}),g.jsxs("div",{className:"lg:col-span-1 lg:order-3",children:[g.jsx("div",{className:"mb-4",children:g.jsxs("div",{className:"flex gap-2",children:[g.jsxs("button",{onClick:bl,disabled:o,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[g.jsx(U0,{className:"w-4 h-4 ml-2"}),""]}),g.jsxs("button",{onClick:di,disabled:o,className:"flex-1 bg-green-500 hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[g.jsx(B0,{className:"w-4 h-4 ml-2"}),""]})]})}),g.jsxs("div",{className:"card p-4 relative",children:[g.jsxs("div",{className:"flex items-center justify-between mb-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:""}),g.jsx("button",{onClick:()=>Cl(i),disabled:oe||!i||o||!ye,className:"w-8 h-8 bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 rounded-full flex items-center justify-center transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:ye?"  ":"   ",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),g.jsx("div",{className:`transition-opacity duration-300 ${oe||o?"opacity-50 pointer-events-none":""}`,children:(K||[]).length===0?g.jsxs("div",{className:"text-center py-8",children:[g.jsx("div",{className:"text-gray-400 mb-2",children:g.jsx(Xl,{className:"w-8 h-8 mx-auto"})}),g.jsx("p",{className:"text-sm text-gray-500",children:"  "}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"  "})]}):g.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto scrollbar-visible",children:(K||[]).map((I,F)=>g.jsx("div",{onClick:()=>fh(I),className:"rounded-lg p-3 transition-colors duration-200 cursor-pointer bg-gray-50 hover:bg-gray-100 border-2 border-transparent",children:g.jsx("p",{className:"text-sm font-medium text-gray-700",children:I})},F))})}),oe&&g.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-xl flex items-center justify-center",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-orange-500 rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-400 border-b-orange-600 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]})]}),g.jsx("div",{className:"lg:col-span-2 lg:order-2",children:g.jsxs("div",{className:"card p-6",children:[g.jsxs("div",{className:"relative mb-6",children:[g.jsx("div",{className:"w-full rounded-lg shadow-lg overflow-hidden transition-all duration-300",style:{aspectRatio:Cn,maxHeight:"70vh"},children:g.jsx("img",{src:i,alt:"Main room design",onClick:Pl,onLoad:fi,className:`w-full h-full object-contain rounded-lg transition-all duration-300 cursor-pointer hover:opacity-90 ${o?"blur-sm cursor-not-allowed":""}`})}),g.jsxs("button",{onClick:Ts,disabled:o,className:"absolute top-4 right-4 bg-blue-500/70 hover:bg-blue-500/90 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm flex items-center gap-2",children:[g.jsx(z0,{className:"w-4 h-4"})," "]}),o&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-lg",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-8 h-8 border-2 border-white/50 border-b-white rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]}),g.jsx("div",{className:"mb-6",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("div",{className:"flex-1 relative",children:[g.jsx("input",{type:"text",value:ht,onChange:I=>Nt(I.target.value),placeholder:" ...",disabled:o,className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",onKeyPress:I=>{I.key==="Enter"&&Rs()}}),ht&&g.jsx("button",{onClick:()=>Nt(""),disabled:o,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsxs("button",{onClick:Rs,disabled:o||!ht.trim(),className:"px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("span",{className:"text-sm font-medium",children:""}),g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})]})}),g.jsxs("div",{className:"flex flex-wrap gap-4",children:[g.jsxs("div",{className:"relative",children:[Ar?g.jsxs("div",{className:"relative btn-secondary h-10 w-24 flex items-center justify-center",children:[g.jsx("img",{src:Ar,alt:"Object to add",className:"w-6 h-6 object-cover rounded border border-gray-300"}),g.jsx("button",{onClick:dh,disabled:o,className:"absolute -top-1 -right-1 bg-red-500 hover:bg-red-600 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}):g.jsxs("button",{onClick:o?void 0:hh,disabled:o,className:"btn-secondary h-10 border-2 border-dashed border-blue-400 hover:border-blue-500 hover:bg-blue-50 flex items-center transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(Go,{className:"w-4 h-4 text-blue-500 ml-2"}),g.jsx("span",{className:"text-sm text-blue-600",children:" "})]}),g.jsx("input",{ref:fn,type:"file",accept:"image/*",onChange:pi,className:"hidden"})]}),(Ml=ar[t])==null?void 0:Ml.map((I,F)=>g.jsxs("button",{onClick:I.action,disabled:o,className:"btn-secondary flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(I.icon,{className:"w-4 h-4 ml-2"}),I.name]},F))]})]})})]})]}),c&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 h-[85vh] overflow-hidden max-w-[95vw] md:max-w-6xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"  RAL"}),g.jsx("button",{onClick:()=>u(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsx("div",{className:"flex flex-wrap gap-1 md:gap-2 mb-4 md:mb-6 border-b border-gray-200 pb-3 md:pb-4",children:Object.keys(Nl).map(I=>g.jsxs("button",{onClick:()=>Lp(I),disabled:o,className:`flex items-center gap-2 px-2 md:px-4 py-1 md:py-2 rounded-lg font-medium text-xs md:text-sm transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed ${ih===I?"bg-blue-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[g.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300",style:{backgroundColor:ph[I]}}),I]},I))}),g.jsx("div",{className:"h-96 overflow-y-auto",children:g.jsx("div",{className:"grid grid-cols-4 md:grid-cols-8 gap-2 md:gap-3",children:(vh=Nl[ih])==null?void 0:vh.map((I,F)=>g.jsxs("button",{onClick:()=>Fp(I),disabled:o,className:"flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-gray-300 shadow-sm mb-2",style:{backgroundColor:I.hex}}),g.jsx("span",{className:"text-xs text-text font-medium text-center leading-tight",children:I.ral}),g.jsx("span",{className:"text-xs text-gray-500 text-center leading-tight mt-1",children:I.name})]},F))})})]})})}),h&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"  "}),g.jsx("button",{onClick:()=>f(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:Bo.map((I,F)=>g.jsxs("button",{onClick:()=>Ol(I),disabled:o,className:"flex items-center p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("span",{className:"text-2xl ml-3",children:I.icon}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-sm font-medium text-text",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.value})]})]},F))})]})})}),p&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"  "}),g.jsx("button",{onClick:()=>v(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:mh.map((I,F)=>g.jsxs("button",{onClick:()=>jp(I),disabled:o,className:"flex items-center p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("span",{className:"text-2xl ml-3",children:""}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-sm font-medium text-text",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.value})]})]},F))})]})})}),b&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"  "}),g.jsx("button",{onClick:()=>P(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:Dl.map((I,F)=>g.jsx("button",{onClick:()=>gh(I),disabled:o,className:"flex items-center p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:g.jsxs("div",{className:"text-right w-full",children:[g.jsx("div",{className:"text-sm font-medium text-text",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.value})]})},F))})]})})}),C&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"  /"}),g.jsx("button",{onClick:()=>E(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Ss.map(I=>g.jsxs("button",{onClick:()=>yh(I),disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Ii,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsx("span",{className:"text-sm font-medium text-gray-800",children:I.name})]},I.value))})]})})}),w&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[80vh] overflow-y-auto max-w-[95vw] md:max-w-3xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"  "}),g.jsx("button",{onClick:()=>R(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Pr.map(I=>g.jsxs("button",{onClick:()=>_h(I),disabled:o,className:"flex flex-col items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-center",children:[g.jsx(Zt,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800 mb-1",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.value})]})]},I.value))})]})})}),V&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[80vh] overflow-y-auto max-w-[95vw] md:max-w-4xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:" "}),g.jsx("button",{onClick:()=>B(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" "}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:" /",value:"       ",hebrew:"       "},{name:" ",value:"Picture Window: Large, fixed view.",hebrew:"      "},{name:" ",value:"Casement Window: Outward crank open.",hebrew:"    "},{name:" / ",value:"Skylight / Sun Tunnel: Light from above.",hebrew:"       "},{name:" ",value:"Transom Window: Sits over door.",hebrew:"    "},{name:" ",value:"Interior Window: Between two rooms.",hebrew:"     "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),B(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Gh,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" "}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:" ",value:"French Doors: Glass pane entry.",hebrew:"    "},{name:" ",value:"Pocket Door: Slides inside wall.",hebrew:"     "},{name:" ",value:"Barn Door: Sliding exposed track.",hebrew:"     "},{name:" ",value:"Louvered Door: Vented slats, air.",hebrew:"     "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),B(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Gh,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]})]})]})})}),$&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[80vh] overflow-y-auto max-w-[95vw] md:max-w-4xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:" "}),g.jsx("button",{onClick:()=>A(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" "}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:" ",value:"Toilet Seat: Slow-close lid",hebrew:"      "},{name:" ",value:"Toilet Seat: Heated bidet function",hebrew:"      "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Dn,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" "}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:" ",value:"Bathtub: Freestanding oval soak",hebrew:"   "},{name:" ",value:"Bathtub: Clawfoot vintage design",hebrew:"     "},{name:" ",value:"Bathtub: Drop-in standard size",hebrew:"   "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Dn,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" "}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:" ",value:"Shower: Walk-in frameless glass",hebrew:"     "},{name:" ",value:"Shower: Rainfall head system",hebrew:"     "},{name:" ",value:"Shower: Sliding door enclosure",hebrew:"    "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Dn,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" "}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:" ",value:"Sink (Vanity): Vessel bowl style",hebrew:"    "},{name:" ",value:"Sink (Vanity): Pedestal classic look",hebrew:"    "},{name:" ",value:"Sink (Vanity): Undermount ceramic white",hebrew:"    "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Dn,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" \\'/"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"' ",value:"Jacuzzi / Spa: Portable vinyl bubble",hebrew:" '  "},{name:"' ",value:"Jacuzzi / Spa: Built-in tiled perimeter",hebrew:" '   "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Dn,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:" "}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"  ",value:"Pool: Above-ground metal frame",hebrew:"      "},{name:"  ",value:"Pool: In-ground concrete custom",hebrew:"      "}].map((I,F)=>g.jsxs("button",{onClick:()=>{Ie(I.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Dn,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:I.name}),g.jsx("div",{className:"text-xs text-gray-500",children:I.hebrew})]})]},F))})]})]})]})})}),ws&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[60] p-4",onClick:Hn,children:g.jsxs("div",{className:"relative max-w-7xl max-h-full w-full h-full flex items-center justify-center",children:[g.jsx("img",{src:i,alt:"Full size view",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"}),g.jsx("button",{onClick:Hn,className:"absolute top-4 right-4 bg-white/20 hover:bg-white/30 text-white p-3 rounded-full transition-colors duration-200 backdrop-blur-sm",children:g.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),g.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-4 py-2 rounded-full backdrop-blur-sm",children:g.jsx("span",{className:"text-sm",children:"      "})})]})}),El&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-w-md",children:g.jsxs("div",{className:"p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:""}),g.jsx("button",{onClick:()=>Sr(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:""})]}),g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("p",{className:"text-gray-600 mb-4",children:"    ?"}),g.jsx("p",{className:"text-sm text-gray-500",children:T==null?void 0:T.email})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:()=>Sr(!1),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-lg transition-colors duration-200",children:""}),g.jsx("button",{onClick:Fo,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200",children:""})]})]})})}),oh&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-w-md",children:g.jsxs("div",{className:"p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:dn==="login"?"":" "}),g.jsx("button",{onClick:()=>{Oo(!1),ui(""),Vo(""),xr(""),Qe("signup")},className:"text-gray-500 hover:text-gray-700 text-xl",children:""})]}),g.jsxs("form",{onSubmit:mi,className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),g.jsx("input",{type:"email",value:Pe,onChange:I=>ui(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),dn==="signup"&&g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  "}),g.jsx("input",{type:"email",value:Lo,onChange:I=>Vo(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"    ",required:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),g.jsx("input",{type:"password",value:br,onChange:I=>xr(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:" ",required:!0,minLength:6})]}),dn==="login"&&g.jsx("div",{className:"text-center",children:g.jsx("button",{type:"button",onClick:Vp,disabled:Mo||!Pe,className:"text-blue-600 hover:text-blue-800 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:Mo?"...":" ?"})}),g.jsx("button",{type:"submit",disabled:Tl||!Pe||!br||dn==="signup"&&!Lo,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:Tl?"...":dn==="login"?"":" "})]}),g.jsx("div",{className:"mt-4 text-center",children:g.jsx("button",{onClick:()=>Qe(dn==="login"?"signup":"login"),className:"border border-blue-600 text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200",children:dn==="login"?"  ?   ":"  ? "})})]})})}),g.jsx("footer",{className:"bg-gray-50 border-t border-gray-200 py-6 mt-12",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[g.jsx("div",{className:"text-sm text-gray-500",children:" 2025 MoomHe.   ."}),g.jsxs("div",{className:"flex space-x-6 space-x-reverse",children:[g.jsx("a",{href:"/eula.html",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors duration-200",children:" "}),g.jsx("a",{href:"/privacy.html",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors duration-200",children:" "})]})]})})})]})}Gm.createRoot(document.getElementById("root")).render(g.jsx(ik.StrictMode,{children:g.jsx(I6,{})}));export{OV as $,x6 as A,q6 as B,Y6 as C,a4 as D,cu as E,Ci as F,Di as G,C6 as H,SL as I,s5 as J,v5 as K,SI as L,nM as M,XL as N,Kr as O,Ys as P,X6 as Q,l5 as R,Wg as S,e4 as T,$6 as U,TV as V,u5 as W,m5 as X,_5 as Y,o5 as Z,VV as _,Uu as a,co as a$,N6 as a0,pL as a1,AV as a2,h5 as a3,p5 as a4,y5 as a5,PL as a6,r5 as a7,H6 as a8,L6 as a9,Ir as aA,Se as aB,En as aC,Po as aD,ko as aE,Ce as aF,j as aG,Er as aH,xj as aI,Xj as aJ,At as aK,vl as aL,th as aM,Dd as aN,Np as aO,nh as aP,kp as aQ,Yv as aR,Tn as aS,Cp as aT,Bi as aU,Ee as aV,Jj as aW,rr as aX,Qj as aY,K_ as aZ,Xe as a_,B6 as aa,J6 as ab,EV as ac,L_ as ad,O6 as ae,U6 as af,z6 as ag,c5 as ah,f5 as ai,g5 as aj,n5 as ak,D6 as al,t5 as am,K6 as an,Q6 as ao,d5 as ap,W6 as aq,e5 as ar,Z6 as as,G6 as at,F6 as au,rP as av,Tu as aw,Cj as ax,yn as ay,b5 as az,ju as b,Zx as b$,H as b0,E5 as b1,c4 as b2,ze as b3,P9 as b4,de as b5,I5 as b6,x9 as b7,b9 as b8,A5 as b9,H5 as bA,q5 as bB,Ke as bC,rh as bD,Uj as bE,l9 as bF,jj as bG,Z5 as bH,e9 as bI,sP as bJ,t9 as bK,n9 as bL,Pj as bM,T9 as bN,v9 as bO,x5 as bP,U5 as bQ,B5 as bR,cT as bS,c9 as bT,h9 as bU,u9 as bV,kj as bW,Ey as bX,o9 as bY,a9 as bZ,F5 as b_,zn as ba,v4 as bb,s9 as bc,K5 as bd,Q5 as be,j5 as bf,_9 as bg,y9 as bh,W5 as bi,C5 as bj,Zu as bk,R5 as bl,bj as bm,Mj as bn,S9 as bo,i9 as bp,m9 as bq,O5 as br,R9 as bs,eo as bt,V5 as bu,Y5 as bv,P5 as bw,k5 as bx,D5 as by,A9 as bz,k6 as c,d9 as c0,f9 as c1,Wj as c2,Xx as c3,Bx as c4,J5 as c5,S5 as c6,p9 as c7,g9 as c8,Op as c9,E9 as ca,w5 as cb,X5 as cc,z5 as cd,$5 as ce,G5 as cf,L5 as cg,r9 as ch,w9 as ci,N5 as cj,M5 as ck,I9 as cl,Ro as d,A6 as e,Ni as f,wd as g,b6 as h,Sa as i,ZM as j,R6 as k,S6 as l,G_ as m,Oi as n,M6 as o,LV as p,a5 as q,zV as r,XM as s,aS as t,SV as u,V6 as v,eV as w,j6 as x,P6 as y,i5 as z};
