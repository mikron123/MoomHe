var HP=Object.defineProperty;var GP=(t,e,n)=>e in t?HP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $w=(t,e,n)=>(GP(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var x6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function WP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var LT={exports:{}},Gf={},VT={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ju=Symbol.for("react.element"),KP=Symbol.for("react.portal"),QP=Symbol.for("react.fragment"),YP=Symbol.for("react.strict_mode"),JP=Symbol.for("react.profiler"),XP=Symbol.for("react.provider"),ZP=Symbol.for("react.context"),ek=Symbol.for("react.forward_ref"),tk=Symbol.for("react.suspense"),nk=Symbol.for("react.memo"),rk=Symbol.for("react.lazy"),zw=Symbol.iterator;function ik(t){return t===null||typeof t!="object"?null:(t=zw&&t[zw]||t["@@iterator"],typeof t=="function"?t:null)}var MT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},FT=Object.assign,jT={};function Tl(t,e,n){this.props=t,this.context=e,this.refs=jT,this.updater=n||MT}Tl.prototype.isReactComponent={};Tl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Tl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function UT(){}UT.prototype=Tl.prototype;function $y(t,e,n){this.props=t,this.context=e,this.refs=jT,this.updater=n||MT}var zy=$y.prototype=new UT;zy.constructor=$y;FT(zy,Tl.prototype);zy.isPureReactComponent=!0;var qw=Array.isArray,BT=Object.prototype.hasOwnProperty,qy={current:null},$T={key:!0,ref:!0,__self:!0,__source:!0};function zT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)BT.call(e,r)&&!$T.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:ju,type:t,key:s,ref:o,props:i,_owner:qy.current}}function sk(t,e){return{$$typeof:ju,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hy(t){return typeof t=="object"&&t!==null&&t.$$typeof===ju}function ok(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Hw=/\/+/g;function lm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ok(""+t.key):e.toString(36)}function _h(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ju:case KP:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+lm(o,0):r,qw(i)?(n="",t!=null&&(n=t.replace(Hw,"$&/")+"/"),_h(i,e,n,"",function(u){return u})):i!=null&&(Hy(i)&&(i=sk(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Hw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",qw(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+lm(s,a);o+=_h(s,e,n,l,i)}else if(l=ik(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+lm(s,a++),o+=_h(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Bd(t,e,n){if(t==null)return t;var r=[],i=0;return _h(t,r,"","",function(s){return e.call(n,s,i++)}),r}function ak(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},vh={transition:null},lk={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:vh,ReactCurrentOwner:qy};function qT(){throw Error("act(...) is not supported in production builds of React.")}pe.Children={map:Bd,forEach:function(t,e,n){Bd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bd(t,function(){e++}),e},toArray:function(t){return Bd(t,function(e){return e})||[]},only:function(t){if(!Hy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};pe.Component=Tl;pe.Fragment=QP;pe.Profiler=JP;pe.PureComponent=$y;pe.StrictMode=YP;pe.Suspense=tk;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lk;pe.act=qT;pe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=FT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=qy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)BT.call(e,l)&&!$T.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:ju,type:t.type,key:i,ref:s,props:r,_owner:o}};pe.createContext=function(t){return t={$$typeof:ZP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:XP,_context:t},t.Consumer=t};pe.createElement=zT;pe.createFactory=function(t){var e=zT.bind(null,t);return e.type=t,e};pe.createRef=function(){return{current:null}};pe.forwardRef=function(t){return{$$typeof:ek,render:t}};pe.isValidElement=Hy;pe.lazy=function(t){return{$$typeof:rk,_payload:{_status:-1,_result:t},_init:ak}};pe.memo=function(t,e){return{$$typeof:nk,type:t,compare:e===void 0?null:e}};pe.startTransition=function(t){var e=vh.transition;vh.transition={};try{t()}finally{vh.transition=e}};pe.unstable_act=qT;pe.useCallback=function(t,e){return tn.current.useCallback(t,e)};pe.useContext=function(t){return tn.current.useContext(t)};pe.useDebugValue=function(){};pe.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};pe.useEffect=function(t,e){return tn.current.useEffect(t,e)};pe.useId=function(){return tn.current.useId()};pe.useImperativeHandle=function(t,e,n){return tn.current.useImperativeHandle(t,e,n)};pe.useInsertionEffect=function(t,e){return tn.current.useInsertionEffect(t,e)};pe.useLayoutEffect=function(t,e){return tn.current.useLayoutEffect(t,e)};pe.useMemo=function(t,e){return tn.current.useMemo(t,e)};pe.useReducer=function(t,e,n){return tn.current.useReducer(t,e,n)};pe.useRef=function(t){return tn.current.useRef(t)};pe.useState=function(t){return tn.current.useState(t)};pe.useSyncExternalStore=function(t,e,n){return tn.current.useSyncExternalStore(t,e,n)};pe.useTransition=function(){return tn.current.useTransition()};pe.version="18.3.1";VT.exports=pe;var ne=VT.exports;const ck=WP(ne);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uk=ne,dk=Symbol.for("react.element"),hk=Symbol.for("react.fragment"),fk=Object.prototype.hasOwnProperty,pk=uk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mk={key:!0,ref:!0,__self:!0,__source:!0};function HT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)fk.call(e,r)&&!mk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:dk,type:t,key:s,ref:o,props:i,_owner:pk.current}}Gf.Fragment=hk;Gf.jsx=HT;Gf.jsxs=HT;LT.exports=Gf;var g=LT.exports,cg={},GT={exports:{}},Dn={},WT={exports:{}},KT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Y,ie){var ae=Y.length;Y.push(ie);e:for(;0<ae;){var Pe=ae-1>>>1,_e=Y[Pe];if(0<i(_e,ie))Y[Pe]=ie,Y[ae]=_e,ae=Pe;else break e}}function n(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var ie=Y[0],ae=Y.pop();if(ae!==ie){Y[0]=ae;e:for(var Pe=0,_e=Y.length,Oe=_e>>>1;Pe<Oe;){var lt=2*(Pe+1)-1,Tt=Y[lt],Mn=lt+1,Qt=Y[Mn];if(0>i(Tt,ae))Mn<_e&&0>i(Qt,Tt)?(Y[Pe]=Qt,Y[Mn]=ae,Pe=Mn):(Y[Pe]=Tt,Y[lt]=ae,Pe=lt);else if(Mn<_e&&0>i(Qt,ae))Y[Pe]=Qt,Y[Mn]=ae,Pe=Mn;else break e}}return ie}function i(Y,ie){var ae=Y.sortIndex-ie.sortIndex;return ae!==0?ae:Y.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,v=!1,S=!1,P=!1,N=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(Y){for(var ie=n(u);ie!==null;){if(ie.callback===null)r(u);else if(ie.startTime<=Y)r(u),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=n(u)}}function M(Y){if(P=!1,b(Y),!S)if(n(l)!==null)S=!0,Ds($);else{var ie=n(u);ie!==null&&Vn(M,ie.startTime-Y)}}function $(Y,ie){S=!1,P&&(P=!1,T(_),_=-1),v=!0;var ae=p;try{for(b(ie),f=n(l);f!==null&&(!(f.expirationTime>ie)||Y&&!k());){var Pe=f.callback;if(typeof Pe=="function"){f.callback=null,p=f.priorityLevel;var _e=Pe(f.expirationTime<=ie);ie=t.unstable_now(),typeof _e=="function"?f.callback=_e:f===n(l)&&r(l),b(ie)}else r(l);f=n(l)}if(f!==null)var Oe=!0;else{var lt=n(u);lt!==null&&Vn(M,lt.startTime-ie),Oe=!1}return Oe}finally{f=null,p=ae,v=!1}}var z=!1,A=null,_=-1,R=5,E=-1;function k(){return!(t.unstable_now()-E<R)}function D(){if(A!==null){var Y=t.unstable_now();E=Y;var ie=!0;try{ie=A(!0,Y)}finally{ie?x():(z=!1,A=null)}}else z=!1}var x;if(typeof I=="function")x=function(){I(D)};else if(typeof MessageChannel<"u"){var Ct=new MessageChannel,rn=Ct.port2;Ct.port1.onmessage=D,x=function(){rn.postMessage(null)}}else x=function(){N(D,0)};function Ds(Y){A=Y,z||(z=!0,x())}function Vn(Y,ie){_=N(function(){Y(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_continueExecution=function(){S||v||(S=!0,Ds($))},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Y){switch(p){case 1:case 2:case 3:var ie=3;break;default:ie=p}var ae=p;p=ie;try{return Y()}finally{p=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Y,ie){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ae=p;p=Y;try{return ie()}finally{p=ae}},t.unstable_scheduleCallback=function(Y,ie,ae){var Pe=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Pe+ae:Pe):ae=Pe,Y){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=ae+_e,Y={id:d++,callback:ie,priorityLevel:Y,startTime:ae,expirationTime:_e,sortIndex:-1},ae>Pe?(Y.sortIndex=ae,e(u,Y),n(l)===null&&Y===n(u)&&(P?(T(_),_=-1):P=!0,Vn(M,ae-Pe))):(Y.sortIndex=_e,e(l,Y),S||v||(S=!0,Ds($))),Y},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(Y){var ie=p;return function(){var ae=p;p=ie;try{return Y.apply(this,arguments)}finally{p=ae}}}})(KT);WT.exports=KT;var gk=WT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yk=ne,kn=gk;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var QT=new Set,Xc={};function Mo(t,e){Ka(t,e),Ka(t+"Capture",e)}function Ka(t,e){for(Xc[t]=e,t=0;t<e.length;t++)QT.add(e[t])}var ri=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ug=Object.prototype.hasOwnProperty,_k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gw={},Ww={};function vk(t){return ug.call(Ww,t)?!0:ug.call(Gw,t)?!1:_k.test(t)?Ww[t]=!0:(Gw[t]=!0,!1)}function wk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ik(t,e,n,r){if(e===null||typeof e>"u"||wk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Mt[t]=new nn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Mt[e]=new nn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Mt[t]=new nn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Mt[t]=new nn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Mt[t]=new nn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Mt[t]=new nn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Mt[t]=new nn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Mt[t]=new nn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Mt[t]=new nn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gy=/[\-:]([a-z])/g;function Wy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gy,Wy);Mt[e]=new nn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gy,Wy);Mt[e]=new nn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gy,Wy);Mt[e]=new nn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Mt[t]=new nn(t,1,!1,t.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Mt[t]=new nn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ky(t,e,n,r){var i=Mt.hasOwnProperty(e)?Mt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ik(e,n,i,r)&&(n=null),r||i===null?vk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fi=yk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$d=Symbol.for("react.element"),Aa=Symbol.for("react.portal"),ba=Symbol.for("react.fragment"),Qy=Symbol.for("react.strict_mode"),dg=Symbol.for("react.profiler"),YT=Symbol.for("react.provider"),JT=Symbol.for("react.context"),Yy=Symbol.for("react.forward_ref"),hg=Symbol.for("react.suspense"),fg=Symbol.for("react.suspense_list"),Jy=Symbol.for("react.memo"),ji=Symbol.for("react.lazy"),XT=Symbol.for("react.offscreen"),Kw=Symbol.iterator;function tc(t){return t===null||typeof t!="object"?null:(t=Kw&&t[Kw]||t["@@iterator"],typeof t=="function"?t:null)}var Je=Object.assign,cm;function gc(t){if(cm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);cm=e&&e[1]||""}return`
`+cm+t}var um=!1;function dm(t,e){if(!t||um)return"";um=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{um=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?gc(t):""}function Ek(t){switch(t.tag){case 5:return gc(t.type);case 16:return gc("Lazy");case 13:return gc("Suspense");case 19:return gc("SuspenseList");case 0:case 2:case 15:return t=dm(t.type,!1),t;case 11:return t=dm(t.type.render,!1),t;case 1:return t=dm(t.type,!0),t;default:return""}}function pg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ba:return"Fragment";case Aa:return"Portal";case dg:return"Profiler";case Qy:return"StrictMode";case hg:return"Suspense";case fg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case JT:return(t.displayName||"Context")+".Consumer";case YT:return(t._context.displayName||"Context")+".Provider";case Yy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jy:return e=t.displayName||null,e!==null?e:pg(t.type)||"Memo";case ji:e=t._payload,t=t._init;try{return pg(t(e))}catch{}}return null}function Tk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pg(e);case 8:return e===Qy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ms(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ZT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ak(t){var e=ZT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function zd(t){t._valueTracker||(t._valueTracker=Ak(t))}function eA(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ZT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function mg(t,e){var n=e.checked;return Je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Qw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ms(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tA(t,e){e=e.checked,e!=null&&Ky(t,"checked",e,!1)}function gg(t,e){tA(t,e);var n=ms(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?yg(t,e.type,n):e.hasOwnProperty("defaultValue")&&yg(t,e.type,ms(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Yw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function yg(t,e,n){(e!=="number"||Qh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var yc=Array.isArray;function Va(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ms(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function _g(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return Je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Jw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(q(92));if(yc(n)){if(1<n.length)throw Error(q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ms(n)}}function nA(t,e){var n=ms(e.value),r=ms(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Xw(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rA(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rA(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var qd,iA=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(qd=qd||document.createElement("div"),qd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Zc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Sc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bk=["Webkit","ms","Moz","O"];Object.keys(Sc).forEach(function(t){bk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Sc[e]=Sc[t]})});function sA(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Sc.hasOwnProperty(t)&&Sc[t]?(""+e).trim():e+"px"}function oA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=sA(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Rk=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wg(t,e){if(e){if(Rk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function Ig(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eg=null;function Xy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tg=null,Ma=null,Fa=null;function Zw(t){if(t=$u(t)){if(typeof Tg!="function")throw Error(q(280));var e=t.stateNode;e&&(e=Jf(e),Tg(t.stateNode,t.type,e))}}function aA(t){Ma?Fa?Fa.push(t):Fa=[t]:Ma=t}function lA(){if(Ma){var t=Ma,e=Fa;if(Fa=Ma=null,Zw(t),e)for(t=0;t<e.length;t++)Zw(e[t])}}function cA(t,e){return t(e)}function uA(){}var hm=!1;function dA(t,e,n){if(hm)return t(e,n);hm=!0;try{return cA(t,e,n)}finally{hm=!1,(Ma!==null||Fa!==null)&&(uA(),lA())}}function eu(t,e){var n=t.stateNode;if(n===null)return null;var r=Jf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(q(231,e,typeof n));return n}var Ag=!1;if(ri)try{var nc={};Object.defineProperty(nc,"passive",{get:function(){Ag=!0}}),window.addEventListener("test",nc,nc),window.removeEventListener("test",nc,nc)}catch{Ag=!1}function Sk(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var xc=!1,Yh=null,Jh=!1,bg=null,xk={onError:function(t){xc=!0,Yh=t}};function Pk(t,e,n,r,i,s,o,a,l){xc=!1,Yh=null,Sk.apply(xk,arguments)}function kk(t,e,n,r,i,s,o,a,l){if(Pk.apply(this,arguments),xc){if(xc){var u=Yh;xc=!1,Yh=null}else throw Error(q(198));Jh||(Jh=!0,bg=u)}}function Fo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function hA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function e0(t){if(Fo(t)!==t)throw Error(q(188))}function Ck(t){var e=t.alternate;if(!e){if(e=Fo(t),e===null)throw Error(q(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return e0(i),t;if(s===r)return e0(i),e;s=s.sibling}throw Error(q(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?t:e}function fA(t){return t=Ck(t),t!==null?pA(t):null}function pA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pA(t);if(e!==null)return e;t=t.sibling}return null}var mA=kn.unstable_scheduleCallback,t0=kn.unstable_cancelCallback,Nk=kn.unstable_shouldYield,Dk=kn.unstable_requestPaint,st=kn.unstable_now,Ok=kn.unstable_getCurrentPriorityLevel,Zy=kn.unstable_ImmediatePriority,gA=kn.unstable_UserBlockingPriority,Xh=kn.unstable_NormalPriority,Lk=kn.unstable_LowPriority,yA=kn.unstable_IdlePriority,Wf=null,Cr=null;function Vk(t){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Wf,t,void 0,(t.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:jk,Mk=Math.log,Fk=Math.LN2;function jk(t){return t>>>=0,t===0?32:31-(Mk(t)/Fk|0)|0}var Hd=64,Gd=4194304;function _c(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=_c(a):(s&=o,s!==0&&(r=_c(s)))}else o=n&~i,o!==0?r=_c(o):s!==0&&(r=_c(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-lr(e),i=1<<n,r|=t[n],e&=~i;return r}function Uk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-lr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Uk(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Rg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _A(){var t=Hd;return Hd<<=1,!(Hd&4194240)&&(Hd=64),t}function fm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Uu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lr(e),t[e]=n}function $k(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-lr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function e_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-lr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Re=0;function vA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var wA,t_,IA,EA,TA,Sg=!1,Wd=[],ns=null,rs=null,is=null,tu=new Map,nu=new Map,$i=[],zk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function n0(t,e){switch(t){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":rs=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":tu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":nu.delete(e.pointerId)}}function rc(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=$u(e),e!==null&&t_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function qk(t,e,n,r,i){switch(e){case"focusin":return ns=rc(ns,t,e,n,r,i),!0;case"dragenter":return rs=rc(rs,t,e,n,r,i),!0;case"mouseover":return is=rc(is,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return tu.set(s,rc(tu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,nu.set(s,rc(nu.get(s)||null,t,e,n,r,i)),!0}return!1}function AA(t){var e=ro(t.target);if(e!==null){var n=Fo(e);if(n!==null){if(e=n.tag,e===13){if(e=hA(n),e!==null){t.blockedOn=e,TA(t.priority,function(){IA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=xg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Eg=r,n.target.dispatchEvent(r),Eg=null}else return e=$u(n),e!==null&&t_(e),t.blockedOn=n,!1;e.shift()}return!0}function r0(t,e,n){wh(t)&&n.delete(e)}function Hk(){Sg=!1,ns!==null&&wh(ns)&&(ns=null),rs!==null&&wh(rs)&&(rs=null),is!==null&&wh(is)&&(is=null),tu.forEach(r0),nu.forEach(r0)}function ic(t,e){t.blockedOn===e&&(t.blockedOn=null,Sg||(Sg=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,Hk)))}function ru(t){function e(i){return ic(i,t)}if(0<Wd.length){ic(Wd[0],t);for(var n=1;n<Wd.length;n++){var r=Wd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ns!==null&&ic(ns,t),rs!==null&&ic(rs,t),is!==null&&ic(is,t),tu.forEach(e),nu.forEach(e),n=0;n<$i.length;n++)r=$i[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<$i.length&&(n=$i[0],n.blockedOn===null);)AA(n),n.blockedOn===null&&$i.shift()}var ja=fi.ReactCurrentBatchConfig,ef=!0;function Gk(t,e,n,r){var i=Re,s=ja.transition;ja.transition=null;try{Re=1,n_(t,e,n,r)}finally{Re=i,ja.transition=s}}function Wk(t,e,n,r){var i=Re,s=ja.transition;ja.transition=null;try{Re=4,n_(t,e,n,r)}finally{Re=i,ja.transition=s}}function n_(t,e,n,r){if(ef){var i=xg(t,e,n,r);if(i===null)Tm(t,e,r,tf,n),n0(t,r);else if(qk(i,t,e,n,r))r.stopPropagation();else if(n0(t,r),e&4&&-1<zk.indexOf(t)){for(;i!==null;){var s=$u(i);if(s!==null&&wA(s),s=xg(t,e,n,r),s===null&&Tm(t,e,r,tf,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Tm(t,e,r,null,n)}}var tf=null;function xg(t,e,n,r){if(tf=null,t=Xy(r),t=ro(t),t!==null)if(e=Fo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=hA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return tf=t,null}function bA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ok()){case Zy:return 1;case gA:return 4;case Xh:case Lk:return 16;case yA:return 536870912;default:return 16}default:return 16}}var Ji=null,r_=null,Ih=null;function RA(){if(Ih)return Ih;var t,e=r_,n=e.length,r,i="value"in Ji?Ji.value:Ji.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Ih=i.slice(t,1<r?1-r:void 0)}function Eh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Kd(){return!0}function i0(){return!1}function On(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Kd:i0,this.isPropagationStopped=i0,this}return Je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Kd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Kd)},persist:function(){},isPersistent:Kd}),e}var Al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},i_=On(Al),Bu=Je({},Al,{view:0,detail:0}),Kk=On(Bu),pm,mm,sc,Kf=Je({},Bu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:s_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==sc&&(sc&&t.type==="mousemove"?(pm=t.screenX-sc.screenX,mm=t.screenY-sc.screenY):mm=pm=0,sc=t),pm)},movementY:function(t){return"movementY"in t?t.movementY:mm}}),s0=On(Kf),Qk=Je({},Kf,{dataTransfer:0}),Yk=On(Qk),Jk=Je({},Bu,{relatedTarget:0}),gm=On(Jk),Xk=Je({},Al,{animationName:0,elapsedTime:0,pseudoElement:0}),Zk=On(Xk),eC=Je({},Al,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),tC=On(eC),nC=Je({},Al,{data:0}),o0=On(nC),rC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=sC[t])?!!e[t]:!1}function s_(){return oC}var aC=Je({},Bu,{key:function(t){if(t.key){var e=rC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Eh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?iC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:s_,charCode:function(t){return t.type==="keypress"?Eh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Eh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),lC=On(aC),cC=Je({},Kf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),a0=On(cC),uC=Je({},Bu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:s_}),dC=On(uC),hC=Je({},Al,{propertyName:0,elapsedTime:0,pseudoElement:0}),fC=On(hC),pC=Je({},Kf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),mC=On(pC),gC=[9,13,27,32],o_=ri&&"CompositionEvent"in window,Pc=null;ri&&"documentMode"in document&&(Pc=document.documentMode);var yC=ri&&"TextEvent"in window&&!Pc,SA=ri&&(!o_||Pc&&8<Pc&&11>=Pc),l0=String.fromCharCode(32),c0=!1;function xA(t,e){switch(t){case"keyup":return gC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function PA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ra=!1;function _C(t,e){switch(t){case"compositionend":return PA(e);case"keypress":return e.which!==32?null:(c0=!0,l0);case"textInput":return t=e.data,t===l0&&c0?null:t;default:return null}}function vC(t,e){if(Ra)return t==="compositionend"||!o_&&xA(t,e)?(t=RA(),Ih=r_=Ji=null,Ra=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return SA&&e.locale!=="ko"?null:e.data;default:return null}}var wC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!wC[t.type]:e==="textarea"}function kA(t,e,n,r){aA(r),e=nf(e,"onChange"),0<e.length&&(n=new i_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var kc=null,iu=null;function IC(t){BA(t,0)}function Qf(t){var e=Pa(t);if(eA(e))return t}function EC(t,e){if(t==="change")return e}var CA=!1;if(ri){var ym;if(ri){var _m="oninput"in document;if(!_m){var d0=document.createElement("div");d0.setAttribute("oninput","return;"),_m=typeof d0.oninput=="function"}ym=_m}else ym=!1;CA=ym&&(!document.documentMode||9<document.documentMode)}function h0(){kc&&(kc.detachEvent("onpropertychange",NA),iu=kc=null)}function NA(t){if(t.propertyName==="value"&&Qf(iu)){var e=[];kA(e,iu,t,Xy(t)),dA(IC,e)}}function TC(t,e,n){t==="focusin"?(h0(),kc=e,iu=n,kc.attachEvent("onpropertychange",NA)):t==="focusout"&&h0()}function AC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qf(iu)}function bC(t,e){if(t==="click")return Qf(e)}function RC(t,e){if(t==="input"||t==="change")return Qf(e)}function SC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dr=typeof Object.is=="function"?Object.is:SC;function su(t,e){if(dr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ug.call(e,i)||!dr(t[i],e[i]))return!1}return!0}function f0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function p0(t,e){var n=f0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=f0(n)}}function DA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?DA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function OA(){for(var t=window,e=Qh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qh(t.document)}return e}function a_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function xC(t){var e=OA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&DA(n.ownerDocument.documentElement,n)){if(r!==null&&a_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=p0(n,s);var o=p0(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var PC=ri&&"documentMode"in document&&11>=document.documentMode,Sa=null,Pg=null,Cc=null,kg=!1;function m0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;kg||Sa==null||Sa!==Qh(r)||(r=Sa,"selectionStart"in r&&a_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Cc&&su(Cc,r)||(Cc=r,r=nf(Pg,"onSelect"),0<r.length&&(e=new i_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Sa)))}function Qd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xa={animationend:Qd("Animation","AnimationEnd"),animationiteration:Qd("Animation","AnimationIteration"),animationstart:Qd("Animation","AnimationStart"),transitionend:Qd("Transition","TransitionEnd")},vm={},LA={};ri&&(LA=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function Yf(t){if(vm[t])return vm[t];if(!xa[t])return t;var e=xa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in LA)return vm[t]=e[n];return t}var VA=Yf("animationend"),MA=Yf("animationiteration"),FA=Yf("animationstart"),jA=Yf("transitionend"),UA=new Map,g0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(t,e){UA.set(t,e),Mo(e,[t])}for(var wm=0;wm<g0.length;wm++){var Im=g0[wm],kC=Im.toLowerCase(),CC=Im[0].toUpperCase()+Im.slice(1);As(kC,"on"+CC)}As(VA,"onAnimationEnd");As(MA,"onAnimationIteration");As(FA,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(jA,"onTransitionEnd");Ka("onMouseEnter",["mouseout","mouseover"]);Ka("onMouseLeave",["mouseout","mouseover"]);Ka("onPointerEnter",["pointerout","pointerover"]);Ka("onPointerLeave",["pointerout","pointerover"]);Mo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NC=new Set("cancel close invalid load scroll toggle".split(" ").concat(vc));function y0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,kk(r,e,void 0,t),t.currentTarget=null}function BA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;y0(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;y0(i,a,u),s=l}}}if(Jh)throw t=bg,Jh=!1,bg=null,t}function je(t,e){var n=e[Lg];n===void 0&&(n=e[Lg]=new Set);var r=t+"__bubble";n.has(r)||($A(e,t,2,!1),n.add(r))}function Em(t,e,n){var r=0;e&&(r|=4),$A(n,t,r,e)}var Yd="_reactListening"+Math.random().toString(36).slice(2);function ou(t){if(!t[Yd]){t[Yd]=!0,QT.forEach(function(n){n!=="selectionchange"&&(NC.has(n)||Em(n,!1,t),Em(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Yd]||(e[Yd]=!0,Em("selectionchange",!1,e))}}function $A(t,e,n,r){switch(bA(e)){case 1:var i=Gk;break;case 4:i=Wk;break;default:i=n_}n=i.bind(null,e,n,t),i=void 0,!Ag||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Tm(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=ro(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}dA(function(){var u=s,d=Xy(n),f=[];e:{var p=UA.get(t);if(p!==void 0){var v=i_,S=t;switch(t){case"keypress":if(Eh(n)===0)break e;case"keydown":case"keyup":v=lC;break;case"focusin":S="focus",v=gm;break;case"focusout":S="blur",v=gm;break;case"beforeblur":case"afterblur":v=gm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=s0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Yk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=dC;break;case VA:case MA:case FA:v=Zk;break;case jA:v=fC;break;case"scroll":v=Kk;break;case"wheel":v=mC;break;case"copy":case"cut":case"paste":v=tC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=a0}var P=(e&4)!==0,N=!P&&t==="scroll",T=P?p!==null?p+"Capture":null:p;P=[];for(var I=u,b;I!==null;){b=I;var M=b.stateNode;if(b.tag===5&&M!==null&&(b=M,T!==null&&(M=eu(I,T),M!=null&&P.push(au(I,M,b)))),N)break;I=I.return}0<P.length&&(p=new v(p,S,null,n,d),f.push({event:p,listeners:P}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",p&&n!==Eg&&(S=n.relatedTarget||n.fromElement)&&(ro(S)||S[ii]))break e;if((v||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,v?(S=n.relatedTarget||n.toElement,v=u,S=S?ro(S):null,S!==null&&(N=Fo(S),S!==N||S.tag!==5&&S.tag!==6)&&(S=null)):(v=null,S=u),v!==S)){if(P=s0,M="onMouseLeave",T="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(P=a0,M="onPointerLeave",T="onPointerEnter",I="pointer"),N=v==null?p:Pa(v),b=S==null?p:Pa(S),p=new P(M,I+"leave",v,n,d),p.target=N,p.relatedTarget=b,M=null,ro(d)===u&&(P=new P(T,I+"enter",S,n,d),P.target=b,P.relatedTarget=N,M=P),N=M,v&&S)t:{for(P=v,T=S,I=0,b=P;b;b=ua(b))I++;for(b=0,M=T;M;M=ua(M))b++;for(;0<I-b;)P=ua(P),I--;for(;0<b-I;)T=ua(T),b--;for(;I--;){if(P===T||T!==null&&P===T.alternate)break t;P=ua(P),T=ua(T)}P=null}else P=null;v!==null&&_0(f,p,v,P,!1),S!==null&&N!==null&&_0(f,N,S,P,!0)}}e:{if(p=u?Pa(u):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var $=EC;else if(u0(p))if(CA)$=RC;else{$=AC;var z=TC}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&($=bC);if($&&($=$(t,u))){kA(f,$,n,d);break e}z&&z(t,p,u),t==="focusout"&&(z=p._wrapperState)&&z.controlled&&p.type==="number"&&yg(p,"number",p.value)}switch(z=u?Pa(u):window,t){case"focusin":(u0(z)||z.contentEditable==="true")&&(Sa=z,Pg=u,Cc=null);break;case"focusout":Cc=Pg=Sa=null;break;case"mousedown":kg=!0;break;case"contextmenu":case"mouseup":case"dragend":kg=!1,m0(f,n,d);break;case"selectionchange":if(PC)break;case"keydown":case"keyup":m0(f,n,d)}var A;if(o_)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Ra?xA(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(SA&&n.locale!=="ko"&&(Ra||_!=="onCompositionStart"?_==="onCompositionEnd"&&Ra&&(A=RA()):(Ji=d,r_="value"in Ji?Ji.value:Ji.textContent,Ra=!0)),z=nf(u,_),0<z.length&&(_=new o0(_,t,null,n,d),f.push({event:_,listeners:z}),A?_.data=A:(A=PA(n),A!==null&&(_.data=A)))),(A=yC?_C(t,n):vC(t,n))&&(u=nf(u,"onBeforeInput"),0<u.length&&(d=new o0("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=A))}BA(f,e)})}function au(t,e,n){return{instance:t,listener:e,currentTarget:n}}function nf(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=eu(t,n),s!=null&&r.unshift(au(t,s,i)),s=eu(t,e),s!=null&&r.push(au(t,s,i))),t=t.return}return r}function ua(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _0(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=eu(n,s),l!=null&&o.unshift(au(n,l,a))):i||(l=eu(n,s),l!=null&&o.push(au(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var DC=/\r\n?/g,OC=/\u0000|\uFFFD/g;function v0(t){return(typeof t=="string"?t:""+t).replace(DC,`
`).replace(OC,"")}function Jd(t,e,n){if(e=v0(e),v0(t)!==e&&n)throw Error(q(425))}function rf(){}var Cg=null,Ng=null;function Dg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Og=typeof setTimeout=="function"?setTimeout:void 0,LC=typeof clearTimeout=="function"?clearTimeout:void 0,w0=typeof Promise=="function"?Promise:void 0,VC=typeof queueMicrotask=="function"?queueMicrotask:typeof w0<"u"?function(t){return w0.resolve(null).then(t).catch(MC)}:Og;function MC(t){setTimeout(function(){throw t})}function Am(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ru(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ru(e)}function ss(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function I0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var bl=Math.random().toString(36).slice(2),Rr="__reactFiber$"+bl,lu="__reactProps$"+bl,ii="__reactContainer$"+bl,Lg="__reactEvents$"+bl,FC="__reactListeners$"+bl,jC="__reactHandles$"+bl;function ro(t){var e=t[Rr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ii]||n[Rr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=I0(t);t!==null;){if(n=t[Rr])return n;t=I0(t)}return e}t=n,n=t.parentNode}return null}function $u(t){return t=t[Rr]||t[ii],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Pa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function Jf(t){return t[lu]||null}var Vg=[],ka=-1;function bs(t){return{current:t}}function $e(t){0>ka||(t.current=Vg[ka],Vg[ka]=null,ka--)}function Le(t,e){ka++,Vg[ka]=t.current,t.current=e}var gs={},Kt=bs(gs),pn=bs(!1),vo=gs;function Qa(t,e){var n=t.type.contextTypes;if(!n)return gs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function mn(t){return t=t.childContextTypes,t!=null}function sf(){$e(pn),$e(Kt)}function E0(t,e,n){if(Kt.current!==gs)throw Error(q(168));Le(Kt,e),Le(pn,n)}function zA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(q(108,Tk(t)||"Unknown",i));return Je({},n,r)}function of(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gs,vo=Kt.current,Le(Kt,t),Le(pn,pn.current),!0}function T0(t,e,n){var r=t.stateNode;if(!r)throw Error(q(169));n?(t=zA(t,e,vo),r.__reactInternalMemoizedMergedChildContext=t,$e(pn),$e(Kt),Le(Kt,t)):$e(pn),Le(pn,n)}var Kr=null,Xf=!1,bm=!1;function qA(t){Kr===null?Kr=[t]:Kr.push(t)}function UC(t){Xf=!0,qA(t)}function Rs(){if(!bm&&Kr!==null){bm=!0;var t=0,e=Re;try{var n=Kr;for(Re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Kr=null,Xf=!1}catch(i){throw Kr!==null&&(Kr=Kr.slice(t+1)),mA(Zy,Rs),i}finally{Re=e,bm=!1}}return null}var Ca=[],Na=0,af=null,lf=0,jn=[],Un=0,wo=null,Qr=1,Yr="";function Gs(t,e){Ca[Na++]=lf,Ca[Na++]=af,af=t,lf=e}function HA(t,e,n){jn[Un++]=Qr,jn[Un++]=Yr,jn[Un++]=wo,wo=t;var r=Qr;t=Yr;var i=32-lr(r)-1;r&=~(1<<i),n+=1;var s=32-lr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Qr=1<<32-lr(e)+i|n<<i|r,Yr=s+t}else Qr=1<<s|n<<i|r,Yr=t}function l_(t){t.return!==null&&(Gs(t,1),HA(t,1,0))}function c_(t){for(;t===af;)af=Ca[--Na],Ca[Na]=null,lf=Ca[--Na],Ca[Na]=null;for(;t===wo;)wo=jn[--Un],jn[Un]=null,Yr=jn[--Un],jn[Un]=null,Qr=jn[--Un],jn[Un]=null}var Rn=null,An=null,Ge=!1,or=null;function GA(t,e){var n=Bn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function A0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Rn=t,An=ss(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Rn=t,An=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=wo!==null?{id:Qr,overflow:Yr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Rn=t,An=null,!0):!1;default:return!1}}function Mg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fg(t){if(Ge){var e=An;if(e){var n=e;if(!A0(t,e)){if(Mg(t))throw Error(q(418));e=ss(n.nextSibling);var r=Rn;e&&A0(t,e)?GA(r,n):(t.flags=t.flags&-4097|2,Ge=!1,Rn=t)}}else{if(Mg(t))throw Error(q(418));t.flags=t.flags&-4097|2,Ge=!1,Rn=t}}}function b0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Rn=t}function Xd(t){if(t!==Rn)return!1;if(!Ge)return b0(t),Ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Dg(t.type,t.memoizedProps)),e&&(e=An)){if(Mg(t))throw WA(),Error(q(418));for(;e;)GA(t,e),e=ss(e.nextSibling)}if(b0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){An=ss(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}An=null}}else An=Rn?ss(t.stateNode.nextSibling):null;return!0}function WA(){for(var t=An;t;)t=ss(t.nextSibling)}function Ya(){An=Rn=null,Ge=!1}function u_(t){or===null?or=[t]:or.push(t)}var BC=fi.ReactCurrentBatchConfig;function oc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,t))}return t}function Zd(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function R0(t){var e=t._init;return e(t._payload)}function KA(t){function e(T,I){if(t){var b=T.deletions;b===null?(T.deletions=[I],T.flags|=16):b.push(I)}}function n(T,I){if(!t)return null;for(;I!==null;)e(T,I),I=I.sibling;return null}function r(T,I){for(T=new Map;I!==null;)I.key!==null?T.set(I.key,I):T.set(I.index,I),I=I.sibling;return T}function i(T,I){return T=cs(T,I),T.index=0,T.sibling=null,T}function s(T,I,b){return T.index=b,t?(b=T.alternate,b!==null?(b=b.index,b<I?(T.flags|=2,I):b):(T.flags|=2,I)):(T.flags|=1048576,I)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function a(T,I,b,M){return I===null||I.tag!==6?(I=Nm(b,T.mode,M),I.return=T,I):(I=i(I,b),I.return=T,I)}function l(T,I,b,M){var $=b.type;return $===ba?d(T,I,b.props.children,M,b.key):I!==null&&(I.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===ji&&R0($)===I.type)?(M=i(I,b.props),M.ref=oc(T,I,b),M.return=T,M):(M=Ph(b.type,b.key,b.props,null,T.mode,M),M.ref=oc(T,I,b),M.return=T,M)}function u(T,I,b,M){return I===null||I.tag!==4||I.stateNode.containerInfo!==b.containerInfo||I.stateNode.implementation!==b.implementation?(I=Dm(b,T.mode,M),I.return=T,I):(I=i(I,b.children||[]),I.return=T,I)}function d(T,I,b,M,$){return I===null||I.tag!==7?(I=ho(b,T.mode,M,$),I.return=T,I):(I=i(I,b),I.return=T,I)}function f(T,I,b){if(typeof I=="string"&&I!==""||typeof I=="number")return I=Nm(""+I,T.mode,b),I.return=T,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case $d:return b=Ph(I.type,I.key,I.props,null,T.mode,b),b.ref=oc(T,null,I),b.return=T,b;case Aa:return I=Dm(I,T.mode,b),I.return=T,I;case ji:var M=I._init;return f(T,M(I._payload),b)}if(yc(I)||tc(I))return I=ho(I,T.mode,b,null),I.return=T,I;Zd(T,I)}return null}function p(T,I,b,M){var $=I!==null?I.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return $!==null?null:a(T,I,""+b,M);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case $d:return b.key===$?l(T,I,b,M):null;case Aa:return b.key===$?u(T,I,b,M):null;case ji:return $=b._init,p(T,I,$(b._payload),M)}if(yc(b)||tc(b))return $!==null?null:d(T,I,b,M,null);Zd(T,b)}return null}function v(T,I,b,M,$){if(typeof M=="string"&&M!==""||typeof M=="number")return T=T.get(b)||null,a(I,T,""+M,$);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case $d:return T=T.get(M.key===null?b:M.key)||null,l(I,T,M,$);case Aa:return T=T.get(M.key===null?b:M.key)||null,u(I,T,M,$);case ji:var z=M._init;return v(T,I,b,z(M._payload),$)}if(yc(M)||tc(M))return T=T.get(b)||null,d(I,T,M,$,null);Zd(I,M)}return null}function S(T,I,b,M){for(var $=null,z=null,A=I,_=I=0,R=null;A!==null&&_<b.length;_++){A.index>_?(R=A,A=null):R=A.sibling;var E=p(T,A,b[_],M);if(E===null){A===null&&(A=R);break}t&&A&&E.alternate===null&&e(T,A),I=s(E,I,_),z===null?$=E:z.sibling=E,z=E,A=R}if(_===b.length)return n(T,A),Ge&&Gs(T,_),$;if(A===null){for(;_<b.length;_++)A=f(T,b[_],M),A!==null&&(I=s(A,I,_),z===null?$=A:z.sibling=A,z=A);return Ge&&Gs(T,_),$}for(A=r(T,A);_<b.length;_++)R=v(A,T,_,b[_],M),R!==null&&(t&&R.alternate!==null&&A.delete(R.key===null?_:R.key),I=s(R,I,_),z===null?$=R:z.sibling=R,z=R);return t&&A.forEach(function(k){return e(T,k)}),Ge&&Gs(T,_),$}function P(T,I,b,M){var $=tc(b);if(typeof $!="function")throw Error(q(150));if(b=$.call(b),b==null)throw Error(q(151));for(var z=$=null,A=I,_=I=0,R=null,E=b.next();A!==null&&!E.done;_++,E=b.next()){A.index>_?(R=A,A=null):R=A.sibling;var k=p(T,A,E.value,M);if(k===null){A===null&&(A=R);break}t&&A&&k.alternate===null&&e(T,A),I=s(k,I,_),z===null?$=k:z.sibling=k,z=k,A=R}if(E.done)return n(T,A),Ge&&Gs(T,_),$;if(A===null){for(;!E.done;_++,E=b.next())E=f(T,E.value,M),E!==null&&(I=s(E,I,_),z===null?$=E:z.sibling=E,z=E);return Ge&&Gs(T,_),$}for(A=r(T,A);!E.done;_++,E=b.next())E=v(A,T,_,E.value,M),E!==null&&(t&&E.alternate!==null&&A.delete(E.key===null?_:E.key),I=s(E,I,_),z===null?$=E:z.sibling=E,z=E);return t&&A.forEach(function(D){return e(T,D)}),Ge&&Gs(T,_),$}function N(T,I,b,M){if(typeof b=="object"&&b!==null&&b.type===ba&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case $d:e:{for(var $=b.key,z=I;z!==null;){if(z.key===$){if($=b.type,$===ba){if(z.tag===7){n(T,z.sibling),I=i(z,b.props.children),I.return=T,T=I;break e}}else if(z.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===ji&&R0($)===z.type){n(T,z.sibling),I=i(z,b.props),I.ref=oc(T,z,b),I.return=T,T=I;break e}n(T,z);break}else e(T,z);z=z.sibling}b.type===ba?(I=ho(b.props.children,T.mode,M,b.key),I.return=T,T=I):(M=Ph(b.type,b.key,b.props,null,T.mode,M),M.ref=oc(T,I,b),M.return=T,T=M)}return o(T);case Aa:e:{for(z=b.key;I!==null;){if(I.key===z)if(I.tag===4&&I.stateNode.containerInfo===b.containerInfo&&I.stateNode.implementation===b.implementation){n(T,I.sibling),I=i(I,b.children||[]),I.return=T,T=I;break e}else{n(T,I);break}else e(T,I);I=I.sibling}I=Dm(b,T.mode,M),I.return=T,T=I}return o(T);case ji:return z=b._init,N(T,I,z(b._payload),M)}if(yc(b))return S(T,I,b,M);if(tc(b))return P(T,I,b,M);Zd(T,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,I!==null&&I.tag===6?(n(T,I.sibling),I=i(I,b),I.return=T,T=I):(n(T,I),I=Nm(b,T.mode,M),I.return=T,T=I),o(T)):n(T,I)}return N}var Ja=KA(!0),QA=KA(!1),cf=bs(null),uf=null,Da=null,d_=null;function h_(){d_=Da=uf=null}function f_(t){var e=cf.current;$e(cf),t._currentValue=e}function jg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ua(t,e){uf=t,d_=Da=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(un=!0),t.firstContext=null)}function zn(t){var e=t._currentValue;if(d_!==t)if(t={context:t,memoizedValue:e,next:null},Da===null){if(uf===null)throw Error(q(308));Da=t,uf.dependencies={lanes:0,firstContext:t}}else Da=Da.next=t;return e}var io=null;function p_(t){io===null?io=[t]:io.push(t)}function YA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,p_(e)):(n.next=i.next,i.next=n),e.interleaved=n,si(t,r)}function si(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ui=!1;function m_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ei(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function os(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,si(t,n)}return i=r.interleaved,i===null?(e.next=e,p_(r)):(e.next=i.next,i.next=e),r.interleaved=e,si(t,n)}function Th(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,e_(t,n)}}function S0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function df(t,e,n,r){var i=t.updateQueue;Ui=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,d=u=l=null,a=s;do{var p=a.lane,v=a.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var S=t,P=a;switch(p=e,v=n,P.tag){case 1:if(S=P.payload,typeof S=="function"){f=S.call(v,f,p);break e}f=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=P.payload,p=typeof S=="function"?S.call(v,f,p):S,p==null)break e;f=Je({},f,p);break e;case 2:Ui=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else v={eventTime:v,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=v,l=f):d=d.next=v,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(1);if(d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Eo|=o,t.lanes=o,t.memoizedState=f}}function x0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(q(191,i));i.call(r)}}}var zu={},Nr=bs(zu),cu=bs(zu),uu=bs(zu);function so(t){if(t===zu)throw Error(q(174));return t}function g_(t,e){switch(Le(uu,e),Le(cu,t),Le(Nr,zu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:vg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=vg(e,t)}$e(Nr),Le(Nr,e)}function Xa(){$e(Nr),$e(cu),$e(uu)}function XA(t){so(uu.current);var e=so(Nr.current),n=vg(e,t.type);e!==n&&(Le(cu,t),Le(Nr,n))}function y_(t){cu.current===t&&($e(Nr),$e(cu))}var Qe=bs(0);function hf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rm=[];function __(){for(var t=0;t<Rm.length;t++)Rm[t]._workInProgressVersionPrimary=null;Rm.length=0}var Ah=fi.ReactCurrentDispatcher,Sm=fi.ReactCurrentBatchConfig,Io=0,Ye=null,_t=null,bt=null,ff=!1,Nc=!1,du=0,$C=0;function Ut(){throw Error(q(321))}function v_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dr(t[n],e[n]))return!1;return!0}function w_(t,e,n,r,i,s){if(Io=s,Ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ah.current=t===null||t.memoizedState===null?GC:WC,t=n(r,i),Nc){s=0;do{if(Nc=!1,du=0,25<=s)throw Error(q(301));s+=1,bt=_t=null,e.updateQueue=null,Ah.current=KC,t=n(r,i)}while(Nc)}if(Ah.current=pf,e=_t!==null&&_t.next!==null,Io=0,bt=_t=Ye=null,ff=!1,e)throw Error(q(300));return t}function I_(){var t=du!==0;return du=0,t}function Tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?Ye.memoizedState=bt=t:bt=bt.next=t,bt}function qn(){if(_t===null){var t=Ye.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var e=bt===null?Ye.memoizedState:bt.next;if(e!==null)bt=e,_t=t;else{if(t===null)throw Error(q(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},bt===null?Ye.memoizedState=bt=t:bt=bt.next=t}return bt}function hu(t,e){return typeof e=="function"?e(t):e}function xm(t){var e=qn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=_t,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((Io&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,Ye.lanes|=d,Eo|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,dr(r,e.memoizedState)||(un=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ye.lanes|=s,Eo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Pm(t){var e=qn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);dr(s,e.memoizedState)||(un=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function ZA(){}function e1(t,e){var n=Ye,r=qn(),i=e(),s=!dr(r.memoizedState,i);if(s&&(r.memoizedState=i,un=!0),r=r.queue,E_(r1.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,fu(9,n1.bind(null,n,r,i,e),void 0,null),St===null)throw Error(q(349));Io&30||t1(n,e,i)}return i}function t1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function n1(t,e,n,r){e.value=n,e.getSnapshot=r,i1(e)&&s1(t)}function r1(t,e,n){return n(function(){i1(e)&&s1(t)})}function i1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dr(t,n)}catch{return!0}}function s1(t){var e=si(t,1);e!==null&&cr(e,t,1,-1)}function P0(t){var e=Tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hu,lastRenderedState:t},e.queue=t,t=t.dispatch=HC.bind(null,Ye,t),[e.memoizedState,t]}function fu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function o1(){return qn().memoizedState}function bh(t,e,n,r){var i=Tr();Ye.flags|=t,i.memoizedState=fu(1|e,n,void 0,r===void 0?null:r)}function Zf(t,e,n,r){var i=qn();r=r===void 0?null:r;var s=void 0;if(_t!==null){var o=_t.memoizedState;if(s=o.destroy,r!==null&&v_(r,o.deps)){i.memoizedState=fu(e,n,s,r);return}}Ye.flags|=t,i.memoizedState=fu(1|e,n,s,r)}function k0(t,e){return bh(8390656,8,t,e)}function E_(t,e){return Zf(2048,8,t,e)}function a1(t,e){return Zf(4,2,t,e)}function l1(t,e){return Zf(4,4,t,e)}function c1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function u1(t,e,n){return n=n!=null?n.concat([t]):null,Zf(4,4,c1.bind(null,e,t),n)}function T_(){}function d1(t,e){var n=qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&v_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function h1(t,e){var n=qn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&v_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function f1(t,e,n){return Io&21?(dr(n,e)||(n=_A(),Ye.lanes|=n,Eo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,un=!0),t.memoizedState=n)}function zC(t,e){var n=Re;Re=n!==0&&4>n?n:4,t(!0);var r=Sm.transition;Sm.transition={};try{t(!1),e()}finally{Re=n,Sm.transition=r}}function p1(){return qn().memoizedState}function qC(t,e,n){var r=ls(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},m1(t))g1(e,n);else if(n=YA(t,e,n,r),n!==null){var i=Zt();cr(n,t,r,i),y1(n,e,r)}}function HC(t,e,n){var r=ls(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(m1(t))g1(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,dr(a,o)){var l=e.interleaved;l===null?(i.next=i,p_(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=YA(t,e,i,r),n!==null&&(i=Zt(),cr(n,t,r,i),y1(n,e,r))}}function m1(t){var e=t.alternate;return t===Ye||e!==null&&e===Ye}function g1(t,e){Nc=ff=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function y1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,e_(t,n)}}var pf={readContext:zn,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},GC={readContext:zn,useCallback:function(t,e){return Tr().memoizedState=[t,e===void 0?null:e],t},useContext:zn,useEffect:k0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,bh(4194308,4,c1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bh(4194308,4,t,e)},useInsertionEffect:function(t,e){return bh(4,2,t,e)},useMemo:function(t,e){var n=Tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=qC.bind(null,Ye,t),[r.memoizedState,t]},useRef:function(t){var e=Tr();return t={current:t},e.memoizedState=t},useState:P0,useDebugValue:T_,useDeferredValue:function(t){return Tr().memoizedState=t},useTransition:function(){var t=P0(!1),e=t[0];return t=zC.bind(null,t[1]),Tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ye,i=Tr();if(Ge){if(n===void 0)throw Error(q(407));n=n()}else{if(n=e(),St===null)throw Error(q(349));Io&30||t1(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,k0(r1.bind(null,r,s,t),[t]),r.flags|=2048,fu(9,n1.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Tr(),e=St.identifierPrefix;if(Ge){var n=Yr,r=Qr;n=(r&~(1<<32-lr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=du++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$C++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},WC={readContext:zn,useCallback:d1,useContext:zn,useEffect:E_,useImperativeHandle:u1,useInsertionEffect:a1,useLayoutEffect:l1,useMemo:h1,useReducer:xm,useRef:o1,useState:function(){return xm(hu)},useDebugValue:T_,useDeferredValue:function(t){var e=qn();return f1(e,_t.memoizedState,t)},useTransition:function(){var t=xm(hu)[0],e=qn().memoizedState;return[t,e]},useMutableSource:ZA,useSyncExternalStore:e1,useId:p1,unstable_isNewReconciler:!1},KC={readContext:zn,useCallback:d1,useContext:zn,useEffect:E_,useImperativeHandle:u1,useInsertionEffect:a1,useLayoutEffect:l1,useMemo:h1,useReducer:Pm,useRef:o1,useState:function(){return Pm(hu)},useDebugValue:T_,useDeferredValue:function(t){var e=qn();return _t===null?e.memoizedState=t:f1(e,_t.memoizedState,t)},useTransition:function(){var t=Pm(hu)[0],e=qn().memoizedState;return[t,e]},useMutableSource:ZA,useSyncExternalStore:e1,useId:p1,unstable_isNewReconciler:!1};function nr(t,e){if(t&&t.defaultProps){e=Je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ug(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ep={isMounted:function(t){return(t=t._reactInternals)?Fo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Zt(),i=ls(t),s=ei(r,i);s.payload=e,n!=null&&(s.callback=n),e=os(t,s,i),e!==null&&(cr(e,t,i,r),Th(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Zt(),i=ls(t),s=ei(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=os(t,s,i),e!==null&&(cr(e,t,i,r),Th(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Zt(),r=ls(t),i=ei(n,r);i.tag=2,e!=null&&(i.callback=e),e=os(t,i,r),e!==null&&(cr(e,t,r,n),Th(e,t,r))}};function C0(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!su(n,r)||!su(i,s):!0}function _1(t,e,n){var r=!1,i=gs,s=e.contextType;return typeof s=="object"&&s!==null?s=zn(s):(i=mn(e)?vo:Kt.current,r=e.contextTypes,s=(r=r!=null)?Qa(t,i):gs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ep,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function N0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ep.enqueueReplaceState(e,e.state,null)}function Bg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},m_(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=zn(s):(s=mn(e)?vo:Kt.current,i.context=Qa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ug(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ep.enqueueReplaceState(i,i.state,null),df(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Za(t,e){try{var n="",r=e;do n+=Ek(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function km(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $g(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var QC=typeof WeakMap=="function"?WeakMap:Map;function v1(t,e,n){n=ei(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){gf||(gf=!0,Xg=r),$g(t,e)},n}function w1(t,e,n){n=ei(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$g(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){$g(t,e),typeof r!="function"&&(as===null?as=new Set([this]):as.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function D0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new QC;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=cN.bind(null,t,e,n),e.then(t,t))}function O0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function L0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ei(-1,1),e.tag=2,os(n,e,1))),n.lanes|=1),t)}var YC=fi.ReactCurrentOwner,un=!1;function Xt(t,e,n,r){e.child=t===null?QA(e,null,n,r):Ja(e,t.child,n,r)}function V0(t,e,n,r,i){n=n.render;var s=e.ref;return Ua(e,i),r=w_(t,e,n,r,s,i),n=I_(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oi(t,e,i)):(Ge&&n&&l_(e),e.flags|=1,Xt(t,e,r,i),e.child)}function M0(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!C_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,I1(t,e,s,r,i)):(t=Ph(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:su,n(o,r)&&t.ref===e.ref)return oi(t,e,i)}return e.flags|=1,t=cs(s,r),t.ref=e.ref,t.return=e,e.child=t}function I1(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(su(s,r)&&t.ref===e.ref)if(un=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(un=!0);else return e.lanes=t.lanes,oi(t,e,i)}return zg(t,e,n,r,i)}function E1(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(La,In),In|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Le(La,In),In|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Le(La,In),In|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Le(La,In),In|=r;return Xt(t,e,i,n),e.child}function T1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function zg(t,e,n,r,i){var s=mn(n)?vo:Kt.current;return s=Qa(e,s),Ua(e,i),n=w_(t,e,n,r,s,i),r=I_(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oi(t,e,i)):(Ge&&r&&l_(e),e.flags|=1,Xt(t,e,n,i),e.child)}function F0(t,e,n,r,i){if(mn(n)){var s=!0;of(e)}else s=!1;if(Ua(e,i),e.stateNode===null)Rh(t,e),_1(e,n,r),Bg(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=zn(u):(u=mn(n)?vo:Kt.current,u=Qa(e,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&N0(e,o,r,u),Ui=!1;var p=e.memoizedState;o.state=p,df(e,r,o,i),l=e.memoizedState,a!==r||p!==l||pn.current||Ui?(typeof d=="function"&&(Ug(e,n,d,r),l=e.memoizedState),(a=Ui||C0(e,n,a,r,p,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,JA(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:nr(e.type,a),o.props=u,f=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=zn(l):(l=mn(n)?vo:Kt.current,l=Qa(e,l));var v=n.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&N0(e,o,r,l),Ui=!1,p=e.memoizedState,o.state=p,df(e,r,o,i);var S=e.memoizedState;a!==f||p!==S||pn.current||Ui?(typeof v=="function"&&(Ug(e,n,v,r),S=e.memoizedState),(u=Ui||C0(e,n,u,r,p,S,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return qg(t,e,n,r,s,i)}function qg(t,e,n,r,i,s){T1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&T0(e,n,!1),oi(t,e,s);r=e.stateNode,YC.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ja(e,t.child,null,s),e.child=Ja(e,null,a,s)):Xt(t,e,a,s),e.memoizedState=r.state,i&&T0(e,n,!0),e.child}function A1(t){var e=t.stateNode;e.pendingContext?E0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&E0(t,e.context,!1),g_(t,e.containerInfo)}function j0(t,e,n,r,i){return Ya(),u_(i),e.flags|=256,Xt(t,e,n,r),e.child}var Hg={dehydrated:null,treeContext:null,retryLane:0};function Gg(t){return{baseLanes:t,cachePool:null,transitions:null}}function b1(t,e,n){var r=e.pendingProps,i=Qe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Le(Qe,i&1),t===null)return Fg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=rp(o,r,0,null),t=ho(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Gg(n),e.memoizedState=Hg,t):A_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return JC(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=cs(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=cs(a,s):(s=ho(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Gg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Hg,r}return s=t.child,t=s.sibling,r=cs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function A_(t,e){return e=rp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function eh(t,e,n,r){return r!==null&&u_(r),Ja(e,t.child,null,n),t=A_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function JC(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=km(Error(q(422))),eh(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=rp({mode:"visible",children:r.children},i,0,null),s=ho(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ja(e,t.child,null,o),e.child.memoizedState=Gg(o),e.memoizedState=Hg,s);if(!(e.mode&1))return eh(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(q(419)),r=km(s,r,void 0),eh(t,e,o,r)}if(a=(o&t.childLanes)!==0,un||a){if(r=St,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,si(t,i),cr(r,t,i,-1))}return k_(),r=km(Error(q(421))),eh(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=uN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,An=ss(i.nextSibling),Rn=e,Ge=!0,or=null,t!==null&&(jn[Un++]=Qr,jn[Un++]=Yr,jn[Un++]=wo,Qr=t.id,Yr=t.overflow,wo=e),e=A_(e,r.children),e.flags|=4096,e)}function U0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jg(t.return,e,n)}function Cm(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function R1(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Xt(t,e,r.children,n),r=Qe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&U0(t,n,e);else if(t.tag===19)U0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Le(Qe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&hf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Cm(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&hf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Cm(e,!0,n,null,s);break;case"together":Cm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function oi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Eo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,n=cs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=cs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function XC(t,e,n){switch(e.tag){case 3:A1(e),Ya();break;case 5:XA(e);break;case 1:mn(e.type)&&of(e);break;case 4:g_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Le(cf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Le(Qe,Qe.current&1),e.flags|=128,null):n&e.child.childLanes?b1(t,e,n):(Le(Qe,Qe.current&1),t=oi(t,e,n),t!==null?t.sibling:null);Le(Qe,Qe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return R1(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Le(Qe,Qe.current),r)break;return null;case 22:case 23:return e.lanes=0,E1(t,e,n)}return oi(t,e,n)}var S1,Wg,x1,P1;S1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Wg=function(){};x1=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,so(Nr.current);var s=null;switch(n){case"input":i=mg(t,i),r=mg(t,r),s=[];break;case"select":i=Je({},i,{value:void 0}),r=Je({},r,{value:void 0}),s=[];break;case"textarea":i=_g(t,i),r=_g(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=rf)}wg(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Xc.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Xc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&je("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};P1=function(t,e,n,r){n!==r&&(e.flags|=4)};function ac(t,e){if(!Ge)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ZC(t,e,n){var r=e.pendingProps;switch(c_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return mn(e.type)&&sf(),Bt(e),null;case 3:return r=e.stateNode,Xa(),$e(pn),$e(Kt),__(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Xd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,or!==null&&(ty(or),or=null))),Wg(t,e),Bt(e),null;case 5:y_(e);var i=so(uu.current);if(n=e.type,t!==null&&e.stateNode!=null)x1(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(q(166));return Bt(e),null}if(t=so(Nr.current),Xd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Rr]=e,r[lu]=s,t=(e.mode&1)!==0,n){case"dialog":je("cancel",r),je("close",r);break;case"iframe":case"object":case"embed":je("load",r);break;case"video":case"audio":for(i=0;i<vc.length;i++)je(vc[i],r);break;case"source":je("error",r);break;case"img":case"image":case"link":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"input":Qw(r,s),je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},je("invalid",r);break;case"textarea":Jw(r,s),je("invalid",r)}wg(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Jd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Jd(r.textContent,a,t),i=["children",""+a]):Xc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&je("scroll",r)}switch(n){case"input":zd(r),Yw(r,s,!0);break;case"textarea":zd(r),Xw(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=rf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rA(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Rr]=e,t[lu]=r,S1(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ig(n,r),n){case"dialog":je("cancel",t),je("close",t),i=r;break;case"iframe":case"object":case"embed":je("load",t),i=r;break;case"video":case"audio":for(i=0;i<vc.length;i++)je(vc[i],t);i=r;break;case"source":je("error",t),i=r;break;case"img":case"image":case"link":je("error",t),je("load",t),i=r;break;case"details":je("toggle",t),i=r;break;case"input":Qw(t,r),i=mg(t,r),je("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Je({},r,{value:void 0}),je("invalid",t);break;case"textarea":Jw(t,r),i=_g(t,r),je("invalid",t);break;default:i=r}wg(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?oA(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&iA(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Zc(t,l):typeof l=="number"&&Zc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Xc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&je("scroll",t):l!=null&&Ky(t,s,l,o))}switch(n){case"input":zd(t),Yw(t,r,!1);break;case"textarea":zd(t),Xw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ms(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Va(t,!!r.multiple,s,!1):r.defaultValue!=null&&Va(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=rf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(t&&e.stateNode!=null)P1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(q(166));if(n=so(uu.current),so(Nr.current),Xd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Rr]=e,(s=r.nodeValue!==n)&&(t=Rn,t!==null))switch(t.tag){case 3:Jd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Jd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Rr]=e,e.stateNode=r}return Bt(e),null;case 13:if($e(Qe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ge&&An!==null&&e.mode&1&&!(e.flags&128))WA(),Ya(),e.flags|=98560,s=!1;else if(s=Xd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(q(317));s[Rr]=e}else Ya(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),s=!1}else or!==null&&(ty(or),or=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Qe.current&1?vt===0&&(vt=3):k_())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return Xa(),Wg(t,e),t===null&&ou(e.stateNode.containerInfo),Bt(e),null;case 10:return f_(e.type._context),Bt(e),null;case 17:return mn(e.type)&&sf(),Bt(e),null;case 19:if($e(Qe),s=e.memoizedState,s===null)return Bt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)ac(s,!1);else{if(vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=hf(t),o!==null){for(e.flags|=128,ac(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Le(Qe,Qe.current&1|2),e.child}t=t.sibling}s.tail!==null&&st()>el&&(e.flags|=128,r=!0,ac(s,!1),e.lanes=4194304)}else{if(!r)if(t=hf(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ac(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ge)return Bt(e),null}else 2*st()-s.renderingStartTime>el&&n!==1073741824&&(e.flags|=128,r=!0,ac(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=st(),e.sibling=null,n=Qe.current,Le(Qe,r?n&1|2:n&1),e):(Bt(e),null);case 22:case 23:return P_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?In&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function eN(t,e){switch(c_(e),e.tag){case 1:return mn(e.type)&&sf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Xa(),$e(pn),$e(Kt),__(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return y_(e),null;case 13:if($e(Qe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));Ya()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $e(Qe),null;case 4:return Xa(),null;case 10:return f_(e.type._context),null;case 22:case 23:return P_(),null;case 24:return null;default:return null}}var th=!1,qt=!1,tN=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Oa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){et(t,e,r)}else n.current=null}function Kg(t,e,n){try{n()}catch(r){et(t,e,r)}}var B0=!1;function nN(t,e){if(Cg=ef,t=OA(),a_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,f=t,p=null;t:for(;;){for(var v;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)p=f,f=v;for(;;){if(f===t)break t;if(p===n&&++u===i&&(a=o),p===s&&++d===r&&(l=o),(v=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=v}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ng={focusedElem:t,selectionRange:n},ef=!1,ee=e;ee!==null;)if(e=ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ee=t;else for(;ee!==null;){e=ee;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var P=S.memoizedProps,N=S.memoizedState,T=e.stateNode,I=T.getSnapshotBeforeUpdate(e.elementType===e.type?P:nr(e.type,P),N);T.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(M){et(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}return S=B0,B0=!1,S}function Dc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Kg(e,n,s)}i=i.next}while(i!==r)}}function tp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Qg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function k1(t){var e=t.alternate;e!==null&&(t.alternate=null,k1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rr],delete e[lu],delete e[Lg],delete e[FC],delete e[jC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function C1(t){return t.tag===5||t.tag===3||t.tag===4}function $0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||C1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=rf));else if(r!==4&&(t=t.child,t!==null))for(Yg(t,e,n),t=t.sibling;t!==null;)Yg(t,e,n),t=t.sibling}function Jg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Jg(t,e,n),t=t.sibling;t!==null;)Jg(t,e,n),t=t.sibling}var Dt=null,ir=!1;function Di(t,e,n){for(n=n.child;n!==null;)N1(t,e,n),n=n.sibling}function N1(t,e,n){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Wf,n)}catch{}switch(n.tag){case 5:qt||Oa(n,e);case 6:var r=Dt,i=ir;Dt=null,Di(t,e,n),Dt=r,ir=i,Dt!==null&&(ir?(t=Dt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(ir?(t=Dt,n=n.stateNode,t.nodeType===8?Am(t.parentNode,n):t.nodeType===1&&Am(t,n),ru(t)):Am(Dt,n.stateNode));break;case 4:r=Dt,i=ir,Dt=n.stateNode.containerInfo,ir=!0,Di(t,e,n),Dt=r,ir=i;break;case 0:case 11:case 14:case 15:if(!qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Kg(n,e,o),i=i.next}while(i!==r)}Di(t,e,n);break;case 1:if(!qt&&(Oa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){et(n,e,a)}Di(t,e,n);break;case 21:Di(t,e,n);break;case 22:n.mode&1?(qt=(r=qt)||n.memoizedState!==null,Di(t,e,n),qt=r):Di(t,e,n);break;default:Di(t,e,n)}}function z0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new tN),e.forEach(function(r){var i=dN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function tr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Dt=a.stateNode,ir=!1;break e;case 3:Dt=a.stateNode.containerInfo,ir=!0;break e;case 4:Dt=a.stateNode.containerInfo,ir=!0;break e}a=a.return}if(Dt===null)throw Error(q(160));N1(s,o,i),Dt=null,ir=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){et(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)D1(e,t),e=e.sibling}function D1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tr(e,t),Er(t),r&4){try{Dc(3,t,t.return),tp(3,t)}catch(P){et(t,t.return,P)}try{Dc(5,t,t.return)}catch(P){et(t,t.return,P)}}break;case 1:tr(e,t),Er(t),r&512&&n!==null&&Oa(n,n.return);break;case 5:if(tr(e,t),Er(t),r&512&&n!==null&&Oa(n,n.return),t.flags&32){var i=t.stateNode;try{Zc(i,"")}catch(P){et(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&tA(i,s),Ig(a,o);var u=Ig(a,s);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?oA(i,f):d==="dangerouslySetInnerHTML"?iA(i,f):d==="children"?Zc(i,f):Ky(i,d,f,u)}switch(a){case"input":gg(i,s);break;case"textarea":nA(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Va(i,!!s.multiple,v,!1):p!==!!s.multiple&&(s.defaultValue!=null?Va(i,!!s.multiple,s.defaultValue,!0):Va(i,!!s.multiple,s.multiple?[]:"",!1))}i[lu]=s}catch(P){et(t,t.return,P)}}break;case 6:if(tr(e,t),Er(t),r&4){if(t.stateNode===null)throw Error(q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){et(t,t.return,P)}}break;case 3:if(tr(e,t),Er(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ru(e.containerInfo)}catch(P){et(t,t.return,P)}break;case 4:tr(e,t),Er(t);break;case 13:tr(e,t),Er(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(S_=st())),r&4&&z0(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(qt=(u=qt)||d,tr(e,t),qt=u):tr(e,t),Er(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ee=t,d=t.child;d!==null;){for(f=ee=d;ee!==null;){switch(p=ee,v=p.child,p.tag){case 0:case 11:case 14:case 15:Dc(4,p,p.return);break;case 1:Oa(p,p.return);var S=p.stateNode;if(typeof S.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(P){et(r,n,P)}}break;case 5:Oa(p,p.return);break;case 22:if(p.memoizedState!==null){H0(f);continue}}v!==null?(v.return=p,ee=v):H0(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=sA("display",o))}catch(P){et(t,t.return,P)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(P){et(t,t.return,P)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:tr(e,t),Er(t),r&4&&z0(t);break;case 21:break;default:tr(e,t),Er(t)}}function Er(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(C1(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Zc(i,""),r.flags&=-33);var s=$0(t);Jg(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=$0(t);Yg(t,a,o);break;default:throw Error(q(161))}}catch(l){et(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function rN(t,e,n){ee=t,O1(t)}function O1(t,e,n){for(var r=(t.mode&1)!==0;ee!==null;){var i=ee,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||th;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||qt;a=th;var u=qt;if(th=o,(qt=l)&&!u)for(ee=i;ee!==null;)o=ee,l=o.child,o.tag===22&&o.memoizedState!==null?G0(i):l!==null?(l.return=o,ee=l):G0(i);for(;s!==null;)ee=s,O1(s),s=s.sibling;ee=i,th=a,qt=u}q0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ee=s):q0(t)}}function q0(t){for(;ee!==null;){var e=ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qt||tp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!qt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:nr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&x0(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}x0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&ru(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}qt||e.flags&512&&Qg(e)}catch(p){et(e,e.return,p)}}if(e===t){ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,ee=n;break}ee=e.return}}function H0(t){for(;ee!==null;){var e=ee;if(e===t){ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ee=n;break}ee=e.return}}function G0(t){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{tp(4,e)}catch(l){et(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){et(e,i,l)}}var s=e.return;try{Qg(e)}catch(l){et(e,s,l)}break;case 5:var o=e.return;try{Qg(e)}catch(l){et(e,o,l)}}}catch(l){et(e,e.return,l)}if(e===t){ee=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ee=a;break}ee=e.return}}var iN=Math.ceil,mf=fi.ReactCurrentDispatcher,b_=fi.ReactCurrentOwner,$n=fi.ReactCurrentBatchConfig,we=0,St=null,ft=null,Vt=0,In=0,La=bs(0),vt=0,pu=null,Eo=0,np=0,R_=0,Oc=null,cn=null,S_=0,el=1/0,Wr=null,gf=!1,Xg=null,as=null,nh=!1,Xi=null,yf=0,Lc=0,Zg=null,Sh=-1,xh=0;function Zt(){return we&6?st():Sh!==-1?Sh:Sh=st()}function ls(t){return t.mode&1?we&2&&Vt!==0?Vt&-Vt:BC.transition!==null?(xh===0&&(xh=_A()),xh):(t=Re,t!==0||(t=window.event,t=t===void 0?16:bA(t.type)),t):1}function cr(t,e,n,r){if(50<Lc)throw Lc=0,Zg=null,Error(q(185));Uu(t,n,r),(!(we&2)||t!==St)&&(t===St&&(!(we&2)&&(np|=n),vt===4&&zi(t,Vt)),gn(t,r),n===1&&we===0&&!(e.mode&1)&&(el=st()+500,Xf&&Rs()))}function gn(t,e){var n=t.callbackNode;Bk(t,e);var r=Zh(t,t===St?Vt:0);if(r===0)n!==null&&t0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&t0(n),e===1)t.tag===0?UC(W0.bind(null,t)):qA(W0.bind(null,t)),VC(function(){!(we&6)&&Rs()}),n=null;else{switch(vA(r)){case 1:n=Zy;break;case 4:n=gA;break;case 16:n=Xh;break;case 536870912:n=yA;break;default:n=Xh}n=$1(n,L1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function L1(t,e){if(Sh=-1,xh=0,we&6)throw Error(q(327));var n=t.callbackNode;if(Ba()&&t.callbackNode!==n)return null;var r=Zh(t,t===St?Vt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=_f(t,r);else{e=r;var i=we;we|=2;var s=M1();(St!==t||Vt!==e)&&(Wr=null,el=st()+500,uo(t,e));do try{aN();break}catch(a){V1(t,a)}while(1);h_(),mf.current=s,we=i,ft!==null?e=0:(St=null,Vt=0,e=vt)}if(e!==0){if(e===2&&(i=Rg(t),i!==0&&(r=i,e=ey(t,i))),e===1)throw n=pu,uo(t,0),zi(t,r),gn(t,st()),n;if(e===6)zi(t,r);else{if(i=t.current.alternate,!(r&30)&&!sN(i)&&(e=_f(t,r),e===2&&(s=Rg(t),s!==0&&(r=s,e=ey(t,s))),e===1))throw n=pu,uo(t,0),zi(t,r),gn(t,st()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(q(345));case 2:Ws(t,cn,Wr);break;case 3:if(zi(t,r),(r&130023424)===r&&(e=S_+500-st(),10<e)){if(Zh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Zt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Og(Ws.bind(null,t,cn,Wr),e);break}Ws(t,cn,Wr);break;case 4:if(zi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-lr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=st()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*iN(r/1960))-r,10<r){t.timeoutHandle=Og(Ws.bind(null,t,cn,Wr),r);break}Ws(t,cn,Wr);break;case 5:Ws(t,cn,Wr);break;default:throw Error(q(329))}}}return gn(t,st()),t.callbackNode===n?L1.bind(null,t):null}function ey(t,e){var n=Oc;return t.current.memoizedState.isDehydrated&&(uo(t,e).flags|=256),t=_f(t,e),t!==2&&(e=cn,cn=n,e!==null&&ty(e)),t}function ty(t){cn===null?cn=t:cn.push.apply(cn,t)}function sN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!dr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zi(t,e){for(e&=~R_,e&=~np,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-lr(e),r=1<<n;t[n]=-1,e&=~r}}function W0(t){if(we&6)throw Error(q(327));Ba();var e=Zh(t,0);if(!(e&1))return gn(t,st()),null;var n=_f(t,e);if(t.tag!==0&&n===2){var r=Rg(t);r!==0&&(e=r,n=ey(t,r))}if(n===1)throw n=pu,uo(t,0),zi(t,e),gn(t,st()),n;if(n===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ws(t,cn,Wr),gn(t,st()),null}function x_(t,e){var n=we;we|=1;try{return t(e)}finally{we=n,we===0&&(el=st()+500,Xf&&Rs())}}function To(t){Xi!==null&&Xi.tag===0&&!(we&6)&&Ba();var e=we;we|=1;var n=$n.transition,r=Re;try{if($n.transition=null,Re=1,t)return t()}finally{Re=r,$n.transition=n,we=e,!(we&6)&&Rs()}}function P_(){In=La.current,$e(La)}function uo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,LC(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(c_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sf();break;case 3:Xa(),$e(pn),$e(Kt),__();break;case 5:y_(r);break;case 4:Xa();break;case 13:$e(Qe);break;case 19:$e(Qe);break;case 10:f_(r.type._context);break;case 22:case 23:P_()}n=n.return}if(St=t,ft=t=cs(t.current,null),Vt=In=e,vt=0,pu=null,R_=np=Eo=0,cn=Oc=null,io!==null){for(e=0;e<io.length;e++)if(n=io[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}io=null}return t}function V1(t,e){do{var n=ft;try{if(h_(),Ah.current=pf,ff){for(var r=Ye.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ff=!1}if(Io=0,bt=_t=Ye=null,Nc=!1,du=0,b_.current=null,n===null||n.return===null){vt=1,pu=e,ft=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Vt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=O0(o);if(v!==null){v.flags&=-257,L0(v,o,a,s,e),v.mode&1&&D0(s,u,e),e=v,l=u;var S=e.updateQueue;if(S===null){var P=new Set;P.add(l),e.updateQueue=P}else S.add(l);break e}else{if(!(e&1)){D0(s,u,e),k_();break e}l=Error(q(426))}}else if(Ge&&a.mode&1){var N=O0(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),L0(N,o,a,s,e),u_(Za(l,a));break e}}s=l=Za(l,a),vt!==4&&(vt=2),Oc===null?Oc=[s]:Oc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=v1(s,l,e);S0(s,T);break e;case 1:a=l;var I=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof I.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(as===null||!as.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var M=w1(s,a,e);S0(s,M);break e}}s=s.return}while(s!==null)}j1(n)}catch($){e=$,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(1)}function M1(){var t=mf.current;return mf.current=pf,t===null?pf:t}function k_(){(vt===0||vt===3||vt===2)&&(vt=4),St===null||!(Eo&268435455)&&!(np&268435455)||zi(St,Vt)}function _f(t,e){var n=we;we|=2;var r=M1();(St!==t||Vt!==e)&&(Wr=null,uo(t,e));do try{oN();break}catch(i){V1(t,i)}while(1);if(h_(),we=n,mf.current=r,ft!==null)throw Error(q(261));return St=null,Vt=0,vt}function oN(){for(;ft!==null;)F1(ft)}function aN(){for(;ft!==null&&!Nk();)F1(ft)}function F1(t){var e=B1(t.alternate,t,In);t.memoizedProps=t.pendingProps,e===null?j1(t):ft=e,b_.current=null}function j1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=eN(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vt=6,ft=null;return}}else if(n=ZC(n,e,In),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);vt===0&&(vt=5)}function Ws(t,e,n){var r=Re,i=$n.transition;try{$n.transition=null,Re=1,lN(t,e,n,r)}finally{$n.transition=i,Re=r}return null}function lN(t,e,n,r){do Ba();while(Xi!==null);if(we&6)throw Error(q(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if($k(t,s),t===St&&(ft=St=null,Vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||nh||(nh=!0,$1(Xh,function(){return Ba(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=$n.transition,$n.transition=null;var o=Re;Re=1;var a=we;we|=4,b_.current=null,nN(t,n),D1(n,t),xC(Ng),ef=!!Cg,Ng=Cg=null,t.current=n,rN(n),Dk(),we=a,Re=o,$n.transition=s}else t.current=n;if(nh&&(nh=!1,Xi=t,yf=i),s=t.pendingLanes,s===0&&(as=null),Vk(n.stateNode),gn(t,st()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(gf)throw gf=!1,t=Xg,Xg=null,t;return yf&1&&t.tag!==0&&Ba(),s=t.pendingLanes,s&1?t===Zg?Lc++:(Lc=0,Zg=t):Lc=0,Rs(),null}function Ba(){if(Xi!==null){var t=vA(yf),e=$n.transition,n=Re;try{if($n.transition=null,Re=16>t?16:t,Xi===null)var r=!1;else{if(t=Xi,Xi=null,yf=0,we&6)throw Error(q(331));var i=we;for(we|=4,ee=t.current;ee!==null;){var s=ee,o=s.child;if(ee.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ee=u;ee!==null;){var d=ee;switch(d.tag){case 0:case 11:case 15:Dc(8,d,s)}var f=d.child;if(f!==null)f.return=d,ee=f;else for(;ee!==null;){d=ee;var p=d.sibling,v=d.return;if(k1(d),d===u){ee=null;break}if(p!==null){p.return=v,ee=p;break}ee=v}}}var S=s.alternate;if(S!==null){var P=S.child;if(P!==null){S.child=null;do{var N=P.sibling;P.sibling=null,P=N}while(P!==null)}}ee=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ee=o;else e:for(;ee!==null;){if(s=ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Dc(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,ee=T;break e}ee=s.return}}var I=t.current;for(ee=I;ee!==null;){o=ee;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ee=b;else e:for(o=I;ee!==null;){if(a=ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:tp(9,a)}}catch($){et(a,a.return,$)}if(a===o){ee=null;break e}var M=a.sibling;if(M!==null){M.return=a.return,ee=M;break e}ee=a.return}}if(we=i,Rs(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Wf,t)}catch{}r=!0}return r}finally{Re=n,$n.transition=e}}return!1}function K0(t,e,n){e=Za(n,e),e=v1(t,e,1),t=os(t,e,1),e=Zt(),t!==null&&(Uu(t,1,e),gn(t,e))}function et(t,e,n){if(t.tag===3)K0(t,t,n);else for(;e!==null;){if(e.tag===3){K0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(as===null||!as.has(r))){t=Za(n,t),t=w1(e,t,1),e=os(e,t,1),t=Zt(),e!==null&&(Uu(e,1,t),gn(e,t));break}}e=e.return}}function cN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Zt(),t.pingedLanes|=t.suspendedLanes&n,St===t&&(Vt&n)===n&&(vt===4||vt===3&&(Vt&130023424)===Vt&&500>st()-S_?uo(t,0):R_|=n),gn(t,e)}function U1(t,e){e===0&&(t.mode&1?(e=Gd,Gd<<=1,!(Gd&130023424)&&(Gd=4194304)):e=1);var n=Zt();t=si(t,e),t!==null&&(Uu(t,e,n),gn(t,n))}function uN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),U1(t,n)}function dN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(e),U1(t,n)}var B1;B1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pn.current)un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return un=!1,XC(t,e,n);un=!!(t.flags&131072)}else un=!1,Ge&&e.flags&1048576&&HA(e,lf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Rh(t,e),t=e.pendingProps;var i=Qa(e,Kt.current);Ua(e,n),i=w_(null,e,r,t,i,n);var s=I_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mn(r)?(s=!0,of(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,m_(e),i.updater=ep,e.stateNode=i,i._reactInternals=e,Bg(e,r,t,n),e=qg(null,e,r,!0,s,n)):(e.tag=0,Ge&&s&&l_(e),Xt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Rh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=fN(r),t=nr(r,t),i){case 0:e=zg(null,e,r,t,n);break e;case 1:e=F0(null,e,r,t,n);break e;case 11:e=V0(null,e,r,t,n);break e;case 14:e=M0(null,e,r,nr(r.type,t),n);break e}throw Error(q(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nr(r,i),zg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nr(r,i),F0(t,e,r,i,n);case 3:e:{if(A1(e),t===null)throw Error(q(387));r=e.pendingProps,s=e.memoizedState,i=s.element,JA(t,e),df(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Za(Error(q(423)),e),e=j0(t,e,r,n,i);break e}else if(r!==i){i=Za(Error(q(424)),e),e=j0(t,e,r,n,i);break e}else for(An=ss(e.stateNode.containerInfo.firstChild),Rn=e,Ge=!0,or=null,n=QA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ya(),r===i){e=oi(t,e,n);break e}Xt(t,e,r,n)}e=e.child}return e;case 5:return XA(e),t===null&&Fg(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Dg(r,i)?o=null:s!==null&&Dg(r,s)&&(e.flags|=32),T1(t,e),Xt(t,e,o,n),e.child;case 6:return t===null&&Fg(e),null;case 13:return b1(t,e,n);case 4:return g_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ja(e,null,r,n):Xt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nr(r,i),V0(t,e,r,i,n);case 7:return Xt(t,e,e.pendingProps,n),e.child;case 8:return Xt(t,e,e.pendingProps.children,n),e.child;case 12:return Xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Le(cf,r._currentValue),r._currentValue=o,s!==null)if(dr(s.value,o)){if(s.children===i.children&&!pn.current){e=oi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ei(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),jg(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(q(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),jg(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Xt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ua(e,n),i=zn(i),r=r(i),e.flags|=1,Xt(t,e,r,n),e.child;case 14:return r=e.type,i=nr(r,e.pendingProps),i=nr(r.type,i),M0(t,e,r,i,n);case 15:return I1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:nr(r,i),Rh(t,e),e.tag=1,mn(r)?(t=!0,of(e)):t=!1,Ua(e,n),_1(e,r,i),Bg(e,r,i,n),qg(null,e,r,!0,t,n);case 19:return R1(t,e,n);case 22:return E1(t,e,n)}throw Error(q(156,e.tag))};function $1(t,e){return mA(t,e)}function hN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(t,e,n,r){return new hN(t,e,n,r)}function C_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fN(t){if(typeof t=="function")return C_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Yy)return 11;if(t===Jy)return 14}return 2}function cs(t,e){var n=t.alternate;return n===null?(n=Bn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ph(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")C_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ba:return ho(n.children,i,s,e);case Qy:o=8,i|=8;break;case dg:return t=Bn(12,n,e,i|2),t.elementType=dg,t.lanes=s,t;case hg:return t=Bn(13,n,e,i),t.elementType=hg,t.lanes=s,t;case fg:return t=Bn(19,n,e,i),t.elementType=fg,t.lanes=s,t;case XT:return rp(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case YT:o=10;break e;case JT:o=9;break e;case Yy:o=11;break e;case Jy:o=14;break e;case ji:o=16,r=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=Bn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ho(t,e,n,r){return t=Bn(7,t,r,e),t.lanes=n,t}function rp(t,e,n,r){return t=Bn(22,t,r,e),t.elementType=XT,t.lanes=n,t.stateNode={isHidden:!1},t}function Nm(t,e,n){return t=Bn(6,t,null,e),t.lanes=n,t}function Dm(t,e,n){return e=Bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function pN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fm(0),this.expirationTimes=fm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fm(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function N_(t,e,n,r,i,s,o,a,l){return t=new pN(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Bn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},m_(s),t}function mN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Aa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function z1(t){if(!t)return gs;t=t._reactInternals;e:{if(Fo(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var n=t.type;if(mn(n))return zA(t,n,e)}return e}function q1(t,e,n,r,i,s,o,a,l){return t=N_(n,r,!0,t,i,s,o,a,l),t.context=z1(null),n=t.current,r=Zt(),i=ls(n),s=ei(r,i),s.callback=e??null,os(n,s,i),t.current.lanes=i,Uu(t,i,r),gn(t,r),t}function ip(t,e,n,r){var i=e.current,s=Zt(),o=ls(i);return n=z1(n),e.context===null?e.context=n:e.pendingContext=n,e=ei(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=os(i,e,o),t!==null&&(cr(t,i,o,s),Th(t,i,o)),o}function vf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Q0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function D_(t,e){Q0(t,e),(t=t.alternate)&&Q0(t,e)}function gN(){return null}var H1=typeof reportError=="function"?reportError:function(t){console.error(t)};function O_(t){this._internalRoot=t}sp.prototype.render=O_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));ip(t,e,null,null)};sp.prototype.unmount=O_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;To(function(){ip(null,t,null,null)}),e[ii]=null}};function sp(t){this._internalRoot=t}sp.prototype.unstable_scheduleHydration=function(t){if(t){var e=EA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<$i.length&&e!==0&&e<$i[n].priority;n++);$i.splice(n,0,t),n===0&&AA(t)}};function L_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function op(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Y0(){}function yN(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=vf(o);s.call(u)}}var o=q1(e,r,t,0,null,!1,!1,"",Y0);return t._reactRootContainer=o,t[ii]=o.current,ou(t.nodeType===8?t.parentNode:t),To(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=vf(l);a.call(u)}}var l=N_(t,0,!1,null,null,!1,!1,"",Y0);return t._reactRootContainer=l,t[ii]=l.current,ou(t.nodeType===8?t.parentNode:t),To(function(){ip(e,l,n,r)}),l}function ap(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=vf(o);a.call(l)}}ip(e,o,t,i)}else o=yN(n,e,t,i,r);return vf(o)}wA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=_c(e.pendingLanes);n!==0&&(e_(e,n|1),gn(e,st()),!(we&6)&&(el=st()+500,Rs()))}break;case 13:To(function(){var r=si(t,1);if(r!==null){var i=Zt();cr(r,t,1,i)}}),D_(t,1)}};t_=function(t){if(t.tag===13){var e=si(t,134217728);if(e!==null){var n=Zt();cr(e,t,134217728,n)}D_(t,134217728)}};IA=function(t){if(t.tag===13){var e=ls(t),n=si(t,e);if(n!==null){var r=Zt();cr(n,t,e,r)}D_(t,e)}};EA=function(){return Re};TA=function(t,e){var n=Re;try{return Re=t,e()}finally{Re=n}};Tg=function(t,e,n){switch(e){case"input":if(gg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Jf(r);if(!i)throw Error(q(90));eA(r),gg(r,i)}}}break;case"textarea":nA(t,n);break;case"select":e=n.value,e!=null&&Va(t,!!n.multiple,e,!1)}};cA=x_;uA=To;var _N={usingClientEntryPoint:!1,Events:[$u,Pa,Jf,aA,lA,x_]},lc={findFiberByHostInstance:ro,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vN={bundleType:lc.bundleType,version:lc.version,rendererPackageName:lc.rendererPackageName,rendererConfig:lc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=fA(t),t===null?null:t.stateNode},findFiberByHostInstance:lc.findFiberByHostInstance||gN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rh.isDisabled&&rh.supportsFiber)try{Wf=rh.inject(vN),Cr=rh}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_N;Dn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L_(e))throw Error(q(200));return mN(t,e,null,n)};Dn.createRoot=function(t,e){if(!L_(t))throw Error(q(299));var n=!1,r="",i=H1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=N_(t,1,!1,null,null,n,!1,r,i),t[ii]=e.current,ou(t.nodeType===8?t.parentNode:t),new O_(e)};Dn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=fA(e),t=t===null?null:t.stateNode,t};Dn.flushSync=function(t){return To(t)};Dn.hydrate=function(t,e,n){if(!op(e))throw Error(q(200));return ap(null,t,e,!0,n)};Dn.hydrateRoot=function(t,e,n){if(!L_(t))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=H1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=q1(e,null,t,1,n??null,i,!1,s,o),t[ii]=e.current,ou(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new sp(e)};Dn.render=function(t,e,n){if(!op(e))throw Error(q(200));return ap(null,t,e,!1,n)};Dn.unmountComponentAtNode=function(t){if(!op(t))throw Error(q(40));return t._reactRootContainer?(To(function(){ap(null,null,t,!1,function(){t._reactRootContainer=null,t[ii]=null})}),!0):!1};Dn.unstable_batchedUpdates=x_;Dn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!op(n))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return ap(t,e,n,!1,r)};Dn.version="18.3.1-next-f1338f8080-20240426";function G1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(G1)}catch(t){console.error(t)}}G1(),GT.exports=Dn;var wN=GT.exports,J0=wN;cg.createRoot=J0.createRoot,cg.hydrateRoot=J0.hydrateRoot;const IN="modulepreload",EN=function(t){return"/"+t},X0={},Gr=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=EN(s),s in X0)return;X0[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=i.length-1;d>=0;d--){const f=i[d];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":IN,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var TN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const AN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bN=(t,e)=>{const n=ne.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,children:a,...l},u)=>ne.createElement("svg",{ref:u,...TN,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:`lucide lucide-${AN(t)}`,...l},[...e.map(([d,f])=>ne.createElement(d,f)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n};var It=bN;const RN=It("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),Z0=It("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),SN=It("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),Oi=It("Hammer",[["path",{d:"m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9",key:"1afvon"}],["path",{d:"M17.64 15 22 10.64",key:"zsji6s"}],["path",{d:"m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25v-.86L16.01 4.6a5.56 5.56 0 0 0-3.94-1.64H9l.92.82A6.18 6.18 0 0 1 12 8.4v1.56l2 2h2.47l2.26 1.91",key:"lehyy1"}]]),Om=It("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),xN=It("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),eI=It("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),tI=It("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),nI=It("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),rI=It("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),on=It("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),da=It("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),qs=It("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),an=It("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),PN=It("Sofa",[["path",{d:"M20 9V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3",key:"1dgpiv"}],["path",{d:"M2 11v5a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v2H6v-2a2 2 0 0 0-4 0Z",key:"u5qfb7"}],["path",{d:"M4 18v2",key:"jwo5n2"}],["path",{d:"M20 18v2",key:"1ar1qi"}],["path",{d:"M12 4v9",key:"oqhhn3"}]]),ih=It("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),kN=It("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]),iI=It("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),sI=It("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),CN=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},NN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},K1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=s>>2,f=(s&3)<<4|a>>4;let p=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(p=64)),r.push(n[d],n[f],n[p],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(W1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):NN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||f==null)throw new DN;const p=s<<2|a>>4;if(r.push(p),u!==64){const v=a<<4&240|u>>2;if(r.push(v),f!==64){const S=u<<6&192|f;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class DN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ON=function(t){const e=W1(t);return K1.encodeByteArray(e,!0)},wf=function(t){return ON(t).replace(/\./g,"")},Q1=function(t){try{return K1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=()=>Y1().__FIREBASE_DEFAULTS__,VN=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Q1(t[1]);return e&&JSON.parse(e)},lp=()=>{try{return CN()||LN()||VN()||MN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},J1=t=>{var e,n;return(n=(e=lp())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},X1=t=>{const e=J1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Z1=()=>{var t;return(t=lp())==null?void 0:t.config},eb=t=>{var e;return(e=lp())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t},a="";return[wf(JSON.stringify(n)),wf(JSON.stringify(o)),a].join(".")}const Vc={};function jN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Vc))Vc[e]?t.emulator.push(e):t.prod.push(e);return t}function UN(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let oI=!1;function V_(t,e){if(typeof window>"u"||typeof document>"u"||!pi(window.location.host)||Vc[t]===e||Vc[t]||oI)return;Vc[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=jN().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,v){p.setAttribute("width","24"),p.setAttribute("id",v),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{oI=!0,o()},p}function d(p,v){p.setAttribute("id",v),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=UN(r),v=n("text"),S=document.getElementById(v)||document.createElement("span"),P=n("learnmore"),N=document.getElementById(P)||document.createElement("a"),T=n("preprendIcon"),I=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const b=p.element;a(b),d(N,P);const M=u();l(I,T),b.append(I,S,N,M),document.body.appendChild(b)}s?(S.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function BN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wt())}function nb(){var e;const t=(e=lp())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $N(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rb(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function zN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qN(){const t=wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ib(){return!nb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sb(){return!nb()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function M_(){try{return typeof indexedDB=="object"}catch{return!1}}function ob(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}function HN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GN="FirebaseError";class Ln extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=GN,Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jo.prototype.create)}}class jo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?WN(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ln(i,a,r)}}function WN(t,e){return t.replace(KN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const KN=/\{\$([^}]+)}/g;function QN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Hn(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(aI(s)&&aI(o)){if(!Hn(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function aI(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function wc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ic(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function YN(t,e){const n=new JN(t,e);return n.subscribe.bind(n)}class JN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");XN(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Lm),i.error===void 0&&(i.error=Lm),i.complete===void 0&&(i.complete=Lm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Lm(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=1e3,eD=2,tD=4*60*60*1e3,nD=.5;function lI(t,e=ZN,n=eD){const r=e*Math.pow(n,t),i=Math.round(nD*r*(Math.random()-.5)*2);return Math.min(tD,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(t){return t&&t._delegate?t._delegate:t}class Cn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new FN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sD(e))try{this.getOrInitializeService({instanceIdentifier:Ks})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ks){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ks){return this.instances.has(e)}getOptions(e=Ks){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:iD(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ks){return this.component?this.component.multipleInstances?e:Ks:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iD(t){return t===Ks?void 0:t}function sD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new rD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(me||(me={}));const aD={debug:me.DEBUG,verbose:me.VERBOSE,info:me.INFO,warn:me.WARN,error:me.ERROR,silent:me.SILENT},lD=me.INFO,cD={[me.DEBUG]:"log",[me.VERBOSE]:"log",[me.INFO]:"info",[me.WARN]:"warn",[me.ERROR]:"error"},uD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=cD[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class qu{constructor(e){this.name=e,this._logLevel=lD,this._logHandler=uD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,me.DEBUG,...e),this._logHandler(this,me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,me.VERBOSE,...e),this._logHandler(this,me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,me.INFO,...e),this._logHandler(this,me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,me.WARN,...e),this._logHandler(this,me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,me.ERROR,...e),this._logHandler(this,me.ERROR,...e)}}const dD=(t,e)=>e.some(n=>t instanceof n);let cI,uI;function hD(){return cI||(cI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fD(){return uI||(uI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ab=new WeakMap,ny=new WeakMap,lb=new WeakMap,Vm=new WeakMap,F_=new WeakMap;function pD(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(us(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&ab.set(n,t)}).catch(()=>{}),F_.set(e,t),e}function mD(t){if(ny.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ny.set(t,e)}let ry={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ny.get(t);if(e==="objectStoreNames")return t.objectStoreNames||lb.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return us(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function gD(t){ry=t(ry)}function yD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Mm(this),e,...n);return lb.set(r,e.sort?e.sort():[e]),us(r)}:fD().includes(t)?function(...e){return t.apply(Mm(this),e),us(ab.get(this))}:function(...e){return us(t.apply(Mm(this),e))}}function _D(t){return typeof t=="function"?yD(t):(t instanceof IDBTransaction&&mD(t),dD(t,hD())?new Proxy(t,ry):t)}function us(t){if(t instanceof IDBRequest)return pD(t);if(Vm.has(t))return Vm.get(t);const e=_D(t);return e!==t&&(Vm.set(t,e),F_.set(e,t)),e}const Mm=t=>F_.get(t);function cb(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=us(o);return r&&o.addEventListener("upgradeneeded",l=>{r(us(o.result),l.oldVersion,l.newVersion,us(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const vD=["get","getKey","getAll","getAllKeys","count"],wD=["put","add","delete","clear"],Fm=new Map;function dI(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Fm.get(e))return Fm.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=wD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||vD.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return Fm.set(e,s),s}gD(t=>({...t,get:(e,n,r)=>dI(e,n)||t.get(e,n,r),has:(e,n)=>!!dI(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(ED(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function ED(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const iy="@firebase/app",hI="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=new qu("@firebase/app"),TD="@firebase/app-compat",AD="@firebase/analytics-compat",bD="@firebase/analytics",RD="@firebase/app-check-compat",SD="@firebase/app-check",xD="@firebase/auth",PD="@firebase/auth-compat",kD="@firebase/database",CD="@firebase/data-connect",ND="@firebase/database-compat",DD="@firebase/functions",OD="@firebase/functions-compat",LD="@firebase/installations",VD="@firebase/installations-compat",MD="@firebase/messaging",FD="@firebase/messaging-compat",jD="@firebase/performance",UD="@firebase/performance-compat",BD="@firebase/remote-config",$D="@firebase/remote-config-compat",zD="@firebase/storage",qD="@firebase/storage-compat",HD="@firebase/firestore",GD="@firebase/ai",WD="@firebase/firestore-compat",KD="firebase",QD="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If="[DEFAULT]",YD={[iy]:"fire-core",[TD]:"fire-core-compat",[bD]:"fire-analytics",[AD]:"fire-analytics-compat",[SD]:"fire-app-check",[RD]:"fire-app-check-compat",[xD]:"fire-auth",[PD]:"fire-auth-compat",[kD]:"fire-rtdb",[CD]:"fire-data-connect",[ND]:"fire-rtdb-compat",[DD]:"fire-fn",[OD]:"fire-fn-compat",[LD]:"fire-iid",[VD]:"fire-iid-compat",[MD]:"fire-fcm",[FD]:"fire-fcm-compat",[jD]:"fire-perf",[UD]:"fire-perf-compat",[BD]:"fire-rc",[$D]:"fire-rc-compat",[zD]:"fire-gcs",[qD]:"fire-gcs-compat",[HD]:"fire-fst",[WD]:"fire-fst-compat",[GD]:"fire-vertex","fire-js":"fire-js",[KD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef=new Map,JD=new Map,sy=new Map;function fI(t,e){try{t.container.addComponent(e)}catch(n){ai.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Gn(t){const e=t.name;if(sy.has(e))return ai.debug(`There were multiple attempts to register component ${e}.`),!1;sy.set(e,t);for(const n of Ef.values())fI(n,t);for(const n of JD.values())fI(n,t);return!0}function hr(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function XD(t,e,n=If){hr(t,e).clearInstance(n)}function Be(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ds=new jo("app","Firebase",ZD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Cn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ds.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo=QD;function ub(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:If,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ds.create("bad-app-name",{appName:String(i)});if(n||(n=Z1()),!n)throw ds.create("no-options");const s=Ef.get(i);if(s){if(Hn(n,s.options)&&Hn(r,s.config))return s;throw ds.create("duplicate-app",{appName:i})}const o=new oD(i);for(const l of sy.values())o.addComponent(l);const a=new e2(n,r,o);return Ef.set(i,a),a}function Hu(t=If){const e=Ef.get(t);if(!e&&t===If&&Z1())return ub();if(!e)throw ds.create("no-app",{appName:t});return e}function Ht(t,e,n){let r=YD[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ai.warn(o.join(" "));return}Gn(new Cn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2="firebase-heartbeat-database",n2=1,mu="firebase-heartbeat-store";let jm=null;function db(){return jm||(jm=cb(t2,n2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(mu)}catch(n){console.warn(n)}}}}).catch(t=>{throw ds.create("idb-open",{originalErrorMessage:t.message})})),jm}async function r2(t){try{const n=(await db()).transaction(mu),r=await n.objectStore(mu).get(hb(t));return await n.done,r}catch(e){if(e instanceof Ln)ai.warn(e.message);else{const n=ds.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ai.warn(n.message)}}}async function pI(t,e){try{const r=(await db()).transaction(mu,"readwrite");await r.objectStore(mu).put(e,hb(t)),await r.done}catch(n){if(n instanceof Ln)ai.warn(n.message);else{const r=ds.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ai.warn(r.message)}}}function hb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=1024,s2=30;class o2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new l2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=mI();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>s2){const o=c2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ai.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=mI(),{heartbeatsToSend:r,unsentEntries:i}=a2(this._heartbeatsCache.heartbeats),s=wf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return ai.warn(n),""}}}function mI(){return new Date().toISOString().substring(0,10)}function a2(t,e=i2){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),gI(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),gI(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class l2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return M_()?ob().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await r2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return pI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return pI(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function gI(t){return wf(JSON.stringify({version:2,heartbeats:t})).length}function c2(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t){Gn(new Cn("platform-logger",e=>new ID(e),"PRIVATE")),Gn(new Cn("heartbeat",e=>new o2(e),"PRIVATE")),Ht(iy,hI,t),Ht(iy,hI,"esm2020"),Ht("fire-js","")}u2("");var d2="firebase",h2="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ht(d2,h2,"app");const fb="@firebase/installations",j_="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb=1e4,mb=`w:${j_}`,gb="FIS_v2",f2="https://firebaseinstallations.googleapis.com/v1",p2=60*60*1e3,m2="installations",g2="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ao=new jo(m2,g2,y2);function yb(t){return t instanceof Ln&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _b({projectId:t}){return`${f2}/projects/${t}/installations`}function vb(t){return{token:t.token,requestStatus:2,expiresIn:v2(t.expiresIn),creationTime:Date.now()}}async function wb(t,e){const r=(await e.json()).error;return Ao.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Ib({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function _2(t,{refreshToken:e}){const n=Ib(t);return n.append("Authorization",w2(e)),n}async function Eb(t){const e=await t();return e.status>=500&&e.status<600?t():e}function v2(t){return Number(t.replace("s","000"))}function w2(t){return`${gb} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I2({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=_b(t),i=Ib(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:gb,appId:t.appId,sdkVersion:mb},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await Eb(()=>fetch(r,a));if(l.ok){const u=await l.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:vb(u.authToken)}}else throw await wb("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tb(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E2(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=/^[cdef][\w-]{21}$/,oy="";function A2(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=b2(t);return T2.test(n)?n:oy}catch{return oy}}function b2(t){return E2(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab=new Map;function bb(t,e){const n=up(t);Rb(n,e),R2(n,e)}function Rb(t,e){const n=Ab.get(t);if(n)for(const r of n)r(e)}function R2(t,e){const n=S2();n&&n.postMessage({key:t,fid:e}),x2()}let oo=null;function S2(){return!oo&&"BroadcastChannel"in self&&(oo=new BroadcastChannel("[Firebase] FID Change"),oo.onmessage=t=>{Rb(t.data.key,t.data.fid)}),oo}function x2(){Ab.size===0&&oo&&(oo.close(),oo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2="firebase-installations-database",k2=1,bo="firebase-installations-store";let Um=null;function U_(){return Um||(Um=cb(P2,k2,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(bo)}}})),Um}async function Tf(t,e){const n=up(t),i=(await U_()).transaction(bo,"readwrite"),s=i.objectStore(bo),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&bb(t,e.fid),e}async function Sb(t){const e=up(t),r=(await U_()).transaction(bo,"readwrite");await r.objectStore(bo).delete(e),await r.done}async function dp(t,e){const n=up(t),i=(await U_()).transaction(bo,"readwrite"),s=i.objectStore(bo),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&bb(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B_(t){let e;const n=await dp(t.appConfig,r=>{const i=C2(r),s=N2(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===oy?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function C2(t){const e=t||{fid:A2(),registrationStatus:0};return xb(e)}function N2(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Ao.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=D2(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:O2(t)}:{installationEntry:e}}async function D2(t,e){try{const n=await I2(t,e);return Tf(t.appConfig,n)}catch(n){throw yb(n)&&n.customData.serverCode===409?await Sb(t.appConfig):await Tf(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function O2(t){let e=await yI(t.appConfig);for(;e.registrationStatus===1;)await Tb(100),e=await yI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await B_(t);return r||n}return e}function yI(t){return dp(t,e=>{if(!e)throw Ao.create("installation-not-found");return xb(e)})}function xb(t){return L2(t)?{fid:t.fid,registrationStatus:0}:t}function L2(t){return t.registrationStatus===1&&t.registrationTime+pb<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V2({appConfig:t,heartbeatServiceProvider:e},n){const r=M2(t,n),i=_2(t,n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:mb,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await Eb(()=>fetch(r,a));if(l.ok){const u=await l.json();return vb(u)}else throw await wb("Generate Auth Token",l)}function M2(t,{fid:e}){return`${_b(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $_(t,e=!1){let n;const r=await dp(t.appConfig,s=>{if(!Pb(s))throw Ao.create("not-registered");const o=s.authToken;if(!e&&U2(o))return s;if(o.requestStatus===1)return n=F2(t,e),s;{if(!navigator.onLine)throw Ao.create("app-offline");const a=$2(s);return n=j2(t,a),a}});return n?await n:r.authToken}async function F2(t,e){let n=await _I(t.appConfig);for(;n.authToken.requestStatus===1;)await Tb(100),n=await _I(t.appConfig);const r=n.authToken;return r.requestStatus===0?$_(t,e):r}function _I(t){return dp(t,e=>{if(!Pb(e))throw Ao.create("not-registered");const n=e.authToken;return z2(n)?{...e,authToken:{requestStatus:0}}:e})}async function j2(t,e){try{const n=await V2(t,e),r={...e,authToken:n};return await Tf(t.appConfig,r),n}catch(n){if(yb(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await Sb(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Tf(t.appConfig,r)}throw n}}function Pb(t){return t!==void 0&&t.registrationStatus===2}function U2(t){return t.requestStatus===2&&!B2(t)}function B2(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+p2}function $2(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function z2(t){return t.requestStatus===1&&t.requestTime+pb<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q2(t){const e=t,{installationEntry:n,registrationPromise:r}=await B_(e);return r?r.catch(console.error):$_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(t,e=!1){const n=t;return await G2(n),(await $_(n,e)).token}async function G2(t){const{registrationPromise:e}=await B_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(t){if(!t||!t.options)throw Bm("App Configuration");if(!t.name)throw Bm("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Bm(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Bm(t){return Ao.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="installations",K2="installations-internal",Q2=t=>{const e=t.getProvider("app").getImmediate(),n=W2(e),r=hr(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Y2=t=>{const e=t.getProvider("app").getImmediate(),n=hr(e,kb).getImmediate();return{getId:()=>q2(n),getToken:i=>H2(n,i)}};function J2(){Gn(new Cn(kb,Q2,"PUBLIC")),Gn(new Cn(K2,Y2,"PRIVATE"))}J2();Ht(fb,j_);Ht(fb,j_,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Af="analytics",X2="firebase_id",Z2="origin",eO=60*1e3,tO="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",z_="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yn=new qu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Sn=new jo("analytics","Analytics",nO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(t){if(!t.startsWith(z_)){const e=Sn.create("invalid-gtag-resource",{gtagURL:t});return yn.warn(e.message),""}return t}function Cb(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function iO(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function sO(t,e){const n=iO("firebase-js-sdk-policy",{createScriptURL:rO}),r=document.createElement("script"),i=`${z_}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function oO(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function aO(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await Cb(n)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(a){yn.error(a)}t("config",i,s)}async function lO(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await Cb(n);for(const l of o){const u=a.find(f=>f.measurementId===l),d=u&&e[u.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){yn.error(s)}}function cO(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await lO(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await aO(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,u]=o;t("get",a,l,u)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){yn.error(a)}}return i}function uO(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=cO(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function dO(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(z_)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=30,fO=1e3;class pO{constructor(e={},n=fO){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Nb=new pO;function mO(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function gO(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:mO(n)},i=tO.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const l=await s.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Sn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function yO(t,e=Nb,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Sn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Sn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new wO;return setTimeout(async()=>{a.abort()},n!==void 0?n:eO),Db({appId:r,apiKey:i,measurementId:s},o,a,e)}async function Db(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=Nb){var a;const{appId:s,measurementId:o}=t;try{await _O(r,e)}catch(l){if(o)return yn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:o};throw l}try{const l=await gO(t);return i.deleteThrottleMetadata(s),l}catch(l){const u=l;if(!vO(u)){if(i.deleteThrottleMetadata(s),o)return yn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:s,measurementId:o};throw l}const d=Number((a=u==null?void 0:u.customData)==null?void 0:a.httpStatus)===503?lI(n,i.intervalMillis,hO):lI(n,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(s,f),yn.debug(`Calling attemptFetch again in ${d} millis`),Db(t,f,r,i)}}function _O(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Sn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function vO(t){if(!(t instanceof Ln)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class wO{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function IO(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o={...r,send_to:s};t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EO(){if(M_())try{await ob()}catch(t){return yn.warn(Sn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return yn.warn(Sn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function TO(t,e,n,r,i,s,o){const a=yO(t);a.then(p=>{n[p.measurementId]=p.appId,t.options.measurementId&&p.measurementId!==t.options.measurementId&&yn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>yn.error(p)),e.push(a);const l=EO().then(p=>{if(p)return r.getId()}),[u,d]=await Promise.all([a,l]);dO(s)||sO(s,u.measurementId),i("js",new Date);const f=(o==null?void 0:o.config)??{};return f[Z2]="firebase",f.update=!0,d!=null&&(f[X2]=d),i("config",u.measurementId,f),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e){this.app=e}_delete(){return delete Mc[this.app.options.appId],Promise.resolve()}}let Mc={},vI=[];const wI={};let $m="dataLayer",bO="gtag",II,Ob,EI=!1;function RO(){const t=[];if(rb()&&t.push("This is a browser extension environment."),HN()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Sn.create("invalid-analytics-context",{errorInfo:e});yn.warn(n.message)}}function SO(t,e,n){RO();const r=t.options.appId;if(!r)throw Sn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)yn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Sn.create("no-api-key");if(Mc[r]!=null)throw Sn.create("already-exists",{id:r});if(!EI){oO($m);const{wrappedGtag:s,gtagCore:o}=uO(Mc,vI,wI,$m,bO);Ob=s,II=o,EI=!0}return Mc[r]=TO(t,vI,wI,e,II,$m,n),new AO(t)}function xO(t=Hu()){t=Z(t);const e=hr(t,Af);return e.isInitialized()?e.getImmediate():PO(t)}function PO(t,e={}){const n=hr(t,Af);if(n.isInitialized()){const i=n.getImmediate();if(Hn(e,n.getOptions()))return i;throw Sn.create("already-initialized")}return n.initialize({options:e})}function kO(t,e,n,r){t=Z(t),IO(Ob,Mc[t.app.options.appId],e,n,r).catch(i=>yn.error(i))}const TI="@firebase/analytics",AI="0.10.18";function CO(){Gn(new Cn(Af,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return SO(r,i,n)},"PUBLIC")),Gn(new Cn("analytics-internal",t,"PRIVATE")),Ht(TI,AI),Ht(TI,AI,"esm2020");function t(e){try{const n=e.getProvider(Af).getImmediate();return{logEvent:(r,i,s)=>kO(n,r,i,s)}}catch(n){throw Sn.create("interop-component-reg-failed",{reason:n})}}}CO();var bI="@firebase/ai",ay="2.2.1";/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl="AI",RI="us-central1",NO="firebasevertexai.googleapis.com",DO="v1beta",SI=ay,OO="gl-js",LO=180*1e3,VO="gemini-2.0-flash-lite";/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI=["user","model","function","system"],Lb={HARM_SEVERITY_NEGLIGIBLE:"HARM_SEVERITY_NEGLIGIBLE",HARM_SEVERITY_LOW:"HARM_SEVERITY_LOW",HARM_SEVERITY_MEDIUM:"HARM_SEVERITY_MEDIUM",HARM_SEVERITY_HIGH:"HARM_SEVERITY_HIGH",HARM_SEVERITY_UNSUPPORTED:"HARM_SEVERITY_UNSUPPORTED"},PI={STOP:"STOP",MAX_TOKENS:"MAX_TOKENS",SAFETY:"SAFETY",RECITATION:"RECITATION",OTHER:"OTHER",BLOCKLIST:"BLOCKLIST",PROHIBITED_CONTENT:"PROHIBITED_CONTENT",SPII:"SPII",MALFORMED_FUNCTION_CALL:"MALFORMED_FUNCTION_CALL"},kI={TEXT:"TEXT",IMAGE:"IMAGE",AUDIO:"AUDIO"},CI={PREFER_ON_DEVICE:"prefer_on_device",ONLY_ON_DEVICE:"only_on_device",ONLY_IN_CLOUD:"only_in_cloud"};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const he={ERROR:"error",REQUEST_ERROR:"request-error",RESPONSE_ERROR:"response-error",FETCH_ERROR:"fetch-error",SESSION_CLOSED:"session-closed",INVALID_CONTENT:"invalid-content",API_NOT_ENABLED:"api-not-enabled",INVALID_SCHEMA:"invalid-schema",NO_API_KEY:"no-api-key",NO_APP_ID:"no-app-id",NO_MODEL:"no-model",NO_PROJECT_ID:"no-project-id",PARSE_FAILED:"parse-failed",UNSUPPORTED:"unsupported"};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi={VERTEX_AI:"VERTEX_AI",GOOGLE_AI:"GOOGLE_AI"};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e){this.backendType=e}}class Gu extends Vb{constructor(){super(mi.GOOGLE_AI)}}class hp extends Vb{constructor(e=RI){super(mi.VERTEX_AI),e?this.location=e:this.location=RI}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MO=class{constructor(e,n,r,i,s){this.app=e,this.backend=n,this.chromeAdapterFactory=s;const o=i==null?void 0:i.getImmediate({optional:!0}),a=r==null?void 0:r.getImmediate({optional:!0});this.auth=a||null,this.appCheck=o||null,n instanceof hp?this.location=n.location:this.location=""}_delete(){return Promise.resolve()}set options(e){this._options=e}get options(){return this._options}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue extends Ln{constructor(e,n,r){const i=tl,s=`${i}/${e}`,o=`${i}: ${n} (${s})`;super(e,o),this.code=e,this.customErrorData=r,Error.captureStackTrace&&Error.captureStackTrace(this,ue),Object.setPrototypeOf(this,ue.prototype),this.toString=()=>o}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t){if(t instanceof Gu)return`${tl}/googleai`;if(t instanceof hp)return`${tl}/vertexai/${t.location}`;throw new ue(he.ERROR,`Invalid backend: ${JSON.stringify(t.backendType)}`)}function jO(t){const e=t.split("/");if(e[0]!==tl)throw new ue(he.ERROR,`Invalid instance identifier, unknown prefix '${e[0]}'`);switch(e[1]){case"vertexai":const r=e[2];if(!r)throw new ue(he.ERROR,`Invalid instance identifier, unknown location '${t}'`);return new hp(r);case"googleai":return new Gu;default:throw new ue(he.ERROR,`Invalid instance identifier string: '${t}'`)}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,n){var r,i,s,o,a,l,u;if((i=(r=e.app)==null?void 0:r.options)!=null&&i.apiKey)if((o=(s=e.app)==null?void 0:s.options)!=null&&o.projectId)if((l=(a=e.app)==null?void 0:a.options)!=null&&l.appId){if(this._apiSettings={apiKey:e.app.options.apiKey,project:e.app.options.projectId,appId:e.app.options.appId,automaticDataCollectionEnabled:e.app.automaticDataCollectionEnabled,location:e.location,backend:e.backend},Be(e.app)&&e.app.settings.appCheckToken){const d=e.app.settings.appCheckToken;this._apiSettings.getAppCheckToken=()=>Promise.resolve({token:d})}else e.appCheck&&((u=e.options)!=null&&u.useLimitedUseAppCheckTokens?this._apiSettings.getAppCheckToken=()=>e.appCheck.getLimitedUseToken():this._apiSettings.getAppCheckToken=()=>e.appCheck.getToken());e.auth&&(this._apiSettings.getAuthToken=()=>e.auth.getToken()),this.model=Fc.normalizeModelName(n,this._apiSettings.backend.backendType)}else throw new ue(he.NO_APP_ID,'The "appId" field is empty in the local Firebase config. Firebase AI requires this field to contain a valid app ID.');else throw new ue(he.NO_PROJECT_ID,'The "projectId" field is empty in the local Firebase config. Firebase AI requires this field to contain a valid project ID.');else throw new ue(he.NO_API_KEY,'The "apiKey" field is empty in the local Firebase config. Firebase AI requires this field to contain a valid API key.')}static normalizeModelName(e,n){return n===mi.GOOGLE_AI?Fc.normalizeGoogleAIModelName(e):Fc.normalizeVertexAIModelName(e)}static normalizeGoogleAIModelName(e){return`models/${e}`}static normalizeVertexAIModelName(e){let n;return e.includes("/")?e.startsWith("models/")?n=`publishers/google/${e}`:n=e:n=`publishers/google/models/${e}`,n}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ln=new qu("@firebase/vertexai");/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gu;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.PREDICT="predict"})(gu||(gu={}));class Mb{constructor(e,n,r,i,s){this.model=e,this.task=n,this.apiSettings=r,this.stream=i,this.requestOptions=s}toString(){const e=new URL(this.baseUrl);return e.pathname=`/${this.apiVersion}/${this.modelPath}:${this.task}`,e.search=this.queryParams.toString(),e.toString()}get baseUrl(){var e;return((e=this.requestOptions)==null?void 0:e.baseUrl)||`https://${NO}`}get apiVersion(){return DO}get modelPath(){if(this.apiSettings.backend instanceof Gu)return`projects/${this.apiSettings.project}/${this.model}`;if(this.apiSettings.backend instanceof hp)return`projects/${this.apiSettings.project}/locations/${this.apiSettings.backend.location}/${this.model}`;throw new ue(he.ERROR,`Invalid backend: ${JSON.stringify(this.apiSettings.backend)}`)}get queryParams(){const e=new URLSearchParams;return this.stream&&e.set("alt","sse"),e}}function UO(){const t=[];return t.push(`${OO}/${SI}`),t.push(`fire/${SI}`),t.join(" ")}async function BO(t){const e=new Headers;if(e.append("Content-Type","application/json"),e.append("x-goog-api-client",UO()),e.append("x-goog-api-key",t.apiSettings.apiKey),t.apiSettings.automaticDataCollectionEnabled&&e.append("X-Firebase-Appid",t.apiSettings.appId),t.apiSettings.getAppCheckToken){const n=await t.apiSettings.getAppCheckToken();n&&(e.append("X-Firebase-AppCheck",n.token),n.error&&ln.warn(`Unable to obtain a valid App Check token: ${n.error.message}`))}if(t.apiSettings.getAuthToken){const n=await t.apiSettings.getAuthToken();n&&e.append("Authorization",`Firebase ${n.accessToken}`)}return e}async function $O(t,e,n,r,i,s){const o=new Mb(t,e,n,r,s);return{url:o.toString(),fetchOptions:{method:"POST",headers:await BO(o),body:i}}}async function q_(t,e,n,r,i,s){const o=new Mb(t,e,n,r,s);let a,l;try{const u=await $O(t,e,n,r,i,s),d=(s==null?void 0:s.timeout)!=null&&s.timeout>=0?s.timeout:LO,f=new AbortController;if(l=setTimeout(()=>f.abort(),d),u.fetchOptions.signal=f.signal,a=await fetch(u.url,u.fetchOptions),!a.ok){let p="",v;try{const S=await a.json();p=S.error.message,S.error.details&&(p+=` ${JSON.stringify(S.error.details)}`,v=S.error.details)}catch{}throw a.status===403&&v&&v.some(S=>S.reason==="SERVICE_DISABLED")&&v.some(S=>{var P,N;return(N=(P=S.links)==null?void 0:P[0])==null?void 0:N.description.includes("Google developers console API activation")})?new ue(he.API_NOT_ENABLED,`The Firebase AI SDK requires the Firebase AI API ('firebasevertexai.googleapis.com') to be enabled in your Firebase project. Enable this API by visiting the Firebase Console at https://console.firebase.google.com/project/${o.apiSettings.project}/genai/ and clicking "Get started". If you enabled this API recently, wait a few minutes for the action to propagate to our systems and then retry.`,{status:a.status,statusText:a.statusText,errorDetails:v}):new ue(he.FETCH_ERROR,`Error fetching from ${o}: [${a.status} ${a.statusText}] ${p}`,{status:a.status,statusText:a.statusText,errorDetails:v})}}catch(u){let d=u;throw u.code!==he.FETCH_ERROR&&u.code!==he.API_NOT_ENABLED&&u instanceof Error&&(d=new ue(he.ERROR,`Error fetching from ${o.toString()}: ${u.message}`),d.stack=u.stack),d}finally{l&&clearTimeout(l)}return a}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(t){if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&ln.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Fb(t.candidates[0]))throw new ue(he.RESPONSE_ERROR,`Response error: ${ao(t)}. Response body stored in error.response`,{response:t});return!0}else return!1}function bf(t){return t.candidates&&!t.candidates[0].hasOwnProperty("index")&&(t.candidates[0].index=0),zO(t)}function zO(t){return t.text=()=>{if(sh(t))return NI(t,e=>!e.thought);if(t.promptFeedback)throw new ue(he.RESPONSE_ERROR,`Text not available. ${ao(t)}`,{response:t});return""},t.thoughtSummary=()=>{if(sh(t)){const e=NI(t,n=>!!n.thought);return e===""?void 0:e}else if(t.promptFeedback)throw new ue(he.RESPONSE_ERROR,`Thought summary not available. ${ao(t)}`,{response:t})},t.inlineDataParts=()=>{if(sh(t))return HO(t);if(t.promptFeedback)throw new ue(he.RESPONSE_ERROR,`Data not available. ${ao(t)}`,{response:t})},t.functionCalls=()=>{if(sh(t))return qO(t);if(t.promptFeedback)throw new ue(he.RESPONSE_ERROR,`Function call not available. ${ao(t)}`,{response:t})},t}function NI(t,e){var r,i,s,o;const n=[];if((i=(r=t.candidates)==null?void 0:r[0].content)!=null&&i.parts)for(const a of(o=(s=t.candidates)==null?void 0:s[0].content)==null?void 0:o.parts)a.text&&e(a)&&n.push(a.text);return n.length>0?n.join(""):""}function qO(t){var n,r,i,s;const e=[];if((r=(n=t.candidates)==null?void 0:n[0].content)!=null&&r.parts)for(const o of(s=(i=t.candidates)==null?void 0:i[0].content)==null?void 0:s.parts)o.functionCall&&e.push(o.functionCall);if(e.length>0)return e}function HO(t){var n,r,i,s;const e=[];if((r=(n=t.candidates)==null?void 0:n[0].content)!=null&&r.parts)for(const o of(s=(i=t.candidates)==null?void 0:i[0].content)==null?void 0:s.parts)o.inlineData&&e.push(o);if(e.length>0)return e}const GO=[PI.RECITATION,PI.SAFETY];function Fb(t){return!!t.finishReason&&GO.some(e=>e===t.finishReason)}function ao(t){var n,r,i;let e="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)e+="Response was blocked",(n=t.promptFeedback)!=null&&n.blockReason&&(e+=` due to ${t.promptFeedback.blockReason}`),(r=t.promptFeedback)!=null&&r.blockReasonMessage&&(e+=`: ${t.promptFeedback.blockReasonMessage}`);else if((i=t.candidates)!=null&&i[0]){const s=t.candidates[0];Fb(s)&&(e+=`Candidate was blocked due to ${s.finishReason}`,s.finishMessage&&(e+=`: ${s.finishMessage}`))}return e}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(t){var e,n;if((e=t.safetySettings)==null||e.forEach(r=>{if(r.method)throw new ue(he.UNSUPPORTED,"SafetySetting.method is not supported in the the Gemini Developer API. Please remove this property.")}),(n=t.generationConfig)!=null&&n.topK){const r=Math.round(t.generationConfig.topK);r!==t.generationConfig.topK&&(ln.warn("topK in GenerationConfig has been rounded to the nearest integer to match the format for requests to the Gemini Developer API."),t.generationConfig.topK=r)}return t}function H_(t){return{candidates:t.candidates?KO(t.candidates):void 0,prompt:t.promptFeedback?QO(t.promptFeedback):void 0,usageMetadata:t.usageMetadata}}function WO(t,e){return{generateContentRequest:{model:e,...t}}}function KO(t){const e=[];let n;return e&&t.forEach(r=>{var o;let i;if(r.citationMetadata&&(i={citations:r.citationMetadata.citationSources}),r.safetyRatings&&(n=r.safetyRatings.map(a=>({...a,severity:a.severity??Lb.HARM_SEVERITY_UNSUPPORTED,probabilityScore:a.probabilityScore??0,severityScore:a.severityScore??0}))),(o=r.content)!=null&&o.parts.some(a=>a==null?void 0:a.videoMetadata))throw new ue(he.UNSUPPORTED,"Part.videoMetadata is not supported in the Gemini Developer API. Please remove this property.");const s={index:r.index,content:r.content,finishReason:r.finishReason,finishMessage:r.finishMessage,safetyRatings:n,citationMetadata:i,groundingMetadata:r.groundingMetadata};e.push(s)}),e}function QO(t){const e=[];return t.safetyRatings.forEach(r=>{e.push({category:r.category,probability:r.probability,severity:r.severity??Lb.HARM_SEVERITY_UNSUPPORTED,probabilityScore:r.probabilityScore??0,severityScore:r.severityScore??0,blocked:r.blocked})}),{blockReason:t.blockReason,safetyRatings:e,blockReasonMessage:t.blockReasonMessage}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function YO(t,e){const n=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),r=ZO(n),[i,s]=r.tee();return{stream:XO(i,e),response:JO(s,e)}}async function JO(t,e){const n=[],r=t.getReader();for(;;){const{done:i,value:s}=await r.read();if(i){let o=eL(n);return e.backend.backendType===mi.GOOGLE_AI&&(o=H_(o)),bf(o)}n.push(s)}}async function*XO(t,e){const n=t.getReader();for(;;){const{value:r,done:i}=await n.read();if(i)break;let s;e.backend.backendType===mi.GOOGLE_AI?s=bf(H_(r)):s=bf(r),yield s}}function ZO(t){const e=t.getReader();return new ReadableStream({start(r){let i="";return s();function s(){return e.read().then(({value:o,done:a})=>{if(a){if(i.trim()){r.error(new ue(he.PARSE_FAILED,"Failed to parse stream"));return}r.close();return}i+=o;let l=i.match(DI),u;for(;l;){try{u=JSON.parse(l[1])}catch{r.error(new ue(he.PARSE_FAILED,`Error parsing JSON response: "${l[1]}`));return}r.enqueue(u),i=i.substring(l[0].length),l=i.match(DI)}return s()})}}})}function eL(t){const e=t[t.length-1],n={promptFeedback:e==null?void 0:e.promptFeedback};for(const r of t)if(r.candidates)for(const i of r.candidates){const s=i.index||0;if(n.candidates||(n.candidates=[]),n.candidates[s]||(n.candidates[s]={index:i.index}),n.candidates[s].citationMetadata=i.citationMetadata,n.candidates[s].finishReason=i.finishReason,n.candidates[s].finishMessage=i.finishMessage,n.candidates[s].safetyRatings=i.safetyRatings,n.candidates[s].groundingMetadata=i.groundingMetadata,i.content&&i.content.parts){n.candidates[s].content||(n.candidates[s].content={role:i.content.role||"user",parts:[]});const o={};for(const a of i.content.parts){if(a.text!==void 0){if(a.text==="")continue;o.text=a.text}if(a.functionCall&&(o.functionCall=a.functionCall),Object.keys(o).length===0)throw new ue(he.INVALID_CONTENT,"Part should have at least one property, but there are none. This is likely caused by a malformed response from the backend.");n.candidates[s].content.parts.push(o)}}}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tL(t,e,n,r){return t.backend.backendType===mi.GOOGLE_AI&&(n=jb(n)),q_(e,gu.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(n),r)}async function Ub(t,e,n,r,i){let s;return r&&await r.isAvailable(n)?s=await r.generateContentStream(n):s=await tL(t,e,n,i),YO(s,t)}async function nL(t,e,n,r){return t.backend.backendType===mi.GOOGLE_AI&&(n=jb(n)),q_(e,gu.GENERATE_CONTENT,t,!1,JSON.stringify(n),r)}async function Bb(t,e,n,r,i){let s;r&&await r.isAvailable(n)?s=await r.generateContent(n):s=await nL(t,e,n,i);const o=await rL(s,t);return{response:bf(o)}}async function rL(t,e){const n=await t.json();return e.backend.backendType===mi.GOOGLE_AI?H_(n):n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function ly(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const n of t)typeof n=="string"?e.push({text:n}):e.push(n);return iL(e)}function iL(t){const e={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,i=!1;for(const s of t)"functionResponse"in s?(n.parts.push(s),i=!0):(e.parts.push(s),r=!0);if(r&&i)throw new ue(he.INVALID_CONTENT,"Within a single message, FunctionResponse cannot be mixed with other type of Part in the request for sending chat message.");if(!r&&!i)throw new ue(he.INVALID_CONTENT,"No Content is provided for sending chat message.");return r?e:n}function zm(t){let e;return t.contents?e=t:e={contents:[ly(t)]},t.systemInstruction&&(e.systemInstruction=$b(t.systemInstruction)),e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI=["text","inlineData","functionCall","functionResponse","thought","thoughtSignature"],sL={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","thought","thoughtSignature"],system:["text"]},LI={user:["model"],function:["model"],model:["user","function"],system:[]};function oL(t){let e=null;for(const n of t){const{role:r,parts:i}=n;if(!e&&r!=="user")throw new ue(he.INVALID_CONTENT,`First Content should be with role 'user', got ${r}`);if(!xI.includes(r))throw new ue(he.INVALID_CONTENT,`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(xI)}`);if(!Array.isArray(i))throw new ue(he.INVALID_CONTENT,"Content should have 'parts' property with an array of Parts");if(i.length===0)throw new ue(he.INVALID_CONTENT,"Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0,thought:0,thoughtSignature:0};for(const a of i)for(const l of OI)l in a&&(s[l]+=1);const o=sL[r];for(const a of OI)if(!o.includes(a)&&s[a]>0)throw new ue(he.INVALID_CONTENT,`Content with role '${r}' can't contain '${a}' part`);if(e&&!LI[r].includes(e.role))throw new ue(he.INVALID_CONTENT,`Content with role '${r}' can't follow '${e.role}'. Valid previous roles: ${JSON.stringify(LI)}`);e=n}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="SILENT_ERROR";class aL{constructor(e,n,r,i,s){this.model=n,this.chromeAdapter=r,this.params=i,this.requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiSettings=e,i!=null&&i.history&&(oL(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e){var s,o,a,l,u;await this._sendPromise;const n=ly(e),r={safetySettings:(s=this.params)==null?void 0:s.safetySettings,generationConfig:(o=this.params)==null?void 0:o.generationConfig,tools:(a=this.params)==null?void 0:a.tools,toolConfig:(l=this.params)==null?void 0:l.toolConfig,systemInstruction:(u=this.params)==null?void 0:u.systemInstruction,contents:[...this._history,n]};let i={};return this._sendPromise=this._sendPromise.then(()=>Bb(this._apiSettings,this.model,r,this.chromeAdapter,this.requestOptions)).then(d=>{var f,p;if(d.response.candidates&&d.response.candidates.length>0){this._history.push(n);const v={parts:((f=d.response.candidates)==null?void 0:f[0].content.parts)||[],role:((p=d.response.candidates)==null?void 0:p[0].content.role)||"model"};this._history.push(v)}else{const v=ao(d.response);v&&ln.warn(`sendMessage() was unsuccessful. ${v}. Inspect response object for details.`)}i=d}),await this._sendPromise,i}async sendMessageStream(e){var s,o,a,l,u;await this._sendPromise;const n=ly(e),r={safetySettings:(s=this.params)==null?void 0:s.safetySettings,generationConfig:(o=this.params)==null?void 0:o.generationConfig,tools:(a=this.params)==null?void 0:a.tools,toolConfig:(l=this.params)==null?void 0:l.toolConfig,systemInstruction:(u=this.params)==null?void 0:u.systemInstruction,contents:[...this._history,n]},i=Ub(this._apiSettings,this.model,r,this.chromeAdapter,this.requestOptions);return this._sendPromise=this._sendPromise.then(()=>i).catch(d=>{throw new Error(VI)}).then(d=>d.response).then(d=>{if(d.candidates&&d.candidates.length>0){this._history.push(n);const f={...d.candidates[0].content};f.role||(f.role="model"),this._history.push(f)}else{const f=ao(d);f&&ln.warn(`sendMessageStream() was unsuccessful. ${f}. Inspect response object for details.`)}}).catch(d=>{d.message!==VI&&ln.error(d)}),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lL(t,e,n,r){let i="";if(t.backend.backendType===mi.GOOGLE_AI){const o=WO(n,e);i=JSON.stringify(o)}else i=JSON.stringify(n);return(await q_(e,gu.COUNT_TOKENS,t,!1,i,r)).json()}async function cL(t,e,n,r,i){return r&&await r.isAvailable(n)?(await r.countTokens(n)).json():lL(t,e,n,i)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL extends Fc{constructor(e,n,r,i){super(e,n.model),this.chromeAdapter=i,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=$b(n.systemInstruction),this.requestOptions=r||{}}async generateContent(e){const n=zm(e);return Bb(this._apiSettings,this.model,{generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,...n},this.chromeAdapter,this.requestOptions)}async generateContentStream(e){const n=zm(e);return Ub(this._apiSettings,this.model,{generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,...n},this.chromeAdapter,this.requestOptions)}startChat(e){return new aL(this._apiSettings,this.model,this.chromeAdapter,{tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,generationConfig:this.generationConfig,safetySettings:this.safetySettings,...e},this.requestOptions)}async countTokens(e){const n=zm(e);return cL(this._apiSettings,this.model,n,this.chromeAdapter)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dL(t=Hu(),e){t=Z(t);const n=hr(t,tl),r=(e==null?void 0:e.backend)??new Gu,i={useLimitedUseAppCheckTokens:(e==null?void 0:e.useLimitedUseAppCheckTokens)??!1},s=FO(r),o=n.getImmediate({identifier:s});return o.options=i,o}function hL(t,e,n){var o;const r=e;let i;if(r.mode?i=r.inCloudParams||{model:VO}:i=e,!i.model)throw new ue(he.NO_MODEL,"Must provide a model name. Example: getGenerativeModel({ model: 'my-model-name' })");const s=(o=t.chromeAdapterFactory)==null?void 0:o.call(t,r.mode,typeof window>"u"?void 0:window,r.onDeviceParams);return new uL(t,i,n,s)}var Xs;(function(t){t.UNAVAILABLE="unavailable",t.DOWNLOADABLE="downloadable",t.DOWNLOADING="downloading",t.AVAILABLE="available"})(Xs||(Xs={}));/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e,n,r={createOptions:{expectedInputs:[{type:"image"}]}}){this.languageModelProvider=e,this.mode=n,this.onDeviceParams=r,this.isDownloading=!1}async isAvailable(e){if(!this.mode)return ln.debug("On-device inference unavailable because mode is undefined."),!1;if(this.mode===CI.ONLY_IN_CLOUD)return ln.debug('On-device inference unavailable because mode is "only_in_cloud".'),!1;const n=await this.downloadIfAvailable();if(this.mode===CI.ONLY_ON_DEVICE){if(n===Xs.UNAVAILABLE)throw new ue(he.API_NOT_ENABLED,"Local LanguageModel API not available in this environment.");return(n===Xs.DOWNLOADABLE||n===Xs.DOWNLOADING)&&(ln.debug("Waiting for download of LanguageModel to complete."),await this.downloadPromise),!0}return n!==Xs.AVAILABLE?(ln.debug(`On-device inference unavailable because availability is "${n}".`),!1):rr.isOnDeviceRequest(e)?!0:(ln.debug("On-device inference unavailable because request is incompatible."),!1)}async generateContent(e){const n=await this.createSession(),r=await Promise.all(e.contents.map(rr.toLanguageModelMessage)),i=await n.prompt(r,this.onDeviceParams.promptOptions);return rr.toResponse(i)}async generateContentStream(e){const n=await this.createSession(),r=await Promise.all(e.contents.map(rr.toLanguageModelMessage)),i=n.promptStreaming(r,this.onDeviceParams.promptOptions);return rr.toStreamResponse(i)}async countTokens(e){throw new ue(he.REQUEST_ERROR,"Count Tokens is not yet available for on-device model.")}static isOnDeviceRequest(e){if(e.contents.length===0)return ln.debug("Empty prompt rejected for on-device inference."),!1;for(const n of e.contents){if(n.role==="function")return ln.debug('"Function" role rejected for on-device inference.'),!1;for(const r of n.parts)if(r.inlineData&&rr.SUPPORTED_MIME_TYPES.indexOf(r.inlineData.mimeType)===-1)return ln.debug(`Unsupported mime type "${r.inlineData.mimeType}" rejected for on-device inference.`),!1}return!0}async downloadIfAvailable(){var n;const e=await((n=this.languageModelProvider)==null?void 0:n.availability(this.onDeviceParams.createOptions));return e===Xs.DOWNLOADABLE&&this.download(),e}download(){var e;this.isDownloading||(this.isDownloading=!0,this.downloadPromise=(e=this.languageModelProvider)==null?void 0:e.create(this.onDeviceParams.createOptions).finally(()=>{this.isDownloading=!1}))}static async toLanguageModelMessage(e){const n=await Promise.all(e.parts.map(rr.toLanguageModelMessageContent));return{role:rr.toLanguageModelMessageRole(e.role),content:n}}static async toLanguageModelMessageContent(e){if(e.text)return{type:"text",value:e.text};if(e.inlineData){const r=await(await fetch(`data:${e.inlineData.mimeType};base64,${e.inlineData.data}`)).blob();return{type:"image",value:await createImageBitmap(r)}}throw new ue(he.REQUEST_ERROR,"Processing of this Part type is not currently supported.")}static toLanguageModelMessageRole(e){return e==="model"?"assistant":"user"}async createSession(){if(!this.languageModelProvider)throw new ue(he.UNSUPPORTED,"Chrome AI requested for unsupported browser version.");const e=await this.languageModelProvider.create(this.onDeviceParams.createOptions);return this.oldSession&&this.oldSession.destroy(),this.oldSession=e,e}static toResponse(e){return{json:async()=>({candidates:[{content:{parts:[{text:e}]}}]})}}static toStreamResponse(e){const n=new TextEncoder;return{body:e.pipeThrough(new TransformStream({transform(r,i){const s=JSON.stringify({candidates:[{content:{role:"model",parts:[{text:r}]}}]});i.enqueue(n.encode(`data: ${s}

`))}}))}}}rr.SUPPORTED_MIME_TYPES=["image/jpeg","image/png"];function fL(t,e,n){if(typeof e<"u"&&t)return new rr(e.LanguageModel,t,n)}function pL(t,{instanceIdentifier:e}){if(!e)throw new ue(he.ERROR,"AIService instance identifier is undefined.");const n=jO(e),r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new MO(r,n,i,s,fL)}function mL(){Gn(new Cn(tl,pL,"PUBLIC").setMultipleInstances(!0)),Ht(bI,ay),Ht(bI,ay,"esm2020")}mL();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k6={PHONE:"phone",TOTP:"totp"},C6={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},N6={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},D6={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},O6={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function zb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const L6=gL,yL=zb,qb=new jo("auth","Firebase",zb()),V6={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf=new qu("@firebase/auth");function _L(t,...e){Rf.logLevel<=me.WARN&&Rf.warn(`Auth (${Uo}): ${t}`,...e)}function kh(t,...e){Rf.logLevel<=me.ERROR&&Rf.error(`Auth (${Uo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(t,...e){throw W_(t,...e)}function en(t,...e){return W_(t,...e)}function G_(t,e,n){const r={...yL(),[e]:n};return new jo("auth","Firebase",r).create(e,{appName:t.name})}function xt(t){return G_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Sl(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&_n(t,"argument-error"),G_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function W_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return qb.create(t,...e)}function H(t,e,...n){if(!t)throw W_(e,...n)}function Sr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw kh(e),new Error(e)}function li(t,e){t||Sr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function K_(){return MI()==="http:"||MI()==="https:"}function MI(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(K_()||rb()||"connection"in navigator)?navigator.onLine:!0}function wL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,n){this.shortDelay=e,this.longDelay=n,li(n>e,"Short delay should be less than long delay!"),this.isMobile=BN()||zN()}get(){return vL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t,e){li(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Sr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Sr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Sr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],TL=new Wu(3e4,6e4);function ze(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function qe(t,e,n,r,i={}){return Gb(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Rl({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...s};return $N()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&pi(t.emulatorConfig.host)&&(u.credentials="include"),Hb.fetch()(await Wb(t,t.config.apiHost,n,a),u)})}async function Gb(t,e,n){t._canInitEmulator=!1;const r={...IL,...e};try{const i=new bL(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ec(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ec(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ec(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ec(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw G_(t,d,u);_n(t,d)}}catch(i){if(i instanceof Ln)throw i;_n(t,"network-request-failed",{message:String(i)})}}async function gi(t,e,n,r,i={}){const s=await qe(t,e,n,r,i);return"mfaPendingCredential"in s&&_n(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function Wb(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?Q_(t.config,i):`${t.config.apiScheme}://${i}`;return EL.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function AL(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(en(this.auth,"network-request-failed")),TL.get())})}}function Ec(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=en(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(t){return t!==void 0&&t.getResponse!==void 0}function jI(t){return t!==void 0&&t.enterprise!==void 0}class Kb{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return AL(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RL(t){return(await qe(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Qb(t,e){return qe(t,"GET","/v2/recaptchaConfig",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SL(t,e){return qe(t,"POST","/v1/accounts:delete",e)}async function xL(t,e){return qe(t,"POST","/v1/accounts:update",e)}async function Sf(t,e){return qe(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(t,e=!1){return Z(t).getIdToken(e)}async function PL(t,e=!1){const n=Z(t),r=await n.getIdToken(e),i=fp(r);H(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:jc(qm(i.auth_time)),issuedAtTime:jc(qm(i.iat)),expirationTime:jc(qm(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function qm(t){return Number(t)*1e3}function fp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return kh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Q1(n);return i?JSON.parse(i):(kh("Failed to decode base64 JWT payload"),null)}catch(i){return kh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function UI(t){const e=fp(t);return H(e,"internal-error"),H(typeof e.exp<"u","internal-error"),H(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ci(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ln&&kL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function kL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=jc(this.lastLoginAt),this.creationTime=jc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _u(t){var f;const e=t.auth,n=await t.getIdToken(),r=await ci(t,Sf(e,{idToken:n}));H(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(f=i.providerUserInfo)!=null&&f.length?Yb(i.providerUserInfo):[],o=DL(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=a?l:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new cy(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function NL(t){const e=Z(t);await _u(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function DL(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Yb(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OL(t,e){const n=await Gb(t,{},async()=>{const r=Rl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await Wb(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&pi(t.emulatorConfig.host)&&(l.credentials="include"),Hb.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function LL(t,e){return qe(t,"POST","/v2/accounts:revokeToken",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){H(e.idToken,"internal-error"),H(typeof e.idToken<"u","internal-error"),H(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):UI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){H(e.length!==0,"internal-error");const n=UI(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(H(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await OL(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new $a;return r&&(H(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(H(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(H(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $a,this.toJSON())}_performRefresh(){return Sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(t,e){H(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ar{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new CL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new cy(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ci(this,this.stsTokenManager.getToken(this.auth,e));return H(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return PL(this,e)}reload(){return NL(this)}_assign(e){this!==e&&(H(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){H(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await _u(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Be(this.auth.app))return Promise.reject(xt(this.auth));const e=await this.getIdToken();return await ci(this,SL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:f,emailVerified:p,isAnonymous:v,providerData:S,stsTokenManager:P}=n;H(f&&P,e,"internal-error");const N=$a.fromJSON(this.name,P);H(typeof f=="string",e,"internal-error"),Li(r,e.name),Li(i,e.name),H(typeof p=="boolean",e,"internal-error"),H(typeof v=="boolean",e,"internal-error"),Li(s,e.name),Li(o,e.name),Li(a,e.name),Li(l,e.name),Li(u,e.name),Li(d,e.name);const T=new ar({uid:f,auth:e,email:i,emailVerified:p,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:N,createdAt:u,lastLoginAt:d});return S&&Array.isArray(S)&&(T.providerData=S.map(I=>({...I}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new $a;i.updateFromServerResponse(n);const s=new ar({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await _u(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];H(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Yb(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new $a;a.updateFromIdToken(r);const l=new ar({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new cy(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=new Map;function Jr(t){li(t instanceof Function,"Expected a class definition");let e=BI.get(t);return e?(li(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,BI.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Jb.type="NONE";const $I=Jb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ch(t,e,n){return`firebase:${t}:${e}:${n}`}class za{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Ch(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ch("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Sf(this.auth,{idToken:e}).catch(()=>{});return n?ar._fromGetAccountInfoResponse(this.auth,n,e):null}return ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new za(Jr($I),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Jr($I);const o=Ch(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){let f;if(typeof d=="string"){const p=await Sf(e,{idToken:d}).catch(()=>{});if(!p)break;f=await ar._fromGetAccountInfoResponse(e,p,d)}else f=ar._fromJSON(e,d);u!==s&&(a=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new za(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new za(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Xb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rR(e))return"Blackberry";if(iR(e))return"Webos";if(Zb(e))return"Safari";if((e.includes("chrome/")||eR(e))&&!e.includes("edge/"))return"Chrome";if(nR(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Xb(t=wt()){return/firefox\//i.test(t)}function Zb(t=wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eR(t=wt()){return/crios\//i.test(t)}function tR(t=wt()){return/iemobile/i.test(t)}function nR(t=wt()){return/android/i.test(t)}function rR(t=wt()){return/blackberry/i.test(t)}function iR(t=wt()){return/webos/i.test(t)}function Y_(t=wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function VL(t=wt()){var e;return Y_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ML(){return qN()&&document.documentMode===10}function sR(t=wt()){return Y_(t)||nR(t)||iR(t)||rR(t)||/windows phone/i.test(t)||tR(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(t,e=[]){let n;switch(t){case"Browser":n=zI(wt());break;case"Worker":n=`${zI(wt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Uo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jL(t,e={}){return qe(t,"GET","/v2/passwordPolicy",ze(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=6;class BL{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??UL,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qI(this),this.idTokenSubscription=new qI(this),this.beforeStateQueue=new FL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Jr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await za.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Sf(this,{idToken:e}),r=await ar._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Be(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return H(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await _u(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=wL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Be(this.app))return Promise.reject(xt(this));const n=e?Z(e):null;return n&&H(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&H(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Be(this.app)?Promise.reject(xt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Be(this.app)?Promise.reject(xt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jL(this),n=new BL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new jo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await LL(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Jr(e)||this._popupRedirectResolver;H(n,this,"argument-error"),this.redirectPersistenceManager=await za.create(this,[Jr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(H(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return H(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Be(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&_L(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function rt(t){return Z(t)}class qI{constructor(e){this.auth=e,this.observer=null,this.addObserver=YN(n=>this.observer=n)}get next(){return H(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ku={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zL(t){Ku=t}function J_(t){return Ku.loadJS(t)}function qL(){return Ku.recaptchaV2Script}function HL(){return Ku.recaptchaEnterpriseScript}function GL(){return Ku.gapiScript}function aR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=500,KL=6e4,oh=1e12;class QL{constructor(e){this.auth=e,this.counter=oh,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new XL(e,this.auth.name,n||{})),this.counter++,r}reset(e){var r;const n=e||oh;(r=this._widgets.get(n))==null||r.delete(),this._widgets.delete(n)}getResponse(e){var r;const n=e||oh;return((r=this._widgets.get(n))==null?void 0:r.getResponse())||""}async execute(e){var r;const n=e||oh;return(r=this._widgets.get(n))==null||r.execute(),""}}class YL{constructor(){this.enterprise=new JL}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class JL{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class XL{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;H(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=ZL(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},KL)},WL))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function ZL(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}const eV="recaptcha-enterprise",Uc="NO_RECAPTCHA";class lR{constructor(e){this.type=eV,this.auth=rt(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{Qb(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new Kb(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;jI(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(Uc)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new YL().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&jI(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=HL();l.length!==0&&(l+=a),J_(l).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function cc(t,e,n,r=!1,i=!1){const s=new lR(t);let o;if(i)o=Uc;else try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function hs(t,e,n,r,i){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if((s=t._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await cc(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await cc(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(a)});else if(i==="PHONE_PROVIDER")if((o=t._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const a=await cc(t,e,n);return r(t,a).catch(async l=>{var u;if(((u=t._getRecaptchaConfig())==null?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await cc(t,e,n,!1,!0);return r(t,d)}return Promise.reject(l)})}else{const a=await cc(t,e,n,!1,!0);return r(t,a)}else return Promise.reject(i+" provider is not supported.")}async function cR(t){const e=rt(t),n=await Qb(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Kb(n);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new lR(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tV(t,e){const n=hr(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Hn(s,e??{}))return i;_n(i,"already-initialized")}return n.initialize({options:e})}function nV(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Jr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function rV(t,e,n){const r=rt(t);H(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=uR(e),{host:o,port:a}=iV(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){H(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),H(Hn(u,r.config.emulator)&&Hn(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,pi(o)?(cp(`${s}//${o}${l}`),V_("Auth",!0)):i||sV()}function uR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function iV(t){const e=uR(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:HI(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:HI(o)}}}function HI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function sV(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Sr("not implemented")}_getIdTokenResponse(e){return Sr("not implemented")}_linkToIdToken(e,n){return Sr("not implemented")}_getReauthenticationResolver(e){return Sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dR(t,e){return qe(t,"POST","/v1/accounts:resetPassword",ze(t,e))}async function oV(t,e){return qe(t,"POST","/v1/accounts:update",e)}async function aV(t,e){return qe(t,"POST","/v1/accounts:signUp",e)}async function lV(t,e){return qe(t,"POST","/v1/accounts:update",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cV(t,e){return gi(t,"POST","/v1/accounts:signInWithPassword",ze(t,e))}async function pp(t,e){return qe(t,"POST","/v1/accounts:sendOobCode",ze(t,e))}async function uV(t,e){return pp(t,e)}async function dV(t,e){return pp(t,e)}async function hV(t,e){return pp(t,e)}async function fV(t,e){return pp(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pV(t,e){return gi(t,"POST","/v1/accounts:signInWithEmailLink",ze(t,e))}async function mV(t,e){return gi(t,"POST","/v1/accounts:signInWithEmailLink",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu extends Qu{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new vu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new vu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hs(e,n,"signInWithPassword",cV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return pV(e,{email:this._email,oobCode:this._password});default:_n(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hs(e,r,"signUpPassword",aV,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return mV(e,{idToken:n,email:this._email,oobCode:this._password});default:_n(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ti(t,e){return gi(t,"POST","/v1/accounts:signInWithIdp",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gV="http://localhost";class ui extends Qu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ui(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):_n("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new ui(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ti(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ti(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ti(e,n)}buildRequest(){const e={requestUri:gV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Rl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GI(t,e){return qe(t,"POST","/v1/accounts:sendVerificationCode",ze(t,e))}async function yV(t,e){return gi(t,"POST","/v1/accounts:signInWithPhoneNumber",ze(t,e))}async function _V(t,e){const n=await gi(t,"POST","/v1/accounts:signInWithPhoneNumber",ze(t,e));if(n.temporaryProof)throw Ec(t,"account-exists-with-different-credential",n);return n}const vV={USER_NOT_FOUND:"user-not-found"};async function wV(t,e){const n={...e,operation:"REAUTH"};return gi(t,"POST","/v1/accounts:signInWithPhoneNumber",ze(t,n),vV)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends Qu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new fo({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new fo({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return yV(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return _V(e,{idToken:n,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return wV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new fo({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IV(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function EV(t){const e=wc(Ic(t)).link,n=e?wc(Ic(e)).deep_link_id:null,r=wc(Ic(t)).deep_link_id;return(r?wc(Ic(r)).link:null)||r||n||e||t}class Yu{constructor(e){const n=wc(Ic(e)),r=n.apiKey??null,i=n.oobCode??null,s=IV(n.mode??null);H(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=EV(e);try{return new Yu(n)}catch{return null}}}function F6(t){return Yu.parseLink(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(){this.providerId=Bo.PROVIDER_ID}static credential(e,n){return vu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Yu.parseLink(n);return H(r,"argument-error"),vu._fromEmailAndCode(e,r.code,r.tenantId)}}Bo.PROVIDER_ID="password";Bo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl extends yi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Nh extends xl{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return H("providerId"in n&&"signInMethod"in n,"argument-error"),ui._fromParams(n)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return H(e.idToken||e.accessToken,"argument-error"),ui._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Nh.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Nh.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!n&&!s||!a)return null;try{return new Nh(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends xl{constructor(){super("facebook.com")}static credential(e){return ui._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qi.credential(e.oauthAccessToken)}catch{return null}}}qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";qi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends xl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ui._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Hi.credential(n,r)}catch{return null}}}Hi.GOOGLE_SIGN_IN_METHOD="google.com";Hi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends xl{constructor(){super("github.com")}static credential(e){return ui._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.GITHUB_SIGN_IN_METHOD="github.com";Gi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TV="http://localhost";class wu extends Qu{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return ti(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ti(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ti(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new wu(r,s)}static _create(e,n){return new wu(e,n)}buildRequest(){return{requestUri:TV,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AV="saml.";class uy extends yi{constructor(e){H(e.startsWith(AV),"argument-error"),super(e)}static credentialFromResult(e){return uy.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return uy.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=wu.fromJSON(e);return H(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return wu._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends xl{constructor(){super("twitter.com")}static credential(e,n){return ui._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Wi.credential(n,r)}catch{return null}}}Wi.TWITTER_SIGN_IN_METHOD="twitter.com";Wi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hR(t,e){return gi(t,"POST","/v1/accounts:signUp",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await ar._fromIdTokenResponse(e,r,i),o=WI(r);return new Wn({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=WI(r);return new Wn({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function WI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bV(t){var i;if(Be(t.app))return Promise.reject(xt(t));const e=rt(t);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new Wn({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await hR(e,{returnSecureToken:!0}),r=await Wn._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf extends Ln{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,xf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new xf(e,n,r,i)}}function fR(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?xf._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j6(t,e){const n=Z(t);await mp(!0,n,e);const{providerUserInfo:r}=await xL(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=pR(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function X_(t,e,n=!1){const r=await ci(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wn._forOperation(t,"link",r)}async function mp(t,e,n){await _u(e);const r=pR(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";H(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mR(t,e,n=!1){const{auth:r}=t;if(Be(r.app))return Promise.reject(xt(r));const i="reauthenticate";try{const s=await ci(t,fR(r,i,e,t),n);H(s.idToken,r,"internal-error");const o=fp(s.idToken);H(o,r,"internal-error");const{sub:a}=o;return H(t.uid===a,r,"user-mismatch"),Wn._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_n(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gR(t,e,n=!1){if(Be(t.app))return Promise.reject(xt(t));const r="signIn",i=await fR(t,r,e),s=await Wn._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Z_(t,e){return gR(rt(t),e)}async function RV(t,e){const n=Z(t);return await mp(!1,n,e.providerId),X_(n,e)}async function SV(t,e){return mR(Z(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xV(t,e){return gi(t,"POST","/v1/accounts:signInWithCustomToken",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U6(t,e){if(Be(t.app))return Promise.reject(xt(t));const n=rt(t),r=await xV(n,{token:e,returnSecureToken:!0}),i=await Wn._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?ev._fromServerResponse(e,n):"totpInfo"in n?tv._fromServerResponse(e,n):_n(e,"internal-error")}}class ev extends Ju{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new ev(n)}}class tv extends Ju{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new tv(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(t,e,n){var r;H(((r=n.url)==null?void 0:r.length)>0,t,"invalid-continue-uri"),H(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),H(typeof n.linkDomain>"u"||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(H(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(H(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nv(t){const e=rt(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function B6(t,e,n){const r=rt(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&gp(r,i,n),await hs(r,i,"getOobCode",dV,"EMAIL_PASSWORD_PROVIDER")}async function $6(t,e,n){await dR(Z(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&nv(t),r})}async function z6(t,e){await lV(Z(t),{oobCode:e})}async function PV(t,e){const n=Z(t),r=await dR(n,{oobCode:e}),i=r.requestType;switch(H(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":H(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":H(r.mfaInfo,n,"internal-error");default:H(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Ju._fromServerResponse(rt(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function q6(t,e){const{data:n}=await PV(Z(t),e);return n.email}async function H6(t,e,n){if(Be(t.app))return Promise.reject(xt(t));const r=rt(t),o=await hs(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",hR,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&nv(t),l}),a=await Wn._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function G6(t,e,n){return Be(t.app)?Promise.reject(xt(t)):Z_(Z(t),Bo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&nv(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W6(t,e,n){const r=rt(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){H(a.handleCodeInApp,r,"argument-error"),a&&gp(r,o,a)}s(i,n),await hs(r,i,"getOobCode",hV,"EMAIL_PASSWORD_PROVIDER")}function K6(t,e){const n=Yu.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function Q6(t,e,n){if(Be(t.app))return Promise.reject(xt(t));const r=Z(t),i=Bo.credentialWithLink(e,n||yu());return H(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Z_(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kV(t,e){return qe(t,"POST","/v1/accounts:createAuthUri",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y6(t,e){const n=K_()?yu():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await kV(Z(t),r);return i||[]}async function J6(t,e){const n=Z(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&gp(n.auth,i,e);const{email:s}=await uV(n.auth,i);s!==t.email&&await t.reload()}async function X6(t,e,n){const r=Z(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&gp(r.auth,s,n);const{email:o}=await fV(r.auth,s);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CV(t,e){return qe(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Z(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await ci(r,CV(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function e5(t,e){const n=Z(t);return Be(n.auth.app)?Promise.reject(xt(n.auth)):yR(n,e,null)}function t5(t,e){return yR(Z(t),null,e)}async function yR(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await ci(t,oV(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NV(t){var i,s;if(!t)return null;const{providerId:e}=t,n=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},r=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(t!=null&&t.idToken)){const o=(s=(i=fp(t.idToken))==null?void 0:i.firebase)==null?void 0:s.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new qa(r,a)}}if(!e)return null;switch(e){case"facebook.com":return new DV(r,n);case"github.com":return new OV(r,n);case"google.com":return new LV(r,n);case"twitter.com":return new VV(r,n,t.screenName||null);case"custom":case"anonymous":return new qa(r,null);default:return new qa(r,e,n)}}class qa{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class _R extends qa{constructor(e,n,r,i){super(e,n,r),this.username=i}}class DV extends qa{constructor(e,n){super(e,"facebook.com",n)}}class OV extends _R{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class LV extends qa{constructor(e,n){super(e,"google.com",n)}}class VV extends _R{constructor(e,n,r){super(e,"twitter.com",n,r)}}function n5(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:NV(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(t,e){return Z(t).setPersistence(e)}function i5(t){return cR(t)}async function s5(t,e){return rt(t).validatePassword(e)}function MV(t,e,n,r){return Z(t).onIdTokenChanged(e,n,r)}function FV(t,e,n){return Z(t).beforeAuthStateChanged(e,n)}function jV(t,e,n,r){return Z(t).onAuthStateChanged(e,n,r)}function o5(t){Z(t).useDeviceLanguage()}function a5(t,e){return Z(t).updateCurrentUser(e)}function l5(t){return Z(t).signOut()}function c5(t,e){return rt(t).revokeAccessToken(e)}async function u5(t){return Z(t).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new lo("enroll",e,n)}static _fromMfaPendingCredential(e){return new lo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if((n=e.multiFactorSession)!=null&&n.pendingCredential)return lo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return lo._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=rt(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Ju._fromServerResponse(r,a));H(i.mfaPendingCredential,r,"internal-error");const o=lo._fromMfaPendingCredential(i.mfaPendingCredential);return new rv(o,s,async a=>{const l=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const u={...i,idToken:l.idToken,refreshToken:l.refreshToken};switch(n.operationType){case"signIn":const d=await Wn._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return H(n.user,r,"internal-error"),Wn._forOperation(n.user,n.operationType,u);default:_n(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function d5(t,e){var i;const n=Z(t),r=e;return H(e.customData.operationType,n,"argument-error"),H((i=r.customData._serverResponse)==null?void 0:i.mfaPendingCredential,n,"argument-error"),rv._fromError(n,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t,e){return qe(t,"POST","/v2/accounts/mfaEnrollment:start",ze(t,e))}function UV(t,e){return qe(t,"POST","/v2/accounts/mfaEnrollment:finalize",ze(t,e))}function BV(t,e){return qe(t,"POST","/v2/accounts/mfaEnrollment:start",ze(t,e))}function $V(t,e){return qe(t,"POST","/v2/accounts/mfaEnrollment:finalize",ze(t,e))}function zV(t,e){return qe(t,"POST","/v2/accounts/mfaEnrollment:withdraw",ze(t,e))}class iv{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Ju._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new iv(e)}async getSession(){return lo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,i=await this.getSession(),s=await ci(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await ci(this.user,zV(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==n),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Hm=new WeakMap;function h5(t){const e=Z(t);return Hm.has(e)||Hm.set(e,iv._fromUser(e)),Hm.get(e)}const Pf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Pf,"1"),this.storage.removeItem(Pf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV=1e3,HV=10;class wR extends vR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);ML()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,HV):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},qV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}wR.type="LOCAL";const GV=wR;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV=1e3;function Gm(t){var r;const e=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${e}=([^;]+)`);return((r=document.cookie.match(n))==null?void 0:r[1])??null}function Wm(t){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${t.split(":")[3]}`}class IR{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;const n=new URL(`${window.location.origin}/__cookies__`);return n.searchParams.set("finalTarget",e),n}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,n){}async _get(e){if(!this._isAvailable())return null;const n=Wm(e);if(window.cookieStore){const r=await window.cookieStore.get(n);return r==null?void 0:r.value}return Gm(n)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;const r=Wm(e);document.cookie=`${r}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,n){if(!this._isAvailable())return;const r=Wm(e);if(window.cookieStore){const a=u=>{const d=u.changed.find(p=>p.name===r);d&&n(d.value),u.deleted.find(p=>p.name===r)&&n(null)},l=()=>window.cookieStore.removeEventListener("change",a);return this.listenerUnsubscribes.set(n,l),window.cookieStore.addEventListener("change",a)}let i=Gm(r);const s=setInterval(()=>{const a=Gm(r);a!==i&&(n(a),i=a)},WV),o=()=>clearInterval(s);this.listenerUnsubscribes.set(n,o)}_removeListener(e,n){const r=this.listenerUnsubscribes.get(n);r&&(r(),this.listenerUnsubscribes.delete(n))}}IR.type="COOKIE";const f5=IR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER extends vR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}ER.type="SESSION";const TR=ER;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KV(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new yp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await KV(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=_p("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(){return window}function YV(t){ht().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(){return typeof ht().WorkerGlobalScope<"u"&&typeof ht().importScripts=="function"}async function JV(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XV(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function ZV(){return sv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR="firebaseLocalStorageDb",eM=1,kf="firebaseLocalStorage",bR="fbase_key";class Xu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function vp(t,e){return t.transaction([kf],e?"readwrite":"readonly").objectStore(kf)}function tM(){const t=indexedDB.deleteDatabase(AR);return new Xu(t).toPromise()}function dy(){const t=indexedDB.open(AR,eM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(kf,{keyPath:bR})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(kf)?e(r):(r.close(),await tM(),e(await dy()))})})}async function QI(t,e,n){const r=vp(t,!0).put({[bR]:e,value:n});return new Xu(r).toPromise()}async function nM(t,e){const n=vp(t,!1).get(e),r=await new Xu(n).toPromise();return r===void 0?null:r.value}function YI(t,e){const n=vp(t,!0).delete(e);return new Xu(n).toPromise()}const rM=800,iM=3;class RR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dy(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>iM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yp._getInstance(ZV()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await JV(),!this.activeServiceWorker)return;this.sender=new QV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dy();return await QI(e,Pf,"1"),await YI(e,Pf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>QI(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>nM(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>YI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=vp(i,!1).getAll();return new Xu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}RR.type="LOCAL";const sM=RR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(t,e){return qe(t,"POST","/v2/accounts/mfaSignIn:start",ze(t,e))}function oM(t,e){return qe(t,"POST","/v2/accounts/mfaSignIn:finalize",ze(t,e))}function aM(t,e){return qe(t,"POST","/v2/accounts/mfaSignIn:finalize",ze(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km=aR("rcb"),lM=new Wu(3e4,6e4);class cM{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=ht().grecaptcha)!=null&&e.render)}load(e,n=""){return H(uM(n),e,"argument-error"),this.shouldResolveImmediately(n)&&FI(ht().grecaptcha)?Promise.resolve(ht().grecaptcha):new Promise((r,i)=>{const s=ht().setTimeout(()=>{i(en(e,"network-request-failed"))},lM.get());ht()[Km]=()=>{ht().clearTimeout(s),delete ht()[Km];const a=ht().grecaptcha;if(!a||!FI(a)){i(en(e,"internal-error"));return}const l=a.render;a.render=(u,d)=>{const f=l(u,d);return this.counter++,f},this.hostLanguage=n,r(a)};const o=`${qL()}?${Rl({onload:Km,render:"explicit",hl:n})}`;J_(o).catch(()=>{clearTimeout(s),i(en(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!((n=ht().grecaptcha)!=null&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function uM(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class dM{async load(e){return new QL(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc="recaptcha",hM={theme:"light",type:"image"};class p5{constructor(e,n,r={...hM}){this.parameters=r,this.type=Bc,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=rt(e),this.isInvisible=this.parameters.size==="invisible",H(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof n=="string"?document.getElementById(n):n;H(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new dM:new cM,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){H(!this.parameters.sitekey,this.auth,"argument-error"),H(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),H(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=ht()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){H(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){H(K_()&&!sv(),this.auth,"internal-error"),await fM(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await RL(this.auth);H(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return H(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function fM(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=fo._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function m5(t,e,n){if(Be(t.app))return Promise.reject(xt(t));const r=rt(t),i=await wp(r,e,Z(n));return new ov(i,s=>Z_(r,s))}async function g5(t,e,n){const r=Z(t);await mp(!1,r,"phone");const i=await wp(r.auth,e,Z(n));return new ov(i,s=>RV(r,s))}async function y5(t,e,n){const r=Z(t);if(Be(r.auth.app))return Promise.reject(xt(r.auth));const i=await wp(r.auth,e,Z(n));return new ov(i,s=>SV(r,s))}async function wp(t,e,n){var r;if(!t._getRecaptchaConfig())try{await cR(t)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const s=i.session;if("phoneNumber"in i){H(s.type==="enroll",t,"internal-error");const o={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await hs(t,o,"mfaSmsEnrollment",async(d,f)=>{if(f.phoneEnrollmentInfo.captchaResponse===Uc){H((n==null?void 0:n.type)===Bc,d,"argument-error");const p=await Qm(d,f,n);return KI(d,p)}return KI(d,f)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneSessionInfo.sessionInfo}else{H(s.type==="signin",t,"internal-error");const o=((r=i.multiFactorHint)==null?void 0:r.uid)||i.multiFactorUid;H(o,t,"missing-multi-factor-info");const a={mfaPendingCredential:s.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await hs(t,a,"mfaSmsSignIn",async(f,p)=>{if(p.phoneSignInInfo.captchaResponse===Uc){H((n==null?void 0:n.type)===Bc,f,"argument-error");const v=await Qm(f,p,n);return JI(f,v)}return JI(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).phoneResponseInfo.sessionInfo}}else{const s={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await hs(t,s,"sendVerificationCode",async(u,d)=>{if(d.captchaResponse===Uc){H((n==null?void 0:n.type)===Bc,u,"argument-error");const f=await Qm(u,d,n);return GI(u,f)}return GI(u,d)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).sessionInfo}}finally{n==null||n._reset()}}async function _5(t,e){const n=Z(t);if(Be(n.auth.app))return Promise.reject(xt(n.auth));await X_(n,e)}async function Qm(t,e,n){H(n.type===Bc,t,"argument-error");const r=await n.verify();H(typeof r=="string",t,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,a=i.phoneEnrollmentInfo.clientType,l=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:a,recaptchaVersion:l}}),i}else if("phoneSignInInfo"in i){const s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,a=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:a}}),i}else return Object.assign(i,{recaptchaToken:r}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.providerId=Ha.PROVIDER_ID,this.auth=rt(e)}verifyPhoneNumber(e,n){return wp(this.auth,e,Z(n))}static credential(e,n){return fo._fromVerification(e,n)}static credentialFromResult(e){const n=e;return Ha.credentialFromTaggedObject(n)}static credentialFromError(e){return Ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?fo._fromTokenResponse(n,r):null}}Ha.PROVIDER_ID="phone";Ha.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(t,e){return e?Jr(e):(H(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av extends Qu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ti(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ti(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ti(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function pM(t){return gR(t.auth,new av(t),t.bypassAuthState)}function mM(t){const{auth:e,user:n}=t;return H(n,e,"internal-error"),mR(n,new av(t),t.bypassAuthState)}async function gM(t){const{auth:e,user:n}=t;return H(n,e,"internal-error"),X_(n,new av(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return pM;case"linkViaPopup":case"linkViaRedirect":return gM;case"reauthViaPopup":case"reauthViaRedirect":return mM;default:_n(this.auth,"internal-error")}}resolve(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM=new Wu(2e3,1e4);async function v5(t,e,n){if(Be(t.app))return Promise.reject(en(t,"operation-not-supported-in-this-environment"));const r=rt(t);Sl(t,e,yi);const i=$o(r,n);return new Xr(r,"signInViaPopup",e,i).executeNotNull()}async function w5(t,e,n){const r=Z(t);if(Be(r.auth.app))return Promise.reject(en(r.auth,"operation-not-supported-in-this-environment"));Sl(r.auth,e,yi);const i=$o(r.auth,n);return new Xr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function I5(t,e,n){const r=Z(t);Sl(r.auth,e,yi);const i=$o(r.auth,n);return new Xr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class Xr extends SR{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Xr.currentPopupAction&&Xr.currentPopupAction.cancel(),Xr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return H(e,this.auth,"internal-error"),e}async onExecution(){li(this.filter.length===1,"Popup operations only handle one event");const e=_p();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(en(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(en(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(en(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,yM.get())};e()}}Xr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M="pendingRedirect",Dh=new Map;class vM extends SR{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Dh.get(this.auth._key());if(!e){try{const r=await wM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Dh.set(this.auth._key(),e)}return this.bypassAuthState||Dh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wM(t,e){const n=PR(e),r=xR(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function lv(t,e){return xR(t)._set(PR(e),"true")}function IM(t,e){Dh.set(t._key(),e)}function xR(t){return Jr(t._redirectPersistence)}function PR(t){return Ch(_M,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E5(t,e,n){return EM(t,e,n)}async function EM(t,e,n){if(Be(t.app))return Promise.reject(xt(t));const r=rt(t);Sl(t,e,yi),await r._initializationPromise;const i=$o(r,n);return await lv(i,r),i._openRedirect(r,e,"signInViaRedirect")}function T5(t,e,n){return TM(t,e,n)}async function TM(t,e,n){const r=Z(t);if(Sl(r.auth,e,yi),Be(r.auth.app))return Promise.reject(xt(r.auth));await r.auth._initializationPromise;const i=$o(r.auth,n);await lv(i,r.auth);const s=await CR(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function A5(t,e,n){return AM(t,e,n)}async function AM(t,e,n){const r=Z(t);Sl(r.auth,e,yi),await r.auth._initializationPromise;const i=$o(r.auth,n);await mp(!1,r,e.providerId),await lv(i,r.auth);const s=await CR(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function b5(t,e){return await rt(t)._initializationPromise,kR(t,e,!1)}async function kR(t,e,n=!1){if(Be(t.app))return Promise.reject(xt(t));const r=rt(t),i=$o(r,e),o=await new vM(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function CR(t){const e=_p(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bM=10*60*1e3;class RM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!SM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!NR(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(en(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=bM&&this.cachedEventUids.clear(),this.cachedEventUids.has(XI(e))}saveEventToCache(e){this.cachedEventUids.add(XI(e)),this.lastProcessedEventTime=Date.now()}}function XI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function NR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function SM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return NR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xM(t,e={}){return qe(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,kM=/^https?/;async function CM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await xM(t);for(const n of e)try{if(NM(n))return}catch{}_n(t,"unauthorized-domain")}function NM(t){const e=yu(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!kM.test(n))return!1;if(PM.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DM=new Wu(3e4,6e4);function ZI(){const t=ht().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function OM(t){return new Promise((e,n)=>{var i,s,o;function r(){ZI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ZI(),n(en(t,"network-request-failed"))},timeout:DM.get()})}if((s=(i=ht().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=ht().gapi)!=null&&o.load)r();else{const a=aR("iframefcb");return ht()[a]=()=>{gapi.load?r():n(en(t,"network-request-failed"))},J_(`${GL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Oh=null,e})}let Oh=null;function LM(t){return Oh=Oh||OM(t),Oh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM=new Wu(5e3,15e3),MM="__/auth/iframe",FM="emulator/auth/iframe",jM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},UM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function BM(t){const e=t.config;H(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Q_(e,FM):`https://${t.config.authDomain}/${MM}`,r={apiKey:e.apiKey,appName:t.name,v:Uo},i=UM.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Rl(r).slice(1)}`}async function $M(t){const e=await LM(t),n=ht().gapi;return H(n,t,"internal-error"),e.open({where:document.body,url:BM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jM,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=en(t,"network-request-failed"),a=ht().setTimeout(()=>{s(o)},VM.get());function l(){ht().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qM=500,HM=600,GM="_blank",WM="http://localhost";class eE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function KM(t,e,n,r=qM,i=HM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...zM,width:r.toString(),height:i.toString(),top:s,left:o},u=wt().toLowerCase();n&&(a=eR(u)?GM:n),Xb(u)&&(e=e||WM,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[v,S])=>`${p}${v}=${S},`,"");if(VL(u)&&a!=="_self")return QM(e||"",a),new eE(null);const f=window.open(e||"",a,d);H(f,t,"popup-blocked");try{f.focus()}catch{}return new eE(f)}function QM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YM="__/auth/handler",JM="emulator/auth/handler",XM=encodeURIComponent("fac");async function tE(t,e,n,r,i,s){H(t.config.authDomain,t,"auth-domain-config-required"),H(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Uo,eventId:i};if(e instanceof yi){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",QN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(s||{}))o[d]=f}if(e instanceof xl){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${XM}=${encodeURIComponent(l)}`:"";return`${ZM(t)}?${Rl(a).slice(1)}${u}`}function ZM({config:t}){return t.emulator?Q_(t,JM):`https://${t.authDomain}/${YM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym="webStorageSupport";class e4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=TR,this._completeRedirectFn=kR,this._overrideRedirectResult=IM}async _openPopup(e,n,r,i){var o;li((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await tE(e,n,r,yu(),i);return KM(e,s,_p())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await tE(e,n,r,yu(),i);return YV(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(li(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await $M(e),r=new RM(e);return n.register("authEvent",i=>(H(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ym,{type:Ym},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[Ym];s!==void 0&&n(!!s),_n(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=CM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return sR()||Zb()||Y_()}}const t4=e4;class DR{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Sr("unexpected MultiFactorSessionType")}}}class cv extends DR{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new cv(e)}_finalizeEnroll(e,n,r){return UV(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return oM(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class n4{constructor(){}static assertion(e){return cv._fromCredential(e)}}n4.FACTOR_ID="phone";class r4{static assertionForEnrollment(e,n){return Iu._fromSecret(e,n)}static assertionForSignIn(e,n){return Iu._fromEnrollmentId(e,n)}static async generateSecret(e){var i;const n=e;H(typeof((i=n.user)==null?void 0:i.auth)<"u","internal-error");const r=await BV(n.user.auth,{idToken:n.credential,totpEnrollmentInfo:{}});return uv._fromStartTotpMfaEnrollmentResponse(r,n.user.auth)}}r4.FACTOR_ID="totp";class Iu extends DR{constructor(e,n,r){super("totp"),this.otp=e,this.enrollmentId=n,this.secret=r}static _fromSecret(e,n){return new Iu(n,void 0,e)}static _fromEnrollmentId(e,n){return new Iu(n,e)}async _finalizeEnroll(e,n,r){return H(typeof this.secret<"u",e,"argument-error"),$V(e,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,n){H(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return aM(e,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class uv{constructor(e,n,r,i,s,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=s}static _fromStartTotpMfaEnrollmentResponse(e,n){return new uv(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,n)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,n){var i;let r=!1;return(ah(e)||ah(n))&&(r=!0),r&&(ah(e)&&(e=((i=this.auth.currentUser)==null?void 0:i.email)||"unknownuser"),ah(n)&&(n=this.auth.name)),`otpauth://totp/${n}:${e}?secret=${this.secretKey}&issuer=${n}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function ah(t){return typeof t>"u"||(t==null?void 0:t.length)===0}var nE="@firebase/auth",rE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){H(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function o4(t){Gn(new Cn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;H(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oR(t)},u=new $L(r,i,s,l);return nV(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Gn(new Cn("auth-internal",e=>{const n=rt(e.getProvider("auth").getImmediate());return(r=>new i4(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ht(nE,rE,s4(t)),Ht(nE,rE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4=5*60,l4=eb("authIdTokenMaxAge")||a4;let iE=null;const c4=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>l4)return;const i=n==null?void 0:n.token;iE!==i&&(iE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function u4(t=Hu()){const e=hr(t,"auth");if(e.isInitialized())return e.getImmediate();const n=tV(t,{popupRedirectResolver:t4,persistence:[sM,GV,TR]}),r=eb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=c4(s.toString());FV(n,o,()=>o(n.currentUser)),MV(n,a=>o(a))}}const i=J1("auth");return i&&rV(n,`http://${i}`),n}function d4(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}zL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=en("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",d4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});o4("Browser");var sE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fs,OR;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,_){function R(){}R.prototype=_.prototype,A.D=_.prototype,A.prototype=new R,A.prototype.constructor=A,A.C=function(E,k,D){for(var x=Array(arguments.length-2),Ct=2;Ct<arguments.length;Ct++)x[Ct-2]=arguments[Ct];return _.prototype[k].apply(E,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,_,R){R||(R=0);var E=Array(16);if(typeof _=="string")for(var k=0;16>k;++k)E[k]=_.charCodeAt(R++)|_.charCodeAt(R++)<<8|_.charCodeAt(R++)<<16|_.charCodeAt(R++)<<24;else for(k=0;16>k;++k)E[k]=_[R++]|_[R++]<<8|_[R++]<<16|_[R++]<<24;_=A.g[0],R=A.g[1],k=A.g[2];var D=A.g[3],x=_+(D^R&(k^D))+E[0]+3614090360&4294967295;_=R+(x<<7&4294967295|x>>>25),x=D+(k^_&(R^k))+E[1]+3905402710&4294967295,D=_+(x<<12&4294967295|x>>>20),x=k+(R^D&(_^R))+E[2]+606105819&4294967295,k=D+(x<<17&4294967295|x>>>15),x=R+(_^k&(D^_))+E[3]+3250441966&4294967295,R=k+(x<<22&4294967295|x>>>10),x=_+(D^R&(k^D))+E[4]+4118548399&4294967295,_=R+(x<<7&4294967295|x>>>25),x=D+(k^_&(R^k))+E[5]+1200080426&4294967295,D=_+(x<<12&4294967295|x>>>20),x=k+(R^D&(_^R))+E[6]+2821735955&4294967295,k=D+(x<<17&4294967295|x>>>15),x=R+(_^k&(D^_))+E[7]+4249261313&4294967295,R=k+(x<<22&4294967295|x>>>10),x=_+(D^R&(k^D))+E[8]+1770035416&4294967295,_=R+(x<<7&4294967295|x>>>25),x=D+(k^_&(R^k))+E[9]+2336552879&4294967295,D=_+(x<<12&4294967295|x>>>20),x=k+(R^D&(_^R))+E[10]+4294925233&4294967295,k=D+(x<<17&4294967295|x>>>15),x=R+(_^k&(D^_))+E[11]+2304563134&4294967295,R=k+(x<<22&4294967295|x>>>10),x=_+(D^R&(k^D))+E[12]+1804603682&4294967295,_=R+(x<<7&4294967295|x>>>25),x=D+(k^_&(R^k))+E[13]+4254626195&4294967295,D=_+(x<<12&4294967295|x>>>20),x=k+(R^D&(_^R))+E[14]+2792965006&4294967295,k=D+(x<<17&4294967295|x>>>15),x=R+(_^k&(D^_))+E[15]+1236535329&4294967295,R=k+(x<<22&4294967295|x>>>10),x=_+(k^D&(R^k))+E[1]+4129170786&4294967295,_=R+(x<<5&4294967295|x>>>27),x=D+(R^k&(_^R))+E[6]+3225465664&4294967295,D=_+(x<<9&4294967295|x>>>23),x=k+(_^R&(D^_))+E[11]+643717713&4294967295,k=D+(x<<14&4294967295|x>>>18),x=R+(D^_&(k^D))+E[0]+3921069994&4294967295,R=k+(x<<20&4294967295|x>>>12),x=_+(k^D&(R^k))+E[5]+3593408605&4294967295,_=R+(x<<5&4294967295|x>>>27),x=D+(R^k&(_^R))+E[10]+38016083&4294967295,D=_+(x<<9&4294967295|x>>>23),x=k+(_^R&(D^_))+E[15]+3634488961&4294967295,k=D+(x<<14&4294967295|x>>>18),x=R+(D^_&(k^D))+E[4]+3889429448&4294967295,R=k+(x<<20&4294967295|x>>>12),x=_+(k^D&(R^k))+E[9]+568446438&4294967295,_=R+(x<<5&4294967295|x>>>27),x=D+(R^k&(_^R))+E[14]+3275163606&4294967295,D=_+(x<<9&4294967295|x>>>23),x=k+(_^R&(D^_))+E[3]+4107603335&4294967295,k=D+(x<<14&4294967295|x>>>18),x=R+(D^_&(k^D))+E[8]+1163531501&4294967295,R=k+(x<<20&4294967295|x>>>12),x=_+(k^D&(R^k))+E[13]+2850285829&4294967295,_=R+(x<<5&4294967295|x>>>27),x=D+(R^k&(_^R))+E[2]+4243563512&4294967295,D=_+(x<<9&4294967295|x>>>23),x=k+(_^R&(D^_))+E[7]+1735328473&4294967295,k=D+(x<<14&4294967295|x>>>18),x=R+(D^_&(k^D))+E[12]+2368359562&4294967295,R=k+(x<<20&4294967295|x>>>12),x=_+(R^k^D)+E[5]+4294588738&4294967295,_=R+(x<<4&4294967295|x>>>28),x=D+(_^R^k)+E[8]+2272392833&4294967295,D=_+(x<<11&4294967295|x>>>21),x=k+(D^_^R)+E[11]+1839030562&4294967295,k=D+(x<<16&4294967295|x>>>16),x=R+(k^D^_)+E[14]+4259657740&4294967295,R=k+(x<<23&4294967295|x>>>9),x=_+(R^k^D)+E[1]+2763975236&4294967295,_=R+(x<<4&4294967295|x>>>28),x=D+(_^R^k)+E[4]+1272893353&4294967295,D=_+(x<<11&4294967295|x>>>21),x=k+(D^_^R)+E[7]+4139469664&4294967295,k=D+(x<<16&4294967295|x>>>16),x=R+(k^D^_)+E[10]+3200236656&4294967295,R=k+(x<<23&4294967295|x>>>9),x=_+(R^k^D)+E[13]+681279174&4294967295,_=R+(x<<4&4294967295|x>>>28),x=D+(_^R^k)+E[0]+3936430074&4294967295,D=_+(x<<11&4294967295|x>>>21),x=k+(D^_^R)+E[3]+3572445317&4294967295,k=D+(x<<16&4294967295|x>>>16),x=R+(k^D^_)+E[6]+76029189&4294967295,R=k+(x<<23&4294967295|x>>>9),x=_+(R^k^D)+E[9]+3654602809&4294967295,_=R+(x<<4&4294967295|x>>>28),x=D+(_^R^k)+E[12]+3873151461&4294967295,D=_+(x<<11&4294967295|x>>>21),x=k+(D^_^R)+E[15]+530742520&4294967295,k=D+(x<<16&4294967295|x>>>16),x=R+(k^D^_)+E[2]+3299628645&4294967295,R=k+(x<<23&4294967295|x>>>9),x=_+(k^(R|~D))+E[0]+4096336452&4294967295,_=R+(x<<6&4294967295|x>>>26),x=D+(R^(_|~k))+E[7]+1126891415&4294967295,D=_+(x<<10&4294967295|x>>>22),x=k+(_^(D|~R))+E[14]+2878612391&4294967295,k=D+(x<<15&4294967295|x>>>17),x=R+(D^(k|~_))+E[5]+4237533241&4294967295,R=k+(x<<21&4294967295|x>>>11),x=_+(k^(R|~D))+E[12]+1700485571&4294967295,_=R+(x<<6&4294967295|x>>>26),x=D+(R^(_|~k))+E[3]+2399980690&4294967295,D=_+(x<<10&4294967295|x>>>22),x=k+(_^(D|~R))+E[10]+4293915773&4294967295,k=D+(x<<15&4294967295|x>>>17),x=R+(D^(k|~_))+E[1]+2240044497&4294967295,R=k+(x<<21&4294967295|x>>>11),x=_+(k^(R|~D))+E[8]+1873313359&4294967295,_=R+(x<<6&4294967295|x>>>26),x=D+(R^(_|~k))+E[15]+4264355552&4294967295,D=_+(x<<10&4294967295|x>>>22),x=k+(_^(D|~R))+E[6]+2734768916&4294967295,k=D+(x<<15&4294967295|x>>>17),x=R+(D^(k|~_))+E[13]+1309151649&4294967295,R=k+(x<<21&4294967295|x>>>11),x=_+(k^(R|~D))+E[4]+4149444226&4294967295,_=R+(x<<6&4294967295|x>>>26),x=D+(R^(_|~k))+E[11]+3174756917&4294967295,D=_+(x<<10&4294967295|x>>>22),x=k+(_^(D|~R))+E[2]+718787259&4294967295,k=D+(x<<15&4294967295|x>>>17),x=R+(D^(k|~_))+E[9]+3951481745&4294967295,A.g[0]=A.g[0]+_&4294967295,A.g[1]=A.g[1]+(k+(x<<21&4294967295|x>>>11))&4294967295,A.g[2]=A.g[2]+k&4294967295,A.g[3]=A.g[3]+D&4294967295}r.prototype.u=function(A,_){_===void 0&&(_=A.length);for(var R=_-this.blockSize,E=this.B,k=this.h,D=0;D<_;){if(k==0)for(;D<=R;)i(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<_;)if(E[k++]=A.charCodeAt(D++),k==this.blockSize){i(this,E),k=0;break}}else for(;D<_;)if(E[k++]=A[D++],k==this.blockSize){i(this,E),k=0;break}}this.h=k,this.o+=_},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var _=1;_<A.length-8;++_)A[_]=0;var R=8*this.o;for(_=A.length-8;_<A.length;++_)A[_]=R&255,R/=256;for(this.u(A),A=Array(16),_=R=0;4>_;++_)for(var E=0;32>E;E+=8)A[R++]=this.g[_]>>>E&255;return A};function s(A,_){var R=a;return Object.prototype.hasOwnProperty.call(R,A)?R[A]:R[A]=_(A)}function o(A,_){this.h=_;for(var R=[],E=!0,k=A.length-1;0<=k;k--){var D=A[k]|0;E&&D==_||(R[k]=D,E=!1)}this.g=R}var a={};function l(A){return-128<=A&&128>A?s(A,function(_){return new o([_|0],0>_?-1:0)}):new o([A|0],0>A?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return f;if(0>A)return N(u(-A));for(var _=[],R=1,E=0;A>=R;E++)_[E]=A/R|0,R*=4294967296;return new o(_,0)}function d(A,_){if(A.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(A.charAt(0)=="-")return N(d(A.substring(1),_));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=u(Math.pow(_,8)),E=f,k=0;k<A.length;k+=8){var D=Math.min(8,A.length-k),x=parseInt(A.substring(k,k+D),_);8>D?(D=u(Math.pow(_,D)),E=E.j(D).add(u(x))):(E=E.j(R),E=E.add(u(x)))}return E}var f=l(0),p=l(1),v=l(16777216);t=o.prototype,t.m=function(){if(P(this))return-N(this).m();for(var A=0,_=1,R=0;R<this.g.length;R++){var E=this.i(R);A+=(0<=E?E:4294967296+E)*_,_*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(S(this))return"0";if(P(this))return"-"+N(this).toString(A);for(var _=u(Math.pow(A,6)),R=this,E="";;){var k=M(R,_).g;R=T(R,k.j(_));var D=((0<R.g.length?R.g[0]:R.h)>>>0).toString(A);if(R=k,S(R))return D+E;for(;6>D.length;)D="0"+D;E=D+E}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function S(A){if(A.h!=0)return!1;for(var _=0;_<A.g.length;_++)if(A.g[_]!=0)return!1;return!0}function P(A){return A.h==-1}t.l=function(A){return A=T(this,A),P(A)?-1:S(A)?0:1};function N(A){for(var _=A.g.length,R=[],E=0;E<_;E++)R[E]=~A.g[E];return new o(R,~A.h).add(p)}t.abs=function(){return P(this)?N(this):this},t.add=function(A){for(var _=Math.max(this.g.length,A.g.length),R=[],E=0,k=0;k<=_;k++){var D=E+(this.i(k)&65535)+(A.i(k)&65535),x=(D>>>16)+(this.i(k)>>>16)+(A.i(k)>>>16);E=x>>>16,D&=65535,x&=65535,R[k]=x<<16|D}return new o(R,R[R.length-1]&-2147483648?-1:0)};function T(A,_){return A.add(N(_))}t.j=function(A){if(S(this)||S(A))return f;if(P(this))return P(A)?N(this).j(N(A)):N(N(this).j(A));if(P(A))return N(this.j(N(A)));if(0>this.l(v)&&0>A.l(v))return u(this.m()*A.m());for(var _=this.g.length+A.g.length,R=[],E=0;E<2*_;E++)R[E]=0;for(E=0;E<this.g.length;E++)for(var k=0;k<A.g.length;k++){var D=this.i(E)>>>16,x=this.i(E)&65535,Ct=A.i(k)>>>16,rn=A.i(k)&65535;R[2*E+2*k]+=x*rn,I(R,2*E+2*k),R[2*E+2*k+1]+=D*rn,I(R,2*E+2*k+1),R[2*E+2*k+1]+=x*Ct,I(R,2*E+2*k+1),R[2*E+2*k+2]+=D*Ct,I(R,2*E+2*k+2)}for(E=0;E<_;E++)R[E]=R[2*E+1]<<16|R[2*E];for(E=_;E<2*_;E++)R[E]=0;return new o(R,0)};function I(A,_){for(;(A[_]&65535)!=A[_];)A[_+1]+=A[_]>>>16,A[_]&=65535,_++}function b(A,_){this.g=A,this.h=_}function M(A,_){if(S(_))throw Error("division by zero");if(S(A))return new b(f,f);if(P(A))return _=M(N(A),_),new b(N(_.g),N(_.h));if(P(_))return _=M(A,N(_)),new b(N(_.g),_.h);if(30<A.g.length){if(P(A)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var R=p,E=_;0>=E.l(A);)R=$(R),E=$(E);var k=z(R,1),D=z(E,1);for(E=z(E,2),R=z(R,2);!S(E);){var x=D.add(E);0>=x.l(A)&&(k=k.add(R),D=x),E=z(E,1),R=z(R,1)}return _=T(A,k.j(_)),new b(k,_)}for(k=f;0<=A.l(_);){for(R=Math.max(1,Math.floor(A.m()/_.m())),E=Math.ceil(Math.log(R)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),D=u(R),x=D.j(_);P(x)||0<x.l(A);)R-=E,D=u(R),x=D.j(_);S(D)&&(D=p),k=k.add(D),A=T(A,x)}return new b(k,A)}t.A=function(A){return M(this,A).h},t.and=function(A){for(var _=Math.max(this.g.length,A.g.length),R=[],E=0;E<_;E++)R[E]=this.i(E)&A.i(E);return new o(R,this.h&A.h)},t.or=function(A){for(var _=Math.max(this.g.length,A.g.length),R=[],E=0;E<_;E++)R[E]=this.i(E)|A.i(E);return new o(R,this.h|A.h)},t.xor=function(A){for(var _=Math.max(this.g.length,A.g.length),R=[],E=0;E<_;E++)R[E]=this.i(E)^A.i(E);return new o(R,this.h^A.h)};function $(A){for(var _=A.g.length+1,R=[],E=0;E<_;E++)R[E]=A.i(E)<<1|A.i(E-1)>>>31;return new o(R,A.h)}function z(A,_){var R=_>>5;_%=32;for(var E=A.g.length-R,k=[],D=0;D<E;D++)k[D]=0<_?A.i(D+R)>>>_|A.i(D+R+1)<<32-_:A.i(D+R);return new o(k,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,OR=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,fs=o}).apply(typeof sE<"u"?sE:typeof self<"u"?self:typeof window<"u"?window:{});var lh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var LR,Tc,VR,Lh,hy,MR,FR,jR;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,h,m){return c==Array.prototype||c==Object.prototype||(c[h]=m.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof lh=="object"&&lh];for(var h=0;h<c.length;++h){var m=c[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function i(c,h){if(h)e:{var m=r;c=c.split(".");for(var y=0;y<c.length-1;y++){var O=c[y];if(!(O in m))break e;m=m[O]}c=c[c.length-1],y=m[c],h=h(y),h!=y&&h!=null&&e(m,c,{configurable:!0,writable:!0,value:h})}}function s(c,h){c instanceof String&&(c+="");var m=0,y=!1,O={next:function(){if(!y&&m<c.length){var F=m++;return{value:h(F,c[F]),done:!1}}return y=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}i("Array.prototype.values",function(c){return c||function(){return s(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var h=typeof c;return h=h!="object"?h:c?Array.isArray(c)?"array":h:"null",h=="array"||h=="object"&&typeof c.length=="number"}function u(c){var h=typeof c;return h=="object"&&c!=null||h=="function"}function d(c,h,m){return c.call.apply(c.bind,arguments)}function f(c,h,m){if(!c)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,y),c.apply(h,O)}}return function(){return c.apply(h,arguments)}}function p(c,h,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function v(c,h){var m=Array.prototype.slice.call(arguments,1);return function(){var y=m.slice();return y.push.apply(y,arguments),c.apply(this,y)}}function S(c,h){function m(){}m.prototype=h.prototype,c.aa=h.prototype,c.prototype=new m,c.prototype.constructor=c,c.Qb=function(y,O,F){for(var K=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)K[Ne-2]=arguments[Ne];return h.prototype[O].apply(y,K)}}function P(c){const h=c.length;if(0<h){const m=Array(h);for(let y=0;y<h;y++)m[y]=c[y];return m}return[]}function N(c,h){for(let m=1;m<arguments.length;m++){const y=arguments[m];if(l(y)){const O=c.length||0,F=y.length||0;c.length=O+F;for(let K=0;K<F;K++)c[O+K]=y[K]}else c.push(y)}}class T{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function I(c){return/^[\s\xa0]*$/.test(c)}function b(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function M(c){return M[" "](c),c}M[" "]=function(){};var $=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function z(c,h,m){for(const y in c)h.call(m,c[y],y,c)}function A(c,h){for(const m in c)h.call(void 0,c[m],m,c)}function _(c){const h={};for(const m in c)h[m]=c[m];return h}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(c,h){let m,y;for(let O=1;O<arguments.length;O++){y=arguments[O];for(m in y)c[m]=y[m];for(let F=0;F<R.length;F++)m=R[F],Object.prototype.hasOwnProperty.call(y,m)&&(c[m]=y[m])}}function k(c){var h=1;c=c.split(":");const m=[];for(;0<h&&c.length;)m.push(c.shift()),h--;return c.length&&m.push(c.join(":")),m}function D(c){a.setTimeout(()=>{throw c},0)}function x(){var c=ie;let h=null;return c.g&&(h=c.g,c.g=c.g.next,c.g||(c.h=null),h.next=null),h}class Ct{constructor(){this.h=this.g=null}add(h,m){const y=rn.get();y.set(h,m),this.h?this.h.next=y:this.g=y,this.h=y}}var rn=new T(()=>new Ds,c=>c.reset());class Ds{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Vn,Y=!1,ie=new Ct,ae=()=>{const c=a.Promise.resolve(void 0);Vn=()=>{c.then(Pe)}};var Pe=()=>{for(var c;c=x();){try{c.h.call(c.g)}catch(m){D(m)}var h=rn;h.j(c),100>h.h&&(h.h++,c.next=h.g,h.g=c)}Y=!1};function _e(){this.s=this.s,this.C=this.C}_e.prototype.s=!1,_e.prototype.ma=function(){this.s||(this.s=!0,this.N())},_e.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Oe(c,h){this.type=c,this.g=this.target=h,this.defaultPrevented=!1}Oe.prototype.h=function(){this.defaultPrevented=!0};var lt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,h=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const m=()=>{};a.addEventListener("test",m,h),a.removeEventListener("test",m,h)}catch{}return c}();function Tt(c,h){if(Oe.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var m=this.type=c.type,y=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=h,h=c.relatedTarget){if($){e:{try{M(h.nodeName);var O=!0;break e}catch{}O=!1}O||(h=null)}}else m=="mouseover"?h=c.fromElement:m=="mouseout"&&(h=c.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Mn[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Tt.aa.h.call(this)}}S(Tt,Oe);var Mn={2:"touch",3:"pen",4:"mouse"};Tt.prototype.h=function(){Tt.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Qt="closure_listenable_"+(1e6*Math.random()|0),pd=0;function Yp(c,h,m,y,O){this.listener=c,this.proxy=null,this.src=h,this.type=m,this.capture=!!y,this.ha=O,this.key=++pd,this.da=this.fa=!1}function Fr(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function jr(c){this.src=c,this.g={},this.h=0}jr.prototype.add=function(c,h,m,y,O){var F=c.toString();c=this.g[F],c||(c=this.g[F]=[],this.h++);var K=Ei(c,h,y,O);return-1<K?(h=c[K],m||(h.fa=!1)):(h=new Yp(h,this.src,F,!!y,O),h.fa=m,c.push(h)),h};function Qn(c,h){var m=h.type;if(m in c.g){var y=c.g[m],O=Array.prototype.indexOf.call(y,h,void 0),F;(F=0<=O)&&Array.prototype.splice.call(y,O,1),F&&(Fr(h),c.g[m].length==0&&(delete c.g[m],c.h--))}}function Ei(c,h,m,y){for(var O=0;O<c.length;++O){var F=c[O];if(!F.da&&F.listener==h&&F.capture==!!m&&F.ha==y)return O}return-1}var Yo="closure_lm_"+(1e6*Math.random()|0),Ur={};function Ti(c,h,m,y,O){if(y&&y.once)return Ul(c,h,m,y,O);if(Array.isArray(h)){for(var F=0;F<h.length;F++)Ti(c,h[F],m,y,O);return null}return m=Yt(m),c&&c[Qt]?c.K(h,m,u(y)?!!y.capture:!!y,O):fr(c,h,m,!1,y,O)}function fr(c,h,m,y,O,F){if(!h)throw Error("Invalid event type");var K=u(O)?!!O.capture:!!O,Ne=vn(c);if(Ne||(c[Yo]=Ne=new jr(c)),m=Ne.add(h,m,y,K,F),m.proxy)return m;if(y=Ai(),m.proxy=y,y.src=c,y.listener=m,c.addEventListener)lt||(O=K),O===void 0&&(O=!1),c.addEventListener(h.toString(),y,O);else if(c.attachEvent)c.attachEvent(gd(h.toString()),y);else if(c.addListener&&c.removeListener)c.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Ai(){function c(m){return h.call(c.src,c.listener,m)}const h=Os;return c}function Ul(c,h,m,y,O){if(Array.isArray(h)){for(var F=0;F<h.length;F++)Ul(c,h[F],m,y,O);return null}return m=Yt(m),c&&c[Qt]?c.L(h,m,u(y)?!!y.capture:!!y,O):fr(c,h,m,!0,y,O)}function md(c,h,m,y,O){if(Array.isArray(h))for(var F=0;F<h.length;F++)md(c,h[F],m,y,O);else y=u(y)?!!y.capture:!!y,m=Yt(m),c&&c[Qt]?(c=c.i,h=String(h).toString(),h in c.g&&(F=c.g[h],m=Ei(F,m,y,O),-1<m&&(Fr(F[m]),Array.prototype.splice.call(F,m,1),F.length==0&&(delete c.g[h],c.h--)))):c&&(c=vn(c))&&(h=c.g[h.toString()],c=-1,h&&(c=Ei(h,m,y,O)),(m=-1<c?h[c]:null)&&bi(m))}function bi(c){if(typeof c!="number"&&c&&!c.da){var h=c.src;if(h&&h[Qt])Qn(h.i,c);else{var m=c.type,y=c.proxy;h.removeEventListener?h.removeEventListener(m,y,c.capture):h.detachEvent?h.detachEvent(gd(m),y):h.addListener&&h.removeListener&&h.removeListener(y),(m=vn(h))?(Qn(m,c),m.h==0&&(m.src=null,h[Yo]=null)):Fr(c)}}}function gd(c){return c in Ur?Ur[c]:Ur[c]="on"+c}function Os(c,h){if(c.da)c=!0;else{h=new Tt(h,this);var m=c.listener,y=c.ha||c.src;c.fa&&bi(c),c=m.call(y,h)}return c}function vn(c){return c=c[Yo],c instanceof jr?c:null}var Br="__closure_events_fn_"+(1e9*Math.random()>>>0);function Yt(c){return typeof c=="function"?c:(c[Br]||(c[Br]=function(h){return c.handleEvent(h)}),c[Br])}function ct(){_e.call(this),this.i=new jr(this),this.M=this,this.F=null}S(ct,_e),ct.prototype[Qt]=!0,ct.prototype.removeEventListener=function(c,h,m,y){md(this,c,h,m,y)};function mt(c,h){var m,y=c.F;if(y)for(m=[];y;y=y.F)m.push(y);if(c=c.M,y=h.type||h,typeof h=="string")h=new Oe(h,c);else if(h instanceof Oe)h.target=h.target||c;else{var O=h;h=new Oe(y,c),E(h,O)}if(O=!0,m)for(var F=m.length-1;0<=F;F--){var K=h.g=m[F];O=Ri(K,y,!0,h)&&O}if(K=h.g=c,O=Ri(K,y,!0,h)&&O,O=Ri(K,y,!1,h)&&O,m)for(F=0;F<m.length;F++)K=h.g=m[F],O=Ri(K,y,!1,h)&&O}ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var c=this.i,h;for(h in c.g){for(var m=c.g[h],y=0;y<m.length;y++)Fr(m[y]);delete c.g[h],c.h--}}this.F=null},ct.prototype.K=function(c,h,m,y){return this.i.add(String(c),h,!1,m,y)},ct.prototype.L=function(c,h,m,y){return this.i.add(String(c),h,!0,m,y)};function Ri(c,h,m,y){if(h=c.i.g[String(h)],!h)return!0;h=h.concat();for(var O=!0,F=0;F<h.length;++F){var K=h[F];if(K&&!K.da&&K.capture==m){var Ne=K.listener,Nt=K.ha||K.src;K.fa&&Qn(c.i,K),O=Ne.call(Nt,y)!==!1&&O}}return O&&!y.defaultPrevented}function pr(c,h,m){if(typeof c=="function")m&&(c=p(c,m));else if(c&&typeof c.handleEvent=="function")c=p(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(c,h||0)}function Jo(c){c.g=pr(()=>{c.g=null,c.i&&(c.i=!1,Jo(c))},c.l);const h=c.h;c.h=null,c.m.apply(null,h)}class yd extends _e{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Jo(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Si(c){_e.call(this),this.h=c,this.g={}}S(Si,_e);var Bl=[];function $l(c){z(c.g,function(h,m){this.g.hasOwnProperty(m)&&bi(h)},c),c.g={}}Si.prototype.N=function(){Si.aa.N.call(this),$l(this)},Si.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xi=a.JSON.stringify,zl=a.JSON.parse,ql=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function mr(){}mr.prototype.h=null;function gt(c){return c.h||(c.h=c.i())}function Xo(){}var Pi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ls(){Oe.call(this,"d")}S(Ls,Oe);function _d(){Oe.call(this,"c")}S(_d,Oe);var Yn={},sn=null;function ki(){return sn=sn||new ct}Yn.La="serverreachability";function Hl(c){Oe.call(this,Yn.La,c)}S(Hl,Oe);function Fn(c){const h=ki();mt(h,new Hl(h))}Yn.STAT_EVENT="statevent";function vd(c,h){Oe.call(this,Yn.STAT_EVENT,c),this.stat=h}S(vd,Oe);function yt(c){const h=ki();mt(h,new vd(h,c))}Yn.Ma="timingevent";function $r(c,h){Oe.call(this,Yn.Ma,c),this.size=h}S($r,Oe);function gr(c,h){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},h)}function yr(){this.g=!0}yr.prototype.xa=function(){this.g=!1};function zr(c,h,m,y,O,F){c.info(function(){if(c.g)if(F)for(var K="",Ne=F.split("&"),Nt=0;Nt<Ne.length;Nt++){var Ie=Ne[Nt].split("=");if(1<Ie.length){var Ft=Ie[0];Ie=Ie[1];var jt=Ft.split("_");K=2<=jt.length&&jt[1]=="type"?K+(Ft+"="+Ie+"&"):K+(Ft+"=redacted&")}}else K=null;else K=F;return"XMLHTTP REQ ("+y+") [attempt "+O+"]: "+h+`
`+m+`
`+K})}function wd(c,h,m,y,O,F,K){c.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+O+"]: "+h+`
`+m+`
`+F+" "+K})}function _r(c,h,m,y){c.info(function(){return"XMLHTTP TEXT ("+h+"): "+Jp(c,m)+(y?" "+y:"")})}function Jn(c,h){c.info(function(){return"TIMEOUT: "+h})}yr.prototype.info=function(){};function Jp(c,h){if(!c.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(c=0;c<m.length;c++)if(Array.isArray(m[c])){var y=m[c];if(!(2>y.length)){var O=y[1];if(Array.isArray(O)&&!(1>O.length)){var F=O[0];if(F!="noop"&&F!="stop"&&F!="close")for(var K=1;K<O.length;K++)O[K]=""}}}}return xi(m)}catch{return h}}var Zo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Gl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ea;function ta(){}S(ta,mr),ta.prototype.g=function(){return new XMLHttpRequest},ta.prototype.i=function(){return{}},ea=new ta;function vr(c,h,m,y){this.j=c,this.i=h,this.l=m,this.R=y||1,this.U=new Si(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Id}function Id(){this.i=null,this.g="",this.h=!1}var Wl={},na={};function ra(c,h,m){c.L=1,c.v=aa(Xn(h)),c.m=m,c.P=!0,Ed(c,null)}function Ed(c,h){c.F=Date.now(),Vs(c),c.A=Xn(c.v);var m=c.A,y=c.R;Array.isArray(y)||(y=[String(y)]),w(m.i,"t",y),c.C=0,m=c.j.J,c.h=new Id,c.g=Fw(c.j,m?h:null,!c.m),0<c.O&&(c.M=new yd(p(c.Y,c,c.g),c.O)),h=c.U,m=c.g,y=c.ca;var O="readystatechange";Array.isArray(O)||(O&&(Bl[0]=O.toString()),O=Bl);for(var F=0;F<O.length;F++){var K=Ti(m,O[F],y||h.handleEvent,!1,h.h||h);if(!K)break;h.g[K.key]=K}h=c.H?_(c.H):{},c.m?(c.u||(c.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,h)):(c.u="GET",c.g.ea(c.A,c.u,null,h)),Fn(),zr(c.i,c.u,c.A,c.l,c.R,c.m)}vr.prototype.ca=function(c){c=c.target;const h=this.M;h&&Hr(c)==3?h.j():this.Y(c)},vr.prototype.Y=function(c){try{if(c==this.g)e:{const jt=Hr(this.g);var h=this.g.Ba();const ca=this.g.Z();if(!(3>jt)&&(jt!=3||this.g&&(this.h.h||this.g.oa()||Sw(this.g)))){this.J||jt!=4||h==7||(h==8||0>=ca?Fn(3):Fn(2)),ia(this);var m=this.g.Z();this.X=m;t:if(Kl(this)){var y=Sw(this.g);c="";var O=y.length,F=Hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wr(this),Ci(this);var K="";break t}this.h.i=new a.TextDecoder}for(h=0;h<O;h++)this.h.h=!0,c+=this.h.i.decode(y[h],{stream:!(F&&h==O-1)});y.length=0,this.h.g+=c,this.C=0,K=this.h.g}else K=this.g.oa();if(this.o=m==200,wd(this.i,this.u,this.A,this.l,this.R,jt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var Ne,Nt=this.g;if((Ne=Nt.g?Nt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(Ne)){var Ie=Ne;break t}}Ie=null}if(m=Ie)_r(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,sa(this,m);else{this.o=!1,this.s=3,yt(12),wr(this),Ci(this);break e}}if(this.P){m=!0;let er;for(;!this.J&&this.C<K.length;)if(er=Td(this,K),er==na){jt==4&&(this.s=4,yt(14),m=!1),_r(this.i,this.l,null,"[Incomplete Response]");break}else if(er==Wl){this.s=4,yt(15),_r(this.i,this.l,K,"[Invalid Chunk]"),m=!1;break}else _r(this.i,this.l,er,null),sa(this,er);if(Kl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),jt!=4||K.length!=0||this.h.h||(this.s=1,yt(16),m=!1),this.o=this.o&&m,!m)_r(this.i,this.l,K,"[Invalid Chunked Response]"),wr(this),Ci(this);else if(0<K.length&&!this.W){this.W=!0;var Ft=this.j;Ft.g==this&&Ft.ba&&!Ft.M&&(Ft.j.info("Great, no buffering proxy detected. Bytes received: "+K.length),om(Ft),Ft.M=!0,yt(11))}}else _r(this.i,this.l,K,null),sa(this,K);jt==4&&wr(this),this.o&&!this.J&&(jt==4?Ow(this.j,this):(this.o=!1,Vs(this)))}else zP(this.g),m==400&&0<K.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),wr(this),Ci(this)}}}catch{}finally{}};function Kl(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Td(c,h){var m=c.C,y=h.indexOf(`
`,m);return y==-1?na:(m=Number(h.substring(m,y)),isNaN(m)?Wl:(y+=1,y+m>h.length?na:(h=h.slice(y,y+m),c.C=y+m,h)))}vr.prototype.cancel=function(){this.J=!0,wr(this)};function Vs(c){c.S=Date.now()+c.I,Ql(c,c.I)}function Ql(c,h){if(c.B!=null)throw Error("WatchDog timer not null");c.B=gr(p(c.ba,c),h)}function ia(c){c.B&&(a.clearTimeout(c.B),c.B=null)}vr.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Jn(this.i,this.A),this.L!=2&&(Fn(),yt(17)),wr(this),this.s=2,Ci(this)):Ql(this,this.S-c)};function Ci(c){c.j.G==0||c.J||Ow(c.j,c)}function wr(c){ia(c);var h=c.M;h&&typeof h.ma=="function"&&h.ma(),c.M=null,$l(c.U),c.g&&(h=c.g,c.g=null,h.abort(),h.ma())}function sa(c,h){try{var m=c.j;if(m.G!=0&&(m.g==c||Yl(m.h,c))){if(!c.K&&Yl(m.h,c)&&m.G==3){try{var y=m.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var O=y;if(O[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<c.F)Fd(m),Vd(m);else break e;sm(m),yt(18)}}else m.za=O[1],0<m.za-m.T&&37500>O[2]&&m.F&&m.v==0&&!m.C&&(m.C=gr(p(m.Za,m),6e3));if(1>=Sd(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else zs(m,11)}else if((c.K||m.g==c)&&Fd(m),!I(h))for(O=m.Da.g.parse(h),h=0;h<O.length;h++){let Ie=O[h];if(m.T=Ie[0],Ie=Ie[1],m.G==2)if(Ie[0]=="c"){m.K=Ie[1],m.ia=Ie[2];const Ft=Ie[3];Ft!=null&&(m.la=Ft,m.j.info("VER="+m.la));const jt=Ie[4];jt!=null&&(m.Aa=jt,m.j.info("SVER="+m.Aa));const ca=Ie[5];ca!=null&&typeof ca=="number"&&0<ca&&(y=1.5*ca,m.L=y,m.j.info("backChannelRequestTimeoutMs_="+y)),y=m;const er=c.g;if(er){const Ud=er.g?er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ud){var F=y.h;F.g||Ud.indexOf("spdy")==-1&&Ud.indexOf("quic")==-1&&Ud.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Ms(F,F.h),F.h=null))}if(y.D){const am=er.g?er.g.getResponseHeader("X-HTTP-Session-Id"):null;am&&(y.ya=am,ke(y.I,y.D,am))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-c.F,m.j.info("Handshake RTT: "+m.R+"ms")),y=m;var K=c;if(y.qa=Mw(y,y.J?y.ia:null,y.W),K.K){xd(y.h,K);var Ne=K,Nt=y.L;Nt&&(Ne.I=Nt),Ne.B&&(ia(Ne),Vs(Ne)),y.g=K}else Nw(y);0<m.i.length&&Md(m)}else Ie[0]!="stop"&&Ie[0]!="close"||zs(m,7);else m.G==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?zs(m,7):im(m):Ie[0]!="noop"&&m.l&&m.l.ta(Ie),m.v=0)}}Fn(4)}catch{}}var Ad=class{constructor(c,h){this.g=c,this.map=h}};function bd(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Rd(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Sd(c){return c.h?1:c.g?c.g.size:0}function Yl(c,h){return c.h?c.h==h:c.g?c.g.has(h):!1}function Ms(c,h){c.g?c.g.add(h):c.h=h}function xd(c,h){c.h&&c.h==h?c.h=null:c.g&&c.g.has(h)&&c.g.delete(h)}bd.prototype.cancel=function(){if(this.i=Pd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Pd(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let h=c.i;for(const m of c.g.values())h=h.concat(m.D);return h}return P(c.i)}function kd(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var h=[],m=c.length,y=0;y<m;y++)h.push(c[y]);return h}h=[],m=0;for(y in c)h[m++]=c[y];return h}function Cd(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var h=[];c=c.length;for(var m=0;m<c;m++)h.push(m);return h}h=[],m=0;for(const y in c)h[m++]=y;return h}}}function Nd(c,h){if(c.forEach&&typeof c.forEach=="function")c.forEach(h,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,h,void 0);else for(var m=Cd(c),y=kd(c),O=y.length,F=0;F<O;F++)h.call(void 0,y[F],m&&m[F],c)}var Fs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Xp(c,h){if(c){c=c.split("&");for(var m=0;m<c.length;m++){var y=c[m].indexOf("="),O=null;if(0<=y){var F=c[m].substring(0,y);O=c[m].substring(y+1)}else F=c[m];h(F,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Ir(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Ir){this.h=c.h,js(this,c.j),this.o=c.o,this.g=c.g,oa(this,c.s),this.l=c.l;var h=c.i,m=new $s;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),Dd(this,m),this.m=c.m}else c&&(h=String(c).match(Fs))?(this.h=!1,js(this,h[1]||"",!0),this.o=Us(h[2]||""),this.g=Us(h[3]||"",!0),oa(this,h[4]),this.l=Us(h[5]||"",!0),Dd(this,h[6]||"",!0),this.m=Us(h[7]||"")):(this.h=!1,this.i=new $s(null,this.h))}Ir.prototype.toString=function(){var c=[],h=this.j;h&&c.push(Bs(h,Od,!0),":");var m=this.g;return(m||h=="file")&&(c.push("//"),(h=this.o)&&c.push(Bs(h,Od,!0),"@"),c.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&c.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&c.push("/"),c.push(Bs(m,m.charAt(0)=="/"?tm:em,!0))),(m=this.i.toString())&&c.push("?",m),(m=this.m)&&c.push("#",Bs(m,Te)),c.join("")};function Xn(c){return new Ir(c)}function js(c,h,m){c.j=m?Us(h,!0):h,c.j&&(c.j=c.j.replace(/:$/,""))}function oa(c,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);c.s=h}else c.s=null}function Dd(c,h,m){h instanceof $s?(c.i=h,U(c.i,c.h)):(m||(h=Bs(h,nm)),c.i=new $s(h,c.h))}function ke(c,h,m){c.i.set(h,m)}function aa(c){return ke(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Us(c,h){return c?h?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Bs(c,h,m){return typeof c=="string"?(c=encodeURI(c).replace(h,Zp),m&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Zp(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Od=/[#\/\?@]/g,em=/[#\?:]/g,tm=/[#\?]/g,nm=/[#\?@]/g,Te=/#/g;function $s(c,h){this.h=this.g=null,this.i=c||null,this.j=!!h}function Zn(c){c.g||(c.g=new Map,c.h=0,c.i&&Xp(c.i,function(h,m){c.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=$s.prototype,t.add=function(c,h){Zn(this),this.i=null,c=C(this,c);var m=this.g.get(c);return m||this.g.set(c,m=[]),m.push(h),this.h+=1,this};function Jl(c,h){Zn(c),h=C(c,h),c.g.has(h)&&(c.i=null,c.h-=c.g.get(h).length,c.g.delete(h))}function Xl(c,h){return Zn(c),h=C(c,h),c.g.has(h)}t.forEach=function(c,h){Zn(this),this.g.forEach(function(m,y){m.forEach(function(O){c.call(h,O,y,this)},this)},this)},t.na=function(){Zn(this);const c=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let y=0;y<h.length;y++){const O=c[y];for(let F=0;F<O.length;F++)m.push(h[y])}return m},t.V=function(c){Zn(this);let h=[];if(typeof c=="string")Xl(this,c)&&(h=h.concat(this.g.get(C(this,c))));else{c=Array.from(this.g.values());for(let m=0;m<c.length;m++)h=h.concat(c[m])}return h},t.set=function(c,h){return Zn(this),this.i=null,c=C(this,c),Xl(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[h]),this.h+=1,this},t.get=function(c,h){return c?(c=this.V(c),0<c.length?String(c[0]):h):h};function w(c,h,m){Jl(c,h),0<m.length&&(c.i=null,c.g.set(C(c,h),P(m)),c.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var y=h[m];const F=encodeURIComponent(String(y)),K=this.V(y);for(y=0;y<K.length;y++){var O=F;K[y]!==""&&(O+="="+encodeURIComponent(String(K[y]))),c.push(O)}}return this.i=c.join("&")};function C(c,h){return h=String(h),c.j&&(h=h.toLowerCase()),h}function U(c,h){h&&!c.j&&(Zn(c),c.i=null,c.g.forEach(function(m,y){var O=y.toLowerCase();y!=O&&(Jl(this,y),w(this,O,m))},c)),c.j=h}function Q(c,h){const m=new yr;if(a.Image){const y=new Image;y.onload=v(se,m,"TestLoadImage: loaded",!0,h,y),y.onerror=v(se,m,"TestLoadImage: error",!1,h,y),y.onabort=v(se,m,"TestLoadImage: abort",!1,h,y),y.ontimeout=v(se,m,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=c}else h(!1)}function X(c,h){const m=new yr,y=new AbortController,O=setTimeout(()=>{y.abort(),se(m,"TestPingServer: timeout",!1,h)},1e4);fetch(c,{signal:y.signal}).then(F=>{clearTimeout(O),F.ok?se(m,"TestPingServer: ok",!0,h):se(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(O),se(m,"TestPingServer: error",!1,h)})}function se(c,h,m,y,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),y(m)}catch{}}function Ee(){this.g=new ql}function ve(c,h,m){const y=m||"";try{Nd(c,function(O,F){let K=O;u(O)&&(K=xi(O)),h.push(y+F+"="+encodeURIComponent(K))})}catch(O){throw h.push(y+"type="+encodeURIComponent("_badmap")),O}}function le(c){this.l=c.Ub||null,this.j=c.eb||!1}S(le,mr),le.prototype.g=function(){return new Ce(this.l,this.j)},le.prototype.i=function(c){return function(){return c}}({});function Ce(c,h){ct.call(this),this.D=c,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Ce,ct),t=Ce.prototype,t.open=function(c,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=h,this.readyState=1,ut(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(h.body=c),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ze(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ut(this)),this.g&&(this.readyState=3,ut(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Me(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Me(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var h=c.value?c.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!c.done}))&&(this.response=this.responseText+=h)}c.done?Ze(this):ut(this),this.readyState==3&&Me(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Ze(this))},t.Qa=function(c){this.g&&(this.response=c,Ze(this))},t.ga=function(){this.g&&Ze(this)};function Ze(c){c.readyState=4,c.l=null,c.j=null,c.v=null,ut(c)}t.setRequestHeader=function(c,h){this.u.append(c,h)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,c.push(m[0]+": "+m[1]),m=h.next();return c.join(`\r
`)};function ut(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Ce.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Ni(c){let h="";return z(c,function(m,y){h+=y,h+=":",h+=m,h+=`\r
`}),h}function qr(c,h,m){e:{for(y in m){var y=!1;break e}y=!0}y||(m=Ni(m),typeof c=="string"?m!=null&&encodeURIComponent(String(m)):ke(c,h,m))}function Fe(c){ct.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Fe,ct);var rm=/^https?$/i,$P=["POST","PUT"];t=Fe.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,h,m,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);h=h?h.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ea.g(),this.v=this.o?gt(this.o):gt(ea),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(h,String(c),!0),this.B=!1}catch(F){Tw(this,F);return}if(c=m||"",m=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var O in y)m.set(O,y[O]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const F of y.keys())m.set(F,y.get(F));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(m.keys()).find(F=>F.toLowerCase()=="content-type"),O=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call($P,h,void 0))||y||O||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,K]of m)this.g.setRequestHeader(F,K);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Rw(this),this.u=!0,this.g.send(c),this.u=!1}catch(F){Tw(this,F)}};function Tw(c,h){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=h,c.m=5,Aw(c),Ld(c)}function Aw(c){c.A||(c.A=!0,mt(c,"complete"),mt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,mt(this,"complete"),mt(this,"abort"),Ld(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ld(this,!0)),Fe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?bw(this):this.bb())},t.bb=function(){bw(this)};function bw(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Hr(c)!=4||c.Z()!=2)){if(c.u&&Hr(c)==4)pr(c.Ea,0,c);else if(mt(c,"readystatechange"),Hr(c)==4){c.h=!1;try{const K=c.Z();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var y;if(y=K===0){var O=String(c.D).match(Fs)[1]||null;!O&&a.self&&a.self.location&&(O=a.self.location.protocol.slice(0,-1)),y=!rm.test(O?O.toLowerCase():"")}m=y}if(m)mt(c,"complete"),mt(c,"success");else{c.m=6;try{var F=2<Hr(c)?c.g.statusText:""}catch{F=""}c.l=F+" ["+c.Z()+"]",Aw(c)}}finally{Ld(c)}}}}function Ld(c,h){if(c.g){Rw(c);const m=c.g,y=c.v[0]?()=>{}:null;c.g=null,c.v=null,h||mt(c,"ready");try{m.onreadystatechange=y}catch{}}}function Rw(c){c.I&&(a.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function Hr(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<Hr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var h=this.g.responseText;return c&&h.indexOf(c)==0&&(h=h.substring(c.length)),zl(h)}};function Sw(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function zP(c){const h={};c=(c.g&&2<=Hr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<c.length;y++){if(I(c[y]))continue;var m=k(c[y]);const O=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const F=h[O]||[];h[O]=F,F.push(m)}A(h,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zl(c,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[c]||h}function xw(c){this.Aa=0,this.i=[],this.j=new yr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zl("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zl("baseRetryDelayMs",5e3,c),this.cb=Zl("retryDelaySeedMs",1e4,c),this.Wa=Zl("forwardChannelMaxRetries",2,c),this.wa=Zl("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new bd(c&&c.concurrentRequestLimit),this.Da=new Ee,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=xw.prototype,t.la=8,t.G=1,t.connect=function(c,h,m,y){yt(0),this.W=c,this.H=h||{},m&&y!==void 0&&(this.H.OSID=m,this.H.OAID=y),this.F=this.X,this.I=Mw(this,null,this.W),Md(this)};function im(c){if(Pw(c),c.G==3){var h=c.U++,m=Xn(c.I);if(ke(m,"SID",c.K),ke(m,"RID",h),ke(m,"TYPE","terminate"),ec(c,m),h=new vr(c,c.j,h),h.L=2,h.v=aa(Xn(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=h.v,m=!0),m||(h.g=Fw(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Vs(h)}Vw(c)}function Vd(c){c.g&&(om(c),c.g.cancel(),c.g=null)}function Pw(c){Vd(c),c.u&&(a.clearTimeout(c.u),c.u=null),Fd(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function Md(c){if(!Rd(c.h)&&!c.s){c.s=!0;var h=c.Ga;Vn||ae(),Y||(Vn(),Y=!0),ie.add(h,c),c.B=0}}function qP(c,h){return Sd(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=h.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=gr(p(c.Ga,c,h),Lw(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const O=new vr(this,this.j,c);let F=this.o;if(this.S&&(F?(F=_(F),E(F,this.S)):F=this.S),this.m!==null||this.O||(O.H=F,F=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var y=this.i[m];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Cw(this,O,h),m=Xn(this.I),ke(m,"RID",c),ke(m,"CVER",22),this.D&&ke(m,"X-HTTP-Session-Id",this.D),ec(this,m),F&&(this.O?h="headers="+encodeURIComponent(String(Ni(F)))+"&"+h:this.m&&qr(m,this.m,F)),Ms(this.h,O),this.Ua&&ke(m,"TYPE","init"),this.P?(ke(m,"$req",h),ke(m,"SID","null"),O.T=!0,ra(O,m,null)):ra(O,m,h),this.G=2}}else this.G==3&&(c?kw(this,c):this.i.length==0||Rd(this.h)||kw(this))};function kw(c,h){var m;h?m=h.l:m=c.U++;const y=Xn(c.I);ke(y,"SID",c.K),ke(y,"RID",m),ke(y,"AID",c.T),ec(c,y),c.m&&c.o&&qr(y,c.m,c.o),m=new vr(c,c.j,m,c.B+1),c.m===null&&(m.H=c.o),h&&(c.i=h.D.concat(c.i)),h=Cw(c,m,1e3),m.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Ms(c.h,m),ra(m,y,h)}function ec(c,h){c.H&&z(c.H,function(m,y){ke(h,y,m)}),c.l&&Nd({},function(m,y){ke(h,y,m)})}function Cw(c,h,m){m=Math.min(c.i.length,m);var y=c.l?p(c.l.Na,c.l,c):null;e:{var O=c.i;let F=-1;for(;;){const K=["count="+m];F==-1?0<m?(F=O[0].g,K.push("ofs="+F)):F=0:K.push("ofs="+F);let Ne=!0;for(let Nt=0;Nt<m;Nt++){let Ie=O[Nt].g;const Ft=O[Nt].map;if(Ie-=F,0>Ie)F=Math.max(0,O[Nt].g-100),Ne=!1;else try{ve(Ft,K,"req"+Ie+"_")}catch{y&&y(Ft)}}if(Ne){y=K.join("&");break e}}}return c=c.i.splice(0,m),h.D=c,y}function Nw(c){if(!c.g&&!c.u){c.Y=1;var h=c.Fa;Vn||ae(),Y||(Vn(),Y=!0),ie.add(h,c),c.v=0}}function sm(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=gr(p(c.Fa,c),Lw(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,Dw(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=gr(p(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),Vd(this),Dw(this))};function om(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function Dw(c){c.g=new vr(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var h=Xn(c.qa);ke(h,"RID","rpc"),ke(h,"SID",c.K),ke(h,"AID",c.T),ke(h,"CI",c.F?"0":"1"),!c.F&&c.ja&&ke(h,"TO",c.ja),ke(h,"TYPE","xmlhttp"),ec(c,h),c.m&&c.o&&qr(h,c.m,c.o),c.L&&(c.g.I=c.L);var m=c.g;c=c.ia,m.L=1,m.v=aa(Xn(h)),m.m=null,m.P=!0,Ed(m,c)}t.Za=function(){this.C!=null&&(this.C=null,Vd(this),sm(this),yt(19))};function Fd(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Ow(c,h){var m=null;if(c.g==h){Fd(c),om(c),c.g=null;var y=2}else if(Yl(c.h,h))m=h.D,xd(c.h,h),y=1;else return;if(c.G!=0){if(h.o)if(y==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var O=c.B;y=ki(),mt(y,new $r(y,m)),Md(c)}else Nw(c);else if(O=h.s,O==3||O==0&&0<h.X||!(y==1&&qP(c,h)||y==2&&sm(c)))switch(m&&0<m.length&&(h=c.h,h.i=h.i.concat(m)),O){case 1:zs(c,5);break;case 4:zs(c,10);break;case 3:zs(c,6);break;default:zs(c,2)}}}function Lw(c,h){let m=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(m*=2),m*h}function zs(c,h){if(c.j.info("Error code "+h),h==2){var m=p(c.fb,c),y=c.Xa;const O=!y;y=new Ir(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||js(y,"https"),aa(y),O?Q(y.toString(),m):X(y.toString(),m)}else yt(2);c.G=0,c.l&&c.l.sa(h),Vw(c),Pw(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function Vw(c){if(c.G=0,c.ka=[],c.l){const h=Pd(c.h);(h.length!=0||c.i.length!=0)&&(N(c.ka,h),N(c.ka,c.i),c.h.i.length=0,P(c.i),c.i.length=0),c.l.ra()}}function Mw(c,h,m){var y=m instanceof Ir?Xn(m):new Ir(m);if(y.g!="")h&&(y.g=h+"."+y.g),oa(y,y.s);else{var O=a.location;y=O.protocol,h=h?h+"."+O.hostname:O.hostname,O=+O.port;var F=new Ir(null);y&&js(F,y),h&&(F.g=h),O&&oa(F,O),m&&(F.l=m),y=F}return m=c.D,h=c.ya,m&&h&&ke(y,m,h),ke(y,"VER",c.la),ec(c,y),y}function Fw(c,h,m){if(h&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=c.Ca&&!c.pa?new Fe(new le({eb:m})):new Fe(c.pa),h.Ha(c.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function jw(){}t=jw.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function jd(){}jd.prototype.g=function(c,h){return new wn(c,h)};function wn(c,h){ct.call(this),this.g=new xw(h),this.l=c,this.h=h&&h.messageUrlParams||null,c=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(c?c["X-WebChannel-Content-Type"]=h.messageContentType:c={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(c?c["X-WebChannel-Client-Profile"]=h.va:c={"X-WebChannel-Client-Profile":h.va}),this.g.S=c,(c=h&&h.Sb)&&!I(c)&&(this.g.m=c),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!I(h)&&(this.g.D=h,c=this.h,c!==null&&h in c&&(c=this.h,h in c&&delete c[h])),this.j=new la(this)}S(wn,ct),wn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){im(this.g)},wn.prototype.o=function(c){var h=this.g;if(typeof c=="string"){var m={};m.__data__=c,c=m}else this.u&&(m={},m.__data__=xi(c),c=m);h.i.push(new Ad(h.Ya++,c)),h.G==3&&Md(h)},wn.prototype.N=function(){this.g.l=null,delete this.j,im(this.g),delete this.g,wn.aa.N.call(this)};function Uw(c){Ls.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var h=c.__sm__;if(h){e:{for(const m in h){c=m;break e}c=void 0}(this.i=c)&&(c=this.i,h=h!==null&&c in h?h[c]:void 0),this.data=h}else this.data=c}S(Uw,Ls);function Bw(){_d.call(this),this.status=1}S(Bw,_d);function la(c){this.g=c}S(la,jw),la.prototype.ua=function(){mt(this.g,"a")},la.prototype.ta=function(c){mt(this.g,new Uw(c))},la.prototype.sa=function(c){mt(this.g,new Bw)},la.prototype.ra=function(){mt(this.g,"b")},jd.prototype.createWebChannel=jd.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,jR=function(){return new jd},FR=function(){return ki()},MR=Yn,hy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zo.NO_ERROR=0,Zo.TIMEOUT=8,Zo.HTTP_ERROR=6,Lh=Zo,Gl.COMPLETE="complete",VR=Gl,Xo.EventType=Pi,Pi.OPEN="a",Pi.CLOSE="b",Pi.ERROR="c",Pi.MESSAGE="d",ct.prototype.listen=ct.prototype.K,Tc=Xo,Fe.prototype.listenOnce=Fe.prototype.L,Fe.prototype.getLastError=Fe.prototype.Ka,Fe.prototype.getLastErrorCode=Fe.prototype.Ba,Fe.prototype.getStatus=Fe.prototype.Z,Fe.prototype.getResponseJson=Fe.prototype.Oa,Fe.prototype.getResponseText=Fe.prototype.oa,Fe.prototype.send=Fe.prototype.ea,Fe.prototype.setWithCredentials=Fe.prototype.Ha,LR=Fe}).apply(typeof lh<"u"?lh:typeof self<"u"?self:typeof window<"u"?window:{});const oE="@firebase/firestore",aE="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Rt.UNAUTHENTICATED=new Rt(null),Rt.GOOGLE_CREDENTIALS=new Rt("google-credentials-uid"),Rt.FIRST_PARTY=new Rt("first-party-uid"),Rt.MOCK_USER=new Rt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pl="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys=new qu("@firebase/firestore");function va(){return ys.logLevel}function R5(t){ys.setLogLevel(t)}function B(t,...e){if(ys.logLevel<=me.DEBUG){const n=e.map(dv);ys.debug(`Firestore (${Pl}): ${t}`,...n)}}function ot(t,...e){if(ys.logLevel<=me.ERROR){const n=e.map(dv);ys.error(`Firestore (${Pl}): ${t}`,...n)}}function Kn(t,...e){if(ys.logLevel<=me.WARN){const n=e.map(dv);ys.warn(`Firestore (${Pl}): ${t}`,...n)}}function dv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,UR(t,r,n)}function UR(t,e,n){let r=`FIRESTORE (${Pl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ot(r),new Error(r)}function te(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||UR(e,i,r)}function S5(t,e){t||J(57014,e)}function W(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends Ln{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class h4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Rt.UNAUTHENTICATED))}shutdown(){}}class f4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class p4{constructor(e){this.t=e,this.currentUser=Rt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){te(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Pt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Pt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Pt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new BR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new Rt(e)}}class m4{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Rt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class g4{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new m4(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Rt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class y4{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Be(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){te(this.o===void 0,3512);const r=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new fy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(te(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new fy(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class x5{getToken(){return Promise.resolve(new fy(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=_4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function oe(t,e){return t<e?-1:t>e?1:0}function py(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Jm(i)===Jm(s)?oe(i,s):Jm(i)?1:-1}return oe(t.length,e.length)}const v4=55296,w4=57343;function Jm(t){const e=t.charCodeAt(0);return e>=v4&&e<=w4}function nl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function $R(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my="__name__";class Ar{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&J(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ar.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ar?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Ar.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return oe(e.length,n.length)}static compareSegments(e,n){const r=Ar.isNumericId(e),i=Ar.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Ar.extractNumericId(e).compare(Ar.extractNumericId(n)):py(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return fs.fromString(e.substring(4,e.length-2))}}class de extends Ar{construct(e,n,r){return new de(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new j(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new de(n)}static emptyPath(){return new de([])}}const I4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class We extends Ar{construct(e,n,r){return new We(e,n,r)}static isValidIdentifier(e){return I4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),We.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===my}static keyField(){return new We([my])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new j(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new j(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new j(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new j(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new We(n)}static emptyPath(){return new We([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.path=e}static fromPath(e){return new G(de.fromString(e))}static fromName(e){return new G(de.fromString(e).popFirst(5))}static empty(){return new G(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return de.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new de(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(t,e,n){if(!n)throw new j(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function E4(t,e,n,r){if(e===!0&&r===!0)throw new j(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function lE(t){if(!G.isDocumentKey(t))throw new j(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function cE(t){if(G.isDocumentKey(t))throw new j(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zR(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ip(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function fe(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new j(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ip(t);throw new j(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function qR(t,e){if(e<=0)throw new j(V.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(t,e){const n={typeString:t};return e&&(n.value=e),n}function zo(t,e){if(!zR(t))throw new j(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new j(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE=-62135596800,dE=1e6;class Ae{static now(){return Ae.fromMillis(Date.now())}static fromDate(e){return Ae.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*dE);return new Ae(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new j(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new j(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<uE)throw new j(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/dE}_compareTo(e){return this.seconds===e.seconds?oe(this.nanoseconds,e.nanoseconds):oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ae._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zo(e,Ae._jsonSchema))return new Ae(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-uE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ae._jsonSchemaVersion="firestore/timestamp/1.0",Ae._jsonSchema={type:pt("string",Ae._jsonSchemaVersion),seconds:pt("number"),nanoseconds:pt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{static fromTimestamp(e){return new re(e)}static min(){return new re(new Ae(0,0))}static max(){return new re(new Ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl=-1;class il{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function gy(t){return t.fields.find(e=>e.kind===2)}function Qs(t){return t.fields.filter(e=>e.kind!==2)}function T4(t,e){let n=oe(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=A4(t.fields[r],e.fields[r]),n!==0)return n;return oe(t.fields.length,e.fields.length)}il.UNKNOWN_ID=-1;class po{constructor(e,n){this.fieldPath=e,this.kind=n}}function A4(t,e){const n=We.comparator(t.fieldPath,e.fieldPath);return n!==0?n:oe(t.kind,e.kind)}class sl{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new sl(0,Nn.min())}}function HR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=re.fromTimestamp(r===1e9?new Ae(n+1,0):new Ae(n,r));return new Nn(i,G.empty(),e)}function GR(t){return new Nn(t.readTime,t.key,rl)}class Nn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Nn(re.min(),G.empty(),rl)}static max(){return new Nn(re.max(),G.empty(),rl)}}function pv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=G.comparator(t.documentKey,e.documentKey),n!==0?n:oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class KR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ss(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==WR)throw t;B("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new L((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):L.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):L.reject(n)}static resolve(e){return new L((n,r)=>{n(e)})}static reject(e){return new L((n,r)=>{r(e)})}static waitFor(e){return new L((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=L.resolve(!1);for(const r of e)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new L((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new L((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En="SimpleDb";class Ep{static open(e,n,r,i){try{return new Ep(n,e.transaction(i,r))}catch(s){throw new $c(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Pt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new $c(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=mv(r.target.error);this.S.reject(new $c(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(B(En,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new R4(n)}}class Dr{static delete(e){return B(En,"Removing database:",e),Zs(Y1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!M_())return!1;if(Dr.F())return!0;const e=wt(),n=Dr.M(e),r=0<n&&n<10,i=QR(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Dr.M(wt())===12.2&&ot("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(B(En,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new $c(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new j(V.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new j(V.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new $c(e,o))},i.onupgradeneeded=s=>{B(En,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next(()=>{B(En,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Ep.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.C(),u)).catch(u=>(a.abort(u),L.reject(u))).toPromise();return l.catch(()=>{}),await a.D,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(B(En,"Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function QR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class b4{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Zs(this.U.delete())}}class $c extends j{constructor(e,n){super(V.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function xs(t){return t.name==="IndexedDbTransactionError"}class R4{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(B(En,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(B(En,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Zs(r)}add(e){return B(En,"ADD",this.store.name,e,e),Zs(this.store.add(e))}get(e){return Zs(this.store.get(e)).next(n=>(n===void 0&&(n=null),B(En,"GET",this.store.name,e,n),n))}delete(e){return B(En,"DELETE",this.store.name,e),Zs(this.store.delete(e))}count(){return B(En,"COUNT",this.store.name),Zs(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new L((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.H(s,(a,l)=>{o.push(l)}).next(()=>o)}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new L((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Z(e,n){B(En,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new L((r,i)=>{n.onerror=s=>{const o=mv(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new L((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new b4(a),u=n(a.primaryKey,a.value,l);if(u instanceof L){const d=u.catch(f=>(l.done(),L.reject(f)));r.push(d)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>L.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Zs(t){return new L((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=mv(r.target.error);n(i)}})}let hE=!1;function mv(t){const e=Dr.M(wt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new j("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hE||(hE=!0,setTimeout(()=>{throw r},0)),r}}return t}const zc="IndexBackfiller";class S4{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){B(zc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();B(zc,`Documents written: ${n}`)}catch(n){xs(n)?B(zc,"Ignoring IndexedDB error during index backfill: ",n):await Ss(n)}await this.re(6e4)})}}class x4{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let i=n,s=!0;return L.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return B(zc,`Processing collection: ${o}`),this.oe(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(i,s)).next(a=>(B(zc,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=GR(s);pv(o,r)>0&&(r=o)}),new Nn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}dn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ps=-1;function Zu(t){return t==null}function Eu(t){return t===0&&1/t==-1/0}function YR(t){return typeof t=="number"&&Number.isInteger(t)&&!Eu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="";function Gt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=fE(e)),e=P4(t.get(n),e);return fE(e)}function P4(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case Cf:n+="";break;default:n+=s}}return n}function fE(t){return t+Cf+""}function xr(t){const e=t.length;if(te(e>=2,64408,{path:t}),e===2)return te(t.charAt(0)===Cf&&t.charAt(1)==="",56145,{path:t}),de.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(Cf,s);switch((o<0||o>n)&&J(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:J(61167,{path:t})}s=o+2}return new de(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="remoteDocuments",ed="owner",ha="owner",Tu="mutationQueues",k4="userId",sr="mutations",pE="batchId",co="userMutationsIndex",mE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(t,e){return[t,Gt(e)]}function JR(t,e,n){return[t,Gt(e),n]}const C4={},ol="documentMutations",Nf="remoteDocumentsV14",N4=["prefixPath","collectionGroup","readTime","documentId"],Mh="documentKeyIndex",D4=["prefixPath","collectionGroup","documentId"],XR="collectionGroupIndex",O4=["collectionGroup","readTime","prefixPath","documentId"],Au="remoteDocumentGlobal",yy="remoteDocumentGlobalKey",al="targets",ZR="queryTargetsIndex",L4=["canonicalId","targetId"],ll="targetDocuments",V4=["targetId","path"],gv="documentTargetsIndex",M4=["path","targetId"],Df="targetGlobalKey",mo="targetGlobal",bu="collectionParents",F4=["collectionId","parent"],cl="clientMetadata",j4="clientId",Tp="bundles",U4="bundleId",Ap="namedQueries",B4="name",yv="indexConfiguration",$4="indexId",_y="collectionGroupIndex",z4="collectionGroup",qc="indexState",q4=["indexId","uid"],eS="sequenceNumberIndex",H4=["uid","sequenceNumber"],Hc="indexEntries",G4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tS="documentKeyIndex",W4=["indexId","uid","orderedDocumentKey"],bp="documentOverlays",K4=["userId","collectionPath","documentId"],vy="collectionPathOverlayIndex",Q4=["userId","collectionPath","largestBatchId"],nS="collectionGroupOverlayIndex",Y4=["userId","collectionGroup","largestBatchId"],_v="globals",J4="name",rS=[Tu,sr,ol,Ys,al,ed,mo,ll,cl,Au,bu,Tp,Ap],X4=[...rS,bp],iS=[Tu,sr,ol,Nf,al,ed,mo,ll,cl,Au,bu,Tp,Ap,bp],sS=iS,vv=[...sS,yv,qc,Hc],Z4=vv,oS=[...vv,_v],eF=oS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy extends KR{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Et(t,e){const n=W(t);return Dr.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ps(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function aS(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function lS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,n){this.comparator=e,this.root=n||Ot.EMPTY}insert(e,n){return new Ve(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ot.BLACK,null,null))}remove(e){return new Ve(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ot.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ch(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ch(this.root,e,this.comparator,!1)}getReverseIterator(){return new ch(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ch(this.root,e,this.comparator,!0)}}class ch{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ot{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ot.RED,this.left=i??Ot.EMPTY,this.right=s??Ot.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ot(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ot.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ot.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ot.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ot.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}}Ot.EMPTY=null,Ot.RED=!0,Ot.BLACK=!1;Ot.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ot(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.comparator=e,this.data=new Ve(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new yE(this.data.getIterator())}getIteratorFrom(e){return new yE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Se)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Se(this.comparator);return n.data=e,n}}class yE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function fa(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.fields=e,e.sort(We.comparator)}static empty(){return new hn([])}unionWith(e){let n=new Se(We.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new hn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return nl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k5(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new cS("Invalid base64 string: "+s):s}}(e);return new tt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tt.EMPTY_BYTE_STRING=new tt("");const tF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function di(t){if(te(!!t,39018),typeof t=="string"){let e=0;const n=tF.exec(t);if(te(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:He(t.seconds),nanos:He(t.nanos)}}function He(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function hi(t){return typeof t=="string"?tt.fromBase64String(t):tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS="server_timestamp",dS="__type__",hS="__previous_value__",fS="__local_write_time__";function Rp(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[dS])==null?void 0:r.stringValue)===uS}function Sp(t){const e=t.mapValue.fields[hS];return Rp(e)?Sp(e):e}function Ru(t){const e=di(t.mapValue.fields[fS].timestampValue);return new Ae(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e,n,r,i,s,o,a,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=d}}const Su="(default)";class Ro{constructor(e,n){this.projectId=e,this.database=n||Su}static empty(){return new Ro("","")}get isDefaultDatabase(){return this.database===Su}isEqual(e){return e instanceof Ro&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="__type__",pS="__max__",Zi={mapValue:{fields:{__type__:{stringValue:pS}}}},Iv="__vector__",ul="value",Fh={nullValue:"NULL_VALUE"};function _s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rp(t)?4:mS(t)?9007199254740991:xp(t)?10:11:J(28295,{value:t})}function Mr(t,e){if(t===e)return!0;const n=_s(t);if(n!==_s(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ru(t).isEqual(Ru(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=di(i.timestampValue),a=di(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return hi(i.bytesValue).isEqual(hi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return He(i.geoPointValue.latitude)===He(s.geoPointValue.latitude)&&He(i.geoPointValue.longitude)===He(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return He(i.integerValue)===He(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=He(i.doubleValue),a=He(s.doubleValue);return o===a?Eu(o)===Eu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return nl(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(gE(o)!==gE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Mr(o[l],a[l])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function xu(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function vs(t,e){if(t===e)return 0;const n=_s(t),r=_s(e);if(n!==r)return oe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return oe(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=He(s.integerValue||s.doubleValue),l=He(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return _E(t.timestampValue,e.timestampValue);case 4:return _E(Ru(t),Ru(e));case 5:return py(t.stringValue,e.stringValue);case 6:return function(s,o){const a=hi(s),l=hi(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=oe(a[u],l[u]);if(d!==0)return d}return oe(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=oe(He(s.latitude),He(o.latitude));return a!==0?a:oe(He(s.longitude),He(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return vE(t.arrayValue,e.arrayValue);case 10:return function(s,o){var p,v,S,P;const a=s.fields||{},l=o.fields||{},u=(p=a[ul])==null?void 0:p.arrayValue,d=(v=l[ul])==null?void 0:v.arrayValue,f=oe(((S=u==null?void 0:u.values)==null?void 0:S.length)||0,((P=d==null?void 0:d.values)==null?void 0:P.length)||0);return f!==0?f:vE(u,d)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Zi.mapValue&&o===Zi.mapValue)return 0;if(s===Zi.mapValue)return 1;if(o===Zi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const p=py(l[f],d[f]);if(p!==0)return p;const v=vs(a[l[f]],u[d[f]]);if(v!==0)return v}return oe(l.length,d.length)}(t.mapValue,e.mapValue);default:throw J(23264,{he:n})}}function _E(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return oe(t,e);const n=di(t),r=di(e),i=oe(n.seconds,r.seconds);return i!==0?i:oe(n.nanos,r.nanos)}function vE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=vs(n[i],r[i]);if(s)return s}return oe(n.length,r.length)}function dl(t){return Iy(t)}function Iy(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=di(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return hi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return G.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Iy(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Iy(n.fields[o])}`;return i+"}"}(t.mapValue):J(61005,{value:t})}function jh(t){switch(_s(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Sp(t);return e?16+jh(e):16;case 5:return 2*t.stringValue.length;case 6:return hi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+jh(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Ps(r.fields,(s,o)=>{i+=s.length+jh(o)}),i}(t.mapValue);default:throw J(13486,{value:t})}}function So(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ey(t){return!!t&&"integerValue"in t}function Pu(t){return!!t&&"arrayValue"in t}function wE(t){return!!t&&"nullValue"in t}function IE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Uh(t){return!!t&&"mapValue"in t}function xp(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[wv])==null?void 0:r.stringValue)===Iv}function Gc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ps(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Gc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Gc(t.arrayValue.values[n]);return e}return{...t}}function mS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===pS}const gS={mapValue:{fields:{[wv]:{stringValue:Iv},[ul]:{arrayValue:{}}}}};function rF(t){return"nullValue"in t?Fh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?So(Ro.empty(),G.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?xp(t)?gS:{mapValue:{}}:J(35942,{value:t})}function iF(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?So(Ro.empty(),G.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gS:"mapValue"in t?xp(t)?{mapValue:{}}:Zi:J(61959,{value:t})}function EE(t,e){const n=vs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function TE(t,e){const n=vs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.value=e}static empty(){return new Lt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Uh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gc(n)}setAll(e){let n=We.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Gc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Uh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Uh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ps(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Lt(Gc(this.value))}}function yS(t){const e=[];return Ps(t.fields,(n,r)=>{const i=new We([n]);if(Uh(r)){const s=yS(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new hn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ue(e,0,re.min(),re.min(),re.min(),Lt.empty(),0)}static newFoundDocument(e,n,r,i){return new Ue(e,1,n,re.min(),r,i,0)}static newNoDocument(e,n){return new Ue(e,2,n,re.min(),re.min(),Lt.empty(),0)}static newUnknownDocument(e,n){return new Ue(e,3,n,re.min(),re.min(),Lt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ue&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ue(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,n){this.position=e,this.inclusive=n}}function AE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=vs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function bE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,n="asc"){this.field=e,this.dir=n}}function sF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{}class ge extends _S{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new oF(e,n,r):n==="array-contains"?new cF(e,r):n==="in"?new AS(e,r):n==="not-in"?new uF(e,r):n==="array-contains-any"?new dF(e,r):new ge(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new aF(e,r):new lF(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(vs(n,this.value)):n!==null&&_s(this.value)===_s(n)&&this.matchesComparison(vs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class be extends _S{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new be(e,n)}matches(e){return hl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hl(t){return t.op==="and"}function Ty(t){return t.op==="or"}function Ev(t){return vS(t)&&hl(t)}function vS(t){for(const e of t.filters)if(e instanceof be)return!1;return!0}function Ay(t){if(t instanceof ge)return t.field.canonicalString()+t.op.toString()+dl(t.value);if(Ev(t))return t.filters.map(e=>Ay(e)).join(",");{const e=t.filters.map(n=>Ay(n)).join(",");return`${t.op}(${e})`}}function wS(t,e){return t instanceof ge?function(r,i){return i instanceof ge&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&wS(o,i.filters[a]),!0):!1}(t,e):void J(19439)}function IS(t,e){const n=t.filters.concat(e);return be.create(n,t.op)}function ES(t){return t instanceof ge?function(n){return`${n.field.canonicalString()} ${n.op} ${dl(n.value)}`}(t):t instanceof be?function(n){return n.op.toString()+" {"+n.getFilters().map(ES).join(" ,")+"}"}(t):"Filter"}class oF extends ge{constructor(e,n,r){super(e,n,r),this.key=G.fromName(r.referenceValue)}matches(e){const n=G.comparator(e.key,this.key);return this.matchesComparison(n)}}class aF extends ge{constructor(e,n){super(e,"in",n),this.keys=TS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class lF extends ge{constructor(e,n){super(e,"not-in",n),this.keys=TS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function TS(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class cF extends ge{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Pu(n)&&xu(n.arrayValue,this.value)}}class AS extends ge{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&xu(this.value.arrayValue,n)}}class uF extends ge{constructor(e,n){super(e,"not-in",n)}matches(e){if(xu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!xu(this.value.arrayValue,n)}}class dF extends ge{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Pu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>xu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function by(t,e=null,n=[],r=[],i=null,s=null,o=null){return new hF(t,e,n,r,i,s,o)}function xo(t){const e=W(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ay(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Zu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>dl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>dl(r)).join(",")),e.Te=n}return e.Te}function td(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!sF(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!wS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bE(t.startAt,e.startAt)&&bE(t.endAt,e.endAt)}function Of(t){return G.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Lf(t,e){return t.filters.filter(n=>n instanceof ge&&n.field.isEqual(e))}function RE(t,e,n){let r=Fh,i=!0;for(const s of Lf(t,e)){let o=Fh,a=!0;switch(s.op){case"<":case"<=":o=rF(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Fh}EE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];EE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function SE(t,e,n){let r=Zi,i=!0;for(const s of Lf(t,e)){let o=Zi,a=!0;switch(s.op){case">=":case">":o=iF(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Zi}TE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];TE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function bS(t,e,n,r,i,s,o,a){return new _i(t,e,n,r,i,s,o,a)}function kl(t){return new _i(t)}function xE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Tv(t){return t.collectionGroup!==null}function Ga(t){const e=W(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Se(We.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new ku(s,r))}),n.has(We.keyField().canonicalString())||e.Ie.push(new ku(We.keyField(),r))}return e.Ie}function Wt(t){const e=W(t);return e.Ee||(e.Ee=SS(e,Ga(t))),e.Ee}function RS(t){const e=W(t);return e.de||(e.de=SS(e,t.explicitOrderBy)),e.de}function SS(t,e){if(t.limitType==="F")return by(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new ku(i.field,s)});const n=t.endAt?new ws(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ws(t.startAt.position,t.startAt.inclusive):null;return by(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ry(t,e){const n=t.filters.concat([e]);return new _i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Vf(t,e,n){return new _i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function nd(t,e){return td(Wt(t),Wt(e))&&t.limitType===e.limitType}function xS(t){return`${xo(Wt(t))}|lt:${t.limitType}`}function wa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>ES(i)).join(", ")}]`),Zu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>dl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>dl(i)).join(",")),`Target(${r})`}(Wt(t))}; limitType=${t.limitType})`}function rd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Ga(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=AE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Ga(r),i)||r.endAt&&!function(o,a,l){const u=AE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Ga(r),i))}(t,e)}function PS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function kS(t){return(e,n)=>{let r=!1;for(const i of Ga(t)){const s=fF(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function fF(t,e,n){const r=t.field.isKeyField()?G.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?vs(l,u):J(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ps(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return lS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF=new Ve(G.comparator);function fn(){return pF}const CS=new Ve(G.comparator);function Ac(...t){let e=CS;for(const n of t)e=e.insert(n.key,n);return e}function NS(t){let e=CS;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Pr(){return Wc()}function DS(){return Wc()}function Wc(){return new vi(t=>t.toString(),(t,e)=>t.isEqual(e))}const mF=new Ve(G.comparator),gF=new Se(G.comparator);function ce(...t){let e=gF;for(const n of t)e=e.add(n);return e}const yF=new Se(oe);function Av(){return yF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Eu(e)?"-0":e}}function OS(t){return{integerValue:""+t}}function LS(t,e){return YR(e)?OS(e):bv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(){this._=void 0}}function _F(t,e,n){return t instanceof fl?function(i,s){const o={fields:{[dS]:{stringValue:uS},[fS]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Rp(s)&&(s=Sp(s)),s&&(o.fields[hS]=s),{mapValue:o}}(n,e):t instanceof Po?MS(t,e):t instanceof ko?FS(t,e):function(i,s){const o=VS(i,s),a=PE(o)+PE(i.Ae);return Ey(o)&&Ey(i.Ae)?OS(a):bv(i.serializer,a)}(t,e)}function vF(t,e,n){return t instanceof Po?MS(t,e):t instanceof ko?FS(t,e):n}function VS(t,e){return t instanceof pl?function(r){return Ey(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class fl extends Pp{}class Po extends Pp{constructor(e){super(),this.elements=e}}function MS(t,e){const n=jS(e);for(const r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}class ko extends Pp{constructor(e){super(),this.elements=e}}function FS(t,e){let n=jS(e);for(const r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}class pl extends Pp{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function PE(t){return He(t.integerValue||t.doubleValue)}function jS(t){return Pu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,n){this.field=e,this.transform=n}}function wF(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Po&&i instanceof Po||r instanceof ko&&i instanceof ko?nl(r.elements,i.elements,Mr):r instanceof pl&&i instanceof pl?Mr(r.Ae,i.Ae):r instanceof fl&&i instanceof fl}(t.transform,e.transform)}class IF{constructor(e,n){this.version=e,this.transformResults=n}}class Ke{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ke}static exists(e){return new Ke(void 0,e)}static updateTime(e){return new Ke(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class kp{}function US(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Nl(t.key,Ke.none()):new Cl(t.key,t.data,Ke.none());{const n=t.data,r=Lt.empty();let i=new Se(We.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new wi(t.key,r,new hn(i.toArray()),Ke.none())}}function EF(t,e,n){t instanceof Cl?function(i,s,o){const a=i.value.clone(),l=CE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof wi?function(i,s,o){if(!Bh(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=CE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(BS(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Kc(t,e,n,r){return t instanceof Cl?function(s,o,a,l){if(!Bh(s.precondition,o))return a;const u=s.value.clone(),d=NE(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof wi?function(s,o,a,l){if(!Bh(s.precondition,o))return a;const u=NE(s.fieldTransforms,l,o),d=o.data;return d.setAll(BS(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return Bh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function TF(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=VS(r.transform,i||null);s!=null&&(n===null&&(n=Lt.empty()),n.set(r.field,s))}return n||null}function kE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&nl(r,i,(s,o)=>wF(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Cl extends kp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class wi extends kp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function BS(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function CE(t,e,n){const r=new Map;te(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,vF(o,a,n[i]))}return r}function NE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,_F(s,o,e))}return r}class Nl extends kp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Rv extends kp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&EF(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Kc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Kc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=DS();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=US(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&nl(this.mutations,e.mutations,(n,r)=>kE(n,r))&&nl(this.baseMutations,e.baseMutations,(n,r)=>kE(n,r))}}class xv{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return mF}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new xv(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt,ye;function zS(t){switch(t){case V.OK:return J(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function qS(t){if(t===void 0)return ot("GRPC error has no .code"),V.UNKNOWN;switch(t){case dt.OK:return V.OK;case dt.CANCELLED:return V.CANCELLED;case dt.UNKNOWN:return V.UNKNOWN;case dt.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case dt.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case dt.INTERNAL:return V.INTERNAL;case dt.UNAVAILABLE:return V.UNAVAILABLE;case dt.UNAUTHENTICATED:return V.UNAUTHENTICATED;case dt.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case dt.NOT_FOUND:return V.NOT_FOUND;case dt.ALREADY_EXISTS:return V.ALREADY_EXISTS;case dt.PERMISSION_DENIED:return V.PERMISSION_DENIED;case dt.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case dt.ABORTED:return V.ABORTED;case dt.OUT_OF_RANGE:return V.OUT_OF_RANGE;case dt.UNIMPLEMENTED:return V.UNIMPLEMENTED;case dt.DATA_LOSS:return V.DATA_LOSS;default:return J(39323,{code:t})}}(ye=dt||(dt={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qc=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF=new fs([4294967295,4294967295],0);function DE(t){const e=HS().encode(t),n=new OR;return n.update(e),new Uint8Array(n.digest())}function OE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new fs([n,r],0),new fs([i,s],0)]}class kv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new bc(`Invalid padding: ${n}`);if(r<0)throw new bc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new bc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=fs.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(fs.fromNumber(r)));return i.compare(bF)===1&&(i=new fs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=DE(e),[r,i]=OE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new kv(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=DE(e),[r,i]=OE(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class bc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,od.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new sd(re.min(),i,new Ve(oe),fn(),ce())}}class od{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new od(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class GS{constructor(e,n){this.targetId=e,this.Ce=n}}class WS{constructor(e,n,r=tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class LE{constructor(){this.ve=0,this.Fe=VE(),this.Me=tt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ce(),n=ce(),r=ce();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:J(38017,{changeType:s})}}),new od(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=VE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class RF{constructor(e){this.Ge=e,this.ze=new Map,this.je=fn(),this.Je=uh(),this.He=uh(),this.Ye=new Ve(oe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(Of(s))if(r===0){const o=new G(s.path);this.et(n,o,Ue.newNoDocument(o,re.min()))}else te(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}Qc==null||Qc.lt(function(d,f,p,v,S){var T,I,b;const P={localCacheCount:d,existenceFilterCount:f.count,databaseId:p.database,projectId:p.projectId},N=f.unchangedNames;return N&&(P.bloomFilter={applied:S===0,hashCount:(N==null?void 0:N.hashCount)??0,bitmapLength:((I=(T=N==null?void 0:N.bits)==null?void 0:T.bitmap)==null?void 0:I.length)??0,padding:((b=N==null?void 0:N.bits)==null?void 0:b.padding)??0,mightContain:M=>(v==null?void 0:v.mightContain(M))??!1}),P}(o,e.Ce,this.Ge.ht(),a,l))}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=hi(r).toUint8Array()}catch(l){if(l instanceof cS)return Kn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new kv(o,i,s)}catch(l){return Kn(l instanceof bc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Of(a.target)){const l=new G(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Ue.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}});let r=ce();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new sd(e,n,this.Ye,this.je,r);return this.je=fn(),this.Je=uh(),this.He=uh(),this.Ye=new Ve(oe),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new LE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Se(oe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Se(oe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||B("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new LE),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function uh(){return new Ve(G.comparator)}function VE(){return new Ve(G.comparator)}const SF=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),xF=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),PF=(()=>({and:"AND",or:"OR"}))();class kF{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Sy(t,e){return t.useProto3Json||Zu(e)?e:{value:e}}function ml(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function KS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function CF(t,e){return ml(t,e.toTimestamp())}function at(t){return te(!!t,49232),re.fromTimestamp(function(n){const r=di(n);return new Ae(r.seconds,r.nanos)}(t))}function Cv(t,e){return xy(t,e).canonicalString()}function xy(t,e){const n=function(i){return new de(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function QS(t){const e=de.fromString(t);return te(ix(e),10190,{key:e.toString()}),e}function Cu(t,e){return Cv(t.databaseId,e.path)}function Or(t,e){const n=QS(e);if(n.get(1)!==t.databaseId.projectId)throw new j(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new j(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new G(XS(n))}function YS(t,e){return Cv(t.databaseId,e)}function JS(t){const e=QS(t);return e.length===4?de.emptyPath():XS(e)}function Py(t){return new de(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function XS(t){return te(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function ME(t,e,n){return{name:Cu(t,e),fields:n.value.mapValue.fields}}function Cp(t,e,n){const r=Or(t,e.name),i=at(e.updateTime),s=e.createTime?at(e.createTime):re.min(),o=new Lt({mapValue:{fields:e.fields}}),a=Ue.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function NF(t,e){return"found"in e?function(r,i){te(!!i.found,43571),i.found.name,i.found.updateTime;const s=Or(r,i.found.name),o=at(i.found.updateTime),a=i.found.createTime?at(i.found.createTime):re.min(),l=new Lt({mapValue:{fields:i.found.fields}});return Ue.newFoundDocument(s,o,a,l)}(t,e):"missing"in e?function(r,i){te(!!i.missing,3894),te(!!i.readTime,22933);const s=Or(r,i.missing),o=at(i.readTime);return Ue.newNoDocument(s,o)}(t,e):J(7234,{result:e})}function DF(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:J(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(te(d===void 0||typeof d=="string",58123),tt.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),tt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?V.UNKNOWN:qS(u.code);return new j(d,u.message||"")}(o);n=new WS(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Or(t,r.document.name),s=at(r.document.updateTime),o=r.document.createTime?at(r.document.createTime):re.min(),a=new Lt({mapValue:{fields:r.document.fields}}),l=Ue.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new $h(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Or(t,r.document),s=r.readTime?at(r.readTime):re.min(),o=Ue.newNoDocument(i,s),a=r.removedTargetIds||[];n=new $h([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Or(t,r.document),s=r.removedTargetIds||[];n=new $h([],s,i,null)}else{if(!("filter"in e))return J(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new AF(i,s),a=r.targetId;n=new GS(a,o)}}return n}function Nu(t,e){let n;if(e instanceof Cl)n={update:ME(t,e.key,e.value)};else if(e instanceof Nl)n={delete:Cu(t,e.key)};else if(e instanceof wi)n={update:ME(t,e.key,e.data),updateMask:jF(e.fieldMask)};else{if(!(e instanceof Rv))return J(16599,{Vt:e.type});n={verify:Cu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof fl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Po)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ko)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof pl)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw J(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:CF(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:J(27497)}(t,e.precondition)),n}function ky(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Ke.updateTime(at(s.updateTime)):s.exists!==void 0?Ke.exists(s.exists):Ke.none()}(e.currentDocument):Ke.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)te(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new fl;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new Po(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new ko(d)}else"increment"in a?l=new pl(o,a.increment):J(16584,{proto:a});const u=We.fromServerFormat(a.fieldPath);return new id(u,l)}(t,i)):[];if(e.update){e.update.name;const i=Or(t,e.update.name),s=new Lt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new hn(u.map(d=>We.fromServerFormat(d)))}(e.updateMask);return new wi(i,s,o,n,r)}return new Cl(i,s,n,r)}if(e.delete){const i=Or(t,e.delete);return new Nl(i,n)}if(e.verify){const i=Or(t,e.verify);return new Rv(i,n)}return J(1463,{proto:e})}function OF(t,e){return t&&t.length>0?(te(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?at(i.updateTime):at(s);return o.isEqual(re.min())&&(o=at(s)),new IF(o,i.transformResults||[])}(n,e))):[]}function ZS(t,e){return{documents:[YS(t,e.path)]}}function Np(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=YS(t,i);const s=function(u){if(u.length!==0)return rx(be.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Ki(p.field),direction:VF(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Sy(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:i}}function ex(t,e,n,r){const{ft:i,parent:s}=Np(t,e),o={},a=[];let l=0;return n.forEach(u=>{const d=r?u.alias:"aggregate_"+l++;o[d]=u.alias,u.aggregateType==="count"?a.push({alias:d,count:{}}):u.aggregateType==="avg"?a.push({alias:d,avg:{field:Ki(u.fieldPath)}}):u.aggregateType==="sum"&&a.push({alias:d,sum:{field:Ki(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function tx(t){let e=JS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){te(r===1,65062);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(f){const p=nx(f);return p instanceof be&&Ev(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(S){return new ku(Ia(S.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,Zu(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(f){const p=!!f.before,v=f.values||[];return new ws(v,p)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const p=!f.before,v=f.values||[];return new ws(v,p)}(n.endAt)),bS(e,i,o,s,a,"F",l,u)}function LF(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function nx(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ia(n.unaryFilter.field);return ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ia(n.unaryFilter.field);return ge.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ia(n.unaryFilter.field);return ge.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ia(n.unaryFilter.field);return ge.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(n){return ge.create(Ia(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return be.create(n.compositeFilter.filters.map(r=>nx(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(n.compositeFilter.op))}(t):J(30097,{filter:t})}function VF(t){return SF[t]}function MF(t){return xF[t]}function FF(t){return PF[t]}function Ki(t){return{fieldPath:t.canonicalString()}}function Ia(t){return We.fromServerFormat(t.fieldPath)}function rx(t){return t instanceof ge?function(n){if(n.op==="=="){if(IE(n.value))return{unaryFilter:{field:Ki(n.field),op:"IS_NAN"}};if(wE(n.value))return{unaryFilter:{field:Ki(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(IE(n.value))return{unaryFilter:{field:Ki(n.field),op:"IS_NOT_NAN"}};if(wE(n.value))return{unaryFilter:{field:Ki(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ki(n.field),op:MF(n.op),value:n.value}}}(t):t instanceof be?function(n){const r=n.getFilters().map(i=>rx(i));return r.length===1?r[0]:{compositeFilter:{op:FF(n.op),filters:r}}}(t):J(54877,{filter:t})}function jF(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ix(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,n,r,i,s=re.min(),o=re.min(),a=tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e){this.yt=e}}function UF(t,e){let n;if(e.document)n=Cp(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=G.fromSegments(e.noDocument.path),i=No(e.noDocument.readTime);n=Ue.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return J(56709);{const r=G.fromSegments(e.unknownDocument.path),i=No(e.unknownDocument.version);n=Ue.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Ae(i[0],i[1]);return re.fromTimestamp(s)}(e.readTime)),n}function FE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Mf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Cu(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ml(s,o.version.toTimestamp()),createTime:ml(s,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Co(e.version)};else{if(!e.isUnknownDocument())return J(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Co(e.version)}}return r}function Mf(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Co(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function No(t){const e=new Ae(t.seconds,t.nanoseconds);return re.fromTimestamp(e)}function eo(t,e){const n=(e.baseMutations||[]).map(s=>ky(t.yt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>ky(t.yt,s)),i=Ae.fromMillis(e.localWriteTimeMs);return new Sv(e.batchId,i,n,r)}function Rc(t){const e=No(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?No(t.lastLimboFreeSnapshotVersion):re.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){const o=s.documents.length;return te(o===1,1966,{count:o}),Wt(kl(JS(s.documents[0])))}(t.query):function(s){return Wt(tx(s))}(t.query),new Zr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,tt.fromBase64String(t.resumeToken))}function ox(t,e){const n=Co(e.snapshotVersion),r=Co(e.lastLimboFreeSnapshotVersion);let i;i=Of(e.target)?ZS(t.yt,e.target):Np(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Dp(t){const e=tx({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Vf(e,e.limit,"L"):e}function Xm(t,e){return new Pv(e.largestBatchId,ky(t.yt,e.overlayMutation))}function jE(t,e){const n=e.path.lastSegment();return[t,Gt(e.path.popLast()),n]}function UE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Co(r.readTime),documentKey:Gt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{getBundleMetadata(e,n){return BE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:No(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return BE(e).put(function(i){return{bundleId:i.id,createTime:Co(at(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return $E(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:Dp(s.bundledQuery),readTime:No(s.readTime)}}(r)})}saveNamedQuery(e,n){return $E(e).put(function(i){return{name:i.name,readTime:Co(at(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function BE(t){return Et(t,Tp)}function $E(t){return Et(t,Ap)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Op(e,r)}getOverlay(e,n){return uc(e).get(jE(this.userId,n)).next(r=>r?Xm(this.serializer,r):null)}getOverlays(e,n){const r=Pr();return L.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Pv(n,o);i.push(this.St(e,a))}),L.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(Gt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(uc(e).Z(vy,a))}),L.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Pr(),s=Gt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return uc(e).J(vy,o).next(a=>{for(const l of a){const u=Xm(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Pr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return uc(e).ee({index:nS,range:a},(l,u,d)=>{const f=Xm(this.serializer,u);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}St(e,n){return uc(e).put(function(i,s,o){const[a,l,u]=jE(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Nu(i.yt,o.mutation)}}(this.serializer,this.userId,n))}}function uc(t){return Et(t,bp)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $F{bt(e){return Et(e,_v)}getSessionToken(e){return this.bt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?tt.fromUint8Array(r):tt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(He(e.integerValue));else if("doubleValue"in e){const r=He(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Eu(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=di(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(hi(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?mS(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):xp(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):J(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const i=ul,s=((a=(o=r[i].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(He(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),G.fromName(e).path.forEach(r=>{this.Ft(n,60),this.Ut(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}to.Kt=new to;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=255;function zF(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function zE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=zF(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class qF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=zE(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=zE(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(pa),this.sn(255)}_n(){this.an(pa),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===pa?(this.sn(pa),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===pa?(this.an(pa),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class HF{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class GF{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class dc{constructor(){this.cn=new qF,this.ln=new HF(this.cn),this.hn=new GF(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new no(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:zh(this.En),directionalValue:zh(this.dn),orderedDocumentKey:zh(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Vi(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=qE(t.En,e.En),n!==0?n:(n=qE(t.dn,e.dn),n!==0?n:G.comparator(t.In,e.In)))}function qE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function zh(t){return sb()?function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r}(t):t}function HE(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(t)}class GE{constructor(e){this.mn=new Se((n,r)=>We.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(te(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=gy(e);if(n!==void 0&&!this.wn(n))return!1;const r=Qs(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Se(We.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new po(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new po(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new po(r.field,r.dir==="asc"?0:1)));return new il(il.UNKNOWN_ID,this.collectionId,n,sl.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(t){var n,r;if(te(t instanceof ge||t instanceof be,20012),t instanceof ge){if(t instanceof AS){const i=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(s=>ge.create(t.field,"==",s)))||[];return be.create(i,"or")}return t}const e=t.filters.map(i=>ax(i));return be.create(e,t.op)}function WF(t){if(t.getFilters().length===0)return[];const e=Dy(ax(t));return te(lx(e),7391),Cy(e)||Ny(e)?[e]:e.getFilters()}function Cy(t){return t instanceof ge}function Ny(t){return t instanceof be&&Ev(t)}function lx(t){return Cy(t)||Ny(t)||function(n){if(n instanceof be&&Ty(n)){for(const r of n.getFilters())if(!Cy(r)&&!Ny(r))return!1;return!0}return!1}(t)}function Dy(t){if(te(t instanceof ge||t instanceof be,34018),t instanceof ge)return t;if(t.filters.length===1)return Dy(t.filters[0]);const e=t.filters.map(r=>Dy(r));let n=be.create(e,t.op);return n=Ff(n),lx(n)?n:(te(n instanceof be,64498),te(hl(n),40251),te(n.filters.length>1,57927),n.filters.reduce((r,i)=>Nv(r,i)))}function Nv(t,e){let n;return te(t instanceof ge||t instanceof be,38388),te(e instanceof ge||e instanceof be,25473),n=t instanceof ge?e instanceof ge?function(i,s){return be.create([i,s],"and")}(t,e):WE(t,e):e instanceof ge?WE(e,t):function(i,s){if(te(i.filters.length>0&&s.filters.length>0,48005),hl(i)&&hl(s))return IS(i,s.getFilters());const o=Ty(i)?i:s,a=Ty(i)?s:i,l=o.filters.map(u=>Nv(u,a));return be.create(l,"or")}(t,e),Ff(n)}function WE(t,e){if(hl(e))return IS(e,t.getFilters());{const n=e.filters.map(r=>Nv(t,r));return be.create(n,"or")}}function Ff(t){if(te(t instanceof ge||t instanceof be,11850),t instanceof ge)return t;const e=t.getFilters();if(e.length===1)return Ff(e[0]);if(vS(t))return t;const n=e.map(i=>Ff(i)),r=[];return n.forEach(i=>{i instanceof ge?r.push(i):i instanceof be&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:be.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(){this.Cn=new Dv}addToCollectionParentIndex(e,n){return this.Cn.add(n),L.resolve()}getCollectionParents(e,n){return L.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return L.resolve()}deleteFieldIndex(e,n){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,n){return L.resolve()}getDocumentsMatchingTarget(e,n){return L.resolve(null)}getIndexType(e,n){return L.resolve(0)}getFieldIndexes(e,n){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,n){return L.resolve(Nn.min())}getMinOffsetFromCollectionGroup(e,n){return L.resolve(Nn.min())}updateCollectionGroup(e,n,r){return L.resolve()}updateIndexEntries(e,n){return L.resolve()}}class Dv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Se(de.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(de.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="IndexedDbIndexManager",dh=new Uint8Array(0);class QF{constructor(e,n){this.databaseId=n,this.vn=new Dv,this.Fn=new vi(r=>xo(r),(r,i)=>td(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.vn.add(n)});const s={collectionId:r,parent:Gt(i)};return QE(e).put(s)}return L.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[$R(n),""],!1,!0);return QE(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(xr(o.parent))}return r})}addFieldIndex(e,n){const r=hc(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=ga(e);return s.next(a=>{o.put(UE(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=hc(e),i=ga(e),s=ma(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=hc(e),r=ma(e),i=ga(e);return n.Z().next(()=>r.Z()).next(()=>i.Z())}createTargetIndexes(e,n){return L.forEach(this.Mn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new GE(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=ma(e);let i=!0;const s=new Map;return L.forEach(this.Mn(n),o=>this.xn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ce();const a=[];return L.forEach(s,(l,u)=>{B(KE,`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(M=>`${M.fieldPath}:${M.kind}`).join(",")}`}(l)} to execute ${xo(n)}`);const d=function(b,M){const $=gy(M);if($===void 0)return null;for(const z of Lf(b,$.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null}(u,l),f=function(b,M){const $=new Map;for(const z of Qs(M))for(const A of Lf(b,z.fieldPath))switch(A.op){case"==":case"in":$.set(z.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return $.set(z.fieldPath.canonicalString(),A.value),Array.from($.values())}return null}(u,l),p=function(b,M){const $=[];let z=!0;for(const A of Qs(M)){const _=A.kind===0?RE(b,A.fieldPath,b.startAt):SE(b,A.fieldPath,b.startAt);$.push(_.value),z&&(z=_.inclusive)}return new ws($,z)}(u,l),v=function(b,M){const $=[];let z=!0;for(const A of Qs(M)){const _=A.kind===0?SE(b,A.fieldPath,b.endAt):RE(b,A.fieldPath,b.endAt);$.push(_.value),z&&(z=_.inclusive)}return new ws($,z)}(u,l),S=this.On(l,u,p),P=this.On(l,u,v),N=this.Nn(l,u,f),T=this.Bn(l.indexId,d,S,p.inclusive,P,v.inclusive,N);return L.forEach(T,I=>r.Y(I,n.limit).next(b=>{b.forEach(M=>{const $=G.fromSegments(M.documentKey);o.has($)||(o=o.add($),a.push($))})}))}).next(()=>a)}return L.resolve(null)})}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=WF(be.create(e.filters,"and")).map(r=>by(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),u=l/(n!=null?n.length:1),d=[];for(let f=0;f<l;++f){const p=n?this.Ln(n[f/u]):dh,v=this.kn(e,p,r[f%u],i),S=this.qn(e,p,s[f%u],o),P=a.map(N=>this.kn(e,p,N,!0));d.push(...this.createRange(v,S,P))}return d}kn(e,n,r,i){const s=new no(e,G.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new no(e,G.empty(),n,r);return i?s.An():s}xn(e,n){const r=new GE(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Mn(n);return L.forEach(i,s=>this.xn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Se(We.comparator),d=!1;for(const f of l.filters)for(const p of f.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?d=!0:u=u.add(p.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Qn(e,n){const r=new dc;for(const i of Qs(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);to.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new dc;return to.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new dc;return to.Kt.Dt(So(this.databaseId,n),r.Pn(function(s){const o=Qs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new dc);let s=0;for(const o of Qs(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&Pu(a))i=this.Kn(i,o,a);else{const u=l.Pn(o.kind);to.Kt.Dt(a,u)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new dc;l.seed(a.un()),to.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find(r=>r instanceof ge&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=hc(e),i=ga(e);return(n?r.J(_y,IDBKeyRange.bound(n,n)):r.J()).next(s=>{const o=[];return L.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,f){const p=f?new sl(f.sequenceNumber,new Nn(No(f.readTime),new G(xr(f.documentKey)),f.largestBatchId)):sl.empty(),v=d.fields.map(([S,P])=>new po(We.fromServerFormat(S),P));return new il(d.indexId,d.collectionGroup,v,p)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:oe(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=hc(e),s=ga(e);return this.Gn(e).next(o=>i.J(_y,IDBKeyRange.bound(n,n)).next(a=>L.forEach(a,l=>s.put(UE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return L.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?L.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),L.forEach(a,l=>this.zn(e,i,l).next(u=>{const d=this.jn(s,l);return u.isEqual(d)?L.resolve():this.Jn(e,s,l,u,d)}))))})}Hn(e,n,r,i){return ma(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return ma(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=ma(e);let s=new Se(Vi);return i.ee({index:tS,range:IDBKeyRange.only([r.indexId,this.uid,zh(this.$n(r,n))])},(o,a)=>{s=s.add(new no(r.indexId,n,HE(a.arrayValue),HE(a.directionalValue)))}).next(()=>s)}jn(e,n){let r=new Se(Vi);const i=this.Qn(n,e);if(i==null)return r;const s=gy(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Pu(o))for(const a of o.arrayValue.values||[])r=r.add(new no(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new no(n.indexId,e.key,dh,i));return r}Jn(e,n,r,i,s){B(KE,"Updating index entries for document '%s'",n.key);const o=[];return function(l,u,d,f,p){const v=l.getIterator(),S=u.getIterator();let P=fa(v),N=fa(S);for(;P||N;){let T=!1,I=!1;if(P&&N){const b=d(P,N);b<0?I=!0:b>0&&(T=!0)}else P!=null?I=!0:T=!0;T?(f(N),N=fa(S)):I?(p(P),P=fa(v)):(P=fa(v),N=fa(S))}}(i,s,Vi,a=>{o.push(this.Hn(e,n,r,a))},a=>{o.push(this.Yn(e,n,r,a))}),L.waitFor(o)}Gn(e){let n=1;return ga(e).ee({index:eS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Vi(o,a)).filter((o,a,l)=>!a||Vi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Vi(o,e),l=Vi(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,dh,G.empty()),l=i[o+1].Vn(this.uid,dh,G.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return Vi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(YE)}getMinOffset(e,n){return L.mapArray(this.Mn(n),r=>this.xn(e,r).next(i=>i||J(44426))).next(YE)}}function QE(t){return Et(t,bu)}function ma(t){return Et(t,Hc)}function hc(t){return Et(t,yv)}function ga(t){return Et(t,qc)}function YE(t){te(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;pv(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Nn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cx=41943040;class zt{static withCacheSize(e){return new zt(e,zt.DEFAULT_COLLECTION_PERCENTILE,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(t,e,n){const r=t.store(sr),i=t.store(ol),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},(d,f,p)=>(a++,p.delete()));s.push(l.next(()=>{te(a===1,47070,{batchId:n.batchId})}));const u=[];for(const d of n.mutations){const f=JR(e,d.key.path,n.batchId);s.push(i.delete(f)),u.push(d.key)}return L.waitFor(s).next(()=>u)}function jf(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw J(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zt.DEFAULT_COLLECTION_PERCENTILE=10,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zt.DEFAULT=new zt(cx,zt.DEFAULT_COLLECTION_PERCENTILE,zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zt.DISABLED=new zt(-1,0,0);class Lp{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){te(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Lp(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Mi(e).ee({index:co,range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ea(e),o=Mi(e);return o.add({}).next(a=>{te(typeof a=="number",49019);const l=new Sv(a,n,r,i),u=function(v,S,P){const N=P.baseMutations.map(I=>Nu(v.yt,I)),T=P.mutations.map(I=>Nu(v.yt,I));return{userId:S,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:N,mutations:T}}(this.serializer,this.userId,l),d=[];let f=new Se((p,v)=>oe(p.canonicalString(),v.canonicalString()));for(const p of i){const v=JR(this.userId,p.key.path,a);f=f.add(p.key.path.popLast()),d.push(o.put(u)),d.push(s.put(v,C4))}return f.forEach(p=>{d.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Xn[a]=l.keys()}),L.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return Mi(e).get(n).next(r=>r?(te(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),eo(this.serializer,r)):null)}er(e,n){return this.Xn[n]?L.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Mi(e).ee({index:co,range:i},(o,a,l)=>{a.userId===this.userId&&(te(a.batchId>=r,47524,{tr:r}),s=eo(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=ps;return Mi(e).ee({index:co,range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,ps],[this.userId,Number.POSITIVE_INFINITY]);return Mi(e).J(co,n).next(r=>r.map(i=>eo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Vh(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ea(e).ee({range:i},(o,a,l)=>{const[u,d,f]=o,p=xr(d);if(u===this.userId&&n.path.isEqual(p))return Mi(e).get(f).next(v=>{if(!v)throw J(61480,{nr:o,batchId:f});te(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:f}),s.push(eo(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(oe);const i=[];return n.forEach(s=>{const o=Vh(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ea(e).ee({range:a},(u,d,f)=>{const[p,v,S]=u,P=xr(v);p===this.userId&&s.path.isEqual(P)?r=r.add(S):f.done()});i.push(l)}),L.waitFor(i).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Vh(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Se(oe);return Ea(e).ee({range:o},(l,u,d)=>{const[f,p,v]=l,S=xr(p);f===this.userId&&r.isPrefixOf(S)?S.length===i&&(a=a.add(v)):d.done()}).next(()=>this.rr(e,a))}rr(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Mi(e).get(s).next(o=>{if(o===null)throw J(35274,{batchId:s});te(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(eo(this.serializer,o))}))}),L.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ux(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.ir(n.batchId)}),L.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return L.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ea(e).ee({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=xr(s[1]);i.push(l)}else a.done()}).next(()=>{te(i.length===0,56720,{sr:i.map(s=>s.canonicalString())})})})}containsKey(e,n){return dx(e,this.userId,n)}_r(e){return hx(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:ps,lastStreamToken:""})}}function dx(t,e,n){const r=Vh(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ea(t).ee({range:s,X:!0},(a,l,u)=>{const[d,f,p]=a;d===e&&f===i&&(o=!0),u.done()}).next(()=>o)}function Mi(t){return Et(t,sr)}function Ea(t){return Et(t,ol)}function hx(t){return Et(t,Tu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Do(0)}static cr(){return new Do(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next(n=>{const r=new Do(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(n=>re.fromTimestamp(new Ae(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.lr(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i)))}addTargetData(e,n){return this.Pr(e,n).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ya(e).delete(n.targetId)).next(()=>this.lr(e)).next(r=>(te(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return ya(e).ee((o,a)=>{const l=Rc(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>L.waitFor(s)).next(()=>i)}forEachTarget(e,n){return ya(e).ee((r,i)=>{const s=Rc(i);n(s)})}lr(e){return XE(e).get(Df).next(n=>(te(n!==null,2888),n))}hr(e,n){return XE(e).put(Df,n)}Pr(e,n){return ya(e).put(ox(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=xo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ya(e).ee({range:i,index:ZR},(o,a,l)=>{const u=Rc(a);td(n,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Qi(e);return n.forEach(o=>{const a=Gt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),L.waitFor(i)}removeMatchingKeys(e,n,r){const i=Qi(e);return L.forEach(n,s=>{const o=Gt(s.path);return L.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Qi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Qi(e);let s=ce();return i.ee({range:r,X:!0},(o,a,l)=>{const u=xr(o[1]),d=new G(u);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=Gt(n.path),i=IDBKeyRange.bound([r],[$R(r)],!1,!0);let s=0;return Qi(e).ee({index:gv,X:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}At(e,n){return ya(e).get(n).next(r=>r?Rc(r):null)}}function ya(t){return Et(t,al)}function XE(t){return Et(t,mo)}function Qi(t){return Et(t,ll)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="LruGarbageCollector",fx=1048576;function eT([t,e],[n,r]){const i=oe(t,n);return i===0?oe(e,r):i}class JF{constructor(e){this.Ir=e,this.buffer=new Se(eT),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();eT(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class px{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){B(ZE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){xs(n)?B(ZE,"Ignoring IndexedDB error during garbage collection: ",n):await Ss(n)}await this.Vr(3e5)})}}class XF{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return L.resolve(dn.ce);const r=new JF(n);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(JE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),JE):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),va()<=me.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function mx(t,e){return new XF(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e,n){this.db=e,this.garbageCollector=mx(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,(r,i)=>n(i))}addReference(e,n,r){return hh(e,r)}removeReference(e,n,r){return hh(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return hh(e,n)}br(e,n){return function(i,s){let o=!1;return hx(i).te(a=>dx(i,a,s).next(l=>(l&&(o=!0),L.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,a)=>{if(a<=n){const l=this.br(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,re.min()),Qi(e).delete(function(f){return[0,Gt(f.path)]}(o))))});i.push(l)}}).next(()=>L.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return hh(e,n)}Sr(e,n){const r=Qi(e);let i,s=dn.ce;return r.ee({index:gv},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==dn.ce&&n(new G(xr(i)),s),s=u,i=l):s=dn.ce}).next(()=>{s!==dn.ce&&n(new G(xr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function hh(t,e){return Qi(t).put(function(r,i){return{targetId:0,path:Gt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(){this.changes=new vi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ue.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Hs(e).put(r)}removeEntry(e,n,r){return Hs(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Mf(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Dr(e,r)))}getEntry(e,n){let r=Ue.newInvalidDocument(n);return Hs(e).ee({index:Mh,range:IDBKeyRange.only(fc(n))},(i,s)=>{r=this.Cr(n,s)}).next(()=>r)}vr(e,n){let r={size:0,document:Ue.newInvalidDocument(n)};return Hs(e).ee({index:Mh,range:IDBKeyRange.only(fc(n))},(i,s)=>{r={document:this.Cr(n,s),size:jf(s)}}).next(()=>r)}getEntries(e,n){let r=fn();return this.Fr(e,n,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Mr(e,n){let r=fn(),i=new Ve(G.comparator);return this.Fr(e,n,(s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,jf(o))}).next(()=>({documents:r,Or:i}))}Fr(e,n,r){if(n.isEmpty())return L.resolve();let i=new Se(rT);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(fc(i.first()),fc(i.last())),o=i.getIterator();let a=o.getNext();return Hs(e).ee({index:Mh,range:s},(l,u,d)=>{const f=G.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&rT(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.j(fc(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Mf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hs(e).J(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=fn();for(const f of u){const p=this.Cr(G.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);p.isFoundDocument()&&(rd(n,p)||i.has(p.key))&&(d=d.insert(p.key,p))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=fn();const o=nT(n,r),a=nT(n,Nn.max());return Hs(e).ee({index:XR,range:IDBKeyRange.bound(o,a,!0)},(l,u,d)=>{const f=this.Cr(G.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new tj(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return tT(e).get(yy).next(n=>(te(!!n,20021),n))}Dr(e,n){return tT(e).put(yy,n)}Cr(e,n){if(n){const r=UF(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(re.min())))return r}return Ue.newInvalidDocument(e)}}function yx(t){return new ej(t)}class tj extends gx{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new vi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Se((s,o)=>oe(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=FE(this.Nr.serializer,o);i=i.add(s.path.popLast());const u=jf(l);r+=u-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=FE(this.Nr.serializer,o.convertToNoDocument(re.min()));n.push(this.Nr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Nr.updateMetadata(e,r)),L.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next(r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next(({documents:r,Or:i})=>(i.forEach((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function tT(t){return Et(t,Au)}function Hs(t){return Et(t,Nf)}function fc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function nT(t,e){const n=e.documentKey.path.toArray();return[t,Mf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function rT(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=oe(n[s],r[s]),i)return i;return i=oe(n.length,r.length),i||(i=oe(n[n.length-2],r[r.length-2]),i||oe(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Kc(r.mutation,i,hn.empty(),Ae.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const i=Pr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ac();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Pr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=fn();const o=Wc(),a=function(){return Wc()}();return n.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof wi)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Kc(d.mutation,u,d.mutation.getFieldMask(),Ae.now())):o.set(u.key,hn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>a.set(u,new nj(d,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Wc();let i=new Ve((o,a)=>o-a),s=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||hn.empty();d=a.applyToLocalView(u,d),r.set(l,d);const f=(i.get(a.batchId)||ce()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,f=DS();d.forEach(p=>{if(!s.has(p)){const v=US(n.get(p),r.get(p));v!==null&&f.set(p,v),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Tv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):L.resolve(Pr());let a=rl,l=s;return o.next(u=>L.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?L.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ce())).next(d=>({batchId:a,changes:NS(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new G(n)).next(r=>{let i=Ac();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Ac();return this.indexManager.getCollectionParents(e,s).next(a=>L.forEach(a,l=>{const u=function(f,p){return new _i(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Ue.newInvalidDocument(d)))});let a=Ac();return o.forEach((l,u)=>{const d=s.get(l);d!==void 0&&Kc(d.mutation,u,hn.empty(),Ae.now()),rd(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return L.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:at(i.createTime)}}(n)),L.resolve()}getNamedQuery(e,n){return L.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(i){return{name:i.name,query:Dp(i.bundledQuery),readTime:at(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(){this.overlays=new Ve(G.comparator),this.qr=new Map}getOverlay(e,n){return L.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Pr();return L.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.St(e,n,s)}),L.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),L.resolve()}getOverlaysForCollection(e,n,r){const i=Pr(),s=n.length+1,o=new G(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return L.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ve((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=Pr(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=Pr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return L.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Pv(n,r));let s=this.qr.get(n);s===void 0&&(s=ce(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(){this.sessionToken=tt.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(){this.Qr=new Se(At.$r),this.Ur=new Se(At.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new At(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new At(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new G(new de([])),r=new At(n,e),i=new At(n,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new G(new de([])),r=new At(n,e),i=new At(n,e+1);let s=ce();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new At(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class At{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return G.comparator(e.key,n.key)||oe(e.Yr,n.Yr)}static Kr(e,n){return oe(e.Yr,n.Yr)||G.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Se(At.$r)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sv(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new At(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return L.resolve(o)}lookupMutationBatch(e,n){return L.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?ps:this.tr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new At(n,0),i=new At(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{const a=this.Xr(o.Yr);s.push(a)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(oe);return n.forEach(i=>{const s=new At(i,0),o=new At(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),L.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const o=new At(new G(s),0);let a=new Se(oe);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Yr)),!0)},o),L.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){te(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return L.forEach(n.mutations,i=>{const s=new At(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new At(n,0),i=this.Zr.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e){this.ri=e,this.docs=function(){return new Ve(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():Ue.newInvalidDocument(n))}getEntries(e,n){let r=fn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ue.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=fn();const o=n.path,a=new G(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||pv(GR(d),r)<=0||(i.has(d.key)||rd(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(e,n,r,i){J(9500)}ii(e,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new lj(this)}getSize(e){return L.resolve(this.size)}}class lj extends gx{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),L.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.persistence=e,this.si=new vi(n=>xo(n),td),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.oi=0,this._i=new Ov,this.targetCount=0,this.ai=Do.ur()}forEachTarget(e,n){return this.si.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),L.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Do(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,L.resolve()}updateTargetData(e,n){return this.Pr(n),L.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return L.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),L.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),L.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return L.resolve(r)}containsKey(e,n){return L.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,n){this.ui={},this.overlays={},this.ci=new dn(0),this.li=!1,this.li=!0,this.hi=new sj,this.referenceDelegate=e(this),this.Pi=new cj(this),this.indexManager=new KF,this.remoteDocumentCache=function(i){return new aj(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new sx(n),this.Ii=new rj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ij,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new oj(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){B("MemoryPersistence","Starting transaction:",e);const i=new uj(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,n){return L.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class uj extends KR{constructor(e){super(),this.currentSequenceNumber=e}}class Vp{constructor(e){this.persistence=e,this.Ri=new Ov,this.Vi=null}static mi(e){return new Vp(e)}get fi(){if(this.Vi)return this.Vi;throw J(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),L.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),L.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.fi,r=>{const i=G.fromPath(r);return this.gi(e,i).next(s=>{s||n.removeEntry(i,re.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return L.or([()=>L.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Uf{constructor(e,n){this.persistence=e,this.pi=new vi(r=>Gt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=mx(this,n)}static mi(e,n){return new Uf(e,n)}Ei(){}di(e){return L.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return L.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?L.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,s.removeEntry(o,re.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),L.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=jh(e.data.value)),n}br(e,n,r){return L.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return L.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e){this.serializer=e}k(e,n,r,i){const s=new Ep("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore(ed)}(e),function(l){l.createObjectStore(Tu,{keyPath:k4}),l.createObjectStore(sr,{keyPath:pE,autoIncrement:!0}).createIndex(co,mE,{unique:!0}),l.createObjectStore(ol)}(e),iT(e),function(l){l.createObjectStore(Ys)}(e));let o=L.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore(ll),l.deleteObjectStore(al),l.deleteObjectStore(mo)}(e),iT(e)),o=o.next(()=>function(l){const u=l.store(mo),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return u.put(Df,d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store(sr).J().next(f=>{l.deleteObjectStore(sr),l.createObjectStore(sr,{keyPath:pE,autoIncrement:!0}).createIndex(co,mE,{unique:!0});const p=u.store(sr),v=f.map(S=>p.put(S));return L.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore(cl,{keyPath:j4})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.yi(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore(Au)}(e),this.wi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.bi(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Di(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Tp,{keyPath:U4})})(e),function(l){l.createObjectStore(Ap,{keyPath:B4})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore(bp,{keyPath:K4});u.createIndex(vy,Q4,{unique:!1}),u.createIndex(nS,Y4,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore(Nf,{keyPath:N4});u.createIndex(Mh,D4),u.createIndex(XR,O4)}(e)).next(()=>this.Ci(e,s)).next(()=>e.deleteObjectStore(Ys))),r<14&&i>=14&&(o=o.next(()=>this.Fi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore(yv,{keyPath:$4,autoIncrement:!0}).createIndex(_y,z4,{unique:!1}),l.createObjectStore(qc,{keyPath:q4}).createIndex(eS,H4,{unique:!1}),l.createObjectStore(Hc,{keyPath:G4}).createIndex(tS,W4,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore(qc).clear()}).next(()=>{n.objectStore(Hc).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore(_v,{keyPath:J4})})(e)})),r<18&&i>=18&&sb()&&(o=o.next(()=>{n.objectStore(qc).clear()}).next(()=>{n.objectStore(Hc).clear()})),o}wi(e){let n=0;return e.store(Ys).ee((r,i)=>{n+=jf(i)}).next(()=>{const r={byteSize:n};return e.store(Au).put(yy,r)})}yi(e){const n=e.store(Tu),r=e.store(sr);return n.J().next(i=>L.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,ps],[s.userId,s.lastAcknowledgedBatchId]);return r.J(co,o).next(a=>L.forEach(a,l=>{te(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const u=eo(this.serializer,l);return ux(e,s.userId,u).next(()=>{})}))}))}Si(e){const n=e.store(ll),r=e.store(Ys);return e.store(mo).get(Df).next(i=>{const s=[];return r.ee((o,a)=>{const l=new de(o),u=function(f){return[0,Gt(f)]}(l);s.push(n.get(u).next(d=>d?L.resolve():(f=>n.put({targetId:0,path:Gt(f),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>L.waitFor(s))})}bi(e,n){e.createObjectStore(bu,{keyPath:F4});const r=n.store(bu),i=new Dv,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Gt(l)})}};return n.store(Ys).ee({X:!0},(o,a)=>{const l=new de(o);return s(l.popLast())}).next(()=>n.store(ol).ee({X:!0},([o,a,l],u)=>{const d=xr(a);return s(d.popLast())}))}Di(e){const n=e.store(al);return n.ee((r,i)=>{const s=Rc(i),o=ox(this.serializer,s);return n.put(o)})}Ci(e,n){const r=n.store(Ys),i=[];return r.ee((s,o)=>{const a=n.store(Nf),l=function(f){return f.document?new G(de.fromString(f.document.name).popFirst(5)):f.noDocument?G.fromSegments(f.noDocument.path):f.unknownDocument?G.fromSegments(f.unknownDocument.path):J(36783)}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>L.waitFor(i))}Fi(e,n){const r=n.store(sr),i=yx(this.serializer),s=new Lv(Vp.mi,this.serializer.yt);return r.J().next(o=>{const a=new Map;return o.forEach(l=>{let u=a.get(l.userId)??ce();eo(this.serializer,l).keys().forEach(d=>u=u.add(d)),a.set(l.userId,u)}),L.forEach(a,(l,u)=>{const d=new Rt(u),f=Op.wt(this.serializer,d),p=s.getIndexManager(d),v=Lp.wt(d,this.serializer,p,s.referenceDelegate);return new _x(i,v,f,p).recalculateAndSaveOverlaysForDocumentKeys(new wy(n,dn.ce),l).next()})})}}function iT(t){t.createObjectStore(ll,{keyPath:V4}).createIndex(gv,M4,{unique:!0}),t.createObjectStore(al,{keyPath:"targetId"}).createIndex(ZR,L4,{unique:!0}),t.createObjectStore(mo)}const Fi="IndexedDbPersistence",Zm=18e5,eg=5e3,tg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vx="main";class Vv{constructor(e,n,r,i,s,o,a,l,u,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=u,this.Oi=d,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=p=>Promise.resolve(),!Vv.v())throw new j(V.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ZF(this,i),this.$i=n+vx,this.serializer=new sx(l),this.Ui=new Dr(this.$i,this.Ni,new dj(this.serializer)),this.hi=new $F,this.Pi=new YF(this.referenceDelegate,this.serializer),this.remoteDocumentCache=yx(this.serializer),this.Ii=new BF,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,d===!1&&ot(Fi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new j(V.FAILED_PRECONDITION,tg);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new dn(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(n=>this.isPrimary&&!n?this.Zi(e).next(()=>!1):!!n&&this.Xi(e).next(()=>!0))).catch(e=>{if(xs(e))return B(Fi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return B(Fi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return pc(e).get(ha).next(n=>L.resolve(this.es(n)))}ts(e){return fh(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Zm)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Et(n,cl);return r.J().next(i=>{const s=this.ss(i,Zm),o=i.filter(a=>s.indexOf(a)===-1);return L.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?L.resolve(!0):pc(e).get(ha).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,eg)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new j(V.FAILED_PRECONDITION,tg);return!1}}return!(!this.networkEnabled||!this.inForeground)||fh(e).J().next(r=>this.ss(r,eg).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&B(Fi,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[ed,cl],e=>{const n=new wy(e,dn.ce);return this.Zi(n).next(()=>this.ts(n))}),this.Ui.close(),this.Ps()}ss(e,n){return e.filter(r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>fh(e).J().next(n=>this.ss(n,Zm).map(r=>r.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return Lp.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new QF(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Op.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){B(Fi,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===18?eF:l===17?oS:l===16?Z4:l===15?vv:l===14?sS:l===13?iS:l===12?X4:l===11?rS:void J(60245)}(this.Ni);let o;return this.Ui.runTransaction(e,i,s,a=>(o=new wy(a,this.ci?this.ci.next():dn.ce),n==="readwrite-primary"?this.Hi(o).next(l=>!!l||this.Yi(o)).next(l=>{if(!l)throw ot(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new j(V.FAILED_PRECONDITION,WR);return r(o)}).next(l=>this.Xi(o).next(()=>l)):this.Is(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Is(e){return pc(e).get(ha).next(n=>{if(n!==null&&this.rs(n.leaseTimestampMs,eg)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new j(V.FAILED_PRECONDITION,tg)})}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return pc(e).put(ha,n)}static v(){return Dr.v()}Zi(e){const n=pc(e);return n.get(ha).next(r=>this.es(r)?(B(Fi,"Releasing primary lease."),n.delete(ha)):L.resolve())}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(ot(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const n=/(?:Version|Mobile)\/1[456]/;ib()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var n;try{const r=((n=this.Ki)==null?void 0:n.getItem(this._s(e)))!==null;return B(Fi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ot(Fi,"Failed to get zombied client id.",r),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){ot("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function pc(t){return Et(t,ed)}function fh(t){return Et(t,cl)}function Mv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=ce(),i=ce();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Fv(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return ib()?8:QR(wt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new hj;return this.Ss(e,n,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>s.result)}bs(e,n,r,i){return r.documentReadCount<this.fs?(va()<=me.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",wa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),L.resolve()):(va()<=me.DEBUG&&B("QueryEngine","Query:",wa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(va()<=me.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",wa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wt(n))):L.resolve())}ys(e,n){if(xE(n))return L.resolve(null);let r=Wt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Vf(n,null,"F"),r=Wt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ce(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Vf(n,null,"F")):this.vs(e,u,n,l)}))})))}ws(e,n,r,i){return xE(n)||i.isEqual(re.min())?L.resolve(null):this.ps.getDocuments(e,r).next(s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?L.resolve(null):(va()<=me.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wa(n)),this.vs(e,o,n,HR(i,rl)).next(a=>a))})}Ds(e,n){let r=new Se(kS(e));return n.forEach((i,s)=>{rd(e,s)&&(r=r.add(s))}),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return va()<=me.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",wa(n)),this.ps.getDocumentsMatchingQuery(e,n,Nn.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="LocalStore",fj=3e8;class pj{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new Ve(oe),this.xs=new vi(s=>xo(s),td),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _x(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function Ix(t,e,n,r){return new pj(t,e,n,r)}async function Ex(t,e){const n=W(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ce();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function mj(t,e){const n=W(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const f=u.batch,p=f.keys();let v=L.resolve();return p.forEach(S=>{v=v.next(()=>d.getEntry(l,S)).next(P=>{const N=u.docVersions.get(S);te(N!==null,48541),P.version.compareTo(N)<0&&(f.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),d.addEntry(P)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ce();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Tx(t){const e=W(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function gj(t,e){const n=W(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach((d,f)=>{const p=i.get(f);if(!p)return;a.push(n.Pi.removeMatchingKeys(s,d.removedDocuments,f).next(()=>n.Pi.addMatchingKeys(s,d.addedDocuments,f)));let v=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(tt.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),i=i.insert(f,v),function(P,N,T){return P.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=fj?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,v,d)&&a.push(n.Pi.updateTargetData(s,v))});let l=fn(),u=ce();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(Ax(s,o,e.documentUpdates).next(d=>{l=d.ks,u=d.qs})),!r.isEqual(re.min())){const d=n.Pi.getLastRemoteSnapshotVersion(s).next(f=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return L.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.Ms=i,s))}function Ax(t,e,n){let r=ce(),i=ce();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=fn();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(re.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):B(jv,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{ks:o,qs:i}})}function yj(t,e){const n=W(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ps),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gl(t,e){const n=W(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Pi.getTargetData(r,e).next(s=>s?(i=s,L.resolve(i)):n.Pi.allocateTargetId(r).next(o=>(i=new Zr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function yl(t,e,n){const r=W(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!xs(o))throw o;B(jv,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Bf(t,e,n){const r=W(t);let i=re.min(),s=ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const f=W(l),p=f.xs.get(d);return p!==void 0?L.resolve(f.Ms.get(p)):f.Pi.getTargetData(u,d)}(r,o,Wt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:re.min(),n?s:ce())).next(a=>(Sx(r,PS(e),a),{documents:a,Qs:s})))}function bx(t,e){const n=W(t),r=W(n.Pi),i=n.Ms.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.At(s,e).next(o=>o?o.target:null))}function Rx(t,e){const n=W(t),r=n.Os.get(e)||re.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.Ns.getAllFromCollectionGroup(i,e,HR(r,rl),Number.MAX_SAFE_INTEGER)).then(i=>(Sx(n,e,i),i))}function Sx(t,e,n){let r=t.Os.get(e)||re.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Os.set(e,r)}async function _j(t,e,n,r){const i=W(t);let s=ce(),o=fn();for(const u of n){const d=e.$s(u.metadata.name);u.document&&(s=s.add(d));const f=e.Us(u);f.setReadTime(e.Ks(u.metadata.readTime)),o=o.insert(d,f)}const a=i.Ns.newChangeBuffer({trackRemovals:!0}),l=await gl(i,function(d){return Wt(kl(de.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>Ax(u,a,o).next(d=>(a.apply(u),d)).next(d=>i.Pi.removeMatchingKeysForTargetId(u,l.targetId).next(()=>i.Pi.addMatchingKeys(u,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,d.ks,d.qs)).next(()=>d.ks)))}async function vj(t,e,n=ce()){const r=await gl(t,Wt(Dp(e.bundledQuery))),i=W(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=at(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ii.saveNamedQuery(s,e);const a=r.withResumeToken(tt.EMPTY_BYTE_STRING,o);return i.Ms=i.Ms.insert(a.targetId,a),i.Pi.updateTargetData(s,a).next(()=>i.Pi.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Pi.addMatchingKeys(s,n,r.targetId)).next(()=>i.Ii.saveNamedQuery(s,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx="firestore_clients";function sT(t,e){return`${xx}_${t}_${e}`}const Px="firestore_mutations";function oT(t,e,n){let r=`${Px}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const kx="firestore_targets";function ng(t,e){return`${kx}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="SharedClientState";class $f{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ws(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new j(i.error.code,i.error.message))),o?new $f(e,n,i.state,s):(ot(br,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ws(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new j(r.error.code,r.error.message))),s?new Yc(e,r.state,i):(ot(br,`Failed to parse target state for ID '${e}': ${n}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ws(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Av();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=YR(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new zf(e,s):(ot(br,`Failed to parse client data for instance '${e}': ${n}`),null)}}class Uv{constructor(e,n){this.clientId=e,this.onlineState=n}static Ws(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Uv(n.clientId,n.onlineState):(ot(br,`Failed to parse online state: ${e}`),null)}}class Oy{constructor(){this.activeTargetIds=Av()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rg{constructor(e,n,r,i,s){this.window=e,this.Mi=n,this.persistenceKey=r,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Ve(oe),this.started=!1,this.Xs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.eo=sT(this.persistenceKey,this.Js),this.no=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Oy),this.ro=new RegExp(`^${xx}_${o}_([^_]*)$`),this.io=new RegExp(`^${Px}_${o}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${kx}_${o}_(\\d+)$`),this.oo=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this._o=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const i=this.getItem(sT(this.persistenceKey,r));if(i){const s=zf.Ws(r,i);s&&(this.Zs=this.Zs.insert(s.clientId,s))}}this.ao();const n=this.storage.getItem(this.oo);if(n){const r=this.uo(n);r&&this.co(r)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let n=!1;return this.Zs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,n,r){this.ho(e,n,r),this.Po(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(ng(this.persistenceKey,e));if(i){const s=Yc.Ws(e,i);s&&(r=s.state)}}return n&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ng(this.persistenceKey,e))}updateQueryState(e,n,r){this.Io(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Po(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return B(br,"READ",e,n),n}setItem(e,n){B(br,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){B(br,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const n=e;if(n.storageArea===this.storage){if(B(br,"EVENT",n.key,n.newValue),n.key===this.eo)return void ot("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.ro.test(n.key)){if(n.newValue==null){const r=this.Ro(n.key);return this.Vo(r,null)}{const r=this.mo(n.key,n.newValue);if(r)return this.Vo(r.clientId,r)}}else if(this.io.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(this.so.test(n.key)){if(n.newValue!==null){const r=this.yo(n.key,n.newValue);if(r)return this.wo(r)}}else if(n.key===this.oo){if(n.newValue!==null){const r=this.uo(n.newValue);if(r)return this.co(r)}}else if(n.key===this.no){const r=function(s){let o=dn.ce;if(s!=null)try{const a=JSON.parse(s);te(typeof a=="number",30636,{So:s}),o=a}catch(a){ot(br,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==dn.ce&&this.sequenceNumberHandler(r)}else if(n.key===this._o){const r=this.bo(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Do(i)))}}}else this.Xs.push(n)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,n,r){const i=new $f(this.currentUser,e,n,r),s=oT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Gs())}Po(e){const n=oT(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Eo(e){const n={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(n))}Io(e,n,r){const i=ng(this.persistenceKey,e),s=new Yc(e,n,r);this.setItem(i,s.Gs())}Ao(e){const n=JSON.stringify(Array.from(e));this.setItem(this._o,n)}Ro(e){const n=this.ro.exec(e);return n?n[1]:null}mo(e,n){const r=this.Ro(e);return zf.Ws(r,n)}fo(e,n){const r=this.io.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return $f.Ws(new Rt(s),i,n)}yo(e,n){const r=this.so.exec(e),i=Number(r[1]);return Yc.Ws(i,n)}uo(e){return Uv.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);B(br,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,n){const r=n?this.Zs.insert(e,n):this.Zs.remove(e),i=this.lo(this.Zs),s=this.lo(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Fo(o,a).then(()=>{this.Zs=r})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let n=Av();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class Cx{constructor(){this.Mo=new Oy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Oy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT="ConnectivityMonitor";class lT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){B(aT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){B(aT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ph=null;function Ly(){return ph===null?ph=function(){return 268435456+Math.round(2147483648*Math.random())}():ph++,"0x"+ph.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig="RestConnection",Ij={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ej{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Su?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Ly(),a=this.zo(e,n.toUriEncodedString());B(ig,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(a),d=pi(u);return this.Jo(e,a,l,r,d).then(f=>(B(ig,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Kn(ig,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,n){const r=Ij[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $t="WebChannelConnection";class Aj extends Ej{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Ly();return new Promise((a,l)=>{const u=new LR;u.setWithCredentials(!0),u.listenOnce(VR.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Lh.NO_ERROR:const f=u.getResponseJson();B($t,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Lh.TIMEOUT:B($t,`RPC '${e}' ${o} timed out`),l(new j(V.DEADLINE_EXCEEDED,"Request time out"));break;case Lh.HTTP_ERROR:const p=u.getStatus();if(B($t,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const S=v==null?void 0:v.error;if(S&&S.status&&S.message){const P=function(T){const I=T.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(I)>=0?I:V.UNKNOWN}(S.status);l(new j(P,S.message))}else l(new j(V.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new j(V.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{B($t,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);B($t,`RPC '${e}' ${o} sending request:`,i),u.send(n,"POST",d,r,15)})}T_(e,n,r){const i=Ly(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=jR(),a=FR(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");B($t,`Creating RPC '${e}' stream ${i}: ${d}`,l);const f=o.createWebChannel(d,l);this.I_(f);let p=!1,v=!1;const S=new Tj({Yo:N=>{v?B($t,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(p||(B($t,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),B($t,`RPC '${e}' stream ${i} sending:`,N),f.send(N))},Zo:()=>f.close()}),P=(N,T,I)=>{N.listen(T,b=>{try{I(b)}catch(M){setTimeout(()=>{throw M},0)}})};return P(f,Tc.EventType.OPEN,()=>{v||(B($t,`RPC '${e}' stream ${i} transport opened.`),S.o_())}),P(f,Tc.EventType.CLOSE,()=>{v||(v=!0,B($t,`RPC '${e}' stream ${i} transport closed`),S.a_(),this.E_(f))}),P(f,Tc.EventType.ERROR,N=>{v||(v=!0,Kn($t,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),S.a_(new j(V.UNAVAILABLE,"The operation could not be completed")))}),P(f,Tc.EventType.MESSAGE,N=>{var T;if(!v){const I=N.data[0];te(!!I,16349);const b=I,M=(b==null?void 0:b.error)||((T=b[0])==null?void 0:T.error);if(M){B($t,`RPC '${e}' stream ${i} received error:`,M);const $=M.status;let z=function(R){const E=dt[R];if(E!==void 0)return qS(E)}($),A=M.message;z===void 0&&(z=V.INTERNAL,A="Unknown error status: "+$+" with message "+M.message),v=!0,S.a_(new j(z,A)),f.close()}else B($t,`RPC '${e}' stream ${i} received:`,I),S.u_(I)}}),P(a,MR.STAT_EVENT,N=>{N.stat===hy.PROXY?B($t,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===hy.NOPROXY&&B($t,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.__()},0),S}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(){return typeof window<"u"?window:null}function qh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t){return new kF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&B("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="PersistentStream";class Dx{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Bv(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(ot(n.toString()),ot("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new j(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return B(cT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(B(cT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class bj extends Dx{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=DF(this.serializer,e),r=function(s){if(!("targetChange"in s))return re.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?at(o.readTime):re.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Py(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Of(l)?{documents:ZS(s,l)}:{query:Np(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=KS(s,o.resumeToken);const u=Sy(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(re.min())>0){a.readTime=ml(s,o.snapshotVersion.toTimestamp());const u=Sy(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=LF(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Py(this.serializer),n.removeTarget=e,this.q_(n)}}class Rj extends Dx{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=OF(e.writeResults,e.commitTime),r=at(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Py(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Nu(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{}class xj extends Sj{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new j(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,xy(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new j(V.UNKNOWN,s.toString())})}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,xy(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new j(V.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Pj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ot(n),this.aa=!1):B("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo="RemoteStore";class kj{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{ks(this)&&(B(Oo,"Restarting streams for network reachability change."),await async function(l){const u=W(l);u.Ea.add(4),await Dl(u),u.Ra.set("Unknown"),u.Ea.delete(4),await ad(u)}(this))})}),this.Ra=new Pj(r,i)}}async function ad(t){if(ks(t))for(const e of t.da)await e(!0)}async function Dl(t){for(const e of t.da)await e(!1)}function Mp(t,e){const n=W(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),qv(n)?zv(n):Ll(n).O_()&&$v(n,e))}function _l(t,e){const n=W(t),r=Ll(n);n.Ia.delete(e),r.O_()&&Ox(n,e),n.Ia.size===0&&(r.O_()?r.L_():ks(n)&&n.Ra.set("Unknown"))}function $v(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ll(t).Y_(e)}function Ox(t,e){t.Va.Ue(e),Ll(t).Z_(e)}function zv(t){t.Va=new RF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ll(t).start(),t.Ra.ua()}function qv(t){return ks(t)&&!Ll(t).x_()&&t.Ia.size>0}function ks(t){return W(t).Ea.size===0}function Lx(t){t.Va=void 0}async function Cj(t){t.Ra.set("Online")}async function Nj(t){t.Ia.forEach((e,n)=>{$v(t,e)})}async function Dj(t,e){Lx(t),qv(t)?(t.Ra.ha(e),zv(t)):t.Ra.set("Unknown")}async function Oj(t,e,n){if(t.Ra.set("Online"),e instanceof WS&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(r){B(Oo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await qf(t,r)}else if(e instanceof $h?t.Va.Ze(e):e instanceof GS?t.Va.st(e):t.Va.tt(e),!n.isEqual(re.min()))try{const r=await Tx(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.Ia.get(u);d&&s.Ia.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.Ia.get(l);if(!d)return;s.Ia.set(l,d.withResumeToken(tt.EMPTY_BYTE_STRING,d.snapshotVersion)),Ox(s,l);const f=new Zr(d.target,l,u,d.sequenceNumber);$v(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){B(Oo,"Failed to raise snapshot:",r),await qf(t,r)}}async function qf(t,e,n){if(!xs(e))throw e;t.Ea.add(1),await Dl(t),t.Ra.set("Offline"),n||(n=()=>Tx(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{B(Oo,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ad(t)})}function Vx(t,e){return e().catch(n=>qf(t,n,e))}async function Ol(t){const e=W(t),n=Is(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ps;for(;Lj(e);)try{const i=await yj(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,Vj(e,i)}catch(i){await qf(e,i)}Mx(e)&&Fx(e)}function Lj(t){return ks(t)&&t.Ta.length<10}function Vj(t,e){t.Ta.push(e);const n=Is(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Mx(t){return ks(t)&&!Is(t).x_()&&t.Ta.length>0}function Fx(t){Is(t).start()}async function Mj(t){Is(t).ra()}async function Fj(t){const e=Is(t);for(const n of t.Ta)e.ea(n.mutations)}async function jj(t,e,n){const r=t.Ta.shift(),i=xv.from(r,e,n);await Vx(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ol(t)}async function Uj(t,e){e&&Is(t).X_&&await async function(r,i){if(function(o){return zS(o)&&o!==V.ABORTED}(i.code)){const s=r.Ta.shift();Is(r).B_(),await Vx(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ol(r)}}(t,e),Mx(t)&&Fx(t)}async function uT(t,e){const n=W(t);n.asyncQueue.verifyOperationInProgress(),B(Oo,"RemoteStore received new credentials");const r=ks(n);n.Ea.add(3),await Dl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ad(n)}async function Vy(t,e){const n=W(t);e?(n.Ea.delete(2),await ad(n)):e||(n.Ea.add(2),await Dl(n),n.Ra.set("Unknown"))}function Ll(t){return t.ma||(t.ma=function(n,r,i){const s=W(n);return s.sa(),new bj(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:Cj.bind(null,t),t_:Nj.bind(null,t),r_:Dj.bind(null,t),H_:Oj.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),qv(t)?zv(t):t.Ra.set("Unknown")):(await t.ma.stop(),Lx(t))})),t.ma}function Is(t){return t.fa||(t.fa=function(n,r,i){const s=W(n);return s.sa(),new Rj(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Mj.bind(null,t),r_:Uj.bind(null,t),ta:Fj.bind(null,t),na:jj.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ol(t)):(await t.fa.stop(),t.Ta.length>0&&(B(Oo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Pt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Hv(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vl(t,e){if(ot("AsyncQueue",`${e}: ${t}`),xs(t))return new j(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{static emptySet(e){return new go(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=Ac(),this.sortedSet=new Ve(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof go)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new go;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(){this.ga=new Ve(G.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):J(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Lo{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Lo(e,n,go.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class $j{constructor(){this.queries=hT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=W(n),s=i.queries;i.queries=hT(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new j(V.ABORTED,"Firestore shutting down"))}}function hT(){return new vi(t=>xS(t),nd)}async function Gv(t,e){const n=W(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new Bj,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Vl(o,`Initialization of query '${wa(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&Kv(n)}async function Wv(t,e){const n=W(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function zj(t,e){const n=W(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&Kv(n)}function qj(t,e,n){const r=W(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function Kv(t){t.Ca.forEach(e=>{e.next()})}var My,fT;(fT=My||(My={})).Ma="default",fT.Cache="cache";class Qv{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Lo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==My.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,n){this.Qa=e,this.byteLength=n}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e){this.serializer=e}$s(e){return Or(this.serializer,e)}Us(e){return e.metadata.exists?Cp(this.serializer,e.document,!1):Ue.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return at(e)}}class Yv{constructor(e,n){this.Ua=e,this.serializer=n,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=Ux(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++n;const r=de.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,{...this.progress}):null}za(e){const n=new Map,r=new pT(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.$s(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||ce()).add(s);n.set(o,a)}}return n}async ja(e){const n=await _j(e,new pT(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const i of this.Ka)await vj(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:n}}}function Ux(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e){this.key=e}}class $x{constructor(e){this.key=e}}class zx{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ce(),this.mutatedKeys=ce(),this.eu=kS(e),this.tu=new go(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new dT,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const p=i.get(d),v=rd(this.query,f)?f:null,S=!!p&&this.mutatedKeys.has(p.key),P=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let N=!1;p&&v?p.data.isEqual(v.data)?S!==P&&(r.track({type:3,doc:v}),N=!0):this.su(p,v)||(r.track({type:2,doc:v}),N=!0,(l&&this.eu(v,l)>0||u&&this.eu(v,u)<0)&&(a=!0)):!p&&v?(r.track({type:0,doc:v}),N=!0):p&&!v&&(r.track({type:1,doc:p}),N=!0,(l||u)&&(a=!0)),N&&(v?(o=o.add(v),s=P?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,f)=>function(v,S){const P=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Rt:N})}};return P(v)-P(S)}(d.type,f.type)||this.eu(d.doc,f.doc)),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new Lo(this.query,e.tu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new dT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ce(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new $x(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new Bx(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=ce();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Lo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Cs="SyncEngine";class Hj{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Gj{constructor(e){this.key=e,this.hu=!1}}class Wj{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new vi(a=>xS(a),nd),this.Iu=new Map,this.Eu=new Set,this.du=new Ve(G.comparator),this.Au=new Map,this.Ru=new Ov,this.Vu={},this.mu=new Map,this.fu=Do.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Kj(t,e,n=!0){const r=Fp(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await qx(r,e,n,!0),i}async function Qj(t,e){const n=Fp(t);await qx(n,e,!0,!1)}async function qx(t,e,n,r){const i=await gl(t.localStore,Wt(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Jv(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Mp(t.remoteStore,i),a}async function Jv(t,e,n,r,i){t.pu=(f,p,v)=>async function(P,N,T,I){let b=N.view.ru(T);b.Cs&&(b=await Bf(P.localStore,N.query,!1).then(({documents:A})=>N.view.ru(A,b)));const M=I&&I.targetChanges.get(N.targetId),$=I&&I.targetMismatches.get(N.targetId)!=null,z=N.view.applyChanges(b,P.isPrimaryClient,M,$);return Fy(P,N.targetId,z.au),z.snapshot}(t,f,p,v);const s=await Bf(t.localStore,e,!0),o=new zx(e,s.Qs),a=o.ru(s.documents),l=od.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);Fy(t,n,u.au);const d=new Hj(e,n,o);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function Yj(t,e,n){const r=W(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!nd(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await yl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&_l(r.remoteStore,i.targetId),vl(r,i.targetId)}).catch(Ss)):(vl(r,i.targetId),await yl(r.localStore,i.targetId,!0))}async function Jj(t,e){const n=W(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),_l(n.remoteStore,r.targetId))}async function Xj(t,e,n){const r=tw(t);try{const i=await function(o,a){const l=W(o),u=Ae.now(),d=a.reduce((v,S)=>v.add(S.key),ce());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let S=fn(),P=ce();return l.Ns.getEntries(v,d).next(N=>{S=N,S.forEach((T,I)=>{I.isValidDocument()||(P=P.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,S)).next(N=>{f=N;const T=[];for(const I of a){const b=TF(I,f.get(I.key).overlayedDocument);b!=null&&T.push(new wi(I.key,b,yS(b.value.mapValue),Ke.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,T,a)}).next(N=>{p=N;const T=N.applyToLocalDocumentSet(f,P);return l.documentOverlayCache.saveOverlays(v,N.batchId,T)})}).then(()=>({batchId:p.batchId,changes:NS(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new Ve(oe)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u}(r,i.batchId,n),await Ii(r,i.changes),await Ol(r.remoteStore)}catch(i){const s=Vl(i,"Failed to persist write");n.reject(s)}}async function Hx(t,e){const n=W(t);try{const r=await gj(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?te(o.hu,14607):i.removedDocuments.size>0&&(te(o.hu,42227),o.hu=!1))}),await Ii(n,r,e)}catch(r){await Ss(r)}}function mT(t,e,n){const r=W(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=W(o);l.onlineState=a;let u=!1;l.queries.forEach((d,f)=>{for(const p of f.Sa)p.va(a)&&(u=!0)}),u&&Kv(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Zj(t,e,n){const r=W(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new Ve(G.comparator);o=o.insert(s,Ue.newNoDocument(s,re.min()));const a=ce().add(s),l=new sd(re.min(),new Map,new Ve(oe),o,a);await Hx(r,l),r.du=r.du.remove(s),r.Au.delete(e),ew(r)}else await yl(r.localStore,e,!1).then(()=>vl(r,e,n)).catch(Ss)}async function e3(t,e){const n=W(t),r=e.batch.batchId;try{const i=await mj(n.localStore,e);Zv(n,r,null),Xv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ii(n,i)}catch(i){await Ss(i)}}async function t3(t,e,n){const r=W(t);try{const i=await function(o,a){const l=W(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(te(f!==null,37113),d=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);Zv(r,e,n),Xv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ii(r,i)}catch(i){await Ss(i)}}async function n3(t,e){const n=W(t);ks(n.remoteStore)||B(Cs,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=W(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(n.localStore);if(r===ps)return void e.resolve();const i=n.mu.get(r)||[];i.push(e),n.mu.set(r,i)}catch(r){const i=Vl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Xv(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Zv(t,e,n){const r=W(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function vl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||Gx(t,r)})}function Gx(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(_l(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),ew(t))}function Fy(t,e,n){for(const r of n)r instanceof Bx?(t.Ru.addReference(r.key,e),r3(t,r)):r instanceof $x?(B(Cs,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Gx(t,r.key)):J(19791,{wu:r})}function r3(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(B(Cs,"New document in limbo: "+n),t.Eu.add(r),ew(t))}function ew(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new G(de.fromString(e)),r=t.fu.next();t.Au.set(r,new Gj(n)),t.du=t.du.insert(n,r),Mp(t.remoteStore,new Zr(Wt(kl(n.path)),r,"TargetPurposeLimboResolution",dn.ce))}}async function Ii(t,e,n){const r=W(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){i.push(u);const f=Fv.As(l.targetId,u);s.push(f)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(l,u){const d=W(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>L.forEach(u,p=>L.forEach(p.Es,v=>d.persistence.referenceDelegate.addReference(f,p.targetId,v)).next(()=>L.forEach(p.ds,v=>d.persistence.referenceDelegate.removeReference(f,p.targetId,v)))))}catch(f){if(!xs(f))throw f;B(jv,"Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const v=d.Ms.get(p),S=v.snapshotVersion,P=v.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(p,P)}}}(r.localStore,s))}async function i3(t,e){const n=W(t);if(!n.currentUser.isEqual(e)){B(Cs,"User change. New user:",e.toKey());const r=await Ex(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new j(V.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ii(n,r.Ls)}}function s3(t,e){const n=W(t),r=n.Au.get(e);if(r&&r.hu)return ce().add(r.key);{let i=ce();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}async function o3(t,e){const n=W(t),r=await Bf(n.localStore,e.query,!0),i=e.view.cu(r);return n.isPrimaryClient&&Fy(n,e.targetId,i.au),i}async function a3(t,e){const n=W(t);return Rx(n.localStore,e).then(r=>Ii(n,r))}async function l3(t,e,n,r){const i=W(t),s=await function(a,l){const u=W(a),d=W(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.er(f,l).next(p=>p?u.localDocuments.getDocuments(f,p):L.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Ol(i.remoteStore):n==="acknowledged"||n==="rejected"?(Zv(i,e,r||null),Xv(i,e),function(a,l){W(W(a).mutationQueue).ir(l)}(i.localStore,e)):J(6720,"Unknown batchState",{Su:n}),await Ii(i,s)):B(Cs,"Cannot apply mutation batch with id: "+e)}async function c3(t,e){const n=W(t);if(Fp(n),tw(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await gT(n,r.toArray());n.gu=!0,await Vy(n.remoteStore,!0);for(const s of i)Mp(n.remoteStore,s)}else if(e===!1&&n.gu!==!1){const r=[];let i=Promise.resolve();n.Iu.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(vl(n,o),yl(n.localStore,o,!0))),_l(n.remoteStore,o)}),await i,await gT(n,r),function(o){const a=W(o);a.Au.forEach((l,u)=>{_l(a.remoteStore,u)}),a.Ru.Jr(),a.Au=new Map,a.du=new Ve(G.comparator)}(n),n.gu=!1,await Vy(n.remoteStore,!1)}}async function gT(t,e,n){const r=W(t),i=[],s=[];for(const o of e){let a;const l=r.Iu.get(o);if(l&&l.length!==0){a=await gl(r.localStore,Wt(l[0]));for(const u of l){const d=r.Tu.get(u),f=await o3(r,d);f.snapshot&&s.push(f.snapshot)}}else{const u=await bx(r.localStore,o);a=await gl(r.localStore,u),await Jv(r,Wx(u),o,!1,a.resumeToken)}i.push(a)}return r.Pu.H_(s),i}function Wx(t){return bS(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function u3(t){return function(n){return W(W(n).persistence).Ts()}(W(t).localStore)}async function d3(t,e,n,r){const i=W(t);if(i.gu)return void B(Cs,"Ignoring unexpected query state notification.");const s=i.Iu.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await Rx(i.localStore,PS(s[0])),a=sd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",tt.EMPTY_BYTE_STRING);await Ii(i,o,a);break}case"rejected":await yl(i.localStore,e,!0),vl(i,e,r);break;default:J(64155,n)}}async function h3(t,e,n){const r=Fp(t);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){B(Cs,"Adding an already active target "+i);continue}const s=await bx(r.localStore,i),o=await gl(r.localStore,s);await Jv(r,Wx(s),o.targetId,!1,o.resumeToken),Mp(r.remoteStore,o)}for(const i of n)r.Iu.has(i)&&await yl(r.localStore,i,!1).then(()=>{_l(r.remoteStore,i),vl(r,i)}).catch(Ss)}}function Fp(t){const e=W(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=s3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Zj.bind(null,e),e.Pu.H_=zj.bind(null,e.eventManager),e.Pu.yu=qj.bind(null,e.eventManager),e}function tw(t){const e=W(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t3.bind(null,e),e}function f3(t,e,n){const r=W(t);(async function(s,o,a){try{const l=await o.getMetadata();if(await function(v,S){const P=W(v),N=at(S.createTime);return P.persistence.runTransaction("hasNewerBundle","readonly",T=>P.Ii.getBundleMetadata(T,S.id)).then(T=>!!T&&T.createTime.compareTo(N)>=0)}(s.localStore,l))return await o.close(),a._completeWith(function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(Ux(l));const u=new Yv(l,o.serializer);let d=await o.bu();for(;d;){const p=await u.Ga(d);p&&a._updateProgress(p),d=await o.bu()}const f=await u.ja(s.localStore);return await Ii(s,f.Ha,void 0),await function(v,S){const P=W(v);return P.persistence.runTransaction("Save bundle","readwrite",N=>P.Ii.saveBundleMetadata(N,S))}(s.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Ja)}catch(l){return Kn(Cs,`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class wl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Ix(this.persistence,new wx,e.initialUser,this.serializer)}Cu(e){return new Lv(Vp.mi,this.serializer)}Du(e){return new Cx}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wl.provider={build:()=>new wl};class nw extends wl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){te(this.persistence.referenceDelegate instanceof Uf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new px(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?zt.withCacheSize(this.cacheSizeBytes):zt.DEFAULT;return new Lv(r=>Uf.mi(r,n),this.serializer)}}class rw extends wl{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await tw(this.xu.syncEngine),await Ol(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return Ix(this.persistence,new wx,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new px(r,e.asyncQueue,n)}Mu(e,n){const r=new x4(n,this.persistence);return new S4(e.asyncQueue,r)}Cu(e){const n=Mv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?zt.withCacheSize(this.cacheSizeBytes):zt.DEFAULT;return new Vv(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Nx(),qh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Cx}}class Kx extends rw{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof rg&&(this.sharedClientState.syncEngine={Co:l3.bind(null,n),vo:d3.bind(null,n),Fo:h3.bind(null,n),Ts:u3.bind(null,n),Do:a3.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await c3(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=Nx();if(!rg.v(n))throw new j(V.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Mv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new rg(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Es{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>mT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=i3.bind(null,this.syncEngine),await Vy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $j}()}createDatastore(e){const n=qo(e.databaseInfo.databaseId),r=function(s){return new Aj(s)}(e.databaseInfo);return function(s,o,a,l){return new xj(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new kj(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>mT(this.syncEngine,n,0),function(){return lT.v()?new lT:new wj}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,d){const f=new Wj(i,s,o,a,l,u);return d&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=W(i);B(Oo,"RemoteStore shutting down."),s.Ea.add(5),await Dl(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Es.provider={build:()=>new Es};function yT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ot("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(e,n){this.Bu=e,this.serializer=n,this.metadata=new Pt,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(r=>{r&&r.$a()?this.metadata.resolve(r.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Qa)}`))},r=>this.metadata.reject(r))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const n=this.Lu.decode(e),r=Number(n);isNaN(r)&&this.Qu(`length string (${n}) is not valid number`);const i=await this.$u(r);return new jx(JSON.parse(i),e.length+r)}Uu(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const n=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(e,n){this.bundleData=e,this.serializer=n,this.cursor=0,this.elements=[];let r=this.bu();if(!r||!r.$a())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r==null?void 0:r.Qa)}`);this.metadata=r;do r=this.bu(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),n=this.$u(e);return new jx(JSON.parse(n),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new j(V.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let n=this.cursor;for(;n<this.bundleData.length;){if(this.bundleData[n]==="{"){if(n===e)throw new Error("First character is a bracket and not a number");return this.cursor=n,Number(this.bundleData.slice(e,n))}n++}throw new Error("Reached the end of bundle when more is expected.")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new j(V.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const o=W(i),a={documents:s.map(f=>Cu(o.serializer,f))},l=await o.Ho("BatchGetDocuments",o.serializer.databaseId,de.emptyPath(),a,s.length),u=new Map;l.forEach(f=>{const p=NF(o.serializer,f);u.set(p.key.toString(),p)});const d=[];return s.forEach(f=>{const p=u.get(f.toString());te(!!p,55234,{key:f}),d.push(p)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Nl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=G.fromPath(r);this.mutations.push(new Rv(i,this.precondition(i)))}),await async function(r,i){const s=W(r),o={writes:i.map(a=>Nu(s.serializer,a))};await s.Go("Commit",s.serializer.databaseId,de.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw J(50498,{Gu:e.constructor.name});n=re.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new j(V.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(re.min())?Ke.exists(!1):Ke.updateTime(n):Ke.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(re.min()))throw new j(V.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ke.updateTime(n)}return Ke.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new Bv(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new g3(this.datastore),n=this.Hu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Yu(i)}))}).catch(r=>{this.Yu(r)})})}Hu(e){try{const n=this.updateFunction(e);return!Zu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if((e==null?void 0:e.name)==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!zS(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts="FirestoreClient";class _3{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Rt.UNAUTHENTICATED,this.clientId=hv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{B(Ts,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(B(Ts,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Vl(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function sg(t,e){t.asyncQueue.verifyOperationInProgress(),B(Ts,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Ex(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function _T(t,e){t.asyncQueue.verifyOperationInProgress();const n=await iw(t);B(Ts,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>uT(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>uT(e.remoteStore,i)),t._onlineComponents=e}async function iw(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){B(Ts,"Using user provided OfflineComponentProvider");try{await sg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===V.FAILED_PRECONDITION||i.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Kn("Error using user provided cache. Falling back to memory cache: "+n),await sg(t,new wl)}}else B(Ts,"Using default OfflineComponentProvider"),await sg(t,new nw(void 0));return t._offlineComponents}async function Up(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(B(Ts,"Using user provided OnlineComponentProvider"),await _T(t,t._uninitializedComponentsProvider._online)):(B(Ts,"Using default OnlineComponentProvider"),await _T(t,new Es))),t._onlineComponents}function Qx(t){return iw(t).then(e=>e.persistence)}function Ml(t){return iw(t).then(e=>e.localStore)}function Yx(t){return Up(t).then(e=>e.remoteStore)}function sw(t){return Up(t).then(e=>e.syncEngine)}function Jx(t){return Up(t).then(e=>e.datastore)}async function Il(t){const e=await Up(t),n=e.eventManager;return n.onListen=Kj.bind(null,e.syncEngine),n.onUnlisten=Yj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Qj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Jj.bind(null,e.syncEngine),n}function v3(t){return t.asyncQueue.enqueue(async()=>{const e=await Qx(t),n=await Yx(t);return e.setNetworkEnabled(!0),function(i){const s=W(i);return s.Ea.delete(0),ad(s)}(n)})}function w3(t){return t.asyncQueue.enqueue(async()=>{const e=await Qx(t),n=await Yx(t);return e.setNetworkEnabled(!1),async function(i){const s=W(i);s.Ea.add(0),await Dl(s),s.Ra.set("Offline")}(n)})}function I3(t,e){const n=new Pt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(u,d){const f=W(u);return f.persistence.runTransaction("read document","readonly",p=>f.localDocuments.getDocument(p,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new j(V.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=Vl(a,`Failed to get document '${s} from cache`);o.reject(l)}}(await Ml(t),e,n)),n.promise}function Xx(t,e,n={}){const r=new Pt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new jp({next:p=>{d.Nu(),o.enqueueAndForget(()=>Wv(s,f));const v=p.docs.has(a);!v&&p.fromCache?u.reject(new j(V.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&p.fromCache&&l&&l.source==="server"?u.reject(new j(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new Qv(kl(a.path),d,{includeMetadataChanges:!0,qa:!0});return Gv(s,f)}(await Il(t),t.asyncQueue,e,n,r)),r.promise}function E3(t,e){const n=new Pt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await Bf(i,s,!0),l=new zx(s,a.Qs),u=l.ru(a.documents),d=l.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){const l=Vl(a,`Failed to execute query '${s} against cache`);o.reject(l)}}(await Ml(t),e,n)),n.promise}function Zx(t,e,n={}){const r=new Pt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new jp({next:p=>{d.Nu(),o.enqueueAndForget(()=>Wv(s,f)),p.fromCache&&l.source==="server"?u.reject(new j(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new Qv(a,d,{includeMetadataChanges:!0,qa:!0});return Gv(s,f)}(await Il(t),t.asyncQueue,e,n,r)),r.promise}function T3(t,e,n){const r=new Pt;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await Jx(t);r.resolve(async function(o,a,l){var P;const u=W(o),{request:d,gt:f,parent:p}=ex(u.serializer,RS(a),l);u.connection.$o||delete d.parent;const v=(await u.Ho("RunAggregationQuery",u.serializer.databaseId,p,d,1)).filter(N=>!!N.result);te(v.length===1,64727);const S=(P=v[0].result)==null?void 0:P.aggregateFields;return Object.keys(S).reduce((N,T)=>(N[f[T]]=S[T],N),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}function A3(t,e){const n=new jp(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){W(i).Ca.add(s),s.next()}(await Il(t),n)),()=>{n.Nu(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){W(i).Ca.delete(s)}(await Il(t),n))}}function b3(t,e,n,r){const i=function(o,a){let l;return l=typeof o=="string"?HS().encode(o):o,function(d,f){return new p3(d,f)}(function(d,f){if(d instanceof Uint8Array)return yT(d,f);if(d instanceof ArrayBuffer)return yT(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(n,qo(e));t.asyncQueue.enqueueAndForget(async()=>{f3(await sw(t),i,r)})}function R3(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=W(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Ii.getNamedQuery(o,i))}(await Ml(t),e))}function eP(t,e){return function(r,i){return new m3(r,i)}(t,e)}function S3(t,e){return t.asyncQueue.enqueue(async()=>async function(r,i){const s=W(r),o=s.indexManager,a=[];return s.persistence.runTransaction("Configure indexes","readwrite",l=>o.getFieldIndexes(l).next(u=>function(f,p,v,S,P){f=[...f],p=[...p],f.sort(v),p.sort(v);const N=f.length,T=p.length;let I=0,b=0;for(;I<T&&b<N;){const M=v(f[b],p[I]);M<0?P(f[b++]):M>0?S(p[I++]):(I++,b++)}for(;I<T;)S(p[I++]);for(;b<N;)P(f[b++])}(u,i,T4,d=>{a.push(o.addFieldIndex(l,d))},d=>{a.push(o.deleteFieldIndex(l,d))})).next(()=>L.waitFor(a)))}(await Ml(t),e))}function x3(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){W(r).Fs.Vs=i}(await Ml(t),e))}function P3(t){return t.asyncQueue.enqueue(async()=>function(n){const r=W(n),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",s=>i.deleteAllFieldIndexes(s))}(await Ml(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tP(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP="firestore.googleapis.com",wT=!0;class IT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new j(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nP,this.ssl=wT}else this.host=e.host,this.ssl=e.ssl??wT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=cx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<fx)throw new j(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}E4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tP(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new j(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new j(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new j(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ld{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new IT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new j(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new j(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new IT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new h4;switch(r.type){case"firstParty":return new g4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new j(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=vT.get(n);r&&(B("ComponentProvider","Removing Datastore"),vT.delete(n),r.terminate())}(this),Promise.resolve()}}function k3(t,e,n,r={}){var u;t=fe(t,ld);const i=pi(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(cp(`https://${a}`),V_("Firestore",!0)),s.host!==nP&&s.host!==a&&Kn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!Hn(l,o)&&(t._setSettings(l),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=Rt.MOCK_USER;else{d=tb(r.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new j(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Rt(p)}t._authCredentials=new f4(new BR(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new kt(this.firestore,e,this._query)}}class xe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xe(this.firestore,e,this._key)}toJSON(){return{type:xe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(zo(n,xe._jsonSchema))return new xe(e,r||null,new G(de.fromString(n.referencePath)))}}xe._jsonSchemaVersion="firestore/documentReference/1.0",xe._jsonSchema={type:pt("string",xe._jsonSchemaVersion),referencePath:pt("string")};class Lr extends kt{constructor(e,n,r){super(e,n,kl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xe(this.firestore,null,new G(e))}withConverter(e){return new Lr(this.firestore,e,this._path)}}function cd(t,e,...n){if(t=Z(t),fv("collection","path",e),t instanceof ld){const r=de.fromString(e,...n);return cE(r),new Lr(t,null,r)}{if(!(t instanceof xe||t instanceof Lr))throw new j(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(de.fromString(e,...n));return cE(r),new Lr(t.firestore,null,r)}}function C5(t,e){if(t=fe(t,ld),fv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new j(V.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new kt(t,null,function(r){return new _i(de.emptyPath(),r)}(e))}function yo(t,e,...n){if(t=Z(t),arguments.length===1&&(e=hv.newId()),fv("doc","path",e),t instanceof ld){const r=de.fromString(e,...n);return lE(r),new xe(t,null,new G(r))}{if(!(t instanceof xe||t instanceof Lr))throw new j(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(de.fromString(e,...n));return lE(r),new xe(t.firestore,t instanceof Lr?t.converter:null,new G(r))}}function N5(t,e){return t=Z(t),e=Z(e),(t instanceof xe||t instanceof Lr)&&(e instanceof xe||e instanceof Lr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function rP(t,e){return t=Z(t),e=Z(e),t instanceof kt&&e instanceof kt&&t.firestore===e.firestore&&nd(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="AsyncQueue";class TT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Bv(this,"async_queue_retry"),this._c=()=>{const r=qh();r&&B(ET,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=qh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=qh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Pt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!xs(e))throw e;B(ET,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ot("INTERNAL UNHANDLED ERROR: ",AT(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=Hv.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&J(47125,{Pc:AT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function AT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class C3{constructor(){this._progressObserver={},this._taskCompletionResolver=new Pt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5=-1;class De extends ld{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new TT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new TT(e),this._firestoreClient=void 0,await e}}}function O5(t,e,n){n||(n=Su);const r=hr(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Hn(s,e))return i;throw new j(V.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new j(V.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<fx)throw new j(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&pi(e.host)&&cp(e.host),r.initialize({options:e,instanceIdentifier:n})}function N3(t,e){const n=typeof t=="object"?t:Hu(),r=typeof t=="string"?t:e||Su,i=hr(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=X1("firestore");s&&k3(i,...s)}return i}function Xe(t){if(t._terminated)throw new j(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||iP(t),t._firestoreClient}function iP(t){var r,i,s;const e=t._freezeSettings(),n=function(a,l,u,d){return new nF(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,tP(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new _3(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function L5(t,e){Kn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return sP(t,Es.provider,{build:r=>new rw(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function V5(t){Kn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();sP(t,Es.provider,{build:n=>new Kx(n,e.cacheSizeBytes)})}function sP(t,e,n){if((t=fe(t,De))._firestoreClient||t._terminated)throw new j(V.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new j(V.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},iP(t)}function M5(t){if(t._initialized&&!t._terminated)throw new j(V.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Pt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Dr.v())return Promise.resolve();const i=r+vx;await Dr.delete(i)}(Mv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function F5(t){return function(n){const r=new Pt;return n.asyncQueue.enqueueAndForget(async()=>n3(await sw(n),r)),r.promise}(Xe(t=fe(t,De)))}function j5(t){return v3(Xe(t=fe(t,De)))}function U5(t){return w3(Xe(t=fe(t,De)))}function B5(t){return XD(t.app,"firestore",t._databaseId.database),t._delete()}function bT(t,e){const n=Xe(t=fe(t,De)),r=new C3;return b3(n,t._databaseId,e,r),r}function D3(t,e){return R3(Xe(t=fe(t,De)),e).then(n=>n?new kt(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class O3{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Tn(tt.fromBase64String(e))}catch(n){throw new j(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Tn(tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Tn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zo(e,Tn._jsonSchema))return Tn.fromBase64String(e.bytes)}}Tn._jsonSchemaVersion="firestore/bytes/1.0",Tn._jsonSchema={type:pt("string",Tn._jsonSchemaVersion),bytes:pt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new j(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new We(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function $5(){return new Ho(my)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new j(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new j(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return oe(this._lat,e._lat)||oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Vr._jsonSchemaVersion}}static fromJSON(e){if(zo(e,Vr._jsonSchema))return new Vr(e.latitude,e.longitude)}}Vr._jsonSchemaVersion="firestore/geoPoint/1.0",Vr._jsonSchema={type:pt("string",Vr._jsonSchemaVersion),latitude:pt("number"),longitude:pt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ur._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zo(e,ur._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ur(e.vectorValues);throw new j(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ur._jsonSchemaVersion="firestore/vectorValue/1.0",ur._jsonSchema={type:pt("string",ur._jsonSchemaVersion),vectorValues:pt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=/^__.*__$/;class V3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new wi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Cl(e,this.data,n,this.fieldTransforms)}}class oP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new wi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function aP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{Ac:t})}}class Bp{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Bp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Hf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(aP(this.Ac)&&L3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class M3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||qo(e)}Cc(e,n,r,i=!1){return new Bp({Ac:e,methodName:n,Dc:r,path:We.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wo(t){const e=t._freezeSettings(),n=qo(t._databaseId);return new M3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function $p(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);hw("Data must be an object, but it was:",o,r);const a=uP(r,o);let l,u;if(s.merge)l=new hn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const p=Ou(e,f,n);if(!o.contains(p))throw new j(V.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);hP(d,p)||d.push(p)}l=new hn(d),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new V3(new Lt(a),l,u)}class ud extends Go{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ud}}function lP(t,e,n){return new Bp({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ow extends Go{_toFieldTransform(e){return new id(e.path,new fl)}isEqual(e){return e instanceof ow}}class aw extends Go{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=lP(this,e,!0),r=this.vc.map(s=>Ko(s,n)),i=new Po(r);return new id(e.path,i)}isEqual(e){return e instanceof aw&&Hn(this.vc,e.vc)}}class lw extends Go{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=lP(this,e,!0),r=this.vc.map(s=>Ko(s,n)),i=new ko(r);return new id(e.path,i)}isEqual(e){return e instanceof lw&&Hn(this.vc,e.vc)}}class cw extends Go{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new pl(e.serializer,LS(e.serializer,this.Fc));return new id(e.path,n)}isEqual(e){return e instanceof cw&&this.Fc===e.Fc}}function uw(t,e,n,r){const i=t.Cc(1,e,n);hw("Data must be an object, but it was:",i,r);const s=[],o=Lt.empty();Ps(r,(l,u)=>{const d=zp(e,l,n);u=Z(u);const f=i.yc(d);if(u instanceof ud)s.push(d);else{const p=Ko(u,f);p!=null&&(s.push(d),o.set(d,p))}});const a=new hn(s);return new oP(o,a,i.fieldTransforms)}function dw(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[Ou(e,r,n)],l=[i];if(s.length%2!=0)throw new j(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(Ou(e,s[p])),l.push(s[p+1]);const u=[],d=Lt.empty();for(let p=a.length-1;p>=0;--p)if(!hP(u,a[p])){const v=a[p];let S=l[p];S=Z(S);const P=o.yc(v);if(S instanceof ud)u.push(v);else{const N=Ko(S,P);N!=null&&(u.push(v),d.set(v,N))}}const f=new hn(u);return new oP(d,f,o.fieldTransforms)}function cP(t,e,n,r=!1){return Ko(n,t.Cc(r?4:3,e))}function Ko(t,e){if(dP(t=Z(t)))return hw("Unsupported field value:",e,t),uP(t,e);if(t instanceof Go)return function(r,i){if(!aP(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Ko(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Z(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return LS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ae.fromDate(r);return{timestampValue:ml(i.serializer,s)}}if(r instanceof Ae){const s=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ml(i.serializer,s)}}if(r instanceof Vr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Tn)return{bytesValue:KS(i.serializer,r._byteString)};if(r instanceof xe){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Cv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ur)return function(o,a){return{mapValue:{fields:{[wv]:{stringValue:Iv},[ul]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return bv(a.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${Ip(r)}`)}(t,e)}function uP(t,e){const n={};return lS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ps(t,(r,i)=>{const s=Ko(i,e.mc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function dP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ae||t instanceof Vr||t instanceof Tn||t instanceof xe||t instanceof Go||t instanceof ur)}function hw(t,e,n){if(!dP(n)||!zR(n)){const r=Ip(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Ou(t,e,n){if((e=Z(e))instanceof Ho)return e._internalPath;if(typeof e=="string")return zp(t,e);throw Hf("Field path arguments must be of type string or ",t,!1,void 0,n)}const F3=new RegExp("[~\\*/\\[\\]]");function zp(t,e,n){if(e.search(F3)>=0)throw Hf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ho(...e.split("."))._internalPath}catch{throw Hf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Hf(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new j(V.INVALID_ARGUMENT,a+t+l)}function hP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new j3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(qp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class j3 extends Lu{data(){return super.data()}}function qp(t,e){return typeof e=="string"?zp(t,e):e instanceof Ho?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new j(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fw{}class dd extends fw{}function Hh(t,e,...n){let r=[];e instanceof fw&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Fl).length,a=s.filter(l=>l instanceof hd).length;if(o>1||o>0&&a>0)throw new j(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class hd extends dd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new hd(e,n,r)}_apply(e){const n=this._parse(e);return mP(e._query,n),new kt(e.firestore,e.converter,Ry(e._query,n))}_parse(e){const n=Wo(e.firestore);return function(s,o,a,l,u,d,f){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new j(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ST(f,d);const S=[];for(const P of f)S.push(RT(l,s,P));p={arrayValue:{values:S}}}else p=RT(l,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ST(f,d),p=cP(a,o,f,d==="in"||d==="not-in");return ge.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Gh(t,e,n){const r=e,i=qp("where",t);return hd._create(i,r,n)}class Fl extends fw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Fl(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:be.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)mP(o,l),o=Ry(o,l)}(e._query,n),new kt(e.firestore,e.converter,Ry(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function z5(...t){return t.forEach(e=>gP("or",e)),Fl._create("or",t)}function q5(...t){return t.forEach(e=>gP("and",e)),Fl._create("and",t)}class pw extends dd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new pw(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new j(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new j(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ku(s,o)}(e._query,this._field,this._direction);return new kt(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new _i(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Wh(t,e="asc"){const n=e,r=qp("orderBy",t);return pw._create(r,n)}class Hp extends dd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Hp(e,n,r)}_apply(e){return new kt(e.firestore,e.converter,Vf(e._query,this._limit,this._limitType))}}function og(t){return qR("limit",t),Hp._create("limit",t,"F")}function H5(t){return qR("limitToLast",t),Hp._create("limitToLast",t,"L")}class Gp extends dd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Gp(e,n,r)}_apply(e){const n=pP(e,this.type,this._docOrFields,this._inclusive);return new kt(e.firestore,e.converter,function(i,s){return new _i(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function G5(...t){return Gp._create("startAt",t,!0)}function U3(...t){return Gp._create("startAfter",t,!1)}class Wp extends dd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Wp(e,n,r)}_apply(e){const n=pP(e,this.type,this._docOrFields,this._inclusive);return new kt(e.firestore,e.converter,function(i,s){return new _i(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function W5(...t){return Wp._create("endBefore",t,!1)}function K5(...t){return Wp._create("endAt",t,!0)}function pP(t,e,n,r){if(n[0]=Z(n[0]),n[0]instanceof Lu)return function(s,o,a,l,u){if(!l)throw new j(V.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of Ga(s))if(f.field.isKeyField())d.push(So(o,l.key));else{const p=l.data.field(f.field);if(Rp(p))throw new j(V.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){const v=f.field.canonicalString();throw new j(V.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}d.push(p)}return new ws(d,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Wo(t.firestore);return function(o,a,l,u,d,f){const p=o.explicitOrderBy;if(d.length>p.length)throw new j(V.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let S=0;S<d.length;S++){const P=d[S];if(p[S].field.isKeyField()){if(typeof P!="string")throw new j(V.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof P}`);if(!Tv(o)&&P.indexOf("/")!==-1)throw new j(V.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${P}' contains a slash.`);const N=o.path.child(de.fromString(P));if(!G.isDocumentKey(N))throw new j(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const T=new G(N);v.push(So(a,T))}else{const N=cP(l,u,P);v.push(N)}}return new ws(v,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function RT(t,e,n){if(typeof(n=Z(n))=="string"){if(n==="")throw new j(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tv(e)&&n.indexOf("/")!==-1)throw new j(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(de.fromString(n));if(!G.isDocumentKey(r))throw new j(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return So(t,new G(r))}if(n instanceof xe)return So(t,n._key);throw new j(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ip(n)}.`)}function ST(t,e){if(!Array.isArray(t)||t.length===0)throw new j(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mP(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new j(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new j(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function gP(t,e){if(!(e instanceof hd||e instanceof Fl))throw new j(V.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class yP{convertValue(e,n="none"){switch(_s(e)){case 0:return null;case 1:return e.booleanValue;case 2:return He(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(hi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ps(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[ul].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>He(o.doubleValue));return new ur(n)}convertGeoPoint(e){return new Vr(He(e.latitude),He(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Sp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ru(e));default:return null}}convertTimestamp(e){const n=di(e);return new Ae(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=de.fromString(e);te(ix(r),9688,{name:e});const i=new Ro(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||ot(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class mw extends yP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q5(t){return new Du("sum",Ou("sum",t))}function Y5(t){return new Du("avg",Ou("average",t))}function B3(){return new Du("count")}function J5(t,e){var n,r;return t instanceof Du&&e instanceof Du&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)==null?void 0:n.canonicalString())===((r=e._internalFieldPath)==null?void 0:r.canonicalString())}function X5(t,e){return rP(t.query,e.query)&&Hn(t.data(),e.data())}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P="NOT SUPPORTED";class es{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xn extends Lu{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Kh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(qp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new j(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=xn._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}function Z5(t,e,n){if(zo(e,xn._jsonSchema)){if(e.bundle===_P)throw new j(V.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=qo(t._databaseId),i=eP(e.bundle,r),s=i.Wu(),o=new Yv(i.getMetadata(),r);for(const d of s)o.Ga(d);const a=o.documents;if(a.length!==1)throw new j(V.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);const l=Cp(r,a[0].document),u=new G(de.fromString(e.bundleName));return new xn(t,new mw(t),u,l,new es(!1,!1),n||null)}}xn._jsonSchemaVersion="firestore/documentSnapshot/1.0",xn._jsonSchema={type:pt("string",xn._jsonSchemaVersion),bundleSource:pt("string","DocumentSnapshot"),bundleName:pt("string"),bundle:pt("string")};class Kh extends xn{data(e={}){return super.data(e)}}class Pn{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new es(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Kh(this._firestore,this._userDataWriter,r.key,r,new es(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new j(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Kh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new es(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Kh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new es(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:$3(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new j(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Pn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function eB(t,e,n){if(zo(e,Pn._jsonSchema)){if(e.bundle===_P)throw new j(V.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const r=qo(t._databaseId),i=eP(e.bundle,r),s=i.Wu(),o=new Yv(i.getMetadata(),r);for(const p of s)o.Ga(p);if(o.queries.length!==1)throw new j(V.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);const a=Dp(o.queries[0].bundledQuery),l=o.documents;let u=new go;l.map(p=>{const v=Cp(r,p.document);u=u.add(v)});const d=Lo.fromInitialDocuments(a,u,ce(),!1,!1),f=new kt(t,n||null,a);return new Pn(t,new mw(t),f,d)}}function $3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}function tB(t,e){return t instanceof xn&&e instanceof xn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Pn&&e instanceof Pn&&t._firestore===e._firestore&&rP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z3(t){t=fe(t,xe);const e=fe(t.firestore,De);return Xx(Xe(e),t._key).then(n=>gw(e,t,n))}Pn._jsonSchemaVersion="firestore/querySnapshot/1.0",Pn._jsonSchema={type:pt("string",Pn._jsonSchemaVersion),bundleSource:pt("string","QuerySnapshot"),bundleName:pt("string"),bundle:pt("string")};class Ns extends yP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,n)}}function nB(t){t=fe(t,xe);const e=fe(t.firestore,De),n=Xe(e),r=new Ns(e);return I3(n,t._key).then(i=>new xn(e,r,t._key,i,new es(i!==null&&i.hasLocalMutations,!0),t.converter))}function rB(t){t=fe(t,xe);const e=fe(t.firestore,De);return Xx(Xe(e),t._key,{source:"server"}).then(n=>gw(e,t,n))}function jy(t){t=fe(t,kt);const e=fe(t.firestore,De),n=Xe(e),r=new Ns(e);return fP(t._query),Zx(n,t._query).then(i=>new Pn(e,r,t,i))}function iB(t){t=fe(t,kt);const e=fe(t.firestore,De),n=Xe(e),r=new Ns(e);return E3(n,t._query).then(i=>new Pn(e,r,t,i))}function sB(t){t=fe(t,kt);const e=fe(t.firestore,De),n=Xe(e),r=new Ns(e);return Zx(n,t._query,{source:"server"}).then(i=>new Pn(e,r,t,i))}function Qp(t,e,n){t=fe(t,xe);const r=fe(t.firestore,De),i=Kp(t.converter,e,n);return fd(r,[$p(Wo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ke.none())])}function oB(t,e,n,...r){t=fe(t,xe);const i=fe(t.firestore,De),s=Wo(i);let o;return o=typeof(e=Z(e))=="string"||e instanceof Ho?dw(s,"updateDoc",t._key,e,n,r):uw(s,"updateDoc",t._key,e),fd(i,[o.toMutation(t._key,Ke.exists(!0))])}function aB(t){return fd(fe(t.firestore,De),[new Nl(t._key,Ke.none())])}function lB(t,e){const n=fe(t.firestore,De),r=yo(t),i=Kp(t.converter,e);return fd(n,[$p(Wo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ke.exists(!1))]).then(()=>r)}function Uy(t,...e){var l,u,d;t=Z(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Wa(e[r])||(n=e[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Wa(e[r])){const f=e[r];e[r]=(l=f.next)==null?void 0:l.bind(f),e[r+1]=(u=f.error)==null?void 0:u.bind(f),e[r+2]=(d=f.complete)==null?void 0:d.bind(f)}let s,o,a;if(t instanceof xe)o=fe(t.firestore,De),a=kl(t._key.path),s={next:f=>{e[r]&&e[r](gw(o,t,f))},error:e[r+1],complete:e[r+2]};else{const f=fe(t,kt);o=fe(f.firestore,De),a=f._query;const p=new Ns(o);s={next:v=>{e[r]&&e[r](new Pn(o,p,f,v))},error:e[r+1],complete:e[r+2]},fP(t._query)}return function(p,v,S,P){const N=new jp(P),T=new Qv(v,N,S);return p.asyncQueue.enqueueAndForget(async()=>Gv(await Il(p),T)),()=>{N.Nu(),p.asyncQueue.enqueueAndForget(async()=>Wv(await Il(p),T))}}(Xe(o),a,i,s)}function cB(t,e,...n){const r=Z(t),i=function(l){const u={bundle:"",bundleName:"",bundleSource:""},d=["bundle","bundleName","bundleSource"];for(const f of d){if(!(f in l)){u.error=`snapshotJson missing required field: ${f}`;break}const p=l[f];if(typeof p!="string"){u.error=`snapshotJson field '${f}' must be a string.`;break}if(p.length===0){u.error=`snapshotJson field '${f}' cannot be an empty string.`;break}f==="bundle"?u.bundle=p:f==="bundleName"?u.bundleName=p:f==="bundleSource"&&(u.bundleSource=p)}return u}(e);if(i.error)throw new j(V.INVALID_ARGUMENT,i.error);let s,o=0;if(typeof n[o]!="object"||Wa(n[o])||(s=n[o++]),i.bundleSource==="QuerySnapshot"){let a=null;if(typeof n[o]=="object"&&Wa(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(u,d,f,p,v){let S,P=!1;return bT(u,d.bundle).then(()=>D3(u,d.bundleName)).then(T=>{T&&!P&&(v&&T.withConverter(v),S=Uy(T,f||{},p))}).catch(T=>(p.error&&p.error(T),()=>{})),()=>{P||(P=!0,S&&S())}}(r,i,s,a,n[o])}if(i.bundleSource==="DocumentSnapshot"){let a=null;if(typeof n[o]=="object"&&Wa(n[o])){const l=n[o++];a={next:l.next,error:l.error,complete:l.complete}}else a={next:n[o++],error:n[o++],complete:n[o++]};return function(u,d,f,p,v){let S,P=!1;return bT(u,d.bundle).then(()=>{if(!P){const T=new xe(u,v||null,G.fromPath(d.bundleName));S=Uy(T,f||{},p)}}).catch(T=>(p.error&&p.error(T),()=>{})),()=>{P||(P=!0,S&&S())}}(r,i,s,a,n[o])}throw new j(V.INVALID_ARGUMENT,`unsupported bundle source: ${i.bundleSource}`)}function uB(t,e){return A3(Xe(t=fe(t,De)),Wa(e)?e:{next:e})}function fd(t,e){return function(r,i){const s=new Pt;return r.asyncQueue.enqueueAndForget(async()=>Xj(await sw(r),i,s)),s.promise}(Xe(t),e)}function gw(t,e,n){const r=n.docs.get(e._key),i=new Ns(t);return new xn(t,i,e._key,r,new es(n.hasPendingWrites,n.fromCache),e.converter)}function dB(t){return q3(t,{count:B3()})}function q3(t,e){const n=fe(t.firestore,De),r=Xe(n),i=aS(e,(s,o)=>new $S(o,s.aggregateType,s._internalFieldPath));return T3(r,t._query,i).then(s=>function(a,l,u){const d=new Ns(a);return new O3(l,d,u)}(n,t,s))}class H3{constructor(e){this.kind="memory",this._onlineComponentProvider=Es.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new nw(void 0)}}toJSON(){return{kind:this.kind}}}class G3{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=J3(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class W3{constructor(){this.kind="memoryEager",this._offlineComponentProvider=wl.provider}toJSON(){return{kind:this.kind}}}class K3{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new nw(e)}}toJSON(){return{kind:this.kind}}}function hB(){return new W3}function fB(t){return new K3(t==null?void 0:t.cacheSizeBytes)}function pB(t){return new H3(t)}function mB(t){return new G3(t)}class Q3{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Es.provider,this._offlineComponentProvider={build:n=>new rw(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Y3{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Es.provider,this._offlineComponentProvider={build:n=>new Kx(n,e==null?void 0:e.cacheSizeBytes)}}}function J3(t){return new Q3(t==null?void 0:t.forceOwnership)}function gB(){return new Y3}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Wo(e)}set(e,n,r){this._verifyNotCommitted();const i=ts(e,this._firestore),s=Kp(i.converter,n,r),o=$p(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ke.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=ts(e,this._firestore);let o;return o=typeof(n=Z(n))=="string"||n instanceof Ho?dw(this._dataReader,"WriteBatch.update",s._key,n,r,i):uw(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Ke.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ts(e,this._firestore);return this._mutations=this._mutations.concat(new Nl(n._key,Ke.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new j(V.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ts(t,e){if((t=Z(t)).firestore!==e)throw new j(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Wo(e)}get(e){const n=ts(e,this._firestore),r=new mw(this._firestore);return this._transaction.lookup([n._key]).then(i=>{if(!i||i.length!==1)return J(24041);const s=i[0];if(s.isFoundDocument())return new Lu(this._firestore,r,s.key,s,n.converter);if(s.isNoDocument())return new Lu(this._firestore,r,n._key,null,n.converter);throw J(18433,{doc:s})})}set(e,n,r){const i=ts(e,this._firestore),s=Kp(i.converter,n,r),o=$p(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,n,r,...i){const s=ts(e,this._firestore);let o;return o=typeof(n=Z(n))=="string"||n instanceof Ho?dw(this._dataReader,"Transaction.update",s._key,n,r,i):uw(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(e){const n=ts(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU extends eU{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=ts(e,this._firestore),r=new Ns(this._firestore);return super.get(e).then(i=>new xn(this._firestore,r,n._key,i._document,new es(!1,!1),n.converter))}}function yB(t,e,n){t=fe(t,De);const r={...X3,...n};return function(s){if(s.maxAttempts<1)throw new j(V.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new Pt;return s.asyncQueue.enqueueAndForget(async()=>{const u=await Jx(s);new y3(s.asyncQueue,u,a,o,l).ju()}),l.promise}(Xe(t),i=>e(new tU(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _B(){return new ud("deleteField")}function vB(){return new ow("serverTimestamp")}function wB(...t){return new aw("arrayUnion",t)}function IB(...t){return new lw("arrayRemove",t)}function EB(t){return new cw("increment",t)}function TB(t){return new ur(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AB(t){return Xe(t=fe(t,De)),new Z3(t,e=>fd(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bB(t,e){const n=Xe(t=fe(t,De));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return Kn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(s){const o=typeof s=="string"?function(u){try{return JSON.parse(u)}catch(d){throw new j(V.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(s):s,a=[];if(Array.isArray(o.indexes))for(const l of o.indexes){const u=xT(l,"collectionGroup"),d=[];if(Array.isArray(l.fields))for(const f of l.fields){const p=zp("setIndexConfiguration",xT(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new po(p,2)):f.order==="ASCENDING"?d.push(new po(p,0)):f.order==="DESCENDING"&&d.push(new po(p,1))}a.push(new il(il.UNKNOWN_ID,u,d,sl.empty()))}return a}(e);return S3(n,r)}function xT(t,e){if(typeof t[e]!="string")throw new j(V.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function RB(t){var i;t=fe(t,De);const e=PT.get(t);if(e)return e;if(((i=Xe(t)._uninitializedComponentsProvider)==null?void 0:i._offline.kind)!=="persistent")return null;const r=new nU(t);return PT.set(t,r),r}function SB(t){vP(t,!0)}function xB(t){vP(t,!1)}function PB(t){P3(Xe(t._firestore)).then(e=>B("deleting all persistent cache indexes succeeded")).catch(e=>Kn("deleting all persistent cache indexes failed",e))}function vP(t,e){x3(Xe(t._firestore),e).then(n=>B(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>Kn(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const PT=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kB(t){var r;const e=Xe(fe(t.firestore,De)),n=(r=e._onlineComponents)==null?void 0:r.datastore.serializer;return n===void 0?null:Np(n,Wt(t._query)).ft}function CB(t,e){var s;const n=aS(e,(o,a)=>new $S(a,o.aggregateType,o._internalFieldPath)),r=Xe(fe(t.firestore,De)),i=(s=r._onlineComponents)==null?void 0:s.datastore.serializer;return i===void 0?null:ex(i,RS(t._query),n,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return yw.instance.onExistenceFilterMismatch(e)}}class yw{constructor(){this.Mc=new Map}static get instance(){return mh||(mh=new yw,function(n){if(Qc)throw new Error("a TestingHooksSpi instance is already set");Qc=n}(mh)),mh}lt(e){this.Mc.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Mc;return r.set(n,e),()=>r.delete(n)}}let mh=null;(function(e,n=!0){(function(i){Pl=i})(Uo),Gn(new Cn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new De(new p4(r.getProvider("auth-internal")),new y4(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new j(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ro(u.options.projectId,d)}(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ht(oE,aE,e),Ht(oE,aE,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP="firebasestorage.googleapis.com",IP="storageBucket",rU=2*60*1e3,iU=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it extends Ln{constructor(e,n,r=0){super(ag(e),`Firebase Storage: ${n} (${ag(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,it.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ag(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var nt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(nt||(nt={}));function ag(t){return"storage/"+t}function _w(){const t="An unknown error occurred, please check the error payload for server response.";return new it(nt.UNKNOWN,t)}function sU(t){return new it(nt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function oU(t){return new it(nt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function aU(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new it(nt.UNAUTHENTICATED,t)}function lU(){return new it(nt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function cU(t){return new it(nt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function uU(){return new it(nt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dU(){return new it(nt.CANCELED,"User canceled the upload/download.")}function hU(t){return new it(nt.INVALID_URL,"Invalid URL '"+t+"'.")}function fU(t){return new it(nt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function pU(){return new it(nt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+IP+"' property when initializing the app?")}function mU(){return new it(nt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function gU(){return new it(nt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function yU(t){return new it(nt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function By(t){return new it(nt.INVALID_ARGUMENT,t)}function EP(){return new it(nt.APP_DELETED,"The Firebase app was deleted.")}function _U(t){return new it(nt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Jc(t,e){return new it(nt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function mc(t){throw new it(nt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=bn.makeFromUrl(e,n)}catch{return new bn(e,"")}if(r.path==="")return r;throw fU(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function u(M){M.path_=decodeURIComponent(M.path)}const d="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${d}/b/${i}/o${p}`,"i"),S={bucket:1,path:3},P=n===wP?"(?:storage.googleapis.com|storage.cloud.google.com)":n,N="([^?#]*)",T=new RegExp(`^https?://${P}/${i}/${N}`,"i"),b=[{regex:a,indices:l,postModify:s},{regex:v,indices:S,postModify:u},{regex:T,indices:{bucket:1,path:2},postModify:u}];for(let M=0;M<b.length;M++){const $=b[M],z=$.regex.exec(e);if(z){const A=z[$.indices.bucket];let _=z[$.indices.path];_||(_=""),r=new bn(A,_),$.postModify(r);break}}if(r==null)throw hU(e);return r}}class vU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let u=!1;function d(...N){u||(u=!0,e.apply(null,N))}function f(N){i=setTimeout(()=>{i=null,t(v,l())},N)}function p(){s&&clearTimeout(s)}function v(N,...T){if(u){p();return}if(N){p(),d.call(null,N,...T);return}if(l()||o){p(),d.call(null,N,...T);return}r<64&&(r*=2);let b;a===1?(a=2,b=0):b=(r+Math.random())*1e3,f(b)}let S=!1;function P(N){S||(S=!0,p(),!u&&(i!==null?(N||(a=2),clearTimeout(i),f(0)):N||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,P(!0)},n),P}function IU(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EU(t){return t!==void 0}function TU(t){return typeof t=="object"&&!Array.isArray(t)}function vw(t){return typeof t=="string"||t instanceof String}function kT(t){return ww()&&t instanceof Blob}function ww(){return typeof Blob<"u"}function CT(t,e,n,r){if(r<e)throw By(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw By(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function TP(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var _o;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(_o||(_o={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AU(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(e,n,r,i,s,o,a,l,u,d,f,p=!0,v=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,P)=>{this.resolve_=S,this.reject_=P,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new gh(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===_o.NO_ERROR,l=s.getStatus();if(!a||AU(l,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===_o.ABORT;r(!1,new gh(!1,null,d));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new gh(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());EU(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=_w();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?EP():dU();o(l)}else{const l=uU();o(l)}};this.canceled_?n(!1,new gh(!1,null,!0)):this.backoffId_=wU(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&IU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function RU(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function SU(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function xU(t,e){e&&(t["X-Firebase-GMPID"]=e)}function PU(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function kU(t,e,n,r,i,s,o=!0,a=!1){const l=TP(t.urlParams),u=t.url+l,d=Object.assign({},t.headers);return xU(d,e),RU(d,n),SU(d,s),PU(d,r),new bU(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function NU(...t){const e=CU();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(ww())return new Blob(t);throw new it(nt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function DU(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OU(t){if(typeof atob>"u")throw yU("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class lg{constructor(e,n){this.data=e,this.contentType=n||null}}function LU(t,e){switch(t){case kr.RAW:return new lg(AP(e));case kr.BASE64:case kr.BASE64URL:return new lg(bP(t,e));case kr.DATA_URL:return new lg(MU(e),FU(e))}throw _w()}function AP(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function VU(t){let e;try{e=decodeURIComponent(t)}catch{throw Jc(kr.DATA_URL,"Malformed data URL.")}return AP(e)}function bP(t,e){switch(t){case kr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Jc(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case kr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Jc(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=OU(e)}catch(i){throw i.message.includes("polyfill")?i:Jc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class RP{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Jc(kr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=jU(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function MU(t){const e=new RP(t);return e.base64?bP(kr.BASE64,e.rest):VU(e.rest)}function FU(t){return new RP(t).contentType}function jU(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,n){let r=0,i="";kT(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(kT(this.data_)){const r=this.data_,i=DU(r,e,n);return i===null?null:new Yi(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Yi(r,!0)}}static getBlob(...e){if(ww()){const n=e.map(r=>r instanceof Yi?r.data_:r);return new Yi(NU.apply(null,n))}else{const n=e.map(o=>vw(o)?LU(kr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Yi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SP(t){let e;try{e=JSON.parse(t)}catch{return null}return TU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UU(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function BU(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function xP(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $U(t,e){return e}class Jt{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||$U}}let yh=null;function zU(t){return!vw(t)||t.length<2?t:xP(t)}function PP(){if(yh)return yh;const t=[];t.push(new Jt("bucket")),t.push(new Jt("generation")),t.push(new Jt("metageneration")),t.push(new Jt("name","fullPath",!0));function e(s,o){return zU(o)}const n=new Jt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Jt("size");return i.xform=r,t.push(i),t.push(new Jt("timeCreated")),t.push(new Jt("updated")),t.push(new Jt("md5Hash",null,!0)),t.push(new Jt("cacheControl",null,!0)),t.push(new Jt("contentDisposition",null,!0)),t.push(new Jt("contentEncoding",null,!0)),t.push(new Jt("contentLanguage",null,!0)),t.push(new Jt("contentType",null,!0)),t.push(new Jt("metadata","customMetadata",!0)),yh=t,yh}function qU(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new bn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function HU(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return qU(r,t),r}function kP(t,e,n){const r=SP(e);return r===null?null:HU(t,r,n)}function GU(t,e,n,r){const i=SP(e);if(i===null||!vw(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const d=t.bucket,f=t.fullPath,p="/b/"+o(d)+"/o/"+o(f),v=Iw(p,n,r),S=TP({alt:"media",token:u});return v+S})[0]}function WU(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class CP{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NP(t){if(!t)throw _w()}function KU(t,e){function n(r,i){const s=kP(t,i,e);return NP(s!==null),s}return n}function QU(t,e){function n(r,i){const s=kP(t,i,e);return NP(s!==null),GU(s,i,t.host,t._protocol)}return n}function DP(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=lU():i=aU():n.getStatus()===402?i=oU(t.bucket):n.getStatus()===403?i=cU(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function YU(t){const e=DP(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=sU(t.path)),s.serverResponse=i.serverResponse,s}return n}function JU(t,e,n){const r=e.fullServerUrl(),i=Iw(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new CP(i,s,QU(t,n),o);return a.errorHandler=YU(e),a}function XU(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function ZU(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=XU(null,e)),r}function e6(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let b="";for(let M=0;M<2;M++)b=b+Math.random().toString().slice(2);return b}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const u=ZU(e,r,i),d=WU(u,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+l+"--",v=Yi.getBlob(f,r,p);if(v===null)throw mU();const S={name:u.fullPath},P=Iw(s,t.host,t._protocol),N="POST",T=t.maxUploadRetryTime,I=new CP(P,N,KU(t,n),T);return I.urlParams=S,I.headers=o,I.body=v.uploadData(),I.errorHandler=DP(e),I}class t6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=_o.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=_o.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=_o.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i,s){if(this.sent_)throw mc("cannot .send() more than once");if(pi(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw mc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw mc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw mc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw mc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class n6 extends t6{initXhr(){this.xhr_.responseType="text"}}function OP(){return new n6}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,n){this._service=e,n instanceof bn?this._location=n:this._location=bn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Vo(e,n)}get root(){const e=new bn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xP(this._location.path)}get storage(){return this._service}get parent(){const e=UU(this._location.path);if(e===null)return null;const n=new bn(this._location.bucket,e);return new Vo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw _U(e)}}function r6(t,e,n){t._throwIfRoot("uploadBytes");const r=e6(t.storage,t._location,PP(),new Yi(e,!0),n);return t.storage.makeRequestWithTokens(r,OP).then(i=>({metadata:i,ref:t}))}function i6(t){t._throwIfRoot("getDownloadURL");const e=JU(t.storage,t._location,PP());return t.storage.makeRequestWithTokens(e,OP).then(n=>{if(n===null)throw gU();return n})}function s6(t,e){const n=BU(t._location.path,e),r=new bn(t._location.bucket,n);return new Vo(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(t){return/^[A-Za-z]+:\/\//.test(t)}function a6(t,e){return new Vo(t,e)}function LP(t,e){if(t instanceof Ew){const n=t;if(n._bucket==null)throw pU();const r=new Vo(n,n._bucket);return e!=null?LP(r,e):r}else return e!==void 0?s6(t,e):t}function l6(t,e){if(e&&o6(e)){if(t instanceof Ew)return a6(t,e);throw By("To use ref(service, url), the first argument must be a Storage instance.")}else return LP(t,e)}function NT(t,e){const n=e==null?void 0:e[IP];return n==null?null:bn.makeFromBucketSpec(n,t)}function c6(t,e,n,r={}){t.host=`${e}:${n}`;const i=pi(e);i&&(cp(`https://${t.host}/b`),V_("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:tb(s,t.app.options.projectId))}class Ew{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=wP,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=rU,this._maxUploadRetryTime=iU,this._requests=new Set,i!=null?this._bucket=bn.makeFromBucketSpec(i,this._host):this._bucket=NT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bn.makeFromBucketSpec(this._url,e):this._bucket=NT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){CT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){CT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Be(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Vo(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new vU(EP());{const o=kU(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const DT="@firebase/storage",OT="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP="storage";function Vu(t,e,n){return t=Z(t),r6(t,e,n)}function Mu(t){return t=Z(t),i6(t)}function Fu(t,e){return t=Z(t),l6(t,e)}function u6(t=Hu(),e){t=Z(t);const r=hr(t,VP).getImmediate({identifier:e}),i=X1("storage");return i&&d6(r,...i),r}function d6(t,e,n,r={}){c6(t,e,n,r)}function h6(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Ew(n,r,i,e,Uo)}function f6(){Gn(new Cn(VP,h6,"PUBLIC").setMultipleInstances(!0)),Ht(DT,OT,""),Ht(DT,OT,"esm2020")}f6();const p6={apiKey:"AIzaSyDexERfe7htllA1aq7vlbnyQAmfgjx6HnI",authDomain:"moomhe-6de30.firebaseapp.com",projectId:"moomhe-6de30",storageBucket:"moomhe-6de30.firebasestorage.app",messagingSenderId:"951714207506",appId:"1:951714207506:web:0e3a50f5d663095e4345cb",measurementId:"G-6PHVQNPHNL"},jl=ub(p6),m6=xO(jl),Bi=u4(jl),ni=N3(jl),El=u6(jl),g6=dL(jl,{backend:new Gu}),y6=hL(g6,{model:"gemini-2.5-flash-image-preview",generationConfig:{responseModalities:[kI.TEXT,kI.IMAGE]}});async function MP(t){return{inlineData:{data:await new Promise(n=>{const r=new FileReader;r.onloadend=()=>n(r.result.split(",")[1]),r.readAsDataURL(t)}),mimeType:t.type}}}async function _6(t){const n=await(await fetch(t)).blob();return new File([n],"image.jpg",{type:n.type})}async function FP(){try{return(await bV(Bi)).user}catch(t){throw console.error("Error signing in:",t),t}}async function Js(t){const e={uid:t.uid,lastActive:new Date,os:navigator.platform,userAgent:navigator.userAgent,createdAt:t.metadata.creationTime,isAnonymous:t.isAnonymous};try{return await Qp(yo(ni,"users",t.uid),e,{merge:!0}),e}catch(n){throw console.error("Error creating/updating user:",n),n}}async function Qo(t,e=1920,n=1080,r=.8){if(t.includes("image/heic")||t.includes("image/heif"))try{console.log("Converting HEIC image to JPEG...");const s=await(await fetch(t)).blob(),o=(await Gr(()=>import("./heic2any-c9230476.js").then(d=>d.h),[])).default,a=await o({blob:s,toType:"image/jpeg",quality:r}),l=Array.isArray(a)?a[0]:a,u=await new Promise(d=>{const f=new FileReader;f.onload=()=>d(f.result),f.readAsDataURL(l)});return console.log("HEIC converted to JPEG successfully"),await Qo(u,e,n,r)}catch(i){throw console.error("Error converting HEIC image:",i),new Error("Failed to convert HEIC image to JPEG")}return new Promise((i,s)=>{const o=new Image;o.crossOrigin="anonymous",o.onload=()=>{try{const a=document.createElement("canvas"),l=a.getContext("2d");let{width:u,height:d}=o;if(u<=e&&d<=n)a.width=u,a.height=d;else{const f=e/u,p=n/d,v=Math.min(f,p);u=Math.floor(u*v),d=Math.floor(d*v),a.width=u,a.height=d}l.drawImage(o,0,0,u,d),a.toBlob(f=>{f?(console.log(`Image compressed: Original ${o.width}x${o.height} -> ${u}x${d}, Size: ${(f.size/1024/1024).toFixed(2)}MB`),i(f)):s(new Error("Failed to create compressed image blob"))},"image/jpeg",r)}catch(a){console.error("Error compressing image:",a),s(a)}},o.onerror=()=>{s(new Error("Failed to load image for compression"))},o.src=t})}function v6(t,e=1920,n=1080,r=.8){return new Promise((i,s)=>{const o=new FileReader;o.onload=a=>{Qo(a.target.result,e,n,r).then(i).catch(s)},o.onerror=()=>s(new Error("Failed to read file")),o.readAsDataURL(t)})}function jP(t,e=200,n=200){return new Promise((r,i)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>{try{const o=document.createElement("canvas"),a=o.getContext("2d");let{width:l,height:u}=s;l>u?l>e&&(u=u*e/l,l=e):u>n&&(l=l*n/u,u=n),o.width=l,o.height=u,a.drawImage(s,0,0,l,u),o.toBlob(d=>{d?r(d):i(new Error("Failed to create thumbnail blob"))},"image/jpeg",.8)}catch(o){console.error("Error creating thumbnail:",o),i(o)}},s.onerror=()=>{i(new Error("Failed to load image for thumbnail creation"))},s.src=t})}async function w6(t,e,n){try{let r;try{r=await Qo(e,1920,1080,.8)}catch(S){console.warn("Failed to compress image, using original:",S),r=await(await fetch(e)).blob()}let i;try{i=await jP(e)}catch(S){console.warn("Failed to create thumbnail, using compressed image:",S),i=r}const s=Date.now(),o=`image_${s}.jpg`,a=`thumbnail_${s}.jpg`,l=Fu(El,`userHistory/${t}/${o}`),u=await Vu(l,r),d=await Mu(u.ref),f=Fu(El,`userHistory/${t}/${a}`),p=await Vu(f,i),v=await Mu(p.ref);return{downloadURL:d,thumbnailURL:v,filename:o,thumbnailFilename:a,timestamp:s}}catch(r){throw console.error("Error uploading image:",r),r}}async function I6(t,e){try{const n=await new Promise(S=>{const P=new FileReader;P.onload=()=>S(P.result),P.readAsDataURL(e)});let r;try{r=await Qo(n,1920,1080,.8)}catch(S){console.warn("Failed to compress image, using original file:",S),r=e}let i;try{i=await jP(n)}catch(S){console.warn("Failed to create thumbnail, using compressed image:",S),i=r}const s=Date.now(),o=`upload_${s}.jpg`,a=`upload_thumbnail_${s}.jpg`,l=Fu(El,`userHistory/${t}/${o}`),u=await Vu(l,r),d=await Mu(u.ref),f=Fu(El,`userHistory/${t}/${a}`),p=await Vu(f,i),v=await Mu(p.ref);return{downloadURL:d,thumbnailURL:v,filename:o,thumbnailFilename:a,timestamp:s}}catch(n){throw console.error("Error uploading user image:",n),n}}async function E6(t,e){try{const{downloadURL:n,thumbnailURL:r,filename:i,thumbnailFilename:s,timestamp:o}=await w6(t,e.imageUrl,e.prompt),a={storageUrl:n,thumbnailUrl:r,filename:i,thumbnailFilename:s,prompt:e.prompt,timestamp:e.timestamp,createdAt:new Date,userId:t,type:"generated"},l=yo(cd(ni,"userHistory"));return await Qp(l,a),{id:l.id,...a}}catch(n){throw console.error("Error saving image to history:",n),n}}async function UP(t,e,n=""){try{const{downloadURL:r,thumbnailURL:i,filename:s,thumbnailFilename:o,timestamp:a}=await I6(t,e),l={storageUrl:r,thumbnailUrl:i,filename:s,thumbnailFilename:o,prompt:n||`Uploaded: ${e.name}`,timestamp:new Date().toLocaleString("he-IL"),createdAt:new Date,userId:t,type:"uploaded"},u=yo(cd(ni,"userHistory"));return await Qp(u,l),{id:u.id,...l}}catch(r){throw console.error("Error saving upload to history:",r),r}}async function T6(t){try{const e=cd(ni,"userHistory"),n=Hh(e,Gh("userId","==",t),Wh("createdAt","desc")),r=await jy(n),i=[];return r.forEach(s=>{const o=s.data();if(!o.isError){const a={id:s.id,...o};o.result&&o.result.storageUrl&&(a.storageUrl=o.result.storageUrl,a.thumbnailUrl=o.result.thumbnailUrl,a.filename=o.result.filename,a.thumbnailFilename=o.result.thumbnailFilename),o.objects&&(a.objects=o.objects),i.push(a)}}),i}catch(e){return console.error("Error loading user history:",e),[]}}async function Ta(t,e=1,n=7){try{const r=cd(ni,"userHistory");let i=null;if(e>1){const f=Hh(r,Gh("userId","==",t),Wh("createdAt","desc"),og((e-1)*n)),p=await jy(f);p.empty||(i=p.docs[p.docs.length-1])}let s;const o=n*2;i&&e>1?s=Hh(r,Gh("userId","==",t),Wh("createdAt","desc"),U3(i),og(o)):s=Hh(r,Gh("userId","==",t),Wh("createdAt","desc"),og(o));const a=await jy(s),l=[];a.forEach(f=>{const p=f.data();if(!p.isError){const v={id:f.id,...p};p.result&&p.result.storageUrl&&(v.storageUrl=p.result.storageUrl,v.thumbnailUrl=p.result.thumbnailUrl,v.filename=p.result.filename,v.thumbnailFilename=p.result.thumbnailFilename),p.objects&&(v.objects=p.objects),l.push(v)}});const u=l.slice(0,n),d=a.docs.length===o&&l.length>=n;return console.log(`Pagination debug - Page: ${e}, Requested: ${n}, Fetched: ${a.docs.length}, Valid: ${l.length}, Returned: ${u.length}, HasMore: ${d}`),{history:u,hasMore:d}}catch(r){return console.error("Error loading paginated user history:",r),{history:[],hasMore:!1}}}async function BP(t,e){try{let n;try{n=await Qo(e,1920,1080,.8)}catch(l){console.warn("Failed to compress image for sharing, using original:",l),n=await(await fetch(e)).blob()}const r=Date.now(),i=`temp_${r}.jpg`,s=Fu(El,`temp/${t}/${i}`),o=await Vu(s,n),a=await Mu(o.ref);return setTimeout(()=>{try{console.log("🧹 Cleanup scheduled for temporary file:",i)}catch(l){console.error("Error during cleanup:",l)}},36e5),{downloadURL:a,filename:i,timestamp:r}}catch(n){throw console.error("Error uploading image for sharing:",n),n}}const A6=Object.freeze(Object.defineProperty({__proto__:null,analytics:m6,app:jl,auth:Bi,compressFile:v6,compressImage:Qo,createOrUpdateUser:Js,db:ni,fileToGenerativePart:MP,loadUserHistory:T6,loadUserHistoryPaginated:Ta,model:y6,saveImageToHistory:E6,saveUploadToHistory:UP,signInUser:FP,storage:El,uploadImageForSharing:BP,urlToFile:_6},Symbol.toStringTag,{value:"Module"}));class b6{constructor(){$w(this,"waitForRequestCompletion",async(e,n=6e4)=>new Promise((r,i)=>{const s=setTimeout(()=>{this.activeRequests.delete(e),i(new Error("Request timeout"))},n),o=Uy(yo(ni,"userHistory",e),a=>{if(!a.exists()){clearTimeout(s),o(),i(new Error("Request document not found"));return}const l=a.data();l.isDone&&(clearTimeout(s),o(),this.activeRequests.delete(e),l.isError?i(new Error(l.error||"Request failed")):r(l.result))},a=>{clearTimeout(s),o(),this.activeRequests.delete(e),i(a)});this.activeRequests.set(e,o)}));this.activeRequests=new Map}async submitImageGenerationRequest(e,n,r,i=null){try{const s=await e.getIdToken(),o={type:"request",requestType:"imageGeneration",userId:e.uid,authToken:s,prompt:n,imageData:r,objectImageData:i,isDone:!1,isError:!1,createdAt:new Date},a=yo(cd(ni,"userHistory"));return await Qp(a,o),a.id}catch(s){throw console.error("Error submitting image generation request:",s),s}}async submitObjectDetectionRequest(e,n,r=null){try{const i=await e.getIdToken(),s=await fetch("https://us-central1-moomhe-6de30.cloudfunctions.net/detectObjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageData:n,authToken:i,historyId:r})});if(!s.ok){const a=await s.json();throw new Error(a.error||"Object detection failed")}const o=await s.json();if(!o.success)throw new Error(o.error||"Object detection failed");return o}catch(i){throw console.error("Error submitting object detection request:",i),i}}cancelRequest(e){const n=this.activeRequests.get(e);n&&(n(),this.activeRequests.delete(e))}async getUserGenerationCount(e){try{const n=new Date,r=`${String(n.getMonth()+1).padStart(2,"0")}-${n.getFullYear()}`,i=yo(ni,"genCount",r,"users",e),s=await z3(i);if(s.exists()){const o=s.data();return{count:o.count||0,limit:o.limit||50}}else return{count:0,limit:50}}catch(n){return console.error("Error getting user generation count:",n),{count:0,limit:50}}}async canMakeRequest(e){const{count:n,limit:r}=await this.getUserGenerationCount(e);return n<r}}const _a=new b6;function R6(){var Zn,Jl,Xl;const[t,e]=ne.useState("עיצוב פנים וחוץ"),[n,r]=ne.useState(null),[i,s]=ne.useState("/assets/design_img.jpg"),[o,a]=ne.useState(!1),[l,u]=ne.useState(!1),[d,f]=ne.useState(!1),[p,v]=ne.useState(!1),[S,P]=ne.useState(!1),[N,T]=ne.useState(!1),[I,b]=ne.useState(!1),[M,$]=ne.useState(!1),[z,A]=ne.useState(!1),[_,R]=ne.useState([]),[E,k]=ne.useState(null),[D,x]=ne.useState(!1),[Ct,rn]=ne.useState(!1),[Ds,Vn]=ne.useState(!1),[Y,ie]=ne.useState([]),[ae,Pe]=ne.useState(!1),[_e,Oe]=ne.useState(null),[lt,Tt]=ne.useState(""),[Mn,Qt]=ne.useState(16/9),[pd,Yp]=ne.useState("אדומים"),[Fr,jr]=ne.useState(null),[Qn,Ei]=ne.useState(null),[Yo,Ur]=ne.useState(1),[Ti,fr]=ne.useState(!0),[Ai,Ul]=ne.useState(!1),[md,bi]=ne.useState(!1),[gd,Os]=ne.useState(!1),[vn,Br]=ne.useState("signup"),[Yt,ct]=ne.useState(""),[mt,Ri]=ne.useState(""),[pr,Jo]=ne.useState(""),[yd,Si]=ne.useState(!1),[Bl,$l]=ne.useState(!1),[xi,zl]=ne.useState(!1),[ql,mr]=ne.useState(!1),[gt,Xo]=ne.useState(!1),[Pi,Ls]=ne.useState(null),[_d,Yn]=ne.useState([]),[sn,ki]=ne.useState(!1),[Hl,Fn]=ne.useState(!1),[vd,yt]=ne.useState(!1),[$r,gr]=ne.useState(null),[yr,zr]=ne.useState(null),wd=ne.useRef(null),_r=ne.useRef(null),Jn=ne.useRef(null),Jp=ne.useRef(null);ne.useEffect(()=>{const w=jV(Bi,async C=>{if(C){k(C),x(!0),await Js(C),rn(!0);try{const U=await Ta(C.uid,1,7);R(U.history),fr(U.hasMore)}finally{rn(!1)}}else try{const U=await FP();k(U),x(!0),await Js(U)}catch(U){console.error("Failed to sign in anonymously:",U)}});return()=>w()},[]),ne.useEffect(()=>()=>{$r&&$r.getTracks().forEach(w=>w.stop())},[$r]);const Zo=async()=>{try{return(await navigator.permissions.query({name:"microphone"})).state==="granted"}catch{return!1}},Gl=async()=>{try{if(Fn(!1),$r&&($r.getTracks().forEach(C=>C.stop()),gr(null)),await Zo()){const C=await navigator.mediaDevices.getUserMedia({audio:!0});return gr(C),yt(!0),C}else{const C=await navigator.mediaDevices.getUserMedia({audio:!0});return gr(C),yt(!0),C}}catch(w){return console.error("Error accessing microphone:",w),Fn(!0),yt(!1),gr(null),null}},ea=w=>{if(!w||!w.active||w.getTracks().length===0)return console.error("Invalid or inactive stream provided to MediaRecorder"),null;try{const C=new MediaRecorder(w,{mimeType:"audio/webm;codecs=opus"}),U=[];return C.ondataavailable=Q=>{Q.data.size>0&&U.push(Q.data)},C.onstop=async()=>{const Q=new Blob(U,{type:"audio/webm"});await Id(Q),Yn([]),Ls(null)},C}catch(C){return console.error("Failed to create MediaRecorder:",C),null}},ta=async w=>{try{const C=new(window.AudioContext||window.webkitAudioContext),U=await w.arrayBuffer(),Q=await C.decodeAudioData(U),X=Math.min(Q.sampleRate,16e3),se=Math.floor(Q.length*X/Q.sampleRate),Ee=C.createBuffer(1,se,X),ve=Q.getChannelData(0),le=Ee.getChannelData(0);for(let Me=0;Me<se;Me++){const Ze=Math.floor(Me*Q.sampleRate/X);le[Me]=ve[Ze]}return await vr(Ee)}catch(C){return console.warn("Audio optimization failed, using original:",C),w}},vr=async w=>{const C=w.length,U=w.sampleRate,Q=new ArrayBuffer(44+C*2),X=new DataView(Q),se=(le,Ce)=>{for(let Me=0;Me<Ce.length;Me++)X.setUint8(le+Me,Ce.charCodeAt(Me))};se(0,"RIFF"),X.setUint32(4,36+C*2,!0),se(8,"WAVE"),se(12,"fmt "),X.setUint32(16,16,!0),X.setUint16(20,1,!0),X.setUint16(22,1,!0),X.setUint32(24,U,!0),X.setUint32(28,U*2,!0),X.setUint16(32,2,!0),X.setUint16(34,16,!0),se(36,"data"),X.setUint32(40,C*2,!0);const Ee=w.getChannelData(0);let ve=44;for(let le=0;le<C;le++){const Ce=Math.max(-1,Math.min(1,Ee[le]));X.setInt16(ve,Ce<0?Ce*32768:Ce*32767,!0),ve+=2}return new Blob([Q],{type:"audio/wav"})},Id=async w=>{if(!E){console.error("No current user available");return}try{const C=new(window.AudioContext||window.webkitAudioContext),U=await w.arrayBuffer(),X=(await C.decodeAudioData(U)).duration;if(X>5){console.warn(`Audio too long (${X.toFixed(1)}s), rejecting. Max duration: 5s`),zr("ההקלטה ארוכה מדי. אנא הקלט עד 5 שניות."),ki(!1);return}}catch(C){console.warn("Could not check audio duration, proceeding anyway:",C)}ki(!0);try{const U=await(await ta(w)).arrayBuffer(),Q=new Uint8Array(U);let X="";const se=8192;for(let ut=0;ut<Q.length;ut+=se){const Ni=Q.slice(ut,ut+se);X+=btoa(String.fromCharCode.apply(null,Ni))}const Ee=`data:audio/wav;base64,${X}`,ve=await E.getIdToken(),le=new AbortController,Ce=setTimeout(()=>le.abort(),1e4),Me=await fetch("https://us-central1-moomhe-6de30.cloudfunctions.net/speechToText",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audioData:Ee,authToken:ve}),signal:le.signal});clearTimeout(Ce);const Ze=await Me.json();if(Ze.success&&Ze.text){const ut=lt.trim();Tt(ut?ut+" "+Ze.text:Ze.text)}else console.error("Speech-to-text failed:",Ze.error),zr("שגיאה בעיבוד ההקלטה. אנא נסה שוב.")}catch(C){C.name==="AbortError"?(console.error("Speech-to-text timeout"),zr("העיבוד ארך זמן רב מדי. אנא נסה הקלטה קצרה יותר.")):(console.error("Error processing speech:",C),zr("שגיאה בעיבוד ההקלטה. אנא נסה שוב."))}finally{ki(!1)}},Wl=async()=>{if(!(o||sn)){if(gt&&Pi)Pi.stop(),Xo(!1);else if(!gt){zr(null),Fn(!1);let w=$r;if((!w||!vd||!w.active||w.getTracks().length===0)&&(console.log("Stream invalid or missing, creating new one..."),zr("מאתחל מיקרופון..."),w=await Gl(),zr(null),!w)){console.error("Failed to initialize microphone"),Fn(!0);return}const C=ea(w);if(!C){console.error("Failed to create MediaRecorder, trying to recreate stream...");const U=await Gl();if(!U){console.error("Failed to recreate microphone stream"),Fn(!0);return}const Q=ea(U);if(!Q){console.error("Failed to create MediaRecorder even after stream recreation"),Fn(!0);return}Ls(Q),Yn([]),Q.start(),Xo(!0);return}Ls(C),Yn([]),C.start(),Xo(!0)}}};ne.useEffect(()=>{if(!(window.innerWidth<1024)){const C=na[t]||[];ie(C),console.log("Loaded default objects for category:",t,C)}},[t]);const na={"עיצוב פנים וחוץ":["קירות בהירים","ספה אפורה","כורסא לבנה","שולחן קפה עגול","שתי מראות קש","שטיח בהיר","אגרטל לבן","מנורת רצפה","סלסלת קש","כריות נוי","שמיכת נוי","הדום קש"],"גינות ומרפסות":["קיר בז'","דק עץ","עץ קטן","עץ גדול","כרית כחולה","עששית שחורה קטנה","עששית שחורה גדולה","שולחן עגול","קומקום כסף","סל קש","חלון גדול","עציץ קטן"],"איפור וטיפוח":["פנים של אישה","שיער חום","כתפיים חשופות","רקע בהיר"],"פרסום ומוצרים":["פחית שתייה","משטח עץ"],"פרופיל ותדמית":["גבר מזוקן","שיער אפור","ז'קט בז'","חולצה בהירה","קיר זכוכית"],"רכבים ודו גלגלי":["מכונית כתומה","עצים ירוקים","שמיים בהירים","כביש אספלט","בניינים רחוקים","עמוד תאורה"],קעקועים:["אישה צעירה","רקע לבן","כתף חשופה","שיער ג'ינג'י","שפתיים אדומות"]},ra={"עיצוב פנים וחוץ":[{name:"שינוי טוטאלי",action:()=>b(!I),icon:RN},{name:"תיקונים/נזקים",action:()=>T(!N),icon:Oi},{name:"שנה צבע",action:()=>u(!l),icon:on},{name:"זווית",action:()=>f(!d),icon:qs},{name:"תאורה",action:()=>v(!p),icon:xN},{name:"ריהוט",action:()=>P(!S),icon:PN},{name:"דלתות/חלונות",action:()=>$(!M),icon:Om},{name:"רחצה",action:()=>A(!z),icon:SN}],"גינות ומרפסות":[{name:"שינוי טוטאלי",action:()=>b(!I),icon:on},{name:"תיקונים/נזקים",action:()=>T(!N),icon:Oi},{name:"שנה צבע",action:()=>u(!l),icon:on},{name:"זווית",action:()=>f(!d),icon:qs},{name:"הוסף צמחים",action:()=>Te("Add beautiful plants and flowers to this garden"),icon:kN},{name:"שיפור תאורה",action:()=>Te("Enhance the outdoor lighting"),icon:an}],"רכבים ודו גלגלי":[{name:"שינוי טוטאלי",action:()=>b(!I),icon:on},{name:"תיקונים/נזקים",action:()=>T(!N),icon:Oi},{name:"שנה צבע",action:()=>u(!l),icon:on},{name:"זווית",action:()=>f(!d),icon:qs},{name:"שיפור תאורה",action:()=>Te("Enhance the lighting and reflections on this vehicle"),icon:an},{name:"הוסף אביזרים",action:()=>Te("Add accessories and modifications to this vehicle"),icon:da}],קעקועים:[{name:"שינוי טוטאלי",action:()=>b(!I),icon:on},{name:"תיקונים/נזקים",action:()=>T(!N),icon:Oi},{name:"שנה צבע",action:()=>u(!l),icon:on},{name:"זווית",action:()=>f(!d),icon:qs},{name:"שיפור תאורה",action:()=>Te("Enhance the lighting to show the tattoo details"),icon:an},{name:"הוסף פרטים",action:()=>Te("Add more details and shading to this tattoo"),icon:da}],"איפור וטיפוח":[{name:"שינוי טוטאלי",action:()=>b(!I),icon:on},{name:"תיקונים/נזקים",action:()=>T(!N),icon:Oi},{name:"שנה צבע",action:()=>u(!l),icon:on},{name:"זווית",action:()=>f(!d),icon:qs},{name:"שיפור תאורה",action:()=>Te("Enhance the lighting for better makeup visibility"),icon:an},{name:"הוסף איפור",action:()=>Te("Add more makeup and beauty enhancements"),icon:ih}],"פרסום ומוצרים":[{name:"שינוי טוטאלי",action:()=>b(!I),icon:on},{name:"תיקונים/נזקים",action:()=>T(!N),icon:Oi},{name:"שנה צבע",action:()=>u(!l),icon:on},{name:"זווית",action:()=>f(!d),icon:qs},{name:"שיפור תאורה",action:()=>Te("Enhance the product lighting and presentation"),icon:an},{name:"הוסף פרטים",action:()=>Te("Add product details and features"),icon:da}],"פרופיל ותדמית":[{name:"שינוי טוטאלי",action:()=>b(!I),icon:on},{name:"תיקונים/נזקים",action:()=>T(!N),icon:Oi},{name:"שנה צבע",action:()=>u(!l),icon:on},{name:"זווית",action:()=>f(!d),icon:qs},{name:"שיפור תאורה",action:()=>Te("Enhance the portrait lighting"),icon:an},{name:"הוסף רקע",action:()=>Te("Add a professional background"),icon:da}]},Ed=async w=>{const C=w.target.files[0];if(C){const U=C.type==="image/heic"||C.type==="image/heif"||C.name.toLowerCase().endsWith(".heic")||C.name.toLowerCase().endsWith(".heif");U&&console.log("HEIC file detected, converting to JPEG...");const Q=new FileReader;Q.onload=async X=>{const se=X.target.result;let Ee=se;try{const ve=await Qo(se,1920,1080,.8),le=new FileReader;Ee=await new Promise(Ce=>{le.onload=()=>Ce(le.result),le.readAsDataURL(ve)}),console.log("Image compressed for display")}catch(ve){console.warn("Failed to compress image for display, using original:",ve),U&&console.error("HEIC conversion failed, please try uploading a JPEG or PNG image instead")}if(r(Ee),s(Ee),Qt(16/9),Oe(null),D&&E){rn(!0);try{const ve=await UP(E.uid,C,`Uploaded: ${C.name}`),le=ve.id;console.log("Upload result ID:",le),console.log("Upload result:",ve);const Ce=await Ta(E.uid,1,7);R(Ce.history),Ur(1),fr(Ce.hasMore),Oe(le),console.log("Set current history ID to newly uploaded image:",le),console.log("Current history after reload:",Ce.history.map(Ze=>({id:Ze.id,prompt:Ze.prompt}))),window.innerWidth<1024||(console.log("About to detect objects for history ID:",le),Ir(Ee,le))}catch(ve){console.error("Failed to save upload to Firebase:",ve)}finally{rn(!1)}}else if(!(window.innerWidth<1024)){const le=na[t]||[];ie(le)}},Q.readAsDataURL(C)}},Kl=()=>{wd.current.click()},Td=async()=>{try{let w=i;if(w.startsWith("https://firebasestorage.googleapis.com/")){const C=document.createElement("a");C.href=w,C.download="moomhe-design.png",C.target="_blank",document.body.appendChild(C),C.click(),document.body.removeChild(C)}else{const U=await(await fetch(w)).blob(),Q=window.URL.createObjectURL(U),X=document.createElement("a");X.href=Q,X.download="moomhe-design.png",document.body.appendChild(X),X.click(),document.body.removeChild(X),window.URL.revokeObjectURL(Q)}}catch(w){console.error("Download failed:",w);try{window.open(i,"_blank")}catch(C){console.error("Fallback download also failed:",C),alert("שגיאה בהורדת התמונה. נסה שוב.")}}},Vs=async()=>{try{let w=i;const C=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(w.startsWith("data:"))try{a(!0);const{downloadURL:U}=await BP((E==null?void 0:E.uid)||"anonymous",w);w=U,console.log("📤 Image uploaded to temporary storage:",U)}catch(U){console.error("Error uploading image to Firebase:",U),alert("שגיאה בהעלאת התמונה. נסה שוב.");return}finally{a(!1)}if(C){const U=`whatsapp://send?text=צפה בעיצוב שיצרתי עם MoomHe: ${encodeURIComponent(w)}`;window.open(U,"_blank")}else{const U=`https://web.whatsapp.com/send?text=צפה בעיצוב שיצרתי עם MoomHe: ${encodeURIComponent(w)}`;window.open(U,"_blank")}}catch(w){console.error("WhatsApp share failed:",w),alert("שגיאה בשיתוף לוואטסאפ. נסה שוב.")}},Ql=w=>{const C=w.storageUrl||w.imageUrl;if(s(C),Qt(16/9),Oe(w.id),w.objects){let U=w.objects;if(Array.isArray(w.objects)&&w.objects.length>0){const Q=w.objects[0];typeof Q=="string"&&Q.includes(",")&&(U=Q.split(",").map(X=>X.trim()).filter(X=>X.length>0))}else typeof w.objects=="string"&&(U=w.objects.split(",").map(Q=>Q.trim()).filter(Q=>Q.length>0));U.length>0?(ie(U),console.log("Loaded objects from history entry:",U)):(ie([]),console.log("No valid objects found in history entry"))}else ie([]),console.log("No objects field in history entry")},ia=()=>{o||Vn(!0)},Ci=w=>{const C=w.target,U=C.naturalWidth/C.naturalHeight;Qt(U)},wr=async w=>{const C=w.target.files[0];if(C){const U=new FileReader;U.onload=Q=>{jr(Q.target.result),Ei(C)},U.readAsDataURL(C)}},sa=()=>{Jn.current.click()},Ad=()=>{jr(null),Ei(null),Jn.current&&(Jn.current.value="")},bd=async w=>{if(w.preventDefault(),!(!Yt||!pr)){if(vn==="signup"&&Yt!==mt){alert("כתובות האימייל אינן תואמות. נסה שוב.");return}Si(!0);try{if(vn==="signup")if(E&&E.isAnonymous){const{linkWithCredential:U,EmailAuthProvider:Q}=await Gr(()=>import("./index.esm-d877e13a.js"),[]),X=Q.credential(Yt,pr);try{const se=await U(E,X);await Js(se.user),alert("החשבון נוצר בהצלחה! כל הנתונים שלך נשמרו.")}catch(se){if(se.code==="auth/email-already-in-use"){const{createUserWithEmailAndPassword:Ee}=await Gr(()=>import("./index.esm-d877e13a.js"),[]),ve=await Ee(Bi,Yt,pr);await Sd(E.uid,ve.user.uid),await Js(ve.user),alert("החשבון נוצר בהצלחה! כל הנתונים שלך הועברו לחשבון החדש.")}else throw se}}else{const{createUserWithEmailAndPassword:U}=await Gr(()=>import("./index.esm-d877e13a.js"),[]),Q=await U(Bi,Yt,pr);await Js(Q.user),alert("החשבון נוצר בהצלחה!")}else{const{signInWithEmailAndPassword:C}=await Gr(()=>import("./index.esm-d877e13a.js"),[]),U=await C(Bi,Yt,pr);await Js(U.user),alert("התחברת בהצלחה!")}bi(!1),ct(""),Ri(""),Jo(""),Br("signup")}catch(C){console.error("Authentication error:",C),C.code==="auth/email-already-in-use"?(alert("כתובת האימייל כבר בשימוש. נסה להתחבר במקום."),Br("login")):C.code==="auth/user-not-found"?(alert("משתמש לא נמצא. נסה ליצור חשבון חדש."),Br("signup")):C.code==="auth/wrong-password"?alert("סיסמה שגויה. נסה שוב."):C.code==="auth/weak-password"?alert("הסיסמה חלשה מדי. השתמש בסיסמה של לפחות 6 תווים."):alert("שגיאה בהתחברות. נסה שוב.")}finally{Si(!1)}}},Rd=async()=>{if(!Yt){alert("אנא הזן כתובת אימייל תחילה.");return}$l(!0);try{const{sendPasswordResetEmail:w}=await Gr(()=>import("./index.esm-d877e13a.js"),[]);await w(Bi,Yt),alert("נשלח אימייל לאיפוס סיסמה לכתובת שלך.")}catch(w){console.error("Password reset error:",w),w.code==="auth/user-not-found"?alert("כתובת האימייל לא נמצאה במערכת."):alert("שגיאה בשליחת אימייל איפוס. נסה שוב.")}finally{$l(!1)}},Sd=async(w,C)=>{try{const{collection:U,query:Q,where:X,getDocs:se,doc:Ee,setDoc:ve,deleteDoc:le}=await Gr(()=>import("./index.esm-e120ba5a.js"),[]),{db:Ce}=await Gr(()=>Promise.resolve().then(()=>A6),void 0),Me=U(Ce,"userHistory"),Ze=Q(Me,X("userId","==",w)),ut=await se(Ze),Ni=[];if(ut.forEach(qr=>{const Fe=qr.data();Fe.userId=C;const rm=Ee(U(Ce,"userHistory"));Ni.push(ve(rm,Fe)),Ni.push(le(qr.ref))}),await Promise.all(Ni),console.log(`Migrated ${ut.size} history entries from ${w} to ${C}`),D){const qr=await Ta(C,1,7);R(qr.history),Ur(1),fr(qr.hasMore)}}catch(U){console.error("Error migrating user data:",U)}},Yl=async()=>{try{const{signOut:w}=await Gr(()=>import("./index.esm-d877e13a.js"),[]);await w(Bi),R([]),ie([]),k(null),x(!1),Os(!1),window.location.reload()}catch(w){console.error("Logout error:",w),alert("שגיאה בהתנתקות. נסה שוב.")}},Ms=async()=>{if(!D||!E||Ai||!Ti){console.log("Load more history blocked:",{isAuthenticated:D,currentUser:!!E,isLoadingMoreHistory:Ai,hasMoreHistory:Ti});return}console.log("Loading more history, current page:",Yo),Ul(!0);try{const w=Yo+1,C=await Ta(E.uid,w,7);console.log("Load more result:",{nextPage:w,historyCount:C.history.length,hasMore:C.hasMore}),C.history.length>0?(R(U=>[...U,...C.history]),Ur(w),fr(C.hasMore)):fr(!1)}catch(w){console.error("Failed to load more history:",w)}finally{Ul(!1)}};ne.useEffect(()=>{const w=C=>{xi&&_r.current&&!_r.current.contains(C.target)&&zl(!1),ql&&!C.target.closest(".suggestions-modal")&&mr(!1)};return document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[xi,ql]);const xd=w=>{const C=String(w.getDate()).padStart(2,"0"),U=String(w.getMonth()+1).padStart(2,"0"),Q=String(w.getFullYear()).slice(-2);return`${C}/${U}/${Q}`},Pd=w=>{const U=Math.floor((new Date-w)/1e3);return U<60?"לפני רגע":U<3600?`לפני ${Math.floor(U/60)} דקות`:U<86400?`לפני ${Math.floor(U/3600)} שעות`:U<172800?"אתמול":U<604800?`לפני ${Math.floor(U/86400)} ימים`:U<2592e3?`לפני ${Math.floor(U/604800)} שבועות`:U<31536e3?`לפני ${Math.floor(U/2592e3)} חודשים`:`לפני ${Math.floor(U/31536e3)} שנים`},kd=w=>{const C=w.createdAt;if(!C)return"תאריך לא זמין";if(/^\d{2}\/\d{2}\/\d{2}$/.test(C))return C;try{let U;if(C&&typeof C=="object"&&C.toDate?U=C.toDate():C&&typeof C=="object"&&C.seconds?U=new Date(C.seconds*1e3):U=new Date(C),!isNaN(U.getTime()))return Pd(U)}catch(U){console.warn("Failed to parse timestamp:",C,U)}return C||"תאריך לא זמין"},Cd=()=>{Vn(!1)},Nd=w=>{Te(w)},Fs=async()=>{if(lt.trim()){if(D&&E&&!await _a.canMakeRequest(E.uid)){alert("הגעת למגבלת הדורות החודשית. נסה שוב בחודש הבא.");return}a(!0);try{const w=lt;let C=w;Qn&&(C=`השתמש בתמונות שצורפו, ${w}`),console.log("🎯 Final prompt for AI:",C),await $s(C),Tt(""),jr(null),Ei(null),Jn.current&&(Jn.current.value="")}catch(w){console.error("Custom prompt failed:",w),alert("שגיאה בעיבוד הבקשה. נסה שוב.")}finally{a(!1)}}},Xp=async w=>{if(w){if(!_e){console.log("No current history ID available for object detection");return}return console.log("detectObjects called with currentHistoryId:",_e),console.log("detectObjects called with imageUrl:",w),Ir(w,_e)}},Ir=async(w,C)=>{if(!(!w||!C)){console.log("detectObjectsWithId called with historyId:",C),console.log("detectObjectsWithId called with imageUrl:",w),Pe(!0);try{if(D&&E&&!await _a.canMakeRequest(E.uid)){alert("הגעת למגבלת הדורות החודשית. נסה שוב בחודש הבא."),Pe(!1);return}let U=w;if(w.startsWith("/assets/")||w.startsWith("./assets/"))try{const se=await(await fetch(w)).blob();U=await new Promise(ve=>{const le=new FileReader;le.onload=()=>ve(le.result),le.readAsDataURL(se)})}catch(X){throw console.error("Error converting local image to data URL:",X),new Error("Failed to load the image for object detection")}console.log("Submitting object detection request for history ID:",C);const Q=await _a.submitObjectDetectionRequest(E,U,C);if(console.log("Object detection result:",Q),console.log("Objects will be saved to history ID:",C),Q&&Q.objects){console.log("Raw objects from server:",Q.objects),console.log("Type of objects:",typeof Q.objects);let X=Q.objects;if(Array.isArray(Q.objects)&&Q.objects.length>0){console.log("Objects is array, checking first element...");const se=Q.objects[0];typeof se=="string"&&se.includes(",")?(console.log("First element is comma-separated string, parsing..."),X=se.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),console.log("Parsed objects array:",X)):console.log("Using array as-is:",X)}else typeof Q.objects=="string"?(console.log("Parsing string objects..."),X=Q.objects.split(",").map(se=>se.trim()).filter(se=>se.length>0),console.log("Parsed objects array:",X)):console.log("Objects is already an array:",X);ie(X),console.log("Final detected objects:",X),C&&_.length>0&&(R(se=>se.map(Ee=>Ee.id===C?{...Ee,objects:X}:Ee)),console.log("Updated local imageHistory with detected objects for ID:",C,X))}else ie([])}catch(U){console.error("Object detection failed:",U),ie([]),alert("שגיאה בזיהוי אובייקטים. נסה שוב.")}finally{Pe(!1)}}},Xn={אדומים:"#C1121C",כתומים:"#FF7514",צהובים:"#E5BE01",ירוקים:"#287233",כחולים:"#1E2460",סגולים:"#6D3F5B",אפורים:"#78858B","לבנים ושחורים":"#F4F4F4"},js={אדומים:[{name:"Flame red",value:"flame red",hex:"#C1121C",ral:"RAL 3000"},{name:"Signal red",value:"signal red",hex:"#A52019",ral:"RAL 3001"},{name:"Carmine red",value:"carmine red",hex:"#A2231D",ral:"RAL 3002"},{name:"Ruby red",value:"ruby red",hex:"#9B111E",ral:"RAL 3003"},{name:"Purple red",value:"purple red",hex:"#75151E",ral:"RAL 3004"},{name:"Wine red",value:"wine red",hex:"#5E2129",ral:"RAL 3005"},{name:"Black red",value:"black red",hex:"#412227",ral:"RAL 3007"},{name:"Oxide red",value:"oxide red",hex:"#642424",ral:"RAL 3009"},{name:"Brown red",value:"brown red",hex:"#781F19",ral:"RAL 3011"},{name:"Beige red",value:"beige red",hex:"#C1876B",ral:"RAL 3012"},{name:"Tomato red",value:"tomato red",hex:"#A12312",ral:"RAL 3013"},{name:"Antique pink",value:"antique pink",hex:"#D36E70",ral:"RAL 3014"},{name:"Light pink",value:"light pink",hex:"#EA899A",ral:"RAL 3015"},{name:"Coral red",value:"coral red",hex:"#B32821",ral:"RAL 3016"},{name:"Rose",value:"rose",hex:"#E63244",ral:"RAL 3017"},{name:"Strawberry red",value:"strawberry red",hex:"#D53032",ral:"RAL 3018"},{name:"Traffic red",value:"traffic red",hex:"#CC0605",ral:"RAL 3020"},{name:"Salmon pink",value:"salmon pink",hex:"#D95030",ral:"RAL 3022"},{name:"Raspberry red",value:"raspberry red",hex:"#C51D34",ral:"RAL 3027"},{name:"Orient red",value:"orient red",hex:"#B32428",ral:"RAL 3031"}],כתומים:[{name:"Red orange",value:"red orange",hex:"#C93C20",ral:"RAL 2001"},{name:"Vermilion",value:"vermilion",hex:"#CB2821",ral:"RAL 2002"},{name:"Pastel orange",value:"pastel orange",hex:"#FF7514",ral:"RAL 2003"},{name:"Pure orange",value:"pure orange",hex:"#F44611",ral:"RAL 2004"},{name:"Bright red orange",value:"bright red orange",hex:"#F75E25",ral:"RAL 2008"},{name:"Traffic orange",value:"traffic orange",hex:"#F54021",ral:"RAL 2009"},{name:"Signal orange",value:"signal orange",hex:"#D84B20",ral:"RAL 2010"},{name:"Deep orange",value:"deep orange",hex:"#EC7C26",ral:"RAL 2011"},{name:"Salmon range",value:"salmon range",hex:"#E55137",ral:"RAL 2012"}],צהובים:[{name:"Green beige",value:"green beige",hex:"#BEBD7F",ral:"RAL 1000"},{name:"Beige",value:"beige",hex:"#C2B078",ral:"RAL 1001"},{name:"Sand yellow",value:"sand yellow",hex:"#C6A664",ral:"RAL 1002"},{name:"Signal yellow",value:"signal yellow",hex:"#E5BE01",ral:"RAL 1003"},{name:"Golden yellow",value:"golden yellow",hex:"#CDA434",ral:"RAL 1004"},{name:"Honey yellow",value:"honey yellow",hex:"#A98307",ral:"RAL 1005"},{name:"Maize yellow",value:"maize yellow",hex:"#E4A010",ral:"RAL 1006"},{name:"Daffodil yellow",value:"daffodil yellow",hex:"#DC9D00",ral:"RAL 1007"},{name:"Brown beige",value:"brown beige",hex:"#8A6642",ral:"RAL 1011"},{name:"Lemon yellow",value:"lemon yellow",hex:"#C7B446",ral:"RAL 1012"},{name:"Oyster white",value:"oyster white",hex:"#EAE6CA",ral:"RAL 1013"},{name:"Ivory",value:"ivory",hex:"#E1CC4F",ral:"RAL 1014"},{name:"Light ivory",value:"light ivory",hex:"#E6D690",ral:"RAL 1015"},{name:"Sulfur yellow",value:"sulfur yellow",hex:"#EDFF21",ral:"RAL 1016"},{name:"Saffron yellow",value:"saffron yellow",hex:"#F5D033",ral:"RAL 1017"},{name:"Zinc yellow",value:"zinc yellow",hex:"#F8F32B",ral:"RAL 1018"},{name:"Grey beige",value:"grey beige",hex:"#a28f7a",ral:"RAL 1019"},{name:"Olive yellow",value:"olive yellow",hex:"#999950",ral:"RAL 1020"},{name:"Rape yellow",value:"rape yellow",hex:"#F3DA0B",ral:"RAL 1021"},{name:"Traffic yellow",value:"traffic yellow",hex:"#FAD201",ral:"RAL 1023"},{name:"Ochre yellow",value:"ochre yellow",hex:"#AEA04B",ral:"RAL 1024"},{name:"Curry",value:"curry",hex:"#9D9101",ral:"RAL 1027"},{name:"Melon yellow",value:"melon yellow",hex:"#F4A900",ral:"RAL 1028"},{name:"Broom yellow",value:"broom yellow",hex:"#D6AE01",ral:"RAL 1032"},{name:"Dahlia yellow",value:"dahlia yellow",hex:"#F3A505",ral:"RAL 1033"},{name:"Pastel yellow",value:"pastel yellow",hex:"#EFA94A",ral:"RAL 1034"},{name:"Sun yellow",value:"sun yellow",hex:"#F39F18",ral:"RAL 1037"}],ירוקים:[{name:"Patina green",value:"patina green",hex:"#316650",ral:"RAL 6000"},{name:"Emerald green",value:"emerald green",hex:"#287233",ral:"RAL 6001"},{name:"Leaf green",value:"leaf green",hex:"#2D572C",ral:"RAL 6002"},{name:"Olive green",value:"olive green",hex:"#424632",ral:"RAL 6003"},{name:"Blue green",value:"blue green",hex:"#1F3A3D",ral:"RAL 6004"},{name:"Moss green",value:"moss green",hex:"#2F4538",ral:"RAL 6005"},{name:"Bottle green",value:"bottle green",hex:"#343B29",ral:"RAL 6007"},{name:"Brown green",value:"brown green",hex:"#39352A",ral:"RAL 6008"},{name:"Fir green",value:"fir green",hex:"#31372B",ral:"RAL 6009"},{name:"Grass green",value:"grass green",hex:"#35682D",ral:"RAL 6010"},{name:"Reseda green",value:"reseda green",hex:"#587246",ral:"RAL 6011"},{name:"Black green",value:"black green",hex:"#343E40",ral:"RAL 6012"},{name:"Reed green",value:"reed green",hex:"#6C7156",ral:"RAL 6013"},{name:"Yellow olive",value:"yellow olive",hex:"#47402E",ral:"RAL 6014"},{name:"Black olive",value:"black olive",hex:"#3B3C36",ral:"RAL 6015"},{name:"Turquoise green",value:"turquoise green",hex:"#1E5945",ral:"RAL 6016"},{name:"May green",value:"may green",hex:"#4C9141",ral:"RAL 6017"},{name:"Yellow green",value:"yellow green",hex:"#57A639",ral:"RAL 6018"},{name:"Pastel green",value:"pastel green",hex:"#BDECB6",ral:"RAL 6019"},{name:"Chrome green",value:"chrome green",hex:"#2E3A23",ral:"RAL 6020"},{name:"Pale green",value:"pale green",hex:"#89AC76",ral:"RAL 6021"},{name:"Olive drab",value:"olive drab",hex:"#25221B",ral:"RAL 6022"},{name:"Traffic green",value:"traffic green",hex:"#308446",ral:"RAL 6024"},{name:"Fern green",value:"fern green",hex:"#3D642D",ral:"RAL 6025"},{name:"Opal green",value:"opal green",hex:"#015D52",ral:"RAL 6026"},{name:"Light green",value:"light green",hex:"#84C3BE",ral:"RAL 6027"},{name:"Pine green",value:"pine green",hex:"#2C5545",ral:"RAL 6028"},{name:"Mint green",value:"mint green",hex:"#20603D",ral:"RAL 6029"},{name:"Signal green",value:"signal green",hex:"#317F43",ral:"RAL 6032"},{name:"Mint turquoise",value:"mint turquoise",hex:"#497E76",ral:"RAL 6033"},{name:"Pastel turquoise",value:"pastel turquoise",hex:"#7FB5B5",ral:"RAL 6034"}],כחולים:[{name:"Violet blue",value:"violet blue",hex:"#354D73",ral:"RAL 5000"},{name:"Green blue",value:"green blue",hex:"#1F3438",ral:"RAL 5001"},{name:"Ultramarine blue",value:"ultramarine blue",hex:"#20214F",ral:"RAL 5002"},{name:"Saphire blue",value:"saphire blue",hex:"#1D1E33",ral:"RAL 5003"},{name:"Black blue",value:"black blue",hex:"#18171C",ral:"RAL 5004"},{name:"Signal blue",value:"signal blue",hex:"#1E2460",ral:"RAL 5005"},{name:"Brillant blue",value:"brillant blue",hex:"#3E5F8A",ral:"RAL 5007"},{name:"Grey blue",value:"grey blue",hex:"#26252D",ral:"RAL 5008"},{name:"Azure blue",value:"azure blue",hex:"#225f78",ral:"RAL 5009"},{name:"Gentian blue",value:"gentian blue",hex:"#0E294B",ral:"RAL 5010"},{name:"Steel blue",value:"steel blue",hex:"#231A24",ral:"RAL 5011"},{name:"Light blue",value:"light blue",hex:"#3B83BD",ral:"RAL 5012"},{name:"Cobalt blue",value:"cobalt blue",hex:"#1E213D",ral:"RAL 5013"},{name:"Pigeon blue",value:"pigeon blue",hex:"#606E8C",ral:"RAL 5014"},{name:"Sky blue",value:"sky blue",hex:"#2271B3",ral:"RAL 5015"},{name:"Traffic blue",value:"traffic blue",hex:"#063971",ral:"RAL 5017"},{name:"Turquoise blue",value:"turquoise blue",hex:"#3F888F",ral:"RAL 5018"},{name:"Capri blue",value:"capri blue",hex:"#1B5583",ral:"RAL 5019"},{name:"Ocean blue",value:"ocean blue",hex:"#1D334A",ral:"RAL 5020"},{name:"Water blue",value:"water blue",hex:"#256D7B",ral:"RAL 5021"},{name:"Night blue",value:"night blue",hex:"#252850",ral:"RAL 5022"},{name:"Distant blue",value:"distant blue",hex:"#49678D",ral:"RAL 5023"},{name:"Pastel blue",value:"pastel blue",hex:"#5D9B9B",ral:"RAL 5024"}],סגולים:[{name:"Red lilac",value:"red lilac",hex:"#6D3F5B",ral:"RAL 4001"},{name:"Red violet",value:"red violet",hex:"#922B3E",ral:"RAL 4002"},{name:"Heather violet",value:"heather violet",hex:"#DE4C8A",ral:"RAL 4003"},{name:"Claret violet",value:"claret violet",hex:"#641C34",ral:"RAL 4004"},{name:"Blue lilac",value:"blue lilac",hex:"#6C4675",ral:"RAL 4005"},{name:"Traffic purple",value:"traffic purple",hex:"#A03472",ral:"RAL 4006"},{name:"Purple violet",value:"purple violet",hex:"#4A192C",ral:"RAL 4007"},{name:"Signal violet",value:"signal violet",hex:"#924E7D",ral:"RAL 4008"},{name:"Pastel violet",value:"pastel violet",hex:"#A18594",ral:"RAL 4009"},{name:"Telemagenta",value:"telemagenta",hex:"#CF3476",ral:"RAL 4010"}],אפורים:[{name:"Squirrel grey",value:"squirrel grey",hex:"#78858B",ral:"RAL 7000"},{name:"Silver grey",value:"silver grey",hex:"#8A9597",ral:"RAL 7001"},{name:"Olive grey",value:"olive grey",hex:"#7E7B52",ral:"RAL 7002"},{name:"Moss grey",value:"moss grey",hex:"#6C7059",ral:"RAL 7003"},{name:"Signal grey",value:"signal grey",hex:"#969992",ral:"RAL 7004"},{name:"Mouse grey",value:"mouse grey",hex:"#646B63",ral:"RAL 7005"},{name:"Beige grey",value:"beige grey",hex:"#6D6552",ral:"RAL 7006"},{name:"Khaki grey",value:"khaki grey",hex:"#6A5F31",ral:"RAL 7008"},{name:"Green grey",value:"green grey",hex:"#4D5645",ral:"RAL 7009"},{name:"Tarpaulin grey",value:"tarpaulin grey",hex:"#4C514A",ral:"RAL 7010"},{name:"Iron grey",value:"iron grey",hex:"#434B4D",ral:"RAL 7011"},{name:"Basalt grey",value:"basalt grey",hex:"#4E5754",ral:"RAL 7012"},{name:"Brown grey",value:"brown grey",hex:"#464531",ral:"RAL 7013"},{name:"Slate grey",value:"slate grey",hex:"#434750",ral:"RAL 7015"},{name:"Anthracite grey",value:"anthracite grey",hex:"#293133",ral:"RAL 7016"},{name:"Black grey",value:"black grey",hex:"#23282B",ral:"RAL 7021"},{name:"Umbra grey",value:"umbra grey",hex:"#332F2C",ral:"RAL 7022"},{name:"Concrete grey",value:"concrete grey",hex:"#686C5E",ral:"RAL 7023"},{name:"Graphite grey",value:"graphite grey",hex:"#474A51",ral:"RAL 7024"},{name:"Granite grey",value:"granite grey",hex:"#2F353B",ral:"RAL 7026"},{name:"Stone grey",value:"stone grey",hex:"#8B8C7A",ral:"RAL 7030"},{name:"Blue grey",value:"blue grey",hex:"#8B8C7A",ral:"RAL 7031"},{name:"Pebble grey",value:"pebble grey",hex:"#B8B799",ral:"RAL 7032"},{name:"Cement grey",value:"cement grey",hex:"#7D8471",ral:"RAL 7033"},{name:"Yellow grey",value:"yellow grey",hex:"#8F8B66",ral:"RAL 7034"},{name:"Light grey",value:"light grey",hex:"#D7D7D7",ral:"RAL 7035"},{name:"Platinum grey",value:"platinum grey",hex:"#7F7679",ral:"RAL 7036"},{name:"Dusty grey",value:"dusty grey",hex:"#7D7F7D",ral:"RAL 7037"},{name:"Agate grey",value:"agate grey",hex:"#B5B8B1",ral:"RAL 7038"},{name:"Quartz grey",value:"quartz grey",hex:"#6C6960",ral:"RAL 7039"},{name:"Window grey",value:"window grey",hex:"#9DA1AA",ral:"RAL 7040"},{name:"Traffic grey A",value:"traffic grey A",hex:"#8D948D",ral:"RAL 7042"},{name:"Traffic grey B",value:"traffic grey B",hex:"#4E5452",ral:"RAL 7043"},{name:"Silk grey",value:"silk grey",hex:"#CAC4B0",ral:"RAL 7044"},{name:"Telegrey 1",value:"telegrey 1",hex:"#909090",ral:"RAL 7045"},{name:"Telegrey 2",value:"telegrey 2",hex:"#82898F",ral:"RAL 7046"},{name:"Telegrey 4",value:"telegrey 4",hex:"#D0D0D0",ral:"RAL 7047"}],"לבנים ושחורים":[{name:"Cream",value:"cream",hex:"#FDF4E3",ral:"RAL 9001"},{name:"Grey white",value:"grey white",hex:"#E7EBDA",ral:"RAL 9002"},{name:"Signal white",value:"signal white",hex:"#F4F4F4",ral:"RAL 9003"},{name:"Signal black",value:"signal black",hex:"#282828",ral:"RAL 9004"},{name:"Jet black",value:"jet black",hex:"#0A0A0A",ral:"RAL 9005"},{name:"Pure white",value:"pure white",hex:"#FFFFFF",ral:"RAL 9010"},{name:"Graphite black",value:"graphite black",hex:"#1C1C1C",ral:"RAL 9011"},{name:"Traffic white",value:"traffic white",hex:"#F6F6F6",ral:"RAL 9016"},{name:"Traffic black",value:"traffic black",hex:"#1E1E1E",ral:"RAL 9017"},{name:"Papyrus white",value:"papyrus white",hex:"#D7D7D7",ral:"RAL 9018"}]},oa=w=>{u(!1);const C=`צבע בצבע ${w.ral} את ה`;console.log("🎨 Color Selection - Prompt being added to input:",C),console.log("🎨 Selected color:",w.ral,w.name),Te(C)},Dd=[{name:"מבט מלמעלה",value:"bird's eye view",icon:"⬆️",prompt:"שנה את התמונה להציג מבט מלמעלה"},{name:"סובב שמאלה",value:"left angle",icon:"⬅️",prompt:"סובב את המצלמה 45 מעלות שמאלה"},{name:"סובב ימינה",value:"right angle",icon:"➡️",prompt:"סובב את המצלמה 45 מעלות ימינה"},{name:"זום פנימה",value:"zoom in",icon:"🔍+",prompt:"זום פנימה להציג יותר פרטים בתמונה"},{name:"זום החוצה",value:"zoom out",icon:"🔍-",prompt:"זום החוצה להציג מבט רחב יותר של התמונה"},{name:"זווית אחורית",value:"back view",icon:"👁️‍🗨️",prompt:"שנה את כל התמונה להציג מבט אחורי 180 מעלות"}],ke=[{name:"תאורה מוסתרת",value:"recessed lighting",prompt:"הוסף תאורה מוסתרת"},{name:"נברשת",value:"pendant lights",prompt:"הוסף נברשת"},{name:"נברשת גדולה",value:"chandeliers",prompt:"הוסף נברשת גדולה"},{name:"מנורת שולחן",value:"table lamps",prompt:"הוסף מנורת שולחן"},{name:"מנורת רצפה",value:"floor lamps",prompt:"הוסף מנורת רצפה"},{name:"מנורת קיר",value:"wall sconces",prompt:"הוסף מנורת קיר"},{name:"תאורת מסילה",value:"track lighting",prompt:"הוסף תאורת מסילה"},{name:"תאורת תקרה",value:"ceiling fixtures",prompt:"הוסף תאורת תקרה"},{name:"תאורת מטבח",value:"under-cabinet lighting",prompt:"הוסף תאורת מטבח"},{name:"תאורה דקורטיבית",value:"string lights",prompt:"הוסף תאורה דקורטיבית"},{name:"יום",value:"day",prompt:"שנה את התאורה לתאורת יום"},{name:"לילה",value:"night",prompt:"שנה את התאורה לתאורת לילה"},{name:"שקיעה",value:"sunset",prompt:"שנה את התאורה לתאורת שקיעה"},{name:"זריחה",value:"sunrise",prompt:"שנה את התאורה לתאורת זריחה"}],aa=[{name:"ספה",value:"sofa",prompt:"הוסף ספה"},{name:"ספה פינתית",value:"sectional sofa",prompt:"הוסף ספה פינתית"},{name:"כורסא",value:"armchair",prompt:"הוסף כורסא"},{name:"כיסא דקורטיבי",value:"accent chair",prompt:"הוסף כיסא דקורטיבי"},{name:"כיסא אוכל",value:"dining chair",prompt:"הוסף כיסא אוכל"},{name:"שרפרף",value:"bar stool",prompt:"הוסף שרפרף"},{name:"מיטה יחידה",value:"single bed",prompt:"הוסף מיטה יחידה"},{name:"מיטה זוגית",value:"double bed",prompt:"הוסף מיטה זוגית"},{name:"פוף",value:"beanbag",prompt:"הוסף פוף"},{name:"הדום",value:"ottoman",prompt:"הוסף הדום"},{name:"ספסל",value:"bench",prompt:"הוסף ספסל"},{name:"שולחן קפה",value:"coffee table",prompt:"הוסף שולחן קפה"},{name:"שולחן צד",value:"end table",prompt:"הוסף שולחן צד"},{name:"שולחן לילה",value:"nightstand",prompt:"הוסף שולחן לילה"},{name:"שולחן אוכל",value:"dining table",prompt:"הוסף שולחן אוכל"},{name:"שולחן עבודה",value:"desk",prompt:"הוסף שולחן עבודה"},{name:"שידה",value:"dresser",prompt:"הוסף שידה"},{name:"ארון בגדים",value:"wardrobe",prompt:"הוסף ארון בגדים"},{name:"מדף ספרים",value:"bookcase",prompt:"הוסף מדף ספרים"},{name:"עמדת טלוויזיה",value:"tv stand",prompt:"הוסף עמדת טלוויזיה"},{name:"ארונות מטבח",value:"cabinetry",prompt:"הוסף ארונות מטבח"}],Us=[{name:"בצע תיקונים להכל",value:"repair everything",prompt:"בצע תיקונים להכל"},{name:"תסדר ותקנה את הכל",value:"fix and repair everything",prompt:"תסדר ותקנה את הכל"},{name:"תבלגן את הכל",value:"mess up everything",prompt:"תבלגן את הכל"},{name:"תהרוס ותגרום נזקים להכל",value:"destroy and cause damage to everything",prompt:"תהרוס ותגרום נזקים להכל"}],Bs=[{name:"מינימליסטי",value:"minimalist",prompt:"שנה את סגנון החדר למינימליסטי - נקי, פשוט, לא עמוס"},{name:"בוהו",value:"bohemian",prompt:"שנה את סגנון החדר לבוהו - אקלקטי, מרקם, חופשי"},{name:"אינדוסטריאלי",value:"industrial",prompt:"שנה את סגנון החדר לאינדוסטריאלי - חומרים גולמיים וחשופים"},{name:"מודרני אמצע המאה",value:"mid-century modern",prompt:"שנה את סגנון החדר למודרני אמצע המאה - חלק, רטרו, פונקציונלי"},{name:"סקנדינבי",value:"scandinavian",prompt:"שנה את סגנון החדר לסקנדינבי - בהיר, נוח, פונקציונלי"},{name:"מסורתי",value:"traditional",prompt:"שנה את סגנון החדר למסורתי - קלאסי, פורמלי, סימטרי"},{name:"חווה מודרנית",value:"modern farmhouse",prompt:"שנה את סגנון החדר לחווה מודרנית - כפרי, ניטרלי, רגוע"},{name:"עכשווי",value:"contemporary",prompt:"שנה את סגנון החדר לעכשווי - עדכני, חלק, מתוחכם"},{name:"חופי",value:"coastal",prompt:"שנה את סגנון החדר לחופי - אוורירי, בהיר, רוחי"},{name:"אר דקו",value:"art deco",prompt:"שנה את סגנון החדר לאר דקו - גיאומטרי, מפואר, גלמור"}],Zp=w=>{f(!1),console.log("📐 Angle Selection - Prompt being added to input:",w.prompt),console.log("📐 Selected angle:",w.name,w.value),Te(w.prompt)},Od=w=>{v(!1),console.log("💡 Lighting Selection - Prompt being added to input:",w.prompt),console.log("💡 Selected lighting:",w.name,w.value),Te(w.prompt)},em=w=>{P(!1),console.log("🪑 Furniture Selection - Prompt being added to input:",w.prompt),console.log("🪑 Selected furniture:",w.name,w.value),Te(w.prompt)},tm=w=>{T(!1),console.log("🔨 Repairs Selection - Prompt being added to input:",w.prompt),console.log("🔨 Selected repair:",w.name,w.value),Te(w.prompt)},nm=w=>{b(!1),console.log("🎨 Style Selection - Prompt being added to input:",w.prompt),console.log("🎨 Selected style:",w.name,w.value),Te(w.prompt)},Te=w=>{const C=lt.trim();let U;C?C.endsWith("את ה")?U=`${C}${w}`:U=`${C}, ${w}`:U=w,Tt(U)},$s=async w=>{var C,U,Q;if(i){a(!0);try{if(console.log("🎨 AI Image Alteration - Prompt being sent:",w),console.log("📸 Main image URL:",i),console.log("🖼️ Object image available:",!!Qn),D&&E&&!await _a.canMakeRequest(E.uid)){alert("הגעת למגבלת הדורות החודשית. נסה שוב בחודש הבא."),a(!1);return}let X=i;if(i.startsWith("/assets/")||i.startsWith("./assets/"))try{const Ce=await(await fetch(i)).blob();X=await new Promise(Ze=>{const ut=new FileReader;ut.onload=()=>Ze(ut.result),ut.readAsDataURL(Ce)})}catch(le){throw console.error("Error converting local image to data URL:",le),new Error("Failed to load the default image")}let se=null;Qn?(console.log("🖼️ Processing object image file:",Qn.name,Qn.type,Qn.size),se=await MP(Qn),console.log("🖼️ Object image processed successfully:",!!se)):console.log("🖼️ No object image file available");const Ee=await _a.submitImageGenerationRequest(E,w,X,se),ve=await _a.waitForRequestCompletion(Ee);if(console.log("AI Service result:",ve),ve&&ve.storageUrl){const le=ve.storageUrl,Ce={imageUrl:le,prompt:w,timestamp:xd(new Date)};if(D&&E){rn(!0);try{const Me=await Ta(E.uid,1,7);R(Me.history),Ur(1),fr(Me.hasMore)}catch(Me){console.error("Failed to reload history from Firebase:",Me)}finally{rn(!1)}}else{const Me={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...Ce};R(Ze=>[Me,...Ze]),Ur(1),fr(!0)}s(le),Qt(16/9),Oe(null),jr(null),Ei(null),Jn.current&&(Jn.current.value="")}else alert("התמונה לא עובדה בהצלחה. נסה עם תמונה אחרת או פעולה אחרת.")}catch(X){console.error("AI processing failed:",X),(C=X.message)!=null&&C.includes("limit reached")||(U=X.message)!=null&&U.includes("מגבלת הדורות")?alert("הגעת למגבלת הדורות החודשית. נסה שוב בחודש הבא."):(Q=X.message)!=null&&Q.includes("timeout")?alert("הבקשה ארכה יותר מדי זמן. נסה שוב."):alert("שגיאה בעיבוד התמונה. אנא נסה שוב או עם תמונה אחרת.")}finally{a(!1)}}};return g.jsxs("div",{className:"min-h-screen bg-background",children:[g.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"hidden md:flex justify-between items-center py-3",children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx("img",{src:"/Logo.png",alt:"MoomHe Logo",className:"h-16 w-auto"}),g.jsx("span",{className:"mr-2 text-sm text-gray-500",children:"עיצוב פנים וחוץ"})]}),g.jsx("div",{className:"flex items-center space-x-4",children:g.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 rounded-full flex items-center gap-2 px-4 py-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:o,onClick:()=>{E&&!E.isAnonymous?Os(!0):bi(!0)},children:E&&!E.isAnonymous?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),g.jsx("span",{className:"text-sm",children:E.email})]}):g.jsxs(g.Fragment,{children:[g.jsx(sI,{className:"w-5 h-5"}),"התחבר"]})})})]}),g.jsx("div",{className:"md:hidden py-3",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("div",{className:"flex items-center",children:g.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 rounded-full flex items-center gap-2 px-3 py-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm",disabled:o,onClick:()=>{E&&!E.isAnonymous?Os(!0):bi(!0)},children:E&&!E.isAnonymous?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full flex items-center justify-center",children:g.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),g.jsx("span",{className:"text-xs",children:E.email})]}):g.jsxs(g.Fragment,{children:[g.jsx(sI,{className:"w-4 h-4"}),"התחבר"]})})}),g.jsx("div",{className:"flex items-center",children:g.jsx("img",{src:"/Logo.png",alt:"MoomHe Logo",className:"h-12 w-auto"})})]})})]})}),g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-8",children:[g.jsxs("div",{className:"block lg:hidden",children:[g.jsx("div",{className:"mb-6 -mt-4",children:g.jsxs("div",{className:"bg-white shadow-sm border-b border-gray-200 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-4",children:[g.jsxs("div",{className:"relative mb-4",children:[g.jsx("div",{className:"w-full rounded-lg shadow-lg overflow-hidden transition-all duration-300",style:{aspectRatio:Mn,maxHeight:"50vh"},children:g.jsx("img",{src:i,alt:"Main room design",onClick:ia,onLoad:Ci,className:`w-full h-full object-contain rounded-lg transition-all duration-300 cursor-pointer hover:opacity-90 ${o?"blur-sm cursor-not-allowed":""}`})}),g.jsxs("button",{onClick:Kl,disabled:o,className:"absolute top-3 right-3 bg-blue-500/70 hover:bg-blue-500/90 text-white px-3 py-2 rounded-lg text-xs font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm flex items-center gap-1",children:[g.jsx(iI,{className:"w-3 h-3"}),"העלה תמונה"]}),g.jsxs("div",{className:"absolute top-3 left-3 flex gap-2",children:[g.jsx("button",{onClick:Td,disabled:o,className:"w-8 h-8 bg-green-600/70 hover:bg-green-600/90 text-white rounded-full flex items-center justify-center transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm",title:"הורדה",children:g.jsx(Z0,{className:"w-4 h-4"})}),g.jsx("button",{onClick:Vs,disabled:o,className:"w-8 h-8 bg-green-500/70 hover:bg-green-500/90 text-white rounded-full flex items-center justify-center transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm",title:"שיתוף בווטסאפ",children:g.jsx(tI,{className:"w-4 h-4"})})]}),o&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-lg",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-12 h-12 border-4 border-white/30 border-t-white rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-6 h-6 border-2 border-white/50 border-b-white rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]}),g.jsxs("div",{className:"mb-4",children:[g.jsxs("div",{className:"flex gap-2 mb-4",children:[g.jsx("button",{onClick:Wl,disabled:o||sn,className:`flex-shrink-0 w-10 h-10 rounded-full border-2 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 select-none ${gt?"bg-green-500 border-green-500 text-white animate-pulse":sn?"bg-blue-500 border-blue-500 text-white":"bg-green-500 border-green-500 hover:bg-green-600 hover:border-green-600 text-white"}`,title:gt?"לחץ כדי לעצור הקלטה":sn?"מעבד הקלטה...":"לחץ כדי להתחיל הקלטה קולית",children:sn?g.jsx(eI,{className:"w-5 h-5 animate-spin"}):gt?g.jsx(nI,{className:"w-5 h-5"}):g.jsx(rI,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex-1 relative",children:[g.jsx("input",{type:"text",value:lt,onChange:w=>Tt(w.target.value),placeholder:"הקלד שינוי...",disabled:o,className:"w-full px-3 py-2 pr-8 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed overflow-x-auto",style:{textAlign:"right",direction:"rtl",overflowX:"auto",whiteSpace:"nowrap"},onKeyPress:w=>{w.key==="Enter"&&Fs()}}),lt&&g.jsx("button",{onClick:()=>Tt(""),disabled:o,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]})]}),(gt||sn)&&g.jsx("div",{className:"mt-2 text-center",children:g.jsxs("div",{className:`inline-flex items-center gap-2 text-sm px-3 py-1 rounded-full ${gt?"text-green-600 bg-green-50":"text-blue-600 bg-blue-50"}`,children:[g.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${gt?"bg-green-500":"bg-blue-500"}`}),g.jsx("span",{children:gt?"מקשיב... לחץ על הכפתור כדי לעצור":"מעבד הקלטה..."})]})}),Hl&&g.jsx("div",{className:"mt-2 text-center",children:g.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-red-600 bg-red-50 px-3 py-1 rounded-full",children:[g.jsx("span",{children:"❌"}),g.jsx("span",{children:"נדרשת הרשאה לגישה למיקרופון"})]})}),yr&&g.jsx("div",{className:"mt-2 text-center",children:g.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-red-600 bg-red-50 px-3 py-1 rounded-full",children:[g.jsx("span",{children:"⚠️"}),g.jsx("span",{children:yr})]})})]}),g.jsxs("div",{className:"relative",children:[g.jsxs("div",{className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2 mb-4",ref:w=>{w&&w.addEventListener("scroll",()=>{const C=w.scrollWidth>w.clientWidth,U=w.scrollLeft<=5,Q=w.scrollLeft+w.clientWidth>=w.scrollWidth-5,X=w.parentElement.querySelector(".fade-overlay-left"),se=w.parentElement.querySelector(".fade-overlay-right");X&&(X.style.opacity=C&&!Q?"1":"0"),se&&(se.style.opacity=C&&!U?"1":"0")})},children:[g.jsxs("button",{onClick:o?void 0:sa,disabled:o,className:"flex-1 btn-secondary border-2 border-dashed border-blue-400 hover:border-blue-500 hover:bg-blue-50 flex items-center justify-center text-sm px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[Fr?g.jsxs("div",{className:"relative w-4 h-4 ml-2",children:[g.jsx("img",{src:Fr,alt:"Object to add",className:"w-full h-full object-cover rounded border border-gray-300"}),g.jsx("button",{onClick:w=>{w.stopPropagation(),Ad()},disabled:o,className:"absolute -top-1 -right-1 bg-red-500 hover:bg-red-600 text-white rounded-full w-3 h-3 flex items-center justify-center text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}):g.jsx(da,{className:"w-4 h-4 text-blue-500 ml-2"}),g.jsx("span",{className:"text-blue-600",children:"הוסף אובייקט"})]}),g.jsxs("button",{onClick:()=>mr(!0),disabled:o,className:"flex-1 btn-secondary flex items-center justify-center text-sm px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(an,{className:"w-4 h-4 ml-2"}),"הצעות..."]}),g.jsxs("button",{onClick:Fs,disabled:o||!lt.trim(),className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center gap-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("span",{className:"text-sm font-medium",children:"בצע"}),g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})]}),g.jsx("div",{className:"fade-overlay-left absolute top-0 left-0 w-8 h-full bg-gradient-to-r from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"}),g.jsx("div",{className:"fade-overlay-right absolute top-0 right-0 w-8 h-full bg-gradient-to-l from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"})]}),g.jsx("input",{ref:Jn,type:"file",accept:"image/*",onChange:wr,className:"hidden"})]})}),g.jsx("input",{ref:wd,type:"file",accept:"image/*",onChange:Ed,className:"hidden"}),g.jsx("div",{className:"space-y-4",children:g.jsxs("div",{className:"card p-4 relative",children:[g.jsxs("h3",{className:"text-lg font-semibold text-text mb-3 flex items-center",children:[g.jsx("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"יצירות"]}),g.jsx("div",{className:`transition-opacity duration-300 ${Ct||o?"opacity-50 pointer-events-none":""}`,children:(_||[]).length===0?g.jsxs("div",{className:"text-center py-6",children:[g.jsx("div",{className:"text-gray-400 mb-2",children:g.jsx(ih,{className:"w-6 h-6 mx-auto"})}),g.jsx("p",{className:"text-sm text-gray-500",children:"אין עריכות עדיין"}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"התמונות שייווצרו יופיעו כאן"})]}):g.jsxs("div",{className:"relative",children:[g.jsxs("div",{ref:Jp,className:"flex gap-3 overflow-x-auto scrollbar-visible pb-2",onScroll:w=>{const{scrollLeft:C,scrollWidth:U,clientWidth:Q}=w.target;C+Q>=U-10&&Ti&&!Ai&&Ms();const X=U>Q,se=C<=5,Ee=C+Q>=U-5,ve=w.target.parentElement.querySelector(".image-fade-overlay-left"),le=w.target.parentElement.querySelector(".image-fade-overlay-right");ve&&(ve.style.opacity=X&&!Ee?"1":"0"),le&&(le.style.opacity=X&&!se?"1":"0")},children:[(_||[]).map(w=>g.jsxs("div",{onClick:()=>Ql(w),className:"cursor-pointer group flex-shrink-0 w-24",children:[g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:w.thumbnailUrl||w.storageUrl||w.imageUrl,alt:"History entry",className:"w-24 h-24 object-cover rounded-lg group-hover:opacity-80 transition-opacity duration-200"}),g.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-200 rounded-lg"})]}),g.jsxs("div",{className:"mt-1",children:[g.jsx("p",{className:"text-xs text-gray-600 truncate",title:w.prompt||"No prompt",children:w.prompt&&w.prompt.length>15?`${w.prompt.substring(0,15)}...`:w.prompt||"No prompt"}),g.jsx("p",{className:"text-xs text-gray-400",children:kd(w)})]})]},w.id)),Ai&&g.jsx("div",{className:"flex-shrink-0 flex items-center justify-center w-24",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})})]}),g.jsx("div",{className:"image-fade-overlay-left absolute top-0 left-0 w-6 h-full bg-gradient-to-r from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"}),g.jsx("div",{className:"image-fade-overlay-right absolute top-0 right-0 w-6 h-full bg-gradient-to-l from-white to-transparent pointer-events-none transition-opacity duration-300 opacity-0"})]})}),Ct&&g.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-xl flex items-center justify-center",children:g.jsx("div",{className:"relative",children:g.jsx("div",{className:"w-8 h-8 border-4 border-gray-300 border-t-purple-500 rounded-full animate-spin"})})})]})})]}),g.jsxs("div",{className:"hidden lg:grid grid-cols-1 lg:grid-cols-4 gap-8",children:[g.jsx("div",{className:"lg:col-span-1 lg:order-1",children:g.jsxs("div",{className:"card p-4 relative",children:[g.jsx("h3",{className:"text-lg font-semibold text-text mb-3",children:"יצירות"}),g.jsx("div",{className:`transition-opacity duration-300 ${Ct||o?"opacity-50 pointer-events-none":""}`,children:(_||[]).length===0?g.jsxs("div",{className:"text-center py-8",children:[g.jsx("div",{className:"text-gray-400 mb-2",children:g.jsx(ih,{className:"w-8 h-8 mx-auto"})}),g.jsx("p",{className:"text-sm text-gray-500",children:"אין עריכות עדיין"}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"התמונות שייווצרו יופיעו כאן"})]}):g.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-visible",onScroll:w=>{const{scrollTop:C,scrollHeight:U,clientHeight:Q}=w.target;C+Q>=U-10&&Ti&&!Ai&&Ms()},children:[(_||[]).map(w=>g.jsxs("div",{onClick:()=>Ql(w),className:"cursor-pointer group",children:[g.jsxs("div",{className:"relative",children:[g.jsx("img",{src:w.thumbnailUrl||w.storageUrl||w.imageUrl,alt:"History entry",className:"w-full h-24 object-cover rounded-lg group-hover:opacity-80 transition-opacity duration-200"}),g.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-200 rounded-lg"})]}),g.jsxs("div",{className:"mt-2",children:[g.jsx("p",{className:"text-xs text-gray-600 truncate",title:w.prompt||"No prompt",children:w.prompt&&w.prompt.length>30?`${w.prompt.substring(0,30)}...`:w.prompt||"No prompt"}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:kd(w)})]})]},w.id)),Ai?g.jsx("div",{className:"flex justify-center py-4",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):Ti?g.jsx("div",{className:"flex justify-center py-4",children:g.jsx("button",{onClick:Ms,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 text-sm",children:"טען עוד"})}):null]})}),Ct&&g.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-xl flex items-center justify-center",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-purple-500 rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-400 border-b-purple-600 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]})}),g.jsx("div",{className:"lg:col-span-1 lg:order-3",children:g.jsxs("div",{className:"card p-4 relative",children:[g.jsxs("div",{className:"flex items-center justify-between mb-3",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"אובייקטים"}),g.jsx("button",{onClick:()=>Xp(i),disabled:ae||!i||o||!_e,className:"w-8 h-8 bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800 rounded-full flex items-center justify-center transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:_e?"רענן רשימת אובייקטים":"בחר תמונה מההיסטוריה תחילה",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),g.jsx("div",{className:`transition-opacity duration-300 ${ae||o?"opacity-50 pointer-events-none":""}`,children:(Y||[]).length===0?g.jsxs("div",{className:"text-center py-8",children:[g.jsx("div",{className:"text-gray-400 mb-2",children:g.jsx(ih,{className:"w-8 h-8 mx-auto"})}),g.jsx("p",{className:"text-sm text-gray-500",children:"אין אובייקטים זוהו"}),g.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"האובייקטים יופיעו כאן"})]}):g.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto scrollbar-visible",children:(Y||[]).map((w,C)=>g.jsx("div",{onClick:()=>Nd(w),className:"rounded-lg p-3 transition-colors duration-200 cursor-pointer bg-gray-50 hover:bg-gray-100 border-2 border-transparent",children:g.jsx("p",{className:"text-sm font-medium text-gray-700",children:w})},C))})}),ae&&g.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm rounded-xl flex items-center justify-center",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-orange-500 rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-6 h-6 border-2 border-gray-400 border-b-orange-600 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]})}),g.jsx("div",{className:"lg:col-span-2 lg:order-2",children:g.jsxs("div",{className:"card p-6",children:[g.jsxs("div",{className:"relative mb-6",children:[g.jsx("div",{className:"w-full rounded-lg shadow-lg overflow-hidden transition-all duration-300",style:{aspectRatio:Mn,maxHeight:"70vh"},children:g.jsx("img",{src:i,alt:"Main room design",onClick:ia,onLoad:Ci,className:`w-full h-full object-contain rounded-lg transition-all duration-300 cursor-pointer hover:opacity-90 ${o?"blur-sm cursor-not-allowed":""}`})}),g.jsxs("button",{onClick:Kl,disabled:o,className:"absolute top-4 right-4 bg-blue-500/70 hover:bg-blue-500/90 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm flex items-center gap-2",children:[g.jsx(iI,{className:"w-4 h-4"}),"העלה תמונה"]}),g.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[g.jsx("button",{onClick:Td,disabled:o,className:"w-10 h-10 bg-green-600/70 hover:bg-green-600/90 text-white rounded-full flex items-center justify-center transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm",title:"הורדה",children:g.jsx(Z0,{className:"w-5 h-5"})}),g.jsx("button",{onClick:Vs,disabled:o,className:"w-10 h-10 bg-green-500/70 hover:bg-green-500/90 text-white rounded-full flex items-center justify-center transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm",title:"שיתוף בווטסאפ",children:g.jsx(tI,{className:"w-5 h-5"})})]}),o&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-lg",children:g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin"}),g.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:g.jsx("div",{className:"w-8 h-8 border-2 border-white/50 border-b-white rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"0.8s"}})})]})})]}),g.jsxs("div",{className:"mb-6",children:[g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:Wl,disabled:o||sn,className:`flex-shrink-0 w-12 h-12 rounded-full border-2 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 select-none ${gt?"bg-green-500 border-green-500 text-white animate-pulse":sn?"bg-blue-500 border-blue-500 text-white":"bg-green-500 border-green-500 hover:bg-green-600 hover:border-green-600 text-white"}`,title:gt?"לחץ כדי לעצור הקלטה":sn?"מעבד הקלטה...":"לחץ כדי להתחיל הקלטה קולית",children:sn?g.jsx(eI,{className:"w-6 h-6 animate-spin"}):gt?g.jsx(nI,{className:"w-6 h-6"}):g.jsx(rI,{className:"w-6 h-6"})}),g.jsxs("div",{className:"flex-1 relative",children:[g.jsx("input",{type:"text",value:lt,onChange:w=>Tt(w.target.value),placeholder:"הקלד שינוי...",disabled:o,className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed overflow-x-auto",style:{textAlign:"right",direction:"rtl",overflowX:"auto",whiteSpace:"nowrap"},onKeyPress:w=>{w.key==="Enter"&&Fs()}}),lt&&g.jsx("button",{onClick:()=>Tt(""),disabled:o,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]})]}),(gt||sn)&&g.jsx("div",{className:"mt-3 text-center",children:g.jsxs("div",{className:`inline-flex items-center gap-2 text-sm px-4 py-2 rounded-full ${gt?"text-green-600 bg-green-50":"text-blue-600 bg-blue-50"}`,children:[g.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${gt?"bg-green-500":"bg-blue-500"}`}),g.jsx("span",{children:gt?"מקשיב... לחץ על הכפתור כדי לעצור":"מעבד הקלטה..."})]})}),Hl&&g.jsx("div",{className:"mt-3 text-center",children:g.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-red-600 bg-red-50 px-4 py-2 rounded-full",children:[g.jsx("span",{children:"❌"}),g.jsx("span",{children:"נדרשת הרשאה לגישה למיקרופון"})]})}),yr&&g.jsx("div",{className:"mt-3 text-center",children:g.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-red-600 bg-red-50 px-4 py-2 rounded-full",children:[g.jsx("span",{children:"⚠️"}),g.jsx("span",{children:yr})]})})]}),g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("div",{className:"relative",children:[Fr?g.jsxs("div",{className:"relative btn-secondary h-10 w-24 flex items-center justify-center",children:[g.jsx("img",{src:Fr,alt:"Object to add",className:"w-6 h-6 object-cover rounded border border-gray-300"}),g.jsx("button",{onClick:Ad,disabled:o,className:"absolute -top-1 -right-1 bg-red-500 hover:bg-red-600 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}):g.jsxs("button",{onClick:o?void 0:sa,disabled:o,className:"flex-1 btn-secondary h-10 border-2 border-dashed border-blue-400 hover:border-blue-500 hover:bg-blue-50 flex items-center justify-center transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(da,{className:"w-4 h-4 text-blue-500 ml-2"}),g.jsx("span",{className:"text-sm text-blue-600",children:"הוסף אובייקט"})]}),g.jsx("input",{ref:Jn,type:"file",accept:"image/*",onChange:wr,className:"hidden"})]}),g.jsxs("div",{className:"relative",ref:_r,children:[g.jsxs("button",{onClick:()=>zl(!xi),disabled:o,className:"flex-1 btn-secondary flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(an,{className:"w-4 h-4 ml-2"}),"הצעות..."]}),xi&&g.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-48",children:(Zn=ra[t])==null?void 0:Zn.map((w,C)=>g.jsxs("button",{onClick:()=>{w.action(),zl(!1)},disabled:o,className:"w-full px-4 py-2 text-right hover:bg-gray-50 flex items-center justify-end gap-2 disabled:opacity-50 disabled:cursor-not-allowed border-b border-gray-100 last:border-b-0",children:[g.jsx("span",{children:w.name}),g.jsx(w.icon,{className:"w-4 h-4"})]},C))})]}),g.jsxs("button",{onClick:Fs,disabled:o||!lt.trim(),className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center gap-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("span",{className:"text-sm font-medium",children:"בצע"}),g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})]})]})})]})]}),l&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 h-[85vh] overflow-hidden max-w-[95vw] md:max-w-6xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"בחר צבע RAL"}),g.jsx("button",{onClick:()=>u(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsx("div",{className:"flex flex-wrap gap-1 md:gap-2 mb-4 md:mb-6 border-b border-gray-200 pb-3 md:pb-4",children:Object.keys(js).map(w=>g.jsxs("button",{onClick:()=>Yp(w),disabled:o,className:`flex items-center gap-2 px-2 md:px-4 py-1 md:py-2 rounded-lg font-medium text-xs md:text-sm transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed ${pd===w?"bg-blue-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[g.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300",style:{backgroundColor:Xn[w]}}),w]},w))}),g.jsx("div",{className:"h-96 overflow-y-auto",children:g.jsx("div",{className:"grid grid-cols-4 md:grid-cols-8 gap-2 md:gap-3",children:(Jl=js[pd])==null?void 0:Jl.map((w,C)=>g.jsxs("button",{onClick:()=>oa(w),disabled:o,className:"flex flex-col items-center p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-gray-300 shadow-sm mb-2",style:{backgroundColor:w.hex}}),g.jsx("span",{className:"text-xs text-text font-medium text-center leading-tight",children:w.ral}),g.jsx("span",{className:"text-xs text-gray-500 text-center leading-tight mt-1",children:w.name})]},C))})})]})})}),d&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"בחר זווית ופרספקטיבה"}),g.jsx("button",{onClick:()=>f(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:Dd.map((w,C)=>g.jsxs("button",{onClick:()=>Zp(w),disabled:o,className:"flex items-center p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("span",{className:"text-2xl ml-3",children:w.icon}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-sm font-medium text-text",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.value})]})]},C))})]})})}),p&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"בחר סוג תאורה"}),g.jsx("button",{onClick:()=>v(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:ke.map((w,C)=>g.jsxs("button",{onClick:()=>Od(w),disabled:o,className:"flex items-center p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx("span",{className:"text-2xl ml-3",children:"💡"}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-sm font-medium text-text",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.value})]})]},C))})]})})}),S&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"בחר סוג ריהוט"}),g.jsx("button",{onClick:()=>P(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:aa.map((w,C)=>g.jsx("button",{onClick:()=>em(w),disabled:o,className:"flex items-center p-4 rounded-lg hover:bg-gray-50 transition-colors duration-200 border border-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:g.jsxs("div",{className:"text-right w-full",children:[g.jsx("div",{className:"text-sm font-medium text-text",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.value})]})},C))})]})})}),N&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[70vh] overflow-y-auto max-w-[95vw] md:max-w-2xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"בחר סוג תיקון/נזק"}),g.jsx("button",{onClick:()=>T(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Us.map(w=>g.jsxs("button",{onClick:()=>tm(w),disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Oi,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsx("span",{className:"text-sm font-medium text-gray-800",children:w.name})]},w.value))})]})})}),I&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[80vh] overflow-y-auto max-w-[95vw] md:max-w-3xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"בחר סגנון עיצוב"}),g.jsx("button",{onClick:()=>b(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Bs.map(w=>g.jsxs("button",{onClick:()=>nm(w),disabled:o,className:"flex flex-col items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-center",children:[g.jsx(on,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800 mb-1",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.value})]})]},w.value))})]})})}),M&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[80vh] overflow-y-auto max-w-[95vw] md:max-w-4xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"דלתות וחלונות"}),g.jsx("button",{onClick:()=>$(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות חלונות"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"חלון מפרץ/קשת",value:"הוסף חלון מפרץ או קשת שמגדיל את החלל",hebrew:"הוסף חלון מפרץ או קשת שמגדיל את החלל"},{name:"חלון תמונה",value:"Picture Window: Large, fixed view.",hebrew:"הוסף חלון תמונה גדול עם נוף קבוע"},{name:"חלון ציר",value:"Casement Window: Outward crank open.",hebrew:"הוסף חלון ציר שנפתח החוצה"},{name:"חלון גג/מנהרת שמש",value:"Skylight / Sun Tunnel: Light from above.",hebrew:"הוסף חלון גג או מנהרת שמש לאור מלמעלה"},{name:"חלון טרנזום",value:"Transom Window: Sits over door.",hebrew:"הוסף חלון טרנזום מעל הדלת"},{name:"חלון פנימי",value:"Interior Window: Between two rooms.",hebrew:"הוסף חלון פנימי בין שני חדרים"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),$(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Om,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות דלתות"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"דלתות צרפתיות",value:"French Doors: Glass pane entry.",hebrew:"הוסף דלתות צרפתיות עם זכוכית"},{name:"דלת כיס",value:"Pocket Door: Slides inside wall.",hebrew:"הוסף דלת כיס שנכנסת לתוך הקיר"},{name:"דלת אסם",value:"Barn Door: Sliding exposed track.",hebrew:"הוסף דלת אסם עם מסילה גלויה"},{name:"דלת לובר",value:"Louvered Door: Vented slats, air.",hebrew:"הוסף דלת לובר עם סורגים לאוורור"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),$(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(Om,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]})]})]})})}),z&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-h-[80vh] overflow-y-auto max-w-[95vw] md:max-w-4xl",children:g.jsxs("div",{className:"p-4 md:p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"אפשרויות רחצה"}),g.jsx("button",{onClick:()=>A(!1),disabled:o,className:"text-gray-500 hover:text-gray-700 text-xl disabled:opacity-50 disabled:cursor-not-allowed",children:"×"})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות אסלה"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"מושב אסלה",value:"Toilet Seat: Slow-close lid",hebrew:"הוסף מושב אסלה עם מכסה שנסגר לאט"},{name:"בידט מחומם",value:"Toilet Seat: Heated bidet function",hebrew:"הוסף מושב אסלה עם פונקציית בידט מחוממת"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(an,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות אמבטיה"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"אמבטיה עומדת",value:"Bathtub: Freestanding oval soak",hebrew:"הוסף אמבטיה עומדת אליפטית"},{name:"אמבטיה וינטג",value:"Bathtub: Clawfoot vintage design",hebrew:"הוסף אמבטיה וינטג עם רגליים מעוצבות"},{name:"אמבטיה סטנדרטית",value:"Bathtub: Drop-in standard size",hebrew:"הוסף אמבטיה סטנדרטית מובנית"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(an,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות מקלחת"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"מקלחת זכוכית",value:"Shower: Walk-in frameless glass",hebrew:"הוסף מקלחת עם זכוכית ללא מסגרת"},{name:"מקלחת גשם",value:"Shower: Rainfall head system",hebrew:"הוסף מקלחת עם מערכת ראש גשם"},{name:"מקלחת דלתות",value:"Shower: Sliding door enclosure",hebrew:"הוסף מקלחת עם דלתות הזזה"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(an,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות כיור"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"כיור כלי",value:"Sink (Vanity): Vessel bowl style",hebrew:"הוסף כיור כלי בסגנון קערה"},{name:"כיור עמוד",value:"Sink (Vanity): Pedestal classic look",hebrew:"הוסף כיור עמוד בסגנון קלאסי"},{name:"כיור מובנה",value:"Sink (Vanity): Undermount ceramic white",hebrew:"הוסף כיור מובנה קרמי לבן"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(an,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות ג\\'קוזי/ספא"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"ג'קוזי נייד",value:"Jacuzzi / Spa: Portable vinyl bubble",hebrew:"הוסף ג'קוזי נייד ויניל"},{name:"ג'קוזי מובנה",value:"Jacuzzi / Spa: Built-in tiled perimeter",hebrew:"הוסף ג'קוזי מובנה עם אריחים"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(an,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"אפשרויות בריכה"}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[{name:"בריכה מעל הקרקע",value:"Pool: Above-ground metal frame",hebrew:"הוסף בריכה מעל הקרקע עם מסגרת מתכת"},{name:"בריכה בתוך הקרקע",value:"Pool: In-ground concrete custom",hebrew:"הוסף בריכה בתוך הקרקע מבטון מותאמת אישית"}].map((w,C)=>g.jsxs("button",{onClick:()=>{Te(w.hebrew),A(!1)},disabled:o,className:"flex items-center gap-3 p-4 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-right",children:[g.jsx(an,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),g.jsxs("div",{children:[g.jsx("div",{className:"text-sm font-medium text-gray-800",children:w.name}),g.jsx("div",{className:"text-xs text-gray-500",children:w.hebrew})]})]},C))})]})]})]})})}),Ds&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[60] p-4",onClick:Cd,children:g.jsxs("div",{className:"relative max-w-7xl max-h-full w-full h-full flex items-center justify-center",children:[g.jsx("img",{src:i,alt:"Full size view",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"}),g.jsx("button",{onClick:Cd,className:"absolute top-4 right-4 bg-white/20 hover:bg-white/30 text-white p-3 rounded-full transition-colors duration-200 backdrop-blur-sm",children:g.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),g.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-4 py-2 rounded-full backdrop-blur-sm",children:g.jsx("span",{className:"text-sm",children:"לחץ על התמונה או מחוץ לה לסגירה"})})]})}),ql&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",onClick:()=>mr(!1),children:g.jsxs("div",{className:"suggestions-modal bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[80vh] flex flex-col",onClick:w=>w.stopPropagation(),children:[g.jsx("div",{className:"p-6 border-b border-gray-200",children:g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs("h3",{className:"text-lg font-semibold text-text",children:["הצעות עבור ",t]}),g.jsx("button",{onClick:()=>mr(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"×"})]})}),g.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:g.jsx("div",{className:"space-y-3",children:(Xl=ra[t])==null?void 0:Xl.map((w,C)=>g.jsxs("button",{onClick:()=>{w.action(),mr(!1)},disabled:o,className:"w-full px-4 py-3 text-right hover:bg-gray-50 flex items-center justify-start gap-3 disabled:opacity-50 disabled:cursor-not-allowed border border-gray-200 rounded-lg transition-colors duration-200",children:[g.jsx(w.icon,{className:"w-5 h-5 text-gray-600"}),g.jsx("span",{className:"text-sm font-medium",children:w.name})]},C))})}),g.jsx("div",{className:"p-6 border-t border-gray-200",children:g.jsx("button",{onClick:()=>mr(!1),className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors duration-200",children:"סגור"})})]})}),gd&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-w-md",children:g.jsxs("div",{className:"p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:"התנתקות"}),g.jsx("button",{onClick:()=>Os(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"×"})]}),g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("p",{className:"text-gray-600 mb-4",children:"האם אתה בטוח שברצונך להתנתק?"}),g.jsx("p",{className:"text-sm text-gray-500",children:E==null?void 0:E.email})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:()=>Os(!1),className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-lg transition-colors duration-200",children:"ביטול"}),g.jsx("button",{onClick:Yl,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200",children:"התנתק"})]})]})})}),md&&g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:g.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full mx-4 max-w-md",children:g.jsxs("div",{className:"p-6",children:[g.jsxs("div",{className:"flex justify-between items-center mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold text-text",children:vn==="login"?"התחברות":"יצירת חשבון"}),g.jsx("button",{onClick:()=>{bi(!1),ct(""),Ri(""),Jo(""),Br("signup")},className:"text-gray-500 hover:text-gray-700 text-xl",children:"×"})]}),g.jsxs("form",{onSubmit:bd,className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"כתובת אימייל"}),g.jsx("input",{type:"email",value:Yt,onChange:w=>ct(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),vn==="signup"&&g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"אישור כתובת אימייל"}),g.jsx("input",{type:"email",value:mt,onChange:w=>Ri(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"הזן שוב את כתובת האימייל",required:!0})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"סיסמה"}),g.jsx("input",{type:"password",value:pr,onChange:w=>Jo(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"הזן סיסמה",required:!0,minLength:6})]}),vn==="login"&&g.jsx("div",{className:"text-center",children:g.jsx("button",{type:"button",onClick:Rd,disabled:Bl||!Yt,className:"text-blue-600 hover:text-blue-800 text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:Bl?"שולח...":"שכחת סיסמה?"})}),g.jsx("button",{type:"submit",disabled:yd||!Yt||!pr||vn==="signup"&&!mt,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:yd?"מעבד...":vn==="login"?"התחבר":"צור חשבון"})]}),g.jsx("div",{className:"mt-4 text-center",children:g.jsx("button",{onClick:()=>Br(vn==="login"?"signup":"login"),className:"border border-blue-600 text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200",children:vn==="login"?"אין לך חשבון? צור חשבון חדש":"יש לך חשבון? התחבר"})})]})})}),g.jsx("footer",{className:"bg-gray-50 border-t border-gray-200 py-6 mt-12",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[g.jsx("div",{className:"text-sm text-gray-500",children:"© 2025 MoomHe. כל הזכויות שמורות."}),g.jsxs("div",{className:"flex space-x-6 space-x-reverse",children:[g.jsx("a",{href:"/eula.html",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors duration-200",children:"הסכם שימוש"}),g.jsx("a",{href:"/privacy.html",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors duration-200",children:"מדיניות פרטיות"})]})]})})})]})}cg.createRoot(document.getElementById("root")).render(g.jsx(ck.StrictMode,{children:g.jsx(R6,{})}));export{MV as $,O6 as A,Y6 as B,n5 as C,u4 as D,vu as E,qi as F,Gi as G,M6 as H,PL as I,d5 as J,b5 as K,$I as L,sM as M,tV as N,ui as O,fo as P,i5 as Q,p5 as R,uy as S,r4 as T,K6 as U,RV as V,g5 as W,I5 as X,A5 as Y,h5 as Z,jV as _,Yu as a,Ro as a$,F6 as a0,yL as a1,SV as a2,y5 as a3,w5 as a4,T5 as a5,NL as a6,c5 as a7,J6 as a8,B6 as a9,Lr as aA,xe as aB,xn as aC,Ho as aD,Go as aE,De as aF,j as aG,Vr as aH,C3 as aI,nU as aJ,kt as aK,Fl as aL,dd as aM,Kh as aN,Wp as aO,hd as aP,Hp as aQ,pw as aR,Pn as aS,Gp as aT,es as aU,Ae as aV,tU as aW,ur as aX,Z3 as aY,hv as aZ,tt as a_,W6 as aa,r5 as ab,bV as ac,Z_ as ad,U6 as ae,G6 as af,Q6 as ag,m5 as ah,v5 as ai,E5 as aj,l5 as ak,j6 as al,a5 as am,e5 as an,t5 as ao,_5 as ap,Z6 as aq,o5 as ar,s5 as as,X6 as at,q6 as au,yP as av,Du as aw,O3 as ax,Tn as ay,D5 as az,Qu as b,Wh as b$,G as b0,x5 as b1,h4 as b2,We as b3,NB as b4,fe as b5,S5 as b6,CB as b7,kB as b8,k5 as b9,K5 as bA,W5 as bB,Xe as bC,fd as bD,q3 as bE,dB as bF,z3 as bG,nB as bH,rB as bI,jy as bJ,iB as bK,sB as bL,N3 as bM,RB as bN,EB as bO,O5 as bP,og as bQ,H5 as bR,bT as bS,hB as bT,pB as bU,fB as bV,D3 as bW,Uy as bX,cB as bY,uB as bZ,z5 as b_,Kn as ba,E4 as bb,lB as bc,J5 as bd,X5 as be,q5 as bf,IB as bg,wB as bh,Y5 as bi,M5 as bj,cd as bk,C5 as bl,k3 as bm,B3 as bn,PB as bo,aB as bp,_B as bq,U5 as br,xB as bs,yo as bt,$5 as bu,Z5 as bv,L5 as bw,V5 as bx,j5 as by,SB as bz,V6 as c,mB as c0,gB as c1,J3 as c2,Hh as c3,rP as c4,eB as c5,N5 as c6,yB as c7,vB as c8,Qp as c9,bB as ca,R5 as cb,tB as cc,U3 as cd,G5 as ce,Q5 as cf,B5 as cg,oB as ch,TB as ci,F5 as cj,Gh as ck,AB as cl,WP as cm,x6 as cn,Bo as d,k6 as e,Hi as f,Nh as g,D6 as h,Ha as i,n4 as j,C6 as k,N6 as l,uv as m,Wi as n,z6 as o,FV as p,f5 as q,GV as r,t4 as s,TR as t,PV as u,$6 as v,rV as w,H6 as x,L6 as y,u5 as z};
